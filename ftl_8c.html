<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FEMU: bbssd/ftl.c 文件参考</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FEMU
   &#160;<span id="projectnumber">原版 master 7e238cc</span>
   </div>
   <div id="projectbrief">FEMU: Accurate, Scalable and Extensible NVMe SSD Emulator (FAST&#39;18)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ftl_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">函数</a>  </div>
  <div class="headertitle">
<div class="title">ftl.c 文件参考</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="ftl_8h_source.html">ftl.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
ftl.c 的引用(Include)关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c__incl.png" border="0" usemap="#bbssd_2ftl_8c" alt=""/></div>
<map name="bbssd_2ftl_8c" id="bbssd_2ftl_8c">
<area shape="rect" title=" " alt="" coords="892,5,980,32"/>
<area shape="rect" href="ftl_8h.html" title=" " alt="" coords="913,80,959,107"/>
<area shape="rect" href="nvme_8h.html" title=" " alt="" coords="895,155,977,181"/>
<area shape="rect" title=" " alt="" coords="5,229,120,256"/>
<area shape="rect" title=" " alt="" coords="145,229,247,256"/>
<area shape="rect" title=" " alt="" coords="272,229,379,256"/>
<area shape="rect" title=" " alt="" coords="403,229,514,256"/>
<area shape="rect" title=" " alt="" coords="539,229,651,256"/>
<area shape="rect" title=" " alt="" coords="675,229,779,256"/>
<area shape="rect" title=" " alt="" coords="803,229,933,256"/>
<area shape="rect" title=" " alt="" coords="957,229,1053,256"/>
<area shape="rect" title=" " alt="" coords="1078,229,1197,256"/>
<area shape="rect" href="dram_8h.html" title=" " alt="" coords="1221,229,1347,256"/>
<area shape="rect" href="rte__ring_8h.html" title=" " alt="" coords="1372,229,1479,256"/>
<area shape="rect" href="pqueue_8h.html" title="Priority Queue function declarations" alt="" coords="1503,229,1609,256"/>
<area shape="rect" href="nand_8h.html" title=" " alt="" coords="1633,229,1735,256"/>
<area shape="rect" href="timing_8h.html" title=" " alt="" coords="1760,229,1928,256"/>
<area shape="rect" title=" " alt="" coords="1134,304,1205,331"/>
<area shape="rect" title=" " alt="" coords="1229,304,1296,331"/>
<area shape="rect" title=" " alt="" coords="1321,304,1421,331"/>
<area shape="rect" title=" " alt="" coords="1445,304,1513,331"/>
<area shape="rect" title=" " alt="" coords="1537,304,1639,331"/>
<area shape="rect" href="rte__atomic__x86_8h.html" title=" " alt="" coords="1663,304,1798,331"/>
<area shape="rect" href="rte__branch__prediction_8h.html" title=" " alt="" coords="1822,304,1997,331"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
函数</h2></td></tr>
<tr class="memitem:a3716c928ff3ccf16e82ae281fd3dd6d3"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3">ftl_thread</a> (void *arg)</td></tr>
<tr class="separator:a3716c928ff3ccf16e82ae281fd3dd6d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6722c643872772d48598187782365209"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a6722c643872772d48598187782365209">should_gc</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>)</td></tr>
<tr class="separator:a6722c643872772d48598187782365209"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4494881726f0faee876d503fa1f2e312"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a4494881726f0faee876d503fa1f2e312">should_gc_high</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>)</td></tr>
<tr class="separator:a4494881726f0faee876d503fa1f2e312"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af93eee663d18640559cfd06afdeb5409"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structppa.html">ppa</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#af93eee663d18640559cfd06afdeb5409">get_maptbl_ent</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, uint64_t lpn)</td></tr>
<tr class="separator:af93eee663d18640559cfd06afdeb5409"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab02c4873ff387abfd6f268ae711fd0b5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#ab02c4873ff387abfd6f268ae711fd0b5">set_maptbl_ent</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, uint64_t lpn, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:ab02c4873ff387abfd6f268ae711fd0b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c2e22192ca991c459c54bead5b1ff98"><td class="memItemLeft" align="right" valign="top">static uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a3c2e22192ca991c459c54bead5b1ff98">ppa2pgidx</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:a3c2e22192ca991c459c54bead5b1ff98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92e6cdd7677ef48c1830b6fbba09a28a"><td class="memItemLeft" align="right" valign="top">static uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a92e6cdd7677ef48c1830b6fbba09a28a">get_rmap_ent</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:a92e6cdd7677ef48c1830b6fbba09a28a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac3ae48a56045829a6e2f1bf933b1d5b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#aac3ae48a56045829a6e2f1bf933b1d5b">set_rmap_ent</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, uint64_t lpn, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:aac3ae48a56045829a6e2f1bf933b1d5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab36d3c54cb8e6ef53588b549a5803172"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#ab36d3c54cb8e6ef53588b549a5803172">victim_line_cmp_pri</a> (<a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a> next, <a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a> curr)</td></tr>
<tr class="separator:ab36d3c54cb8e6ef53588b549a5803172"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9417ce02aa098194c92e57ef04abb6b7"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a9417ce02aa098194c92e57ef04abb6b7">victim_line_get_pri</a> (void *a)</td></tr>
<tr class="separator:a9417ce02aa098194c92e57ef04abb6b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d8917709dbdb441c13fc5d6ee5204aa"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a6d8917709dbdb441c13fc5d6ee5204aa">victim_line_set_pri</a> (void *a, <a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a> pri)</td></tr>
<tr class="separator:a6d8917709dbdb441c13fc5d6ee5204aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c491d1c863f0b3501bd668a59dec976"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a3c491d1c863f0b3501bd668a59dec976">victim_line_get_pos</a> (void *a)</td></tr>
<tr class="separator:a3c491d1c863f0b3501bd668a59dec976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8e269140ca688f2decf1b684d2e3991"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#ae8e269140ca688f2decf1b684d2e3991">victim_line_set_pos</a> (void *a, size_t pos)</td></tr>
<tr class="separator:ae8e269140ca688f2decf1b684d2e3991"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75e82f66648a13506f57f7bb0fce7a10"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a75e82f66648a13506f57f7bb0fce7a10">ssd_init_lines</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>)</td></tr>
<tr class="separator:a75e82f66648a13506f57f7bb0fce7a10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37afec234fedd2c392569d5ce0af6cb4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a37afec234fedd2c392569d5ce0af6cb4">ssd_init_write_pointer</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>)</td></tr>
<tr class="separator:a37afec234fedd2c392569d5ce0af6cb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b6eca1c9bf137587f4c3c7aed0ea914"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a0b6eca1c9bf137587f4c3c7aed0ea914">check_addr</a> (int a, int max)</td></tr>
<tr class="separator:a0b6eca1c9bf137587f4c3c7aed0ea914"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a659c0c25af9ae17e1771fc5bf7bca444"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structline.html">line</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a659c0c25af9ae17e1771fc5bf7bca444">get_next_free_line</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>)</td></tr>
<tr class="separator:a659c0c25af9ae17e1771fc5bf7bca444"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52df9249316530eb887e0412ca51f048"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a52df9249316530eb887e0412ca51f048">ssd_advance_write_pointer</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>)</td></tr>
<tr class="separator:a52df9249316530eb887e0412ca51f048"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2db76f519a8218ea9cda35e61552a4ec"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structppa.html">ppa</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a2db76f519a8218ea9cda35e61552a4ec">get_new_page</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>)</td></tr>
<tr class="separator:a2db76f519a8218ea9cda35e61552a4ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa555ec9dcfe762eb6c39afa3cb167e3d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#aa555ec9dcfe762eb6c39afa3cb167e3d">check_params</a> (struct <a class="el" href="structssdparams.html">ssdparams</a> *spp)</td></tr>
<tr class="separator:aa555ec9dcfe762eb6c39afa3cb167e3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96c1b582459f3ccfc0643bac1a8cdf35"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a96c1b582459f3ccfc0643bac1a8cdf35">ssd_init_params</a> (struct <a class="el" href="structssdparams.html">ssdparams</a> *spp)</td></tr>
<tr class="separator:a96c1b582459f3ccfc0643bac1a8cdf35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa17bd85978e80a1bb61285f026f7a427"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#aa17bd85978e80a1bb61285f026f7a427">ssd_init_nand_page</a> (struct <a class="el" href="structnand__page.html">nand_page</a> *pg, struct <a class="el" href="structssdparams.html">ssdparams</a> *spp)</td></tr>
<tr class="separator:aa17bd85978e80a1bb61285f026f7a427"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd1c030b3a24f516a3eda967bb936f8d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#afd1c030b3a24f516a3eda967bb936f8d">ssd_init_nand_blk</a> (struct <a class="el" href="structnand__block.html">nand_block</a> *blk, struct <a class="el" href="structssdparams.html">ssdparams</a> *spp)</td></tr>
<tr class="separator:afd1c030b3a24f516a3eda967bb936f8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6428955c80a1fb3371e13b2b2f4ea26"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#ac6428955c80a1fb3371e13b2b2f4ea26">ssd_init_nand_plane</a> (struct <a class="el" href="structnand__plane.html">nand_plane</a> *pl, struct <a class="el" href="structssdparams.html">ssdparams</a> *spp)</td></tr>
<tr class="separator:ac6428955c80a1fb3371e13b2b2f4ea26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae77b0af37a85b3285ff26402ca7d03a5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#ae77b0af37a85b3285ff26402ca7d03a5">ssd_init_nand_lun</a> (struct <a class="el" href="structnand__lun.html">nand_lun</a> *lun, struct <a class="el" href="structssdparams.html">ssdparams</a> *spp)</td></tr>
<tr class="separator:ae77b0af37a85b3285ff26402ca7d03a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4643e6bbe68de1c047ec1d1745a82e3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#aa4643e6bbe68de1c047ec1d1745a82e3">ssd_init_ch</a> (struct <a class="el" href="structssd__channel.html">ssd_channel</a> *ch, struct <a class="el" href="structssdparams.html">ssdparams</a> *spp)</td></tr>
<tr class="separator:aa4643e6bbe68de1c047ec1d1745a82e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a358979ad49087b2f21ead4eb9a153f14"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a358979ad49087b2f21ead4eb9a153f14">ssd_init_maptbl</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>)</td></tr>
<tr class="separator:a358979ad49087b2f21ead4eb9a153f14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae19a0a686346f1ffbfa9e73035efbaad"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#ae19a0a686346f1ffbfa9e73035efbaad">ssd_init_rmap</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>)</td></tr>
<tr class="separator:ae19a0a686346f1ffbfa9e73035efbaad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3f6de830b620d1f3060c7de8c8ddec0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#af3f6de830b620d1f3060c7de8c8ddec0">ssd_init</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n)</td></tr>
<tr class="separator:af3f6de830b620d1f3060c7de8c8ddec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4237c1400d2e5e24f32b77e347163ab9"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a4237c1400d2e5e24f32b77e347163ab9">valid_ppa</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:a4237c1400d2e5e24f32b77e347163ab9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a3067e8cef7d5c0e777cc82cf9c40c3"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a4a3067e8cef7d5c0e777cc82cf9c40c3">valid_lpn</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, uint64_t lpn)</td></tr>
<tr class="separator:a4a3067e8cef7d5c0e777cc82cf9c40c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e8a2a542e569fe2662cbb8cf647590b"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a6e8a2a542e569fe2662cbb8cf647590b">mapped_ppa</a> (struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:a6e8a2a542e569fe2662cbb8cf647590b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadf575bf139734453ba8fa6af20b1ac3"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structssd__channel.html">ssd_channel</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3">get_ch</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:aadf575bf139734453ba8fa6af20b1ac3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc3fd6a4f50d3279de8a77eb9d605a8d"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structnand__lun.html">nand_lun</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d">get_lun</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:adc3fd6a4f50d3279de8a77eb9d605a8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f0b10088699a4513219eafe0e2e4bc6"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structnand__plane.html">nand_plane</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a8f0b10088699a4513219eafe0e2e4bc6">get_pl</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:a8f0b10088699a4513219eafe0e2e4bc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a340d3d702f25d601cb40dbd85a30dd82"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structnand__block.html">nand_block</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82">get_blk</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:a340d3d702f25d601cb40dbd85a30dd82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a080e38a63b4626bd7cf314fcf74f2fb2"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structline.html">line</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a080e38a63b4626bd7cf314fcf74f2fb2">get_line</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:a080e38a63b4626bd7cf314fcf74f2fb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cfafde63950110fe49516abc429ef66"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structnand__page.html">nand_page</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66">get_pg</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:a3cfafde63950110fe49516abc429ef66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0299da5e7e5dd1eb868d80914de35ee8"><td class="memItemLeft" align="right" valign="top">static uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8">ssd_advance_status</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>, struct <a class="el" href="structnand__cmd.html">nand_cmd</a> *ncmd)</td></tr>
<tr class="separator:a0299da5e7e5dd1eb868d80914de35ee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaaf0f3e032de3124ddc61a6111b25db"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#adaaf0f3e032de3124ddc61a6111b25db">mark_page_invalid</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:adaaf0f3e032de3124ddc61a6111b25db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03834614ca890f0367e871939f0ffc3b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b">mark_page_valid</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:a03834614ca890f0367e871939f0ffc3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5313a5ca429ce56095c0c1052c301c15"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a5313a5ca429ce56095c0c1052c301c15">mark_block_free</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:a5313a5ca429ce56095c0c1052c301c15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b9026945c9fcc578ba0f7a7a84a1af1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a4b9026945c9fcc578ba0f7a7a84a1af1">gc_read_page</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:a4b9026945c9fcc578ba0f7a7a84a1af1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1952595f15249cd0335bcf5e12d2048"><td class="memItemLeft" align="right" valign="top">static uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048">gc_write_page</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *old_ppa)</td></tr>
<tr class="separator:ad1952595f15249cd0335bcf5e12d2048"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5f2680b1c6531f6394723c150f11e1c"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structline.html">line</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#ae5f2680b1c6531f6394723c150f11e1c">select_victim_line</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, bool force)</td></tr>
<tr class="separator:ae5f2680b1c6531f6394723c150f11e1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4d530364d4008be453c27d200eacddf"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf">clean_one_block</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:ae4d530364d4008be453c27d200eacddf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c41ad05315023bfa77846568e4f7282"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a2c41ad05315023bfa77846568e4f7282">mark_line_free</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, struct <a class="el" href="structppa.html">ppa</a> *<a class="el" href="structppa.html">ppa</a>)</td></tr>
<tr class="separator:a2c41ad05315023bfa77846568e4f7282"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedba9d148f29a3ea880cf3abbbc07fad"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad">do_gc</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, bool force)</td></tr>
<tr class="separator:aedba9d148f29a3ea880cf3abbbc07fad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a306780893a49a72da761566ca918b35e"><td class="memItemLeft" align="right" valign="top">static uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a306780893a49a72da761566ca918b35e">ssd_read</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:a306780893a49a72da761566ca918b35e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8610a939b22b60851e3b88e0137b7ede"><td class="memItemLeft" align="right" valign="top">static uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede">ssd_write</a> (struct <a class="el" href="structssd.html">ssd</a> *<a class="el" href="structssd.html">ssd</a>, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:a8610a939b22b60851e3b88e0137b7ede"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">函数说明</h2>
<a id="a0b6eca1c9bf137587f4c3c7aed0ea914"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b6eca1c9bf137587f4c3c7aed0ea914">&#9670;&nbsp;</a></span>check_addr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void check_addr </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(a &gt;= 0 &amp;&amp; a &lt; max);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a0b6eca1c9bf137587f4c3c7aed0ea914_icgraph.png" border="0" usemap="#ftl_8c_a0b6eca1c9bf137587f4c3c7aed0ea914_icgraph" alt=""/></div>
<map name="ftl_8c_a0b6eca1c9bf137587f4c3c7aed0ea914_icgraph" id="ftl_8c_a0b6eca1c9bf137587f4c3c7aed0ea914_icgraph">
<area shape="rect" title=" " alt="" coords="1980,31,2076,57"/>
<area shape="rect" href="ftl_8c.html#a52df9249316530eb887e0412ca51f048" title=" " alt="" coords="1733,31,1932,57"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1569,5,1685,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,56,1235,83"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,5,1521,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,31,1103,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,31,971,57"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,31,851,57"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,31,736,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="aa555ec9dcfe762eb6c39afa3cb167e3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa555ec9dcfe762eb6c39afa3cb167e3d">&#9670;&nbsp;</a></span>check_params()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void check_params </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssdparams.html">ssdparams</a> *&#160;</td>
          <td class="paramname"><em>spp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;{</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">     * we are using a general write pointer increment method now, no need to</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">     * force luns_per_ch and nchs to be power of 2</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">//ftl_assert(is_power_of_2(spp-&gt;luns_per_ch));</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">//ftl_assert(is_power_of_2(spp-&gt;nchs));</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_aa555ec9dcfe762eb6c39afa3cb167e3d_icgraph.png" border="0" usemap="#ftl_8c_aa555ec9dcfe762eb6c39afa3cb167e3d_icgraph" alt=""/></div>
<map name="ftl_8c_aa555ec9dcfe762eb6c39afa3cb167e3d_icgraph" id="ftl_8c_aa555ec9dcfe762eb6c39afa3cb167e3d_icgraph">
<area shape="rect" title=" " alt="" coords="1195,5,1311,32"/>
<area shape="rect" href="ftl_8c.html#a96c1b582459f3ccfc0643bac1a8cdf35" title=" " alt="" coords="1019,5,1147,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ae4d530364d4008be453c27d200eacddf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4d530364d4008be453c27d200eacddf">&#9670;&nbsp;</a></span>clean_one_block()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void clean_one_block </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;{</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssdparams.html">ssdparams</a> *spp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnand__page.html">nand_page</a> *pg_iter = NULL;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordtype">int</span> cnt = 0;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pg = 0; pg &lt; spp-&gt;<a class="code" href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">pgs_per_blk</a>; pg++) {</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <a class="code" href="structppa.html">ppa</a>-&gt;<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.pg = pg;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        pg_iter = <a class="code" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66">get_pg</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="comment">/* there shouldn&#39;t be any free page in victim blocks */</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(pg_iter-&gt;<a class="code" href="structnand__page.html#ac238873d503e6fd6530f43b784019dfc">status</a> != <a class="code" href="ftl_8h.html#a99fb83031ce9923c84392b4e92f956b5a0d5f318c3fc765bc802353b6cc599214">PG_FREE</a>);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordflow">if</span> (pg_iter-&gt;<a class="code" href="structnand__page.html#ac238873d503e6fd6530f43b784019dfc">status</a> == <a class="code" href="ftl_8h.html#a99fb83031ce9923c84392b4e92f956b5ae15fc2b67b2402b6f167ecccafbbecd2">PG_VALID</a>) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <a class="code" href="ftl_8c.html#a4b9026945c9fcc578ba0f7a7a84a1af1">gc_read_page</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            <span class="comment">/* delay the maptbl update until &quot;write&quot; happens */</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            <a class="code" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048">gc_write_page</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            cnt++;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        }</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(<a class="code" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82">get_blk</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>)-&gt;vpc == cnt);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_ae4d530364d4008be453c27d200eacddf_cgraph.png" border="0" usemap="#ftl_8c_ae4d530364d4008be453c27d200eacddf_cgraph" alt=""/></div>
<map name="ftl_8c_ae4d530364d4008be453c27d200eacddf_cgraph" id="ftl_8c_ae4d530364d4008be453c27d200eacddf_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,136,108"/>
<area shape="rect" href="ftl_8c.html#a4b9026945c9fcc578ba0f7a7a84a1af1" title=" " alt="" coords="186,5,298,32"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="184,411,300,437"/>
<area shape="rect" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82" title=" " alt="" coords="795,132,865,159"/>
<area shape="rect" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66" title=" " alt="" coords="633,107,699,133"/>
<area shape="rect" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8" title=" " alt="" coords="371,5,524,32"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="1033,259,1104,285"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="1152,487,1217,513"/>
<area shape="rect" href="ftl_8c.html#a2db76f519a8218ea9cda35e61552a4ec" title=" " alt="" coords="389,613,505,640"/>
<area shape="rect" href="ftl_8c.html#a92e6cdd7677ef48c1830b6fbba09a28a" title=" " alt="" coords="391,512,503,539"/>
<area shape="rect" href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b" title=" " alt="" coords="380,183,515,209"/>
<area shape="rect" href="ftl_8c.html#ab02c4873ff387abfd6f268ae711fd0b5" title=" " alt="" coords="386,664,509,691"/>
<area shape="rect" href="ftl_8c.html#aac3ae48a56045829a6e2f1bf933b1d5b" title=" " alt="" coords="392,411,503,437"/>
<area shape="rect" href="ftl_8c.html#a52df9249316530eb887e0412ca51f048" title=" " alt="" coords="348,309,547,336"/>
<area shape="rect" href="ftl_8c.html#a4a3067e8cef7d5c0e777cc82cf9c40c3" title=" " alt="" coords="407,461,488,488"/>
<area shape="rect" href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8" title=" " alt="" coords="627,639,705,665"/>
<area shape="rect" href="ftl_8c.html#a3c2e22192ca991c459c54bead5b1ff98" title=" " alt="" coords="621,487,711,513"/>
<area shape="rect" href="ftl_8c.html#a080e38a63b4626bd7cf314fcf74f2fb2" title=" " alt="" coords="629,208,703,235"/>
<area shape="rect" href="ftl_8c.html#a8f0b10088699a4513219eafe0e2e4bc6" title=" " alt="" coords="923,195,985,221"/>
<area shape="rect" href="ftl_8c.html#a0b6eca1c9bf137587f4c3c7aed0ea914" title=" " alt="" coords="618,259,714,285"/>
<area shape="rect" href="ftl_8c.html#a659c0c25af9ae17e1771fc5bf7bca444" title=" " alt="" coords="595,309,737,336"/>
<area shape="rect" href="pqueue_8h.html#addd8cdfbc8c47b8cdd7eb4c4560de7aa" title=" " alt="" coords="609,360,723,387"/>
<area shape="rect" href="pqueue_8c.html#a918fcd7df850b9a0c17111abc9c323b1" title=" " alt="" coords="785,360,875,387"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_ae4d530364d4008be453c27d200eacddf_icgraph.png" border="0" usemap="#ftl_8c_ae4d530364d4008be453c27d200eacddf_icgraph" alt=""/></div>
<map name="ftl_8c_ae4d530364d4008be453c27d200eacddf_icgraph" id="ftl_8c_ae4d530364d4008be453c27d200eacddf_icgraph">
<area shape="rect" title=" " alt="" coords="1391,5,1521,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,31,1235,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="aedba9d148f29a3ea880cf3abbbc07fad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedba9d148f29a3ea880cf3abbbc07fad">&#9670;&nbsp;</a></span>do_gc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int do_gc </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>force</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;{</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keyword">struct </span><a class="code" href="structline.html">line</a> *victim_line = NULL;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssdparams.html">ssdparams</a> *spp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnand__lun.html">nand_lun</a> *lunp;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keyword">struct </span><a class="code" href="structppa.html">ppa</a> <a class="code" href="structppa.html">ppa</a>;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structppa.html#a2b5af16973594981a998ae3328eac8f7">ch</a>, <a class="code" href="structppa.html#a9ca7013864c40d83a67ce2d8edf2350e">lun</a>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    victim_line = <a class="code" href="ftl_8c.html#ae5f2680b1c6531f6394723c150f11e1c">select_victim_line</a>(<a class="code" href="structssd.html">ssd</a>, force);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordflow">if</span> (!victim_line) {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <a class="code" href="structppa.html">ppa</a>.<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.blk = victim_line-&gt;<a class="code" href="structline.html#aea4a6b372d188d62345ed68656fff577">id</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <a class="code" href="ftl_8h.html#adee7fac1ed803808b8fb7ee9ffa785d2">ftl_debug</a>(<span class="stringliteral">&quot;GC-ing line:%d,ipc=%d,victim=%d,full=%d,free=%d\n&quot;</span>, <a class="code" href="structppa.html">ppa</a>.<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.blk,</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;              victim_line-&gt;<a class="code" href="structline.html#a7ddd1d1c2be2ce5467a30c30c9a989bd">ipc</a>, <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a58bcbabc96ec3acaa19fac4ecf7956dc">lm</a>.<a class="code" href="structline__mgmt.html#a7cba4eac7dbe081ea3f943a5bd9b6ab8">victim_line_cnt</a>, <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a58bcbabc96ec3acaa19fac4ecf7956dc">lm</a>.<a class="code" href="structline__mgmt.html#a8ebebc34bbd4abeb8fdad4457042ad3b">full_line_cnt</a>,</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;              <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a58bcbabc96ec3acaa19fac4ecf7956dc">lm</a>.<a class="code" href="structline__mgmt.html#ab3da4f318464b294f5ad5179a0aa7b24">free_line_cnt</a>);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="comment">/* copy back valid data */</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="structppa.html#a2b5af16973594981a998ae3328eac8f7">ch</a> = 0; <a class="code" href="structppa.html#a2b5af16973594981a998ae3328eac8f7">ch</a> &lt; spp-&gt;<a class="code" href="structssdparams.html#a17a649068b0acfe64a1afc67b51236fb">nchs</a>; <a class="code" href="structppa.html#a2b5af16973594981a998ae3328eac8f7">ch</a>++) {</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="structppa.html#a9ca7013864c40d83a67ce2d8edf2350e">lun</a> = 0; <a class="code" href="structppa.html#a9ca7013864c40d83a67ce2d8edf2350e">lun</a> &lt; spp-&gt;<a class="code" href="structssdparams.html#ad339ca6a9e013ff5d28d408f7e2ad705">luns_per_ch</a>; <a class="code" href="structppa.html#a9ca7013864c40d83a67ce2d8edf2350e">lun</a>++) {</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <a class="code" href="structppa.html">ppa</a>.<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.ch = <a class="code" href="structppa.html#a2b5af16973594981a998ae3328eac8f7">ch</a>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <a class="code" href="structppa.html">ppa</a>.<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.lun = <a class="code" href="structppa.html#a9ca7013864c40d83a67ce2d8edf2350e">lun</a>;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <a class="code" href="structppa.html">ppa</a>.<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.pl = 0;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            lunp = <a class="code" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d">get_lun</a>(<a class="code" href="structssd.html">ssd</a>, &amp;<a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            <a class="code" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf">clean_one_block</a>(<a class="code" href="structssd.html">ssd</a>, &amp;<a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <a class="code" href="ftl_8c.html#a5313a5ca429ce56095c0c1052c301c15">mark_block_free</a>(<a class="code" href="structssd.html">ssd</a>, &amp;<a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            <span class="keywordflow">if</span> (spp-&gt;<a class="code" href="structssdparams.html#ab072044ad8c0107835464ba876b618f2">enable_gc_delay</a>) {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                <span class="keyword">struct </span><a class="code" href="structnand__cmd.html">nand_cmd</a> gce;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                gce.<a class="code" href="structnand__cmd.html#a364c052be48202ede06e883e4b120409">type</a> = <a class="code" href="ftl_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a20ce8680df93c5e2acbf38a65350e122">GC_IO</a>;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                gce.cmd = <a class="code" href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba21101ced44d7c10f4be3536ccf778399">NAND_ERASE</a>;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                gce.stime = 0;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                <a class="code" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8">ssd_advance_status</a>(<a class="code" href="structssd.html">ssd</a>, &amp;<a class="code" href="structppa.html">ppa</a>, &amp;gce);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            lunp-&gt;<a class="code" href="structnand__lun.html#a68ecfcc73af2f1103b2612aab0db8c2d">gc_endtime</a> = lunp-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="comment">/* update line status */</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <a class="code" href="ftl_8c.html#a2c41ad05315023bfa77846568e4f7282">mark_line_free</a>(<a class="code" href="structssd.html">ssd</a>, &amp;<a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_aedba9d148f29a3ea880cf3abbbc07fad_cgraph.png" border="0" usemap="#ftl_8c_aedba9d148f29a3ea880cf3abbbc07fad_cgraph" alt=""/></div>
<map name="ftl_8c_aedba9d148f29a3ea880cf3abbbc07fad_cgraph" id="ftl_8c_aedba9d148f29a3ea880cf3abbbc07fad_cgraph">
<area shape="rect" title=" " alt="" coords="5,461,65,488"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="118,372,249,399"/>
<area shape="rect" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8" title=" " alt="" coords="488,93,641,120"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="1151,245,1221,272"/>
<area shape="rect" href="ftl_8c.html#a5313a5ca429ce56095c0c1052c301c15" title=" " alt="" coords="118,664,249,691"/>
<area shape="rect" href="ftl_8c.html#a2c41ad05315023bfa77846568e4f7282" title=" " alt="" coords="123,588,243,615"/>
<area shape="rect" href="ftl_8c.html#ae5f2680b1c6531f6394723c150f11e1c" title=" " alt="" coords="113,803,253,829"/>
<area shape="rect" href="ftl_8c.html#a4b9026945c9fcc578ba0f7a7a84a1af1" title=" " alt="" coords="303,144,415,171"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="301,372,417,399"/>
<area shape="rect" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82" title=" " alt="" coords="912,473,983,500"/>
<area shape="rect" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66" title=" " alt="" coords="750,423,817,449"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="1269,423,1335,449"/>
<area shape="rect" href="ftl_8c.html#a2db76f519a8218ea9cda35e61552a4ec" title=" " alt="" coords="507,347,623,373"/>
<area shape="rect" href="ftl_8c.html#a92e6cdd7677ef48c1830b6fbba09a28a" title=" " alt="" coords="509,499,621,525"/>
<area shape="rect" href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b" title=" " alt="" coords="497,448,632,475"/>
<area shape="rect" href="ftl_8c.html#ab02c4873ff387abfd6f268ae711fd0b5" title=" " alt="" coords="503,397,626,424"/>
<area shape="rect" href="ftl_8c.html#aac3ae48a56045829a6e2f1bf933b1d5b" title=" " alt="" coords="509,549,620,576"/>
<area shape="rect" href="ftl_8c.html#a52df9249316530eb887e0412ca51f048" title=" " alt="" coords="465,144,664,171"/>
<area shape="rect" href="ftl_8c.html#a4a3067e8cef7d5c0e777cc82cf9c40c3" title=" " alt="" coords="524,296,605,323"/>
<area shape="rect" href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8" title=" " alt="" coords="744,347,823,373"/>
<area shape="rect" href="ftl_8c.html#a3c2e22192ca991c459c54bead5b1ff98" title=" " alt="" coords="738,524,829,551"/>
<area shape="rect" href="ftl_8c.html#a080e38a63b4626bd7cf314fcf74f2fb2" title=" " alt="" coords="746,651,821,677"/>
<area shape="rect" href="ftl_8c.html#a8f0b10088699a4513219eafe0e2e4bc6" title=" " alt="" coords="1040,372,1103,399"/>
<area shape="rect" href="ftl_8c.html#a0b6eca1c9bf137587f4c3c7aed0ea914" title=" " alt="" coords="735,195,831,221"/>
<area shape="rect" href="ftl_8c.html#a659c0c25af9ae17e1771fc5bf7bca444" title=" " alt="" coords="712,144,855,171"/>
<area shape="rect" href="pqueue_8h.html#addd8cdfbc8c47b8cdd7eb4c4560de7aa" title=" " alt="" coords="726,93,841,120"/>
<area shape="rect" href="pqueue_8c.html#a918fcd7df850b9a0c17111abc9c323b1" title=" " alt="" coords="903,93,992,120"/>
<area shape="rect" href="pqueue_8h.html#a2919d3e817688b81da746d4123f51ba3" title=" " alt="" coords="305,803,414,829"/>
<area shape="rect" href="pqueue_8h.html#abec9363c7a9cc89190bf0925a4a1652c" title=" " alt="" coords="309,853,410,880"/>
<area shape="rect" href="pqueue_8c.html#a69ad19c161ae75369d1a444c83f4600c" title=" " alt="" coords="502,853,627,880"/>
<area shape="rect" href="pqueue_8c.html#a3e99f0cb15bfac6eeee46df9c875073a" title=" " alt="" coords="742,853,825,880"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_aedba9d148f29a3ea880cf3abbbc07fad_icgraph.png" border="0" usemap="#ftl_8c_aedba9d148f29a3ea880cf3abbbc07fad_icgraph" alt=""/></div>
<map name="ftl_8c_aedba9d148f29a3ea880cf3abbbc07fad_icgraph" id="ftl_8c_aedba9d148f29a3ea880cf3abbbc07fad_icgraph">
<area shape="rect" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,31,1235,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a3716c928ff3ccf16e82ae281fd3dd6d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3716c928ff3ccf16e82ae281fd3dd6d3">&#9670;&nbsp;</a></span>ftl_thread()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void * ftl_thread </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;{</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = (<a class="code" href="structFemuCtrl.html">FemuCtrl</a> *)arg;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssd.html">ssd</a> *<a class="code" href="structssd.html">ssd</a> = n-&gt;<a class="code" href="structFemuCtrl.html#a4464c81978268e5df515d91044ea1ec2">ssd</a>;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <a class="code" href="structNvmeRequest.html">NvmeRequest</a> *req = NULL;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    uint64_t lat = 0;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordtype">int</span> rc;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordflow">while</span> (!*(<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a2b0e9503ff5811ff40f5b426d137692e">dataplane_started_ptr</a>)) {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        usleep(100000);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160; </div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="comment">/* FIXME: not safe, to handle -&gt;to_ftl and -&gt;to_poller gracefully */</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#af1863ea3d676d7f2a9db127e2ced4c87">to_ftl</a> = n-&gt;<a class="code" href="structFemuCtrl.html#a0ff7c6d5e0e6313cc66e2d62f4e98221">to_ftl</a>;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#af5ac3e7f4169f686b1279f054413e84f">to_poller</a> = n-&gt;<a class="code" href="structFemuCtrl.html#ad818a28bdef83c4bb07c0d4f00942b06">to_poller</a>;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordflow">while</span> (1) {</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordflow">for</span> (i = 1; i &lt;= n-&gt;<a class="code" href="structFemuCtrl.html#a78baba4717dd495d81af587a1a95a0b7">num_poller</a>; i++) {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#af1863ea3d676d7f2a9db127e2ced4c87">to_ftl</a>[i] || !<a class="code" href="rte__ring_8h.html#a96ef17a77ac3deecdb8a1fb71b6bdf63">femu_ring_count</a>(<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#af1863ea3d676d7f2a9db127e2ced4c87">to_ftl</a>[i]))</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            rc = <a class="code" href="rte__ring_8h.html#ab2417e0e85ffd0e61ec4b0ee263ab809">femu_ring_dequeue</a>(<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#af1863ea3d676d7f2a9db127e2ced4c87">to_ftl</a>[i], (<span class="keywordtype">void</span> *)&amp;req, 1);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            <span class="keywordflow">if</span> (rc != 1) {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                printf(<span class="stringliteral">&quot;FEMU: FTL to_ftl dequeue failed\n&quot;</span>);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(req);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            <span class="keywordflow">switch</span> (req-&gt;<a class="code" href="structNvmeRequest.html#a335e5b18fb079480b1b1a1f06652c647">cmd</a>.<a class="code" href="structNvmeCmd.html#a2751bc2a772082d3af81124a1d120a0c">opcode</a>) {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6af12c69a9bdf0ad418e4a144ef5424336">NVME_CMD_WRITE</a>:</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                lat = <a class="code" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede">ssd_write</a>(<a class="code" href="structssd.html">ssd</a>, req);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a13421e16e166f06ef616c86258232336">NVME_CMD_READ</a>:</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                lat = <a class="code" href="ftl_8c.html#a306780893a49a72da761566ca918b35e">ssd_read</a>(<a class="code" href="structssd.html">ssd</a>, req);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a324318d7d84def33dd8a53724f14ab10">NVME_CMD_DSM</a>:</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                lat = 0;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                <span class="comment">//ftl_err(&quot;FTL received unkown request type, ERROR\n&quot;);</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                ;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            req-&gt;<a class="code" href="structNvmeRequest.html#a5b78c8ff9c9bf2a1012976ac9764d5bc">reqlat</a> = lat;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            req-&gt;<a class="code" href="structNvmeRequest.html#a135bf3cba23f12bad28c20805a8f5d93">expire_time</a> += lat;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            rc = <a class="code" href="rte__ring_8h.html#a3afc06d02f63e84fe1569c99955af57a">femu_ring_enqueue</a>(<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#af5ac3e7f4169f686b1279f054413e84f">to_poller</a>[i], (<span class="keywordtype">void</span> *)&amp;req, 1);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            <span class="keywordflow">if</span> (rc != 1) {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                <a class="code" href="ftl_8h.html#ae78ff7bb5a99b8a8ac5fc3c82e0ca403">ftl_err</a>(<span class="stringliteral">&quot;FTL to_poller enqueue failed\n&quot;</span>);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            <span class="comment">/* clean one line if needed (in the background) */</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="ftl_8c.html#a6722c643872772d48598187782365209">should_gc</a>(<a class="code" href="structssd.html">ssd</a>)) {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                <a class="code" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad">do_gc</a>(<a class="code" href="structssd.html">ssd</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        }</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a3716c928ff3ccf16e82ae281fd3dd6d3_cgraph.png" border="0" usemap="#ftl_8c_a3716c928ff3ccf16e82ae281fd3dd6d3_cgraph" alt=""/></div>
<map name="ftl_8c_a3716c928ff3ccf16e82ae281fd3dd6d3_cgraph" id="ftl_8c_a3716c928ff3ccf16e82ae281fd3dd6d3_cgraph">
<area shape="rect" title=" " alt="" coords="5,980,89,1007"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="393,429,453,456"/>
<area shape="rect" href="rte__ring_8h.html#a96ef17a77ac3deecdb8a1fb71b6bdf63" title=" " alt="" coords="147,980,278,1007"/>
<area shape="rect" href="rte__ring_8h.html#ab2417e0e85ffd0e61ec4b0ee263ab809" title=" " alt="" coords="137,1031,288,1057"/>
<area shape="rect" href="rte__ring_8h.html#a3afc06d02f63e84fe1569c99955af57a" title=" " alt="" coords="137,1081,288,1108"/>
<area shape="rect" href="ftl_8c.html#a6722c643872772d48598187782365209" title=" " alt="" coords="169,1132,256,1159"/>
<area shape="rect" href="ftl_8c.html#a306780893a49a72da761566ca918b35e" title=" " alt="" coords="173,904,253,931"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="171,676,255,703"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="579,347,710,373"/>
<area shape="rect" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8" title=" " alt="" coords="1056,43,1209,69"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="1791,93,1861,120"/>
<area shape="rect" href="ftl_8c.html#a5313a5ca429ce56095c0c1052c301c15" title=" " alt="" coords="579,411,710,437"/>
<area shape="rect" href="ftl_8c.html#a2c41ad05315023bfa77846568e4f7282" title=" " alt="" coords="585,487,705,513"/>
<area shape="rect" href="ftl_8c.html#ae5f2680b1c6531f6394723c150f11e1c" title=" " alt="" coords="1063,651,1203,677"/>
<area shape="rect" href="ftl_8c.html#a4b9026945c9fcc578ba0f7a7a84a1af1" title=" " alt="" coords="826,245,938,272"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="824,347,940,373"/>
<area shape="rect" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82" title=" " alt="" coords="1534,372,1605,399"/>
<area shape="rect" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66" title=" " alt="" coords="1336,448,1403,475"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="1909,195,1975,221"/>
<area shape="rect" href="ftl_8c.html#a2db76f519a8218ea9cda35e61552a4ec" title=" " alt="" coords="1075,803,1191,829"/>
<area shape="rect" href="ftl_8c.html#a92e6cdd7677ef48c1830b6fbba09a28a" title=" " alt="" coords="1077,296,1189,323"/>
<area shape="rect" href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b" title=" " alt="" coords="1065,448,1200,475"/>
<area shape="rect" href="ftl_8c.html#ab02c4873ff387abfd6f268ae711fd0b5" title=" " alt="" coords="1071,752,1194,779"/>
<area shape="rect" href="ftl_8c.html#aac3ae48a56045829a6e2f1bf933b1d5b" title=" " alt="" coords="1077,195,1188,221"/>
<area shape="rect" href="ftl_8c.html#a52df9249316530eb887e0412ca51f048" title=" " alt="" coords="1033,701,1232,728"/>
<area shape="rect" href="ftl_8c.html#a4a3067e8cef7d5c0e777cc82cf9c40c3" title=" " alt="" coords="1092,245,1173,272"/>
<area shape="rect" href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8" title=" " alt="" coords="1330,904,1409,931"/>
<area shape="rect" href="ftl_8c.html#a3c2e22192ca991c459c54bead5b1ff98" title=" " alt="" coords="1324,220,1415,247"/>
<area shape="rect" href="ftl_8c.html#a080e38a63b4626bd7cf314fcf74f2fb2" title=" " alt="" coords="1332,499,1407,525"/>
<area shape="rect" href="ftl_8c.html#a8f0b10088699a4513219eafe0e2e4bc6" title=" " alt="" coords="1680,359,1743,385"/>
<area shape="rect" href="ftl_8c.html#a0b6eca1c9bf137587f4c3c7aed0ea914" title=" " alt="" coords="1321,853,1417,880"/>
<area shape="rect" href="ftl_8c.html#a659c0c25af9ae17e1771fc5bf7bca444" title=" " alt="" coords="1298,803,1441,829"/>
<area shape="rect" href="pqueue_8h.html#addd8cdfbc8c47b8cdd7eb4c4560de7aa" title=" " alt="" coords="1312,701,1427,728"/>
<area shape="rect" href="pqueue_8h.html#a2919d3e817688b81da746d4123f51ba3" title=" " alt="" coords="1315,651,1424,677"/>
<area shape="rect" href="pqueue_8h.html#abec9363c7a9cc89190bf0925a4a1652c" title=" " alt="" coords="1319,752,1420,779"/>
<area shape="rect" href="pqueue_8c.html#a69ad19c161ae75369d1a444c83f4600c" title=" " alt="" coords="1507,676,1632,703"/>
<area shape="rect" href="rte__ring_8h.html#abc8376d2c6e609707d52032860880b34" title=" " alt="" coords="366,1005,481,1032"/>
<area shape="rect" href="rte__ring_8h.html#a8742d4b89ce43dbd93cc2ef48518ccf0" title=" " alt="" coords="336,1056,511,1083"/>
<area shape="rect" href="rte__ring_8h.html#a201b5c512389dd58216906866aba1ec5" title=" " alt="" coords="559,1056,731,1083"/>
<area shape="rect" href="rte__ring_8h.html#a3a4127db74610c522be2a4f8f70c033d" title=" " alt="" coords="779,1031,985,1057"/>
<area shape="rect" href="rte__ring_8h.html#a269bf4b0dad1a7d2bb0396350f5e7976" title=" " alt="" coords="835,1081,929,1108"/>
<area shape="rect" href="rte__ring_8h.html#ab8debfb458e927d559e7ce750048502d" title=" " alt="" coords="338,1107,509,1133"/>
<area shape="rect" href="rte__ring_8h.html#a388f737bcdf0a8ee4cf6f75464ca5979" title=" " alt="" coords="559,1107,731,1133"/>
<area shape="rect" href="rte__ring_8h.html#a22ab749e8f41b8e232a5c54a5c100d16" title=" " alt="" coords="779,1132,985,1159"/>
<area shape="rect" href="ftl_8c.html#af93eee663d18640559cfd06afdeb5409" title=" " alt="" coords="361,904,485,931"/>
<area shape="rect" href="ftl_8c.html#a6e8a2a542e569fe2662cbb8cf647590b" title=" " alt="" coords="370,853,477,880"/>
<area shape="rect" href="ftl_8c.html#a4237c1400d2e5e24f32b77e347163ab9" title=" " alt="" coords="381,955,466,981"/>
<area shape="rect" href="ftl_8c.html#adaaf0f3e032de3124ddc61a6111b25db" title=" " alt="" coords="1059,600,1206,627"/>
<area shape="rect" href="ftl_8c.html#a4494881726f0faee876d503fa1f2e312" title=" " alt="" coords="362,499,485,525"/>
<area shape="rect" href="pqueue_8h.html#a7dfaa607ca404b915355d4b123c669ee" title=" " alt="" coords="1280,600,1459,627"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a3716c928ff3ccf16e82ae281fd3dd6d3_icgraph.png" border="0" usemap="#ftl_8c_a3716c928ff3ccf16e82ae281fd3dd6d3_icgraph" alt=""/></div>
<map name="ftl_8c_a3716c928ff3ccf16e82ae281fd3dd6d3_icgraph" id="ftl_8c_a3716c928ff3ccf16e82ae281fd3dd6d3_icgraph">
<area shape="rect" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a4b9026945c9fcc578ba0f7a7a84a1af1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b9026945c9fcc578ba0f7a7a84a1af1">&#9670;&nbsp;</a></span>gc_read_page()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void gc_read_page </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;{</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="comment">/* advance ssd status, we don&#39;t care about how long it takes */</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>.<a class="code" href="structssdparams.html#ab072044ad8c0107835464ba876b618f2">enable_gc_delay</a>) {</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keyword">struct </span><a class="code" href="structnand__cmd.html">nand_cmd</a> gcr;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        gcr.<a class="code" href="structnand__cmd.html#a364c052be48202ede06e883e4b120409">type</a> = <a class="code" href="ftl_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a20ce8680df93c5e2acbf38a65350e122">GC_IO</a>;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        gcr.cmd = <a class="code" href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba064c38a00639099031cda82711a5ac5d">NAND_READ</a>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        gcr.stime = 0;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <a class="code" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8">ssd_advance_status</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>, &amp;gcr);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a4b9026945c9fcc578ba0f7a7a84a1af1_cgraph.png" border="0" usemap="#ftl_8c_a4b9026945c9fcc578ba0f7a7a84a1af1_cgraph" alt=""/></div>
<map name="ftl_8c_a4b9026945c9fcc578ba0f7a7a84a1af1_cgraph" id="ftl_8c_a4b9026945c9fcc578ba0f7a7a84a1af1_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,117,32"/>
<area shape="rect" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8" title=" " alt="" coords="165,5,319,32"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="367,5,437,32"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="485,5,551,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a4b9026945c9fcc578ba0f7a7a84a1af1_icgraph.png" border="0" usemap="#ftl_8c_a4b9026945c9fcc578ba0f7a7a84a1af1_icgraph" alt=""/></div>
<map name="ftl_8c_a4b9026945c9fcc578ba0f7a7a84a1af1_icgraph" id="ftl_8c_a4b9026945c9fcc578ba0f7a7a84a1af1_icgraph">
<area shape="rect" title=" " alt="" coords="1569,5,1681,32"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,5,1521,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,31,1235,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ad1952595f15249cd0335bcf5e12d2048"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1952595f15249cd0335bcf5e12d2048">&#9670;&nbsp;</a></span>gc_write_page()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint64_t gc_write_page </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>old_ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;{</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keyword">struct </span><a class="code" href="structppa.html">ppa</a> new_ppa;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnand__lun.html">nand_lun</a> *new_lun;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    uint64_t lpn = <a class="code" href="ftl_8c.html#a92e6cdd7677ef48c1830b6fbba09a28a">get_rmap_ent</a>(<a class="code" href="structssd.html">ssd</a>, old_ppa);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(<a class="code" href="ftl_8c.html#a4a3067e8cef7d5c0e777cc82cf9c40c3">valid_lpn</a>(<a class="code" href="structssd.html">ssd</a>, lpn));</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    new_ppa = <a class="code" href="ftl_8c.html#a2db76f519a8218ea9cda35e61552a4ec">get_new_page</a>(<a class="code" href="structssd.html">ssd</a>);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="comment">/* update maptbl */</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <a class="code" href="ftl_8c.html#ab02c4873ff387abfd6f268ae711fd0b5">set_maptbl_ent</a>(<a class="code" href="structssd.html">ssd</a>, lpn, &amp;new_ppa);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">/* update rmap */</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="ftl_8c.html#aac3ae48a56045829a6e2f1bf933b1d5b">set_rmap_ent</a>(<a class="code" href="structssd.html">ssd</a>, lpn, &amp;new_ppa);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b">mark_page_valid</a>(<a class="code" href="structssd.html">ssd</a>, &amp;new_ppa);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="comment">/* need to advance the write pointer here */</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="ftl_8c.html#a52df9249316530eb887e0412ca51f048">ssd_advance_write_pointer</a>(<a class="code" href="structssd.html">ssd</a>);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>.<a class="code" href="structssdparams.html#ab072044ad8c0107835464ba876b618f2">enable_gc_delay</a>) {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keyword">struct </span><a class="code" href="structnand__cmd.html">nand_cmd</a> gcw;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        gcw.<a class="code" href="structnand__cmd.html#a364c052be48202ede06e883e4b120409">type</a> = <a class="code" href="ftl_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a20ce8680df93c5e2acbf38a65350e122">GC_IO</a>;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        gcw.cmd = <a class="code" href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba9eb21f1680871f4d099414752c40a2e4">NAND_WRITE</a>;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        gcw.stime = 0;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <a class="code" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8">ssd_advance_status</a>(<a class="code" href="structssd.html">ssd</a>, &amp;new_ppa, &amp;gcw);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">/* advance per-ch gc_endtime as well */</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    new_ch = <a class="code" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3">get_ch</a>(<a class="code" href="structssd.html">ssd</a>, &amp;new_ppa);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    new_ch-&gt;gc_endtime = new_ch-&gt;next_ch_avail_time;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    new_lun = <a class="code" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d">get_lun</a>(<a class="code" href="structssd.html">ssd</a>, &amp;new_ppa);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    new_lun-&gt;<a class="code" href="structnand__lun.html#a68ecfcc73af2f1103b2612aab0db8c2d">gc_endtime</a> = new_lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_ad1952595f15249cd0335bcf5e12d2048_cgraph.png" border="0" usemap="#ftl_8c_ad1952595f15249cd0335bcf5e12d2048_cgraph" alt=""/></div>
<map name="ftl_8c_ad1952595f15249cd0335bcf5e12d2048_cgraph" id="ftl_8c_ad1952595f15249cd0335bcf5e12d2048_cgraph">
<area shape="rect" title=" " alt="" coords="5,230,121,257"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="1064,53,1129,80"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="945,78,1016,105"/>
<area shape="rect" href="ftl_8c.html#a2db76f519a8218ea9cda35e61552a4ec" title=" " alt="" coords="211,104,327,130"/>
<area shape="rect" href="ftl_8c.html#a92e6cdd7677ef48c1830b6fbba09a28a" title=" " alt="" coords="213,205,325,232"/>
<area shape="rect" href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b" title=" " alt="" coords="201,306,336,333"/>
<area shape="rect" href="ftl_8c.html#ab02c4873ff387abfd6f268ae711fd0b5" title=" " alt="" coords="207,154,330,181"/>
<area shape="rect" href="ftl_8c.html#aac3ae48a56045829a6e2f1bf933b1d5b" title=" " alt="" coords="213,256,324,282"/>
<area shape="rect" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8" title=" " alt="" coords="744,306,897,333"/>
<area shape="rect" href="ftl_8c.html#a52df9249316530eb887e0412ca51f048" title=" " alt="" coords="169,408,368,434"/>
<area shape="rect" href="ftl_8c.html#a4a3067e8cef7d5c0e777cc82cf9c40c3" title=" " alt="" coords="228,458,309,485"/>
<area shape="rect" href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8" title=" " alt="" coords="448,104,527,130"/>
<area shape="rect" href="ftl_8c.html#a3c2e22192ca991c459c54bead5b1ff98" title=" " alt="" coords="442,154,533,181"/>
<area shape="rect" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82" title=" " alt="" coords="616,205,687,232"/>
<area shape="rect" href="ftl_8c.html#a080e38a63b4626bd7cf314fcf74f2fb2" title=" " alt="" coords="450,256,525,282"/>
<area shape="rect" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66" title=" " alt="" coords="454,306,521,333"/>
<area shape="rect" href="ftl_8c.html#a8f0b10088699a4513219eafe0e2e4bc6" title=" " alt="" coords="789,154,852,181"/>
<area shape="rect" href="ftl_8c.html#a0b6eca1c9bf137587f4c3c7aed0ea914" title=" " alt="" coords="439,408,535,434"/>
<area shape="rect" href="ftl_8c.html#a659c0c25af9ae17e1771fc5bf7bca444" title=" " alt="" coords="416,458,559,485"/>
<area shape="rect" href="pqueue_8h.html#addd8cdfbc8c47b8cdd7eb4c4560de7aa" title=" " alt="" coords="430,509,545,536"/>
<area shape="rect" href="pqueue_8c.html#a918fcd7df850b9a0c17111abc9c323b1" title=" " alt="" coords="607,509,696,536"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_ad1952595f15249cd0335bcf5e12d2048_icgraph.png" border="0" usemap="#ftl_8c_ad1952595f15249cd0335bcf5e12d2048_icgraph" alt=""/></div>
<map name="ftl_8c_ad1952595f15249cd0335bcf5e12d2048_icgraph" id="ftl_8c_ad1952595f15249cd0335bcf5e12d2048_icgraph">
<area shape="rect" title=" " alt="" coords="1569,5,1685,32"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,5,1521,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,31,1235,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a340d3d702f25d601cb40dbd85a30dd82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a340d3d702f25d601cb40dbd85a30dd82">&#9670;&nbsp;</a></span>get_blk()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structnand__block.html">nand_block</a>* get_blk </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;{</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnand__plane.html">nand_plane</a> *pl = <a class="code" href="ftl_8c.html#a8f0b10088699a4513219eafe0e2e4bc6">get_pl</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">return</span> &amp;(pl-&gt;<a class="code" href="structnand__plane.html#a178c78d74aad32ee73f5101bbe5d3af0">blk</a>[<a class="code" href="structppa.html">ppa</a>-&gt;<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.blk]);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a340d3d702f25d601cb40dbd85a30dd82_cgraph.png" border="0" usemap="#ftl_8c_a340d3d702f25d601cb40dbd85a30dd82_cgraph" alt=""/></div>
<map name="ftl_8c_a340d3d702f25d601cb40dbd85a30dd82_cgraph" id="ftl_8c_a340d3d702f25d601cb40dbd85a30dd82_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,76,32"/>
<area shape="rect" href="ftl_8c.html#a8f0b10088699a4513219eafe0e2e4bc6" title=" " alt="" coords="124,5,187,32"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="235,5,305,32"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="353,5,419,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a340d3d702f25d601cb40dbd85a30dd82_icgraph.png" border="0" usemap="#ftl_8c_a340d3d702f25d601cb40dbd85a30dd82_icgraph" alt=""/></div>
<map name="ftl_8c_a340d3d702f25d601cb40dbd85a30dd82_icgraph" id="ftl_8c_a340d3d702f25d601cb40dbd85a30dd82_icgraph">
<area shape="rect" title=" " alt="" coords="2057,160,2128,187"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,110,1521,136"/>
<area shape="rect" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66" title=" " alt="" coords="1943,211,2009,238"/>
<area shape="rect" href="ftl_8c.html#adaaf0f3e032de3124ddc61a6111b25db" title=" " alt="" coords="1748,262,1895,288"/>
<area shape="rect" href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b" title=" " alt="" coords="1754,160,1889,187"/>
<area shape="rect" href="ftl_8c.html#a5313a5ca429ce56095c0c1052c301c15" title=" " alt="" coords="1569,8,1700,35"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,110,1343,136"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,135,1103,162"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,160,1235,187"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,135,971,162"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,135,851,162"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,135,736,162"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,135,527,162"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,135,284,162"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,135,129,162"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1577,110,1693,136"/>
</map>
</div>

</div>
</div>
<a id="aadf575bf139734453ba8fa6af20b1ac3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadf575bf139734453ba8fa6af20b1ac3">&#9670;&nbsp;</a></span>get_ch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structssd__channel.html">ssd_channel</a>* get_ch </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;{</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">return</span> &amp;(<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a6ffa7f5fbc77044d9fb80e65d477a632">ch</a>[<a class="code" href="structppa.html">ppa</a>-&gt;<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.ch]);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_aadf575bf139734453ba8fa6af20b1ac3_icgraph.png" border="0" usemap="#ftl_8c_aadf575bf139734453ba8fa6af20b1ac3_icgraph" alt=""/></div>
<map name="ftl_8c_aadf575bf139734453ba8fa6af20b1ac3_icgraph" id="ftl_8c_aadf575bf139734453ba8fa6af20b1ac3_icgraph">
<area shape="rect" title=" " alt="" coords="2417,183,2483,209"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1589,208,1705,235"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="2299,208,2369,235"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1411,259,1541,285"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1293,284,1353,311"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,259,1103,285"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,309,1235,336"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,259,971,285"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,259,851,285"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,259,736,285"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,259,527,285"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,259,284,285"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,259,129,285"/>
<area shape="rect" href="ftl_8c.html#a8f0b10088699a4513219eafe0e2e4bc6" title=" " alt="" coords="2188,309,2251,336"/>
<area shape="rect" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8" title=" " alt="" coords="1753,107,1907,133"/>
<area shape="rect" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82" title=" " alt="" coords="2069,335,2140,361"/>
<area shape="rect" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66" title=" " alt="" coords="1955,411,2021,437"/>
<area shape="rect" href="ftl_8c.html#adaaf0f3e032de3124ddc61a6111b25db" title=" " alt="" coords="1757,461,1903,488"/>
<area shape="rect" href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b" title=" " alt="" coords="1763,360,1897,387"/>
<area shape="rect" href="ftl_8c.html#a5313a5ca429ce56095c0c1052c301c15" title=" " alt="" coords="1411,309,1541,336"/>
<area shape="rect" href="ftl_8c.html#a4b9026945c9fcc578ba0f7a7a84a1af1" title=" " alt="" coords="1591,157,1703,184"/>
<area shape="rect" href="ftl_8c.html#a306780893a49a72da761566ca918b35e" title=" " alt="" coords="1283,5,1363,32"/>
</map>
</div>

</div>
</div>
<a id="a080e38a63b4626bd7cf314fcf74f2fb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a080e38a63b4626bd7cf314fcf74f2fb2">&#9670;&nbsp;</a></span>get_line()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structline.html">line</a>* get_line </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;{</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">return</span> &amp;(<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a58bcbabc96ec3acaa19fac4ecf7956dc">lm</a>.<a class="code" href="structline__mgmt.html#a52782d1468638fe4b1462bcd2175976c">lines</a>[<a class="code" href="structppa.html">ppa</a>-&gt;<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.blk]);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a080e38a63b4626bd7cf314fcf74f2fb2_icgraph.png" border="0" usemap="#ftl_8c_a080e38a63b4626bd7cf314fcf74f2fb2_icgraph" alt=""/></div>
<map name="ftl_8c_a080e38a63b4626bd7cf314fcf74f2fb2_icgraph" id="ftl_8c_a080e38a63b4626bd7cf314fcf74f2fb2_icgraph">
<area shape="rect" title=" " alt="" coords="1936,107,2011,133"/>
<area shape="rect" href="ftl_8c.html#a2c41ad05315023bfa77846568e4f7282" title=" " alt="" coords="1585,5,1705,32"/>
<area shape="rect" href="ftl_8c.html#adaaf0f3e032de3124ddc61a6111b25db" title=" " alt="" coords="1391,157,1537,184"/>
<area shape="rect" href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b" title=" " alt="" coords="1753,107,1888,133"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,56,1343,83"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,81,1103,108"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,107,1235,133"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,81,971,108"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,81,851,108"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,81,736,108"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,81,527,108"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,81,284,108"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,81,129,108"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1587,56,1703,83"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1399,56,1529,83"/>
</map>
</div>

</div>
</div>
<a id="adc3fd6a4f50d3279de8a77eb9d605a8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc3fd6a4f50d3279de8a77eb9d605a8d">&#9670;&nbsp;</a></span>get_lun()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structnand__lun.html">nand_lun</a>* get_lun </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;{</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssd__channel.html">ssd_channel</a> *ch = <a class="code" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3">get_ch</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">return</span> &amp;(ch-&gt;<a class="code" href="structssd__channel.html#a43f4b195efe270acfb3ba6fa229ecf1b">lun</a>[<a class="code" href="structppa.html">ppa</a>-&gt;<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.lun]);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_adc3fd6a4f50d3279de8a77eb9d605a8d_cgraph.png" border="0" usemap="#ftl_8c_adc3fd6a4f50d3279de8a77eb9d605a8d_cgraph" alt=""/></div>
<map name="ftl_8c_adc3fd6a4f50d3279de8a77eb9d605a8d_cgraph" id="ftl_8c_adc3fd6a4f50d3279de8a77eb9d605a8d_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,76,32"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="124,5,189,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_adc3fd6a4f50d3279de8a77eb9d605a8d_icgraph.png" border="0" usemap="#ftl_8c_adc3fd6a4f50d3279de8a77eb9d605a8d_icgraph" alt=""/></div>
<map name="ftl_8c_adc3fd6a4f50d3279de8a77eb9d605a8d_icgraph" id="ftl_8c_adc3fd6a4f50d3279de8a77eb9d605a8d_icgraph">
<area shape="rect" title=" " alt="" coords="2299,335,2369,361"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1293,309,1353,336"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1589,259,1705,285"/>
<area shape="rect" href="ftl_8c.html#a8f0b10088699a4513219eafe0e2e4bc6" title=" " alt="" coords="2188,183,2251,209"/>
<area shape="rect" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8" title=" " alt="" coords="1753,411,1907,437"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,335,1103,361"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,284,1235,311"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,335,971,361"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,335,851,361"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,335,736,361"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,335,527,361"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,335,284,361"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,335,129,361"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1411,259,1541,285"/>
<area shape="rect" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82" title=" " alt="" coords="2069,132,2140,159"/>
<area shape="rect" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66" title=" " alt="" coords="1955,56,2021,83"/>
<area shape="rect" href="ftl_8c.html#adaaf0f3e032de3124ddc61a6111b25db" title=" " alt="" coords="1757,5,1903,32"/>
<area shape="rect" href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b" title=" " alt="" coords="1763,107,1897,133"/>
<area shape="rect" href="ftl_8c.html#a5313a5ca429ce56095c0c1052c301c15" title=" " alt="" coords="1411,157,1541,184"/>
<area shape="rect" href="ftl_8c.html#a4b9026945c9fcc578ba0f7a7a84a1af1" title=" " alt="" coords="1591,309,1703,336"/>
<area shape="rect" href="ftl_8c.html#a306780893a49a72da761566ca918b35e" title=" " alt="" coords="1283,512,1363,539"/>
</map>
</div>

</div>
</div>
<a id="af93eee663d18640559cfd06afdeb5409"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af93eee663d18640559cfd06afdeb5409">&#9670;&nbsp;</a></span>get_maptbl_ent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structppa.html">ppa</a> get_maptbl_ent </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>lpn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a9d1cef93bbb35d5d9ee62073e99e53b0">maptbl</a>[lpn];</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_af93eee663d18640559cfd06afdeb5409_icgraph.png" border="0" usemap="#ftl_8c_af93eee663d18640559cfd06afdeb5409_icgraph" alt=""/></div>
<map name="ftl_8c_af93eee663d18640559cfd06afdeb5409_icgraph" id="ftl_8c_af93eee663d18640559cfd06afdeb5409_icgraph">
<area shape="rect" title=" " alt="" coords="1283,31,1407,57"/>
<area shape="rect" href="ftl_8c.html#a306780893a49a72da761566ca918b35e" title=" " alt="" coords="1153,5,1233,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,56,1235,83"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,31,1103,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,31,971,57"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,31,851,57"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,31,736,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="a2db76f519a8218ea9cda35e61552a4ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2db76f519a8218ea9cda35e61552a4ec">&#9670;&nbsp;</a></span>get_new_page()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structppa.html">ppa</a> get_new_page </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;{</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keyword">struct </span><a class="code" href="structwrite__pointer.html">write_pointer</a> *wpp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a8ce888a31348d5b2fa1d914dde456166">wp</a>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keyword">struct </span><a class="code" href="structppa.html">ppa</a> <a class="code" href="structppa.html">ppa</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="structppa.html">ppa</a>.<a class="code" href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8">ppa</a> = 0;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="structppa.html">ppa</a>.<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.ch = wpp-&gt;<a class="code" href="structwrite__pointer.html#adf3acc53d295719babbd39458dddaa66">ch</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="structppa.html">ppa</a>.<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.lun = wpp-&gt;<a class="code" href="structwrite__pointer.html#aac27e9340ffc7900b39c57731fa61dc0">lun</a>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="structppa.html">ppa</a>.<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.pg = wpp-&gt;<a class="code" href="structwrite__pointer.html#acbaa6937b756b9cbf3f457973f98b12a">pg</a>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="structppa.html">ppa</a>.<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.blk = wpp-&gt;<a class="code" href="structwrite__pointer.html#a854272876a0fbd867842d16a3620a827">blk</a>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="structppa.html">ppa</a>.<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.pl = wpp-&gt;<a class="code" href="structwrite__pointer.html#a685331c5878278ccaf80c3672ce73f7c">pl</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(<a class="code" href="structppa.html">ppa</a>.<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.pl == 0);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8">ppa</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a2db76f519a8218ea9cda35e61552a4ec_cgraph.png" border="0" usemap="#ftl_8c_a2db76f519a8218ea9cda35e61552a4ec_cgraph" alt=""/></div>
<map name="ftl_8c_a2db76f519a8218ea9cda35e61552a4ec_cgraph" id="ftl_8c_a2db76f519a8218ea9cda35e61552a4ec_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,121,32"/>
<area shape="rect" href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8" title=" " alt="" coords="169,5,248,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a2db76f519a8218ea9cda35e61552a4ec_icgraph.png" border="0" usemap="#ftl_8c_a2db76f519a8218ea9cda35e61552a4ec_icgraph" alt=""/></div>
<map name="ftl_8c_a2db76f519a8218ea9cda35e61552a4ec_icgraph" id="ftl_8c_a2db76f519a8218ea9cda35e61552a4ec_icgraph">
<area shape="rect" title=" " alt="" coords="1733,31,1849,57"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1569,5,1685,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,56,1235,83"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,5,1521,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,31,1103,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,31,971,57"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,31,851,57"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,31,736,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="a659c0c25af9ae17e1771fc5bf7bca444"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a659c0c25af9ae17e1771fc5bf7bca444">&#9670;&nbsp;</a></span>get_next_free_line()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structline.html">line</a>* get_next_free_line </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;{</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keyword">struct </span><a class="code" href="structline__mgmt.html">line_mgmt</a> *lm = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a58bcbabc96ec3acaa19fac4ecf7956dc">lm</a>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keyword">struct </span><a class="code" href="structline.html">line</a> *curline = NULL;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    curline = QTAILQ_FIRST(&amp;lm-&gt;free_line_list);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">if</span> (!curline) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <a class="code" href="ftl_8h.html#ae78ff7bb5a99b8a8ac5fc3c82e0ca403">ftl_err</a>(<span class="stringliteral">&quot;No free lines left in [%s] !!!!\n&quot;</span>, <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a8724ca69d768471877affbeadbe3c244">ssdname</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    QTAILQ_REMOVE(&amp;lm-&gt;free_line_list, curline, entry);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    lm-&gt;<a class="code" href="structline__mgmt.html#ab3da4f318464b294f5ad5179a0aa7b24">free_line_cnt</a>--;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">return</span> curline;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a659c0c25af9ae17e1771fc5bf7bca444_icgraph.png" border="0" usemap="#ftl_8c_a659c0c25af9ae17e1771fc5bf7bca444_icgraph" alt=""/></div>
<map name="ftl_8c_a659c0c25af9ae17e1771fc5bf7bca444_icgraph" id="ftl_8c_a659c0c25af9ae17e1771fc5bf7bca444_icgraph">
<area shape="rect" title=" " alt="" coords="1980,31,2123,57"/>
<area shape="rect" href="ftl_8c.html#a52df9249316530eb887e0412ca51f048" title=" " alt="" coords="1733,31,1932,57"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1569,5,1685,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,56,1235,83"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,5,1521,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,31,1103,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,31,971,57"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,31,851,57"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,31,736,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="a3cfafde63950110fe49516abc429ef66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cfafde63950110fe49516abc429ef66">&#9670;&nbsp;</a></span>get_pg()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structnand__page.html">nand_page</a>* get_pg </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;{</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnand__block.html">nand_block</a> *blk = <a class="code" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82">get_blk</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">return</span> &amp;(blk-&gt;<a class="code" href="structnand__block.html#a8670e24bc47c15366be8fe4c238a2922">pg</a>[<a class="code" href="structppa.html">ppa</a>-&gt;<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.pg]);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a3cfafde63950110fe49516abc429ef66_cgraph.png" border="0" usemap="#ftl_8c_a3cfafde63950110fe49516abc429ef66_cgraph" alt=""/></div>
<map name="ftl_8c_a3cfafde63950110fe49516abc429ef66_cgraph" id="ftl_8c_a3cfafde63950110fe49516abc429ef66_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,72,32"/>
<area shape="rect" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82" title=" " alt="" coords="120,5,191,32"/>
<area shape="rect" href="ftl_8c.html#a8f0b10088699a4513219eafe0e2e4bc6" title=" " alt="" coords="239,5,301,32"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="349,5,420,32"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="468,5,533,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a3cfafde63950110fe49516abc429ef66_icgraph.png" border="0" usemap="#ftl_8c_a3cfafde63950110fe49516abc429ef66_icgraph" alt=""/></div>
<map name="ftl_8c_a3cfafde63950110fe49516abc429ef66_icgraph" id="ftl_8c_a3cfafde63950110fe49516abc429ef66_icgraph">
<area shape="rect" title=" " alt="" coords="1947,40,2013,67"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,28,1521,55"/>
<area shape="rect" href="ftl_8c.html#adaaf0f3e032de3124ddc61a6111b25db" title=" " alt="" coords="1569,130,1716,156"/>
<area shape="rect" href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b" title=" " alt="" coords="1764,40,1899,67"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,28,1343,55"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,54,1103,80"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,79,1235,106"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,54,971,80"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,54,851,80"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,54,736,80"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,54,527,80"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,54,284,80"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,54,129,80"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1585,28,1701,55"/>
</map>
</div>

</div>
</div>
<a id="a8f0b10088699a4513219eafe0e2e4bc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f0b10088699a4513219eafe0e2e4bc6">&#9670;&nbsp;</a></span>get_pl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structnand__plane.html">nand_plane</a>* get_pl </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;{</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnand__lun.html">nand_lun</a> *lun = <a class="code" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d">get_lun</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">return</span> &amp;(lun-&gt;<a class="code" href="structnand__lun.html#ae64d00bf7f1ed056065e1a6c91898473">pl</a>[<a class="code" href="structppa.html">ppa</a>-&gt;<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.pl]);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a8f0b10088699a4513219eafe0e2e4bc6_cgraph.png" border="0" usemap="#ftl_8c_a8f0b10088699a4513219eafe0e2e4bc6_cgraph" alt=""/></div>
<map name="ftl_8c_a8f0b10088699a4513219eafe0e2e4bc6_cgraph" id="ftl_8c_a8f0b10088699a4513219eafe0e2e4bc6_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,68,32"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="116,5,187,32"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="235,5,300,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a8f0b10088699a4513219eafe0e2e4bc6_icgraph.png" border="0" usemap="#ftl_8c_a8f0b10088699a4513219eafe0e2e4bc6_icgraph" alt=""/></div>
<map name="ftl_8c_a8f0b10088699a4513219eafe0e2e4bc6_icgraph" id="ftl_8c_a8f0b10088699a4513219eafe0e2e4bc6_icgraph">
<area shape="rect" title=" " alt="" coords="2176,160,2239,187"/>
<area shape="rect" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82" title=" " alt="" coords="2057,160,2128,187"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,110,1521,136"/>
<area shape="rect" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66" title=" " alt="" coords="1943,211,2009,238"/>
<area shape="rect" href="ftl_8c.html#adaaf0f3e032de3124ddc61a6111b25db" title=" " alt="" coords="1748,262,1895,288"/>
<area shape="rect" href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b" title=" " alt="" coords="1754,160,1889,187"/>
<area shape="rect" href="ftl_8c.html#a5313a5ca429ce56095c0c1052c301c15" title=" " alt="" coords="1569,8,1700,35"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,110,1343,136"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,135,1103,162"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,160,1235,187"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,135,971,162"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,135,851,162"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,135,736,162"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,135,527,162"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,135,284,162"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,135,129,162"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1577,110,1693,136"/>
</map>
</div>

</div>
</div>
<a id="a92e6cdd7677ef48c1830b6fbba09a28a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92e6cdd7677ef48c1830b6fbba09a28a">&#9670;&nbsp;</a></span>get_rmap_ent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint64_t get_rmap_ent </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    uint64_t pgidx = <a class="code" href="ftl_8c.html#a3c2e22192ca991c459c54bead5b1ff98">ppa2pgidx</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#ae49bd8bfc26a6a8f1a992d84e0cc862c">rmap</a>[pgidx];</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a92e6cdd7677ef48c1830b6fbba09a28a_cgraph.png" border="0" usemap="#ftl_8c_a92e6cdd7677ef48c1830b6fbba09a28a_cgraph" alt=""/></div>
<map name="ftl_8c_a92e6cdd7677ef48c1830b6fbba09a28a_cgraph" id="ftl_8c_a92e6cdd7677ef48c1830b6fbba09a28a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,117,32"/>
<area shape="rect" href="ftl_8c.html#a3c2e22192ca991c459c54bead5b1ff98" title=" " alt="" coords="165,5,256,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a92e6cdd7677ef48c1830b6fbba09a28a_icgraph.png" border="0" usemap="#ftl_8c_a92e6cdd7677ef48c1830b6fbba09a28a_icgraph" alt=""/></div>
<map name="ftl_8c_a92e6cdd7677ef48c1830b6fbba09a28a_icgraph" id="ftl_8c_a92e6cdd7677ef48c1830b6fbba09a28a_icgraph">
<area shape="rect" title=" " alt="" coords="1733,5,1845,32"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1569,5,1685,32"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,5,1521,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,31,1235,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a6e8a2a542e569fe2662cbb8cf647590b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e8a2a542e569fe2662cbb8cf647590b">&#9670;&nbsp;</a></span>mapped_ppa()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool mapped_ppa </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;{</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">return</span> !(<a class="code" href="structppa.html">ppa</a>-&gt;<a class="code" href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8">ppa</a> == <a class="code" href="ftl_8h.html#a4f586d4bebabb8dce738295d42a3671e">UNMAPPED_PPA</a>);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a6e8a2a542e569fe2662cbb8cf647590b_cgraph.png" border="0" usemap="#ftl_8c_a6e8a2a542e569fe2662cbb8cf647590b_cgraph" alt=""/></div>
<map name="ftl_8c_a6e8a2a542e569fe2662cbb8cf647590b_cgraph" id="ftl_8c_a6e8a2a542e569fe2662cbb8cf647590b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,112,32"/>
<area shape="rect" href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8" title=" " alt="" coords="160,5,239,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a6e8a2a542e569fe2662cbb8cf647590b_icgraph.png" border="0" usemap="#ftl_8c_a6e8a2a542e569fe2662cbb8cf647590b_icgraph" alt=""/></div>
<map name="ftl_8c_a6e8a2a542e569fe2662cbb8cf647590b_icgraph" id="ftl_8c_a6e8a2a542e569fe2662cbb8cf647590b_icgraph">
<area shape="rect" title=" " alt="" coords="1283,31,1389,57"/>
<area shape="rect" href="ftl_8c.html#a306780893a49a72da761566ca918b35e" title=" " alt="" coords="1153,5,1233,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,56,1235,83"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,31,1103,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,31,971,57"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,31,851,57"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,31,736,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="a5313a5ca429ce56095c0c1052c301c15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5313a5ca429ce56095c0c1052c301c15">&#9670;&nbsp;</a></span>mark_block_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void mark_block_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;{</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssdparams.html">ssdparams</a> *spp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnand__block.html">nand_block</a> *blk = <a class="code" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82">get_blk</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnand__page.html">nand_page</a> *pg = NULL;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; spp-&gt;<a class="code" href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">pgs_per_blk</a>; i++) {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="comment">/* reset page status */</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        pg = &amp;blk-&gt;<a class="code" href="structnand__block.html#a8670e24bc47c15366be8fe4c238a2922">pg</a>[i];</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(pg-&gt;<a class="code" href="structnand__page.html#a07a35cddc22d7c84ced03c17b23ed244">nsecs</a> == spp-&gt;<a class="code" href="structssdparams.html#a93143586362c365e97e39c4b544807ca">secs_per_pg</a>);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        pg-&gt;<a class="code" href="structnand__page.html#ac238873d503e6fd6530f43b784019dfc">status</a> = <a class="code" href="ftl_8h.html#a99fb83031ce9923c84392b4e92f956b5a0d5f318c3fc765bc802353b6cc599214">PG_FREE</a>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="comment">/* reset block status */</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(blk-&gt;<a class="code" href="structnand__block.html#afd82eb2e8b19ec2dd70b0bfa3e602776">npgs</a> == spp-&gt;<a class="code" href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">pgs_per_blk</a>);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    blk-&gt;<a class="code" href="structnand__block.html#a0c979863e9e1648cbf3a129bcd92820b">ipc</a> = 0;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    blk-&gt;<a class="code" href="structnand__block.html#a89ec2fe3aff210edec30210b24dd2039">vpc</a> = 0;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    blk-&gt;<a class="code" href="structnand__block.html#a8629bef6da40ace33902c884d6b0127c">erase_cnt</a>++;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a5313a5ca429ce56095c0c1052c301c15_cgraph.png" border="0" usemap="#ftl_8c_a5313a5ca429ce56095c0c1052c301c15_cgraph" alt=""/></div>
<map name="ftl_8c_a5313a5ca429ce56095c0c1052c301c15_cgraph" id="ftl_8c_a5313a5ca429ce56095c0c1052c301c15_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,136,32"/>
<area shape="rect" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82" title=" " alt="" coords="184,5,255,32"/>
<area shape="rect" href="ftl_8c.html#a8f0b10088699a4513219eafe0e2e4bc6" title=" " alt="" coords="303,5,365,32"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="413,5,484,32"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="532,5,597,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a5313a5ca429ce56095c0c1052c301c15_icgraph.png" border="0" usemap="#ftl_8c_a5313a5ca429ce56095c0c1052c301c15_icgraph" alt=""/></div>
<map name="ftl_8c_a5313a5ca429ce56095c0c1052c301c15_icgraph" id="ftl_8c_a5313a5ca429ce56095c0c1052c301c15_icgraph">
<area shape="rect" title=" " alt="" coords="1391,5,1521,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,31,1235,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a2c41ad05315023bfa77846568e4f7282"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c41ad05315023bfa77846568e4f7282">&#9670;&nbsp;</a></span>mark_line_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void mark_line_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;{</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keyword">struct </span><a class="code" href="structline__mgmt.html">line_mgmt</a> *lm = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a58bcbabc96ec3acaa19fac4ecf7956dc">lm</a>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keyword">struct </span><a class="code" href="structline.html">line</a> *<a class="code" href="structline.html">line</a> = <a class="code" href="ftl_8c.html#a080e38a63b4626bd7cf314fcf74f2fb2">get_line</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#a7ddd1d1c2be2ce5467a30c30c9a989bd">ipc</a> = 0;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#aeefab665d811bfabfdaca326ab72e79c">vpc</a> = 0;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">/* move this line to free line list */</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    QTAILQ_INSERT_TAIL(&amp;lm-&gt;free_line_list, <a class="code" href="structline.html">line</a>, entry);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    lm-&gt;<a class="code" href="structline__mgmt.html#ab3da4f318464b294f5ad5179a0aa7b24">free_line_cnt</a>++;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a2c41ad05315023bfa77846568e4f7282_cgraph.png" border="0" usemap="#ftl_8c_a2c41ad05315023bfa77846568e4f7282_cgraph" alt=""/></div>
<map name="ftl_8c_a2c41ad05315023bfa77846568e4f7282_cgraph" id="ftl_8c_a2c41ad05315023bfa77846568e4f7282_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,125,32"/>
<area shape="rect" href="ftl_8c.html#a080e38a63b4626bd7cf314fcf74f2fb2" title=" " alt="" coords="173,5,248,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a2c41ad05315023bfa77846568e4f7282_icgraph.png" border="0" usemap="#ftl_8c_a2c41ad05315023bfa77846568e4f7282_icgraph" alt=""/></div>
<map name="ftl_8c_a2c41ad05315023bfa77846568e4f7282_icgraph" id="ftl_8c_a2c41ad05315023bfa77846568e4f7282_icgraph">
<area shape="rect" title=" " alt="" coords="1391,5,1511,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,31,1235,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="adaaf0f3e032de3124ddc61a6111b25db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaaf0f3e032de3124ddc61a6111b25db">&#9670;&nbsp;</a></span>mark_page_invalid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void mark_page_invalid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;{</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keyword">struct </span><a class="code" href="structline__mgmt.html">line_mgmt</a> *lm = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a58bcbabc96ec3acaa19fac4ecf7956dc">lm</a>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssdparams.html">ssdparams</a> *spp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnand__block.html">nand_block</a> *blk = NULL;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnand__page.html">nand_page</a> *pg = NULL;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordtype">bool</span> was_full_line = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keyword">struct </span><a class="code" href="structline.html">line</a> *<a class="code" href="ftl_8h.html#aed1bbdc2f5620a4e59bee553c2cdd5fb">line</a>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">/* update corresponding page status */</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    pg = <a class="code" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66">get_pg</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(pg-&gt;<a class="code" href="structnand__page.html#ac238873d503e6fd6530f43b784019dfc">status</a> == <a class="code" href="ftl_8h.html#a99fb83031ce9923c84392b4e92f956b5ae15fc2b67b2402b6f167ecccafbbecd2">PG_VALID</a>);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    pg-&gt;<a class="code" href="structnand__page.html#ac238873d503e6fd6530f43b784019dfc">status</a> = <a class="code" href="ftl_8h.html#a99fb83031ce9923c84392b4e92f956b5a46fea2e65406af489e63ac526c7553db">PG_INVALID</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">/* update corresponding block status */</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    blk = <a class="code" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82">get_blk</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(blk-&gt;<a class="code" href="structnand__block.html#a0c979863e9e1648cbf3a129bcd92820b">ipc</a> &gt;= 0 &amp;&amp; blk-&gt;<a class="code" href="structnand__block.html#a0c979863e9e1648cbf3a129bcd92820b">ipc</a> &lt; spp-&gt;<a class="code" href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">pgs_per_blk</a>);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    blk-&gt;<a class="code" href="structnand__block.html#a0c979863e9e1648cbf3a129bcd92820b">ipc</a>++;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(blk-&gt;<a class="code" href="structnand__block.html#a89ec2fe3aff210edec30210b24dd2039">vpc</a> &gt; 0 &amp;&amp; blk-&gt;<a class="code" href="structnand__block.html#a89ec2fe3aff210edec30210b24dd2039">vpc</a> &lt;= spp-&gt;<a class="code" href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">pgs_per_blk</a>);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    blk-&gt;<a class="code" href="structnand__block.html#a89ec2fe3aff210edec30210b24dd2039">vpc</a>--;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">/* update corresponding line status */</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <a class="code" href="structline.html">line</a> = <a class="code" href="ftl_8c.html#a080e38a63b4626bd7cf314fcf74f2fb2">get_line</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(<a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#a7ddd1d1c2be2ce5467a30c30c9a989bd">ipc</a> &gt;= 0 &amp;&amp; <a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#a7ddd1d1c2be2ce5467a30c30c9a989bd">ipc</a> &lt; spp-&gt;<a class="code" href="structssdparams.html#a09e04352d7b5b2e8f9bb011a37204e3c">pgs_per_line</a>);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#aeefab665d811bfabfdaca326ab72e79c">vpc</a> == spp-&gt;<a class="code" href="structssdparams.html#a09e04352d7b5b2e8f9bb011a37204e3c">pgs_per_line</a>) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(<a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#a7ddd1d1c2be2ce5467a30c30c9a989bd">ipc</a> == 0);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        was_full_line = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#a7ddd1d1c2be2ce5467a30c30c9a989bd">ipc</a>++;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(<a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#aeefab665d811bfabfdaca326ab72e79c">vpc</a> &gt; 0 &amp;&amp; <a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#aeefab665d811bfabfdaca326ab72e79c">vpc</a> &lt;= spp-&gt;<a class="code" href="structssdparams.html#a09e04352d7b5b2e8f9bb011a37204e3c">pgs_per_line</a>);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">/* Adjust the position of the victime line in the pq under over-writes */</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#a089ed2a089e88d1421b88830d98561c2">pos</a>) {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="comment">/* Note that line-&gt;vpc will be updated by this call */</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <a class="code" href="pqueue_8h.html#a7dfaa607ca404b915355d4b123c669ee">pqueue_change_priority</a>(lm-&gt;<a class="code" href="structline__mgmt.html#ade69f28e6b03baac256cd1646f95b3d8">victim_line_pq</a>, <a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#aeefab665d811bfabfdaca326ab72e79c">vpc</a> - 1, <a class="code" href="structline.html">line</a>);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#aeefab665d811bfabfdaca326ab72e79c">vpc</a>--;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">if</span> (was_full_line) {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="comment">/* move line: &quot;full&quot; -&gt; &quot;victim&quot; */</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        QTAILQ_REMOVE(&amp;lm-&gt;full_line_list, <a class="code" href="structline.html">line</a>, entry);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        lm-&gt;<a class="code" href="structline__mgmt.html#a8ebebc34bbd4abeb8fdad4457042ad3b">full_line_cnt</a>--;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <a class="code" href="pqueue_8h.html#addd8cdfbc8c47b8cdd7eb4c4560de7aa">pqueue_insert</a>(lm-&gt;<a class="code" href="structline__mgmt.html#ade69f28e6b03baac256cd1646f95b3d8">victim_line_pq</a>, <a class="code" href="structline.html">line</a>);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        lm-&gt;<a class="code" href="structline__mgmt.html#a7cba4eac7dbe081ea3f943a5bd9b6ab8">victim_line_cnt</a>++;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_adaaf0f3e032de3124ddc61a6111b25db_cgraph.png" border="0" usemap="#ftl_8c_adaaf0f3e032de3124ddc61a6111b25db_cgraph" alt=""/></div>
<map name="ftl_8c_adaaf0f3e032de3124ddc61a6111b25db_cgraph" id="ftl_8c_adaaf0f3e032de3124ddc61a6111b25db_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,152,107"/>
<area shape="rect" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82" title=" " alt="" coords="454,29,525,56"/>
<area shape="rect" href="ftl_8c.html#a080e38a63b4626bd7cf314fcf74f2fb2" title=" " alt="" coords="252,29,327,56"/>
<area shape="rect" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66" title=" " alt="" coords="256,80,323,107"/>
<area shape="rect" href="pqueue_8h.html#a7dfaa607ca404b915355d4b123c669ee" title=" " alt="" coords="200,181,379,208"/>
<area shape="rect" href="pqueue_8h.html#addd8cdfbc8c47b8cdd7eb4c4560de7aa" title=" " alt="" coords="232,131,347,157"/>
<area shape="rect" href="ftl_8c.html#a8f0b10088699a4513219eafe0e2e4bc6" title=" " alt="" coords="610,29,673,56"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="731,29,801,56"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="849,29,915,56"/>
<area shape="rect" href="pqueue_8c.html#a918fcd7df850b9a0c17111abc9c323b1" title=" " alt="" coords="445,131,534,157"/>
<area shape="rect" href="pqueue_8c.html#a69ad19c161ae75369d1a444c83f4600c" title=" " alt="" coords="427,181,552,208"/>
<area shape="rect" href="pqueue_8c.html#a3e99f0cb15bfac6eeee46df9c875073a" title=" " alt="" coords="600,181,683,208"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_adaaf0f3e032de3124ddc61a6111b25db_icgraph.png" border="0" usemap="#ftl_8c_adaaf0f3e032de3124ddc61a6111b25db_icgraph" alt=""/></div>
<map name="ftl_8c_adaaf0f3e032de3124ddc61a6111b25db_icgraph" id="ftl_8c_adaaf0f3e032de3124ddc61a6111b25db_icgraph">
<area shape="rect" title=" " alt="" coords="1283,5,1429,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,5,1235,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a03834614ca890f0367e871939f0ffc3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03834614ca890f0367e871939f0ffc3b">&#9670;&nbsp;</a></span>mark_page_valid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void mark_page_valid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;{</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnand__block.html">nand_block</a> *blk = NULL;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnand__page.html">nand_page</a> *pg = NULL;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keyword">struct </span><a class="code" href="structline.html">line</a> *<a class="code" href="ftl_8h.html#aed1bbdc2f5620a4e59bee553c2cdd5fb">line</a>;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">/* update page status */</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    pg = <a class="code" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66">get_pg</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(pg-&gt;<a class="code" href="structnand__page.html#ac238873d503e6fd6530f43b784019dfc">status</a> == <a class="code" href="ftl_8h.html#a99fb83031ce9923c84392b4e92f956b5a0d5f318c3fc765bc802353b6cc599214">PG_FREE</a>);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    pg-&gt;<a class="code" href="structnand__page.html#ac238873d503e6fd6530f43b784019dfc">status</a> = <a class="code" href="ftl_8h.html#a99fb83031ce9923c84392b4e92f956b5ae15fc2b67b2402b6f167ecccafbbecd2">PG_VALID</a>;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">/* update corresponding block status */</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    blk = <a class="code" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82">get_blk</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(blk-&gt;<a class="code" href="structnand__block.html#a89ec2fe3aff210edec30210b24dd2039">vpc</a> &gt;= 0 &amp;&amp; blk-&gt;<a class="code" href="structnand__block.html#a89ec2fe3aff210edec30210b24dd2039">vpc</a> &lt; <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>.<a class="code" href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">pgs_per_blk</a>);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    blk-&gt;<a class="code" href="structnand__block.html#a89ec2fe3aff210edec30210b24dd2039">vpc</a>++;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">/* update corresponding line status */</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <a class="code" href="structline.html">line</a> = <a class="code" href="ftl_8c.html#a080e38a63b4626bd7cf314fcf74f2fb2">get_line</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(<a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#aeefab665d811bfabfdaca326ab72e79c">vpc</a> &gt;= 0 &amp;&amp; <a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#aeefab665d811bfabfdaca326ab72e79c">vpc</a> &lt; <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>.<a class="code" href="structssdparams.html#a09e04352d7b5b2e8f9bb011a37204e3c">pgs_per_line</a>);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#aeefab665d811bfabfdaca326ab72e79c">vpc</a>++;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a03834614ca890f0367e871939f0ffc3b_cgraph.png" border="0" usemap="#ftl_8c_a03834614ca890f0367e871939f0ffc3b_cgraph" alt=""/></div>
<map name="ftl_8c_a03834614ca890f0367e871939f0ffc3b_cgraph" id="ftl_8c_a03834614ca890f0367e871939f0ffc3b_cgraph">
<area shape="rect" title=" " alt="" coords="5,20,140,47"/>
<area shape="rect" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82" title=" " alt="" coords="311,20,381,47"/>
<area shape="rect" href="ftl_8c.html#a080e38a63b4626bd7cf314fcf74f2fb2" title=" " alt="" coords="188,20,263,47"/>
<area shape="rect" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66" title=" " alt="" coords="192,71,259,97"/>
<area shape="rect" href="ftl_8c.html#a8f0b10088699a4513219eafe0e2e4bc6" title=" " alt="" coords="429,20,492,47"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="540,20,611,47"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="659,20,724,47"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a03834614ca890f0367e871939f0ffc3b_icgraph.png" border="0" usemap="#ftl_8c_a03834614ca890f0367e871939f0ffc3b_icgraph" alt=""/></div>
<map name="ftl_8c_a03834614ca890f0367e871939f0ffc3b_icgraph" id="ftl_8c_a03834614ca890f0367e871939f0ffc3b_icgraph">
<area shape="rect" title=" " alt="" coords="1733,31,1868,57"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1569,5,1685,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,56,1235,83"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,5,1521,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,31,1103,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,31,971,57"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,31,851,57"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,31,736,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="a3c2e22192ca991c459c54bead5b1ff98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c2e22192ca991c459c54bead5b1ff98">&#9670;&nbsp;</a></span>ppa2pgidx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint64_t ppa2pgidx </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssdparams.html">ssdparams</a> *spp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    uint64_t pgidx;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    pgidx = <a class="code" href="structppa.html">ppa</a>-&gt;<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.ch  * spp-&gt;<a class="code" href="structssdparams.html#a618e42c61c1487fbe274ecc9d8b47e26">pgs_per_ch</a>  + \</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            ppa-&gt;g.lun * spp-&gt;<a class="code" href="structssdparams.html#a0a856000ec8d7d076eef4db2f1c4d87e">pgs_per_lun</a> + \</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            ppa-&gt;g.pl  * spp-&gt;<a class="code" href="structssdparams.html#abd6475e516ca9a5b1250d32c52853951">pgs_per_pl</a>  + \</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            ppa-&gt;g.blk * spp-&gt;<a class="code" href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">pgs_per_blk</a> + \</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            ppa-&gt;g.pg;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(pgidx &lt; spp-&gt;<a class="code" href="structssdparams.html#a853908a359571730e9f08e808eec2281">tt_pgs</a>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">return</span> pgidx;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a3c2e22192ca991c459c54bead5b1ff98_icgraph.png" border="0" usemap="#ftl_8c_a3c2e22192ca991c459c54bead5b1ff98_icgraph" alt=""/></div>
<map name="ftl_8c_a3c2e22192ca991c459c54bead5b1ff98_icgraph" id="ftl_8c_a3c2e22192ca991c459c54bead5b1ff98_icgraph">
<area shape="rect" title=" " alt="" coords="1893,31,1984,57"/>
<area shape="rect" href="ftl_8c.html#a92e6cdd7677ef48c1830b6fbba09a28a" title=" " alt="" coords="1733,5,1845,32"/>
<area shape="rect" href="ftl_8c.html#aac3ae48a56045829a6e2f1bf933b1d5b" title=" " alt="" coords="1734,56,1845,83"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1569,5,1685,32"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,5,1521,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,31,1103,57"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,56,1235,83"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,31,971,57"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,31,851,57"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,31,736,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="ae5f2680b1c6531f6394723c150f11e1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5f2680b1c6531f6394723c150f11e1c">&#9670;&nbsp;</a></span>select_victim_line()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structline.html">line</a>* select_victim_line </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>force</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;{</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keyword">struct </span><a class="code" href="structline__mgmt.html">line_mgmt</a> *lm = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a58bcbabc96ec3acaa19fac4ecf7956dc">lm</a>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keyword">struct </span><a class="code" href="structline.html">line</a> *victim_line = NULL;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    victim_line = <a class="code" href="pqueue_8h.html#a2919d3e817688b81da746d4123f51ba3">pqueue_peek</a>(lm-&gt;<a class="code" href="structline__mgmt.html#ade69f28e6b03baac256cd1646f95b3d8">victim_line_pq</a>);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">if</span> (!victim_line) {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">if</span> (!force &amp;&amp; victim_line-&gt;<a class="code" href="structline.html#a7ddd1d1c2be2ce5467a30c30c9a989bd">ipc</a> &lt; <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>.<a class="code" href="structssdparams.html#a09e04352d7b5b2e8f9bb011a37204e3c">pgs_per_line</a> / 8) {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="pqueue_8h.html#abec9363c7a9cc89190bf0925a4a1652c">pqueue_pop</a>(lm-&gt;<a class="code" href="structline__mgmt.html#ade69f28e6b03baac256cd1646f95b3d8">victim_line_pq</a>);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    victim_line-&gt;<a class="code" href="structline.html#a089ed2a089e88d1421b88830d98561c2">pos</a> = 0;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    lm-&gt;<a class="code" href="structline__mgmt.html#a7cba4eac7dbe081ea3f943a5bd9b6ab8">victim_line_cnt</a>--;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="comment">/* victim_line is a danggling node now */</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">return</span> victim_line;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_ae5f2680b1c6531f6394723c150f11e1c_cgraph.png" border="0" usemap="#ftl_8c_ae5f2680b1c6531f6394723c150f11e1c_cgraph" alt=""/></div>
<map name="ftl_8c_ae5f2680b1c6531f6394723c150f11e1c_cgraph" id="ftl_8c_ae5f2680b1c6531f6394723c150f11e1c_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,145,57"/>
<area shape="rect" href="pqueue_8h.html#a2919d3e817688b81da746d4123f51ba3" title=" " alt="" coords="193,5,303,32"/>
<area shape="rect" href="pqueue_8h.html#abec9363c7a9cc89190bf0925a4a1652c" title=" " alt="" coords="197,56,299,83"/>
<area shape="rect" href="pqueue_8c.html#a69ad19c161ae75369d1a444c83f4600c" title=" " alt="" coords="351,56,476,83"/>
<area shape="rect" href="pqueue_8c.html#a3e99f0cb15bfac6eeee46df9c875073a" title=" " alt="" coords="524,56,607,83"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_ae5f2680b1c6531f6394723c150f11e1c_icgraph.png" border="0" usemap="#ftl_8c_ae5f2680b1c6531f6394723c150f11e1c_icgraph" alt=""/></div>
<map name="ftl_8c_ae5f2680b1c6531f6394723c150f11e1c_icgraph" id="ftl_8c_ae5f2680b1c6531f6394723c150f11e1c_icgraph">
<area shape="rect" title=" " alt="" coords="1391,5,1531,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,31,1235,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ab02c4873ff387abfd6f268ae711fd0b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab02c4873ff387abfd6f268ae711fd0b5">&#9670;&nbsp;</a></span>set_maptbl_ent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_maptbl_ent </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>lpn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(lpn &lt; ssd-&gt;sp.tt_pgs);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a9d1cef93bbb35d5d9ee62073e99e53b0">maptbl</a>[lpn] = *<a class="code" href="structppa.html">ppa</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_ab02c4873ff387abfd6f268ae711fd0b5_cgraph.png" border="0" usemap="#ftl_8c_ab02c4873ff387abfd6f268ae711fd0b5_cgraph" alt=""/></div>
<map name="ftl_8c_ab02c4873ff387abfd6f268ae711fd0b5_cgraph" id="ftl_8c_ab02c4873ff387abfd6f268ae711fd0b5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,128,32"/>
<area shape="rect" href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8" title=" " alt="" coords="176,5,255,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_ab02c4873ff387abfd6f268ae711fd0b5_icgraph.png" border="0" usemap="#ftl_8c_ab02c4873ff387abfd6f268ae711fd0b5_icgraph" alt=""/></div>
<map name="ftl_8c_ab02c4873ff387abfd6f268ae711fd0b5_icgraph" id="ftl_8c_ab02c4873ff387abfd6f268ae711fd0b5_icgraph">
<area shape="rect" title=" " alt="" coords="1733,31,1856,57"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1569,5,1685,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,56,1235,83"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,5,1521,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,31,1103,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,31,971,57"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,31,851,57"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,31,736,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="aac3ae48a56045829a6e2f1bf933b1d5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac3ae48a56045829a6e2f1bf933b1d5b">&#9670;&nbsp;</a></span>set_rmap_ent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_rmap_ent </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>lpn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    uint64_t pgidx = <a class="code" href="ftl_8c.html#a3c2e22192ca991c459c54bead5b1ff98">ppa2pgidx</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#ae49bd8bfc26a6a8f1a992d84e0cc862c">rmap</a>[pgidx] = lpn;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_aac3ae48a56045829a6e2f1bf933b1d5b_cgraph.png" border="0" usemap="#ftl_8c_aac3ae48a56045829a6e2f1bf933b1d5b_cgraph" alt=""/></div>
<map name="ftl_8c_aac3ae48a56045829a6e2f1bf933b1d5b_cgraph" id="ftl_8c_aac3ae48a56045829a6e2f1bf933b1d5b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,116,32"/>
<area shape="rect" href="ftl_8c.html#a3c2e22192ca991c459c54bead5b1ff98" title=" " alt="" coords="164,5,255,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_aac3ae48a56045829a6e2f1bf933b1d5b_icgraph.png" border="0" usemap="#ftl_8c_aac3ae48a56045829a6e2f1bf933b1d5b_icgraph" alt=""/></div>
<map name="ftl_8c_aac3ae48a56045829a6e2f1bf933b1d5b_icgraph" id="ftl_8c_aac3ae48a56045829a6e2f1bf933b1d5b_icgraph">
<area shape="rect" title=" " alt="" coords="1733,31,1844,57"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1569,5,1685,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,56,1235,83"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,5,1521,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,31,1103,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,31,971,57"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,31,851,57"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,31,736,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="a6722c643872772d48598187782365209"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6722c643872772d48598187782365209">&#9670;&nbsp;</a></span>should_gc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool should_gc </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a58bcbabc96ec3acaa19fac4ecf7956dc">lm</a>.<a class="code" href="structline__mgmt.html#ab3da4f318464b294f5ad5179a0aa7b24">free_line_cnt</a> &lt;= <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>.<a class="code" href="structssdparams.html#a1bccb207bbd6aeca6c7b5fef5d530f6d">gc_thres_lines</a>);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a6722c643872772d48598187782365209_icgraph.png" border="0" usemap="#ftl_8c_a6722c643872772d48598187782365209_icgraph" alt=""/></div>
<map name="ftl_8c_a6722c643872772d48598187782365209_icgraph" id="ftl_8c_a6722c643872772d48598187782365209_icgraph">
<area shape="rect" title=" " alt="" coords="1151,5,1237,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a4494881726f0faee876d503fa1f2e312"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4494881726f0faee876d503fa1f2e312">&#9670;&nbsp;</a></span>should_gc_high()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool should_gc_high </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;{</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a58bcbabc96ec3acaa19fac4ecf7956dc">lm</a>.<a class="code" href="structline__mgmt.html#ab3da4f318464b294f5ad5179a0aa7b24">free_line_cnt</a> &lt;= <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>.<a class="code" href="structssdparams.html#ad72919d3040d8ba48758f0e276aea4ad">gc_thres_lines_high</a>);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a4494881726f0faee876d503fa1f2e312_icgraph.png" border="0" usemap="#ftl_8c_a4494881726f0faee876d503fa1f2e312_icgraph" alt=""/></div>
<map name="ftl_8c_a4494881726f0faee876d503fa1f2e312_icgraph" id="ftl_8c_a4494881726f0faee876d503fa1f2e312_icgraph">
<area shape="rect" title=" " alt="" coords="1283,5,1405,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,5,1235,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a0299da5e7e5dd1eb868d80914de35ee8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0299da5e7e5dd1eb868d80914de35ee8">&#9670;&nbsp;</a></span>ssd_advance_status()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint64_t ssd_advance_status </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnand__cmd.html">nand_cmd</a> *&#160;</td>
          <td class="paramname"><em>ncmd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;{</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordtype">int</span> c = ncmd-&gt;<a class="code" href="structnand__cmd.html#ac07e681b9811d160def06261529461c2">cmd</a>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    uint64_t cmd_stime = (ncmd-&gt;<a class="code" href="structnand__cmd.html#a0fda017087a80858b838195f4d8e2b36">stime</a> == 0) ? \</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        qemu_clock_get_ns(QEMU_CLOCK_REALTIME) : ncmd-&gt;<a class="code" href="structnand__cmd.html#a0fda017087a80858b838195f4d8e2b36">stime</a>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    uint64_t nand_stime;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssdparams.html">ssdparams</a> *spp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnand__lun.html">nand_lun</a> *lun = <a class="code" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d">get_lun</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    uint64_t lat = 0;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">switch</span> (c) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba064c38a00639099031cda82711a5ac5d">NAND_READ</a>:</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="comment">/* read: perform NAND cmd first */</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        nand_stime = (lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a> &lt; cmd_stime) ? cmd_stime : \</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                     lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a>;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a> = nand_stime + spp-&gt;<a class="code" href="structssdparams.html#ab8b7f48bd8cae23a4da6dcc8ceeb05ab">pg_rd_lat</a>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        lat = lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a> - cmd_stime;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;#<span class="keywordflow">if</span> 0</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a> = nand_stime + spp-&gt;<a class="code" href="structssdparams.html#ab8b7f48bd8cae23a4da6dcc8ceeb05ab">pg_rd_lat</a>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="comment">/* read: then data transfer through channel */</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        chnl_stime = (ch-&gt;next_ch_avail_time &lt; lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a>) ? \</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            lun-&gt;next_lun_avail_time : ch-&gt;next_ch_avail_time;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        ch-&gt;next_ch_avail_time = chnl_stime + spp-&gt;<a class="code" href="structssdparams.html#aebc159516f73021767eb96c276f64d08">ch_xfer_lat</a>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        lat = ch-&gt;next_ch_avail_time - cmd_stime;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba9eb21f1680871f4d099414752c40a2e4">NAND_WRITE</a>:</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="comment">/* write: transfer data through channel first */</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        nand_stime = (lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a> &lt; cmd_stime) ? cmd_stime : \</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                     lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        if (ncmd-&gt;<a class="code" href="structnand__cmd.html#a364c052be48202ede06e883e4b120409">type</a> == <a class="code" href="ftl_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a2dbf63358e7e23749bc4332d41ec31af">USER_IO</a>) {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a> = nand_stime + spp-&gt;<a class="code" href="structssdparams.html#a584a92a1768fad79586d746562db0ced">pg_wr_lat</a>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a> = nand_stime + spp-&gt;<a class="code" href="structssdparams.html#a584a92a1768fad79586d746562db0ced">pg_wr_lat</a>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        lat = lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a> - cmd_stime;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        chnl_stime = (ch-&gt;next_ch_avail_time &lt; cmd_stime) ? cmd_stime : \</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                     ch-&gt;next_ch_avail_time;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        ch-&gt;next_ch_avail_time = chnl_stime + spp-&gt;<a class="code" href="structssdparams.html#aebc159516f73021767eb96c276f64d08">ch_xfer_lat</a>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="comment">/* write: then do NAND program */</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        nand_stime = (lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a> &lt; ch-&gt;next_ch_avail_time) ? \</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            ch-&gt;next_ch_avail_time : lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a> = nand_stime + spp-&gt;<a class="code" href="structssdparams.html#a584a92a1768fad79586d746562db0ced">pg_wr_lat</a>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        lat = lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a> - cmd_stime;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba21101ced44d7c10f4be3536ccf778399">NAND_ERASE</a>:</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="comment">/* erase: only need to advance NAND status */</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        nand_stime = (lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a> &lt; cmd_stime) ? cmd_stime : \</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                     lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a> = nand_stime + spp-&gt;<a class="code" href="structssdparams.html#a6865de86ba20967f6ef156beeca0d62a">blk_er_lat</a>;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        lat = lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a> - cmd_stime;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <a class="code" href="ftl_8h.html#ae78ff7bb5a99b8a8ac5fc3c82e0ca403">ftl_err</a>(<span class="stringliteral">&quot;Unsupported NAND command: 0x%x\n&quot;</span>, c);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">return</span> lat;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a0299da5e7e5dd1eb868d80914de35ee8_cgraph.png" border="0" usemap="#ftl_8c_a0299da5e7e5dd1eb868d80914de35ee8_cgraph" alt=""/></div>
<map name="ftl_8c_a0299da5e7e5dd1eb868d80914de35ee8_cgraph" id="ftl_8c_a0299da5e7e5dd1eb868d80914de35ee8_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,159,32"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="207,5,277,32"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="325,5,391,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a0299da5e7e5dd1eb868d80914de35ee8_icgraph.png" border="0" usemap="#ftl_8c_a0299da5e7e5dd1eb868d80914de35ee8_icgraph" alt=""/></div>
<map name="ftl_8c_a0299da5e7e5dd1eb868d80914de35ee8_icgraph" id="ftl_8c_a0299da5e7e5dd1eb868d80914de35ee8_icgraph">
<area shape="rect" title=" " alt="" coords="1733,87,1887,114"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,94,1343,120"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,55,1235,82"/>
<area shape="rect" href="ftl_8c.html#a4b9026945c9fcc578ba0f7a7a84a1af1" title=" " alt="" coords="1571,87,1683,114"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1569,36,1685,63"/>
<area shape="rect" href="ftl_8c.html#a306780893a49a72da761566ca918b35e" title=" " alt="" coords="1416,188,1496,215"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,106,1103,132"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,106,971,132"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,106,851,132"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,106,736,132"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,106,527,132"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,106,284,132"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,106,129,132"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,87,1521,114"/>
</map>
</div>

</div>
</div>
<a id="a52df9249316530eb887e0412ca51f048"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52df9249316530eb887e0412ca51f048">&#9670;&nbsp;</a></span>ssd_advance_write_pointer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ssd_advance_write_pointer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;{</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssdparams.html">ssdparams</a> *spp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keyword">struct </span><a class="code" href="structwrite__pointer.html">write_pointer</a> *wpp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a8ce888a31348d5b2fa1d914dde456166">wp</a>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keyword">struct </span><a class="code" href="structline__mgmt.html">line_mgmt</a> *lm = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a58bcbabc96ec3acaa19fac4ecf7956dc">lm</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="ftl_8c.html#a0b6eca1c9bf137587f4c3c7aed0ea914">check_addr</a>(wpp-&gt;<a class="code" href="structwrite__pointer.html#adf3acc53d295719babbd39458dddaa66">ch</a>, spp-&gt;<a class="code" href="structssdparams.html#a17a649068b0acfe64a1afc67b51236fb">nchs</a>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    wpp-&gt;<a class="code" href="structwrite__pointer.html#adf3acc53d295719babbd39458dddaa66">ch</a>++;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">if</span> (wpp-&gt;<a class="code" href="structwrite__pointer.html#adf3acc53d295719babbd39458dddaa66">ch</a> == spp-&gt;<a class="code" href="structssdparams.html#a17a649068b0acfe64a1afc67b51236fb">nchs</a>) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        wpp-&gt;<a class="code" href="structwrite__pointer.html#adf3acc53d295719babbd39458dddaa66">ch</a> = 0;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <a class="code" href="ftl_8c.html#a0b6eca1c9bf137587f4c3c7aed0ea914">check_addr</a>(wpp-&gt;<a class="code" href="structwrite__pointer.html#aac27e9340ffc7900b39c57731fa61dc0">lun</a>, spp-&gt;<a class="code" href="structssdparams.html#ad339ca6a9e013ff5d28d408f7e2ad705">luns_per_ch</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        wpp-&gt;<a class="code" href="structwrite__pointer.html#aac27e9340ffc7900b39c57731fa61dc0">lun</a>++;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">/* in this case, we should go to next lun */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span> (wpp-&gt;<a class="code" href="structwrite__pointer.html#aac27e9340ffc7900b39c57731fa61dc0">lun</a> == spp-&gt;<a class="code" href="structssdparams.html#ad339ca6a9e013ff5d28d408f7e2ad705">luns_per_ch</a>) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            wpp-&gt;<a class="code" href="structwrite__pointer.html#aac27e9340ffc7900b39c57731fa61dc0">lun</a> = 0;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="comment">/* go to next page in the block */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <a class="code" href="ftl_8c.html#a0b6eca1c9bf137587f4c3c7aed0ea914">check_addr</a>(wpp-&gt;<a class="code" href="structwrite__pointer.html#acbaa6937b756b9cbf3f457973f98b12a">pg</a>, spp-&gt;<a class="code" href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">pgs_per_blk</a>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            wpp-&gt;<a class="code" href="structwrite__pointer.html#acbaa6937b756b9cbf3f457973f98b12a">pg</a>++;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keywordflow">if</span> (wpp-&gt;<a class="code" href="structwrite__pointer.html#acbaa6937b756b9cbf3f457973f98b12a">pg</a> == spp-&gt;<a class="code" href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">pgs_per_blk</a>) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                wpp-&gt;<a class="code" href="structwrite__pointer.html#acbaa6937b756b9cbf3f457973f98b12a">pg</a> = 0;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <span class="comment">/* move current line to {victim,full} line list */</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <span class="keywordflow">if</span> (wpp-&gt;<a class="code" href="structwrite__pointer.html#ac533d4150e459ae66a36a1407d74cddc">curline</a>-&gt;<a class="code" href="structline.html#aeefab665d811bfabfdaca326ab72e79c">vpc</a> == spp-&gt;<a class="code" href="structssdparams.html#a09e04352d7b5b2e8f9bb011a37204e3c">pgs_per_line</a>) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                    <span class="comment">/* all pgs are still valid, move to full line list */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(wpp-&gt;<a class="code" href="structwrite__pointer.html#ac533d4150e459ae66a36a1407d74cddc">curline</a>-&gt;<a class="code" href="structline.html#a7ddd1d1c2be2ce5467a30c30c9a989bd">ipc</a> == 0);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    QTAILQ_INSERT_TAIL(&amp;lm-&gt;full_line_list, wpp-&gt;<a class="code" href="structwrite__pointer.html#ac533d4150e459ae66a36a1407d74cddc">curline</a>, entry);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                    lm-&gt;<a class="code" href="structline__mgmt.html#a8ebebc34bbd4abeb8fdad4457042ad3b">full_line_cnt</a>++;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(wpp-&gt;<a class="code" href="structwrite__pointer.html#ac533d4150e459ae66a36a1407d74cddc">curline</a>-&gt;<a class="code" href="structline.html#aeefab665d811bfabfdaca326ab72e79c">vpc</a> &gt;= 0 &amp;&amp; wpp-&gt;<a class="code" href="structwrite__pointer.html#ac533d4150e459ae66a36a1407d74cddc">curline</a>-&gt;<a class="code" href="structline.html#aeefab665d811bfabfdaca326ab72e79c">vpc</a> &lt; spp-&gt;<a class="code" href="structssdparams.html#a09e04352d7b5b2e8f9bb011a37204e3c">pgs_per_line</a>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                    <span class="comment">/* there must be some invalid pages in this line */</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(wpp-&gt;<a class="code" href="structwrite__pointer.html#ac533d4150e459ae66a36a1407d74cddc">curline</a>-&gt;<a class="code" href="structline.html#a7ddd1d1c2be2ce5467a30c30c9a989bd">ipc</a> &gt; 0);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                    <a class="code" href="pqueue_8h.html#addd8cdfbc8c47b8cdd7eb4c4560de7aa">pqueue_insert</a>(lm-&gt;<a class="code" href="structline__mgmt.html#ade69f28e6b03baac256cd1646f95b3d8">victim_line_pq</a>, wpp-&gt;<a class="code" href="structwrite__pointer.html#ac533d4150e459ae66a36a1407d74cddc">curline</a>);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    lm-&gt;<a class="code" href="structline__mgmt.html#a7cba4eac7dbe081ea3f943a5bd9b6ab8">victim_line_cnt</a>++;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                <span class="comment">/* current line is used up, pick another empty line */</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <a class="code" href="ftl_8c.html#a0b6eca1c9bf137587f4c3c7aed0ea914">check_addr</a>(wpp-&gt;<a class="code" href="structwrite__pointer.html#a854272876a0fbd867842d16a3620a827">blk</a>, spp-&gt;<a class="code" href="structssdparams.html#aaafec0385f6c9c34b05be63526644c5a">blks_per_pl</a>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                wpp-&gt;<a class="code" href="structwrite__pointer.html#ac533d4150e459ae66a36a1407d74cddc">curline</a> = NULL;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                wpp-&gt;<a class="code" href="structwrite__pointer.html#ac533d4150e459ae66a36a1407d74cddc">curline</a> = <a class="code" href="ftl_8c.html#a659c0c25af9ae17e1771fc5bf7bca444">get_next_free_line</a>(<a class="code" href="structssd.html">ssd</a>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="keywordflow">if</span> (!wpp-&gt;<a class="code" href="structwrite__pointer.html#ac533d4150e459ae66a36a1407d74cddc">curline</a>) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                    <span class="comment">/* TODO */</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    abort();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                wpp-&gt;<a class="code" href="structwrite__pointer.html#a854272876a0fbd867842d16a3620a827">blk</a> = wpp-&gt;<a class="code" href="structwrite__pointer.html#ac533d4150e459ae66a36a1407d74cddc">curline</a>-&gt;<a class="code" href="structline.html#aea4a6b372d188d62345ed68656fff577">id</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                <a class="code" href="ftl_8c.html#a0b6eca1c9bf137587f4c3c7aed0ea914">check_addr</a>(wpp-&gt;<a class="code" href="structwrite__pointer.html#a854272876a0fbd867842d16a3620a827">blk</a>, spp-&gt;<a class="code" href="structssdparams.html#aaafec0385f6c9c34b05be63526644c5a">blks_per_pl</a>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                <span class="comment">/* make sure we are starting from page 0 in the super block */</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(wpp-&gt;<a class="code" href="structwrite__pointer.html#acbaa6937b756b9cbf3f457973f98b12a">pg</a> == 0);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(wpp-&gt;<a class="code" href="structwrite__pointer.html#aac27e9340ffc7900b39c57731fa61dc0">lun</a> == 0);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(wpp-&gt;<a class="code" href="structwrite__pointer.html#adf3acc53d295719babbd39458dddaa66">ch</a> == 0);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                <span class="comment">/* TODO: assume # of pl_per_lun is 1, fix later */</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(wpp-&gt;<a class="code" href="structwrite__pointer.html#a685331c5878278ccaf80c3672ce73f7c">pl</a> == 0);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a52df9249316530eb887e0412ca51f048_cgraph.png" border="0" usemap="#ftl_8c_a52df9249316530eb887e0412ca51f048_cgraph" alt=""/></div>
<map name="ftl_8c_a52df9249316530eb887e0412ca51f048_cgraph" id="ftl_8c_a52df9249316530eb887e0412ca51f048_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,204,83"/>
<area shape="rect" href="ftl_8c.html#a0b6eca1c9bf137587f4c3c7aed0ea914" title=" " alt="" coords="275,5,371,32"/>
<area shape="rect" href="ftl_8c.html#a659c0c25af9ae17e1771fc5bf7bca444" title=" " alt="" coords="252,56,395,83"/>
<area shape="rect" href="pqueue_8h.html#addd8cdfbc8c47b8cdd7eb4c4560de7aa" title=" " alt="" coords="266,107,381,133"/>
<area shape="rect" href="pqueue_8c.html#a918fcd7df850b9a0c17111abc9c323b1" title=" " alt="" coords="443,107,532,133"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a52df9249316530eb887e0412ca51f048_icgraph.png" border="0" usemap="#ftl_8c_a52df9249316530eb887e0412ca51f048_icgraph" alt=""/></div>
<map name="ftl_8c_a52df9249316530eb887e0412ca51f048_icgraph" id="ftl_8c_a52df9249316530eb887e0412ca51f048_icgraph">
<area shape="rect" title=" " alt="" coords="1733,31,1932,57"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1569,5,1685,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,56,1235,83"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,5,1521,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,31,1103,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,31,971,57"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,31,851,57"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,31,736,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="af3f6de830b620d1f3060c7de8c8ddec0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3f6de830b620d1f3060c7de8c8ddec0">&#9670;&nbsp;</a></span>ssd_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ssd_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;{</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssd.html">ssd</a> *<a class="code" href="structssd.html">ssd</a> = n-&gt;<a class="code" href="structFemuCtrl.html#a4464c81978268e5df515d91044ea1ec2">ssd</a>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssdparams.html">ssdparams</a> *spp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(<a class="code" href="structssd.html">ssd</a>);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="ftl_8c.html#a96c1b582459f3ccfc0643bac1a8cdf35">ssd_init_params</a>(spp);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">/* initialize ssd internal layout architecture */</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a6ffa7f5fbc77044d9fb80e65d477a632">ch</a> = g_malloc0(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structssd__channel.html">ssd_channel</a>) * spp-&gt;<a class="code" href="structssdparams.html#a17a649068b0acfe64a1afc67b51236fb">nchs</a>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; spp-&gt;<a class="code" href="structssdparams.html#a17a649068b0acfe64a1afc67b51236fb">nchs</a>; i++) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <a class="code" href="ftl_8c.html#aa4643e6bbe68de1c047ec1d1745a82e3">ssd_init_ch</a>(&amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a6ffa7f5fbc77044d9fb80e65d477a632">ch</a>[i], spp);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">/* initialize maptbl */</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="ftl_8c.html#a358979ad49087b2f21ead4eb9a153f14">ssd_init_maptbl</a>(<a class="code" href="structssd.html">ssd</a>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">/* initialize rmap */</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="ftl_8c.html#ae19a0a686346f1ffbfa9e73035efbaad">ssd_init_rmap</a>(<a class="code" href="structssd.html">ssd</a>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">/* initialize all the lines */</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="ftl_8c.html#a75e82f66648a13506f57f7bb0fce7a10">ssd_init_lines</a>(<a class="code" href="structssd.html">ssd</a>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">/* initialize write pointer, this is how we allocate new pages for writes */</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <a class="code" href="ftl_8c.html#a37afec234fedd2c392569d5ce0af6cb4">ssd_init_write_pointer</a>(<a class="code" href="structssd.html">ssd</a>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    qemu_thread_create(&amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a6952886e09ff0a561ea0f61786904637">ftl_thread</a>, <span class="stringliteral">&quot;FEMU-FTL-Thread&quot;</span>, <a class="code" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3">ftl_thread</a>, n,</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                       QEMU_THREAD_JOINABLE);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_af3f6de830b620d1f3060c7de8c8ddec0_cgraph.png" border="0" usemap="#ftl_8c_af3f6de830b620d1f3060c7de8c8ddec0_cgraph" alt=""/></div>
<map name="ftl_8c_af3f6de830b620d1f3060c7de8c8ddec0_cgraph" id="ftl_8c_af3f6de830b620d1f3060c7de8c8ddec0_cgraph">
<area shape="rect" title=" " alt="" coords="5,777,77,804"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="166,264,250,291"/>
<area shape="rect" href="ftl_8c.html#aa4643e6bbe68de1c047ec1d1745a82e3" title=" " alt="" coords="161,777,255,804"/>
<area shape="rect" href="ftl_8c.html#a75e82f66648a13506f57f7bb0fce7a10" title=" " alt="" coords="153,727,263,753"/>
<area shape="rect" href="ftl_8c.html#a358979ad49087b2f21ead4eb9a153f14" title=" " alt="" coords="951,81,1076,108"/>
<area shape="rect" href="ftl_8c.html#a96c1b582459f3ccfc0643bac1a8cdf35" title=" " alt="" coords="144,828,272,855"/>
<area shape="rect" href="ftl_8c.html#ae19a0a686346f1ffbfa9e73035efbaad" title=" " alt="" coords="151,879,265,905"/>
<area shape="rect" href="ftl_8c.html#a37afec234fedd2c392569d5ce0af6cb4" title=" " alt="" coords="125,929,291,956"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="597,955,657,981"/>
<area shape="rect" href="rte__ring_8h.html#a96ef17a77ac3deecdb8a1fb71b6bdf63" title=" " alt="" coords="350,49,481,76"/>
<area shape="rect" href="rte__ring_8h.html#ab2417e0e85ffd0e61ec4b0ee263ab809" title=" " alt="" coords="340,112,491,139"/>
<area shape="rect" href="rte__ring_8h.html#a3afc06d02f63e84fe1569c99955af57a" title=" " alt="" coords="340,239,491,265"/>
<area shape="rect" href="ftl_8c.html#a6722c643872772d48598187782365209" title=" " alt="" coords="372,188,459,215"/>
<area shape="rect" href="ftl_8c.html#a306780893a49a72da761566ca918b35e" title=" " alt="" coords="375,289,455,316"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="373,499,457,525"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="767,701,898,728"/>
<area shape="rect" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8" title=" " alt="" coords="1147,955,1300,981"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="1375,904,1445,931"/>
<area shape="rect" href="ftl_8c.html#a5313a5ca429ce56095c0c1052c301c15" title=" " alt="" coords="767,955,898,981"/>
<area shape="rect" href="ftl_8c.html#a2c41ad05315023bfa77846568e4f7282" title=" " alt="" coords="953,955,1073,981"/>
<area shape="rect" href="ftl_8c.html#ae5f2680b1c6531f6394723c150f11e1c" title=" " alt="" coords="763,1005,903,1032"/>
<area shape="rect" href="ftl_8c.html#a4b9026945c9fcc578ba0f7a7a84a1af1" title=" " alt="" coords="957,853,1069,880"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="955,701,1071,728"/>
<area shape="rect" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82" title=" " alt="" coords="1497,701,1568,728"/>
<area shape="rect" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66" title=" " alt="" coords="1377,600,1443,627"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="1500,853,1565,880"/>
<area shape="rect" href="ftl_8c.html#a2db76f519a8218ea9cda35e61552a4ec" title=" " alt="" coords="1165,397,1281,424"/>
<area shape="rect" href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b" title=" " alt="" coords="1156,701,1291,728"/>
<area shape="rect" href="ftl_8c.html#ab02c4873ff387abfd6f268ae711fd0b5" title=" " alt="" coords="1162,448,1285,475"/>
<area shape="rect" href="ftl_8c.html#aac3ae48a56045829a6e2f1bf933b1d5b" title=" " alt="" coords="1168,651,1279,677"/>
<area shape="rect" href="ftl_8c.html#a52df9249316530eb887e0412ca51f048" title=" " alt="" coords="1124,904,1323,931"/>
<area shape="rect" href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8" title=" " alt="" coords="1371,347,1449,373"/>
<area shape="rect" href="ftl_8c.html#a080e38a63b4626bd7cf314fcf74f2fb2" title=" " alt="" coords="1373,651,1447,677"/>
<area shape="rect" href="rte__ring_8h.html#abc8376d2c6e609707d52032860880b34" title=" " alt="" coords="570,43,685,69"/>
<area shape="rect" href="rte__ring_8h.html#a8742d4b89ce43dbd93cc2ef48518ccf0" title=" " alt="" coords="540,93,715,120"/>
<area shape="rect" href="rte__ring_8h.html#ab8debfb458e927d559e7ce750048502d" title=" " alt="" coords="542,144,713,171"/>
<area shape="rect" href="ftl_8c.html#af93eee663d18640559cfd06afdeb5409" title=" " alt="" coords="565,347,689,373"/>
<area shape="rect" href="ftl_8c.html#a6e8a2a542e569fe2662cbb8cf647590b" title=" " alt="" coords="574,296,681,323"/>
<area shape="rect" href="ftl_8c.html#a4237c1400d2e5e24f32b77e347163ab9" title=" " alt="" coords="585,195,670,221"/>
<area shape="rect" href="ftl_8c.html#adaaf0f3e032de3124ddc61a6111b25db" title=" " alt="" coords="1150,549,1297,576"/>
<area shape="rect" href="ftl_8c.html#a4494881726f0faee876d503fa1f2e312" title=" " alt="" coords="566,853,689,880"/>
<area shape="rect" href="ftl_8c.html#ae77b0af37a85b3285ff26402ca7d03a5" title=" " alt="" coords="346,904,485,931"/>
<area shape="rect" href="ftl_8c.html#ac6428955c80a1fb3371e13b2b2f4ea26" title=" " alt="" coords="550,1005,705,1032"/>
<area shape="rect" href="pqueue_8h.html#a2c27c13ed1c988e9fc7b259e6820ca8c" title=" " alt="" coords="366,600,465,627"/>
<area shape="rect" href="ftl_8c.html#ab36d3c54cb8e6ef53588b549a5803172" title=" " alt="" coords="339,651,492,677"/>
<area shape="rect" href="ftl_8c.html#a3c491d1c863f0b3501bd668a59dec976" title=" " alt="" coords="339,701,491,728"/>
<area shape="rect" href="ftl_8c.html#a9417ce02aa098194c92e57ef04abb6b7" title=" " alt="" coords="342,752,489,779"/>
<area shape="rect" href="ftl_8c.html#ae8e269140ca688f2decf1b684d2e3991" title=" " alt="" coords="340,803,491,829"/>
<area shape="rect" href="ftl_8c.html#a6d8917709dbdb441c13fc5d6ee5204aa" title=" " alt="" coords="343,853,488,880"/>
<area shape="rect" href="ftl_8c.html#aa555ec9dcfe762eb6c39afa3cb167e3d" title=" " alt="" coords="357,955,473,981"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_af3f6de830b620d1f3060c7de8c8ddec0_icgraph.png" border="0" usemap="#ftl_8c_af3f6de830b620d1f3060c7de8c8ddec0_icgraph" alt=""/></div>
<map name="ftl_8c_af3f6de830b620d1f3060c7de8c8ddec0_icgraph" id="ftl_8c_af3f6de830b620d1f3060c7de8c8ddec0_icgraph">
<area shape="rect" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="aa4643e6bbe68de1c047ec1d1745a82e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4643e6bbe68de1c047ec1d1745a82e3">&#9670;&nbsp;</a></span>ssd_init_ch()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ssd_init_ch </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd__channel.html">ssd_channel</a> *&#160;</td>
          <td class="paramname"><em>ch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structssdparams.html">ssdparams</a> *&#160;</td>
          <td class="paramname"><em>spp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;{</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    ch-&gt;<a class="code" href="structssd__channel.html#a8004398246e9bc2a7e48a71d1b58d90f">nluns</a> = spp-&gt;<a class="code" href="structssdparams.html#ad339ca6a9e013ff5d28d408f7e2ad705">luns_per_ch</a>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    ch-&gt;<a class="code" href="structssd__channel.html#a43f4b195efe270acfb3ba6fa229ecf1b">lun</a> = g_malloc0(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structnand__lun.html">nand_lun</a>) * ch-&gt;<a class="code" href="structssd__channel.html#a8004398246e9bc2a7e48a71d1b58d90f">nluns</a>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ch-&gt;<a class="code" href="structssd__channel.html#a8004398246e9bc2a7e48a71d1b58d90f">nluns</a>; i++) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <a class="code" href="ftl_8c.html#ae77b0af37a85b3285ff26402ca7d03a5">ssd_init_nand_lun</a>(&amp;ch-&gt;<a class="code" href="structssd__channel.html#a43f4b195efe270acfb3ba6fa229ecf1b">lun</a>[i], spp);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    ch-&gt;<a class="code" href="structssd__channel.html#a11dd1bcafa099c1d41787aeac9730aea">next_ch_avail_time</a> = 0;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    ch-&gt;<a class="code" href="structssd__channel.html#ad3796afe284a6e0a1980e4f1c0ab291d">busy</a> = 0;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_aa4643e6bbe68de1c047ec1d1745a82e3_cgraph.png" border="0" usemap="#ftl_8c_aa4643e6bbe68de1c047ec1d1745a82e3_cgraph" alt=""/></div>
<map name="ftl_8c_aa4643e6bbe68de1c047ec1d1745a82e3_cgraph" id="ftl_8c_aa4643e6bbe68de1c047ec1d1745a82e3_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,100,32"/>
<area shape="rect" href="ftl_8c.html#ae77b0af37a85b3285ff26402ca7d03a5" title=" " alt="" coords="148,5,287,32"/>
<area shape="rect" href="ftl_8c.html#ac6428955c80a1fb3371e13b2b2f4ea26" title=" " alt="" coords="335,5,489,32"/>
<area shape="rect" href="ftl_8c.html#afd1c030b3a24f516a3eda967bb936f8d" title=" " alt="" coords="537,5,676,32"/>
<area shape="rect" href="ftl_8c.html#aa17bd85978e80a1bb61285f026f7a427" title=" " alt="" coords="724,5,875,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_aa4643e6bbe68de1c047ec1d1745a82e3_icgraph.png" border="0" usemap="#ftl_8c_aa4643e6bbe68de1c047ec1d1745a82e3_icgraph" alt=""/></div>
<map name="ftl_8c_aa4643e6bbe68de1c047ec1d1745a82e3_icgraph" id="ftl_8c_aa4643e6bbe68de1c047ec1d1745a82e3_icgraph">
<area shape="rect" title=" " alt="" coords="1019,5,1113,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a75e82f66648a13506f57f7bb0fce7a10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75e82f66648a13506f57f7bb0fce7a10">&#9670;&nbsp;</a></span>ssd_init_lines()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ssd_init_lines </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssdparams.html">ssdparams</a> *spp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keyword">struct </span><a class="code" href="structline__mgmt.html">line_mgmt</a> *lm = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a58bcbabc96ec3acaa19fac4ecf7956dc">lm</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keyword">struct </span><a class="code" href="structline.html">line</a> *<a class="code" href="ftl_8h.html#aed1bbdc2f5620a4e59bee553c2cdd5fb">line</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    lm-&gt;<a class="code" href="structline__mgmt.html#a871cace77a18047bec4e8bb62524321e">tt_lines</a> = spp-&gt;<a class="code" href="structssdparams.html#aaafec0385f6c9c34b05be63526644c5a">blks_per_pl</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(lm-&gt;<a class="code" href="structline__mgmt.html#a871cace77a18047bec4e8bb62524321e">tt_lines</a> == spp-&gt;<a class="code" href="structssdparams.html#acd04d8260ca1b86005ccc56307105b23">tt_lines</a>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    lm-&gt;<a class="code" href="structline__mgmt.html#a52782d1468638fe4b1462bcd2175976c">lines</a> = g_malloc0(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structline.html">line</a>) * lm-&gt;<a class="code" href="structline__mgmt.html#a871cace77a18047bec4e8bb62524321e">tt_lines</a>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    QTAILQ_INIT(&amp;lm-&gt;free_line_list);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    lm-&gt;<a class="code" href="structline__mgmt.html#ade69f28e6b03baac256cd1646f95b3d8">victim_line_pq</a> = <a class="code" href="pqueue_8h.html#a2c27c13ed1c988e9fc7b259e6820ca8c">pqueue_init</a>(spp-&gt;<a class="code" href="structssdparams.html#acd04d8260ca1b86005ccc56307105b23">tt_lines</a>, <a class="code" href="ftl_8c.html#ab36d3c54cb8e6ef53588b549a5803172">victim_line_cmp_pri</a>,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <a class="code" href="ftl_8c.html#a9417ce02aa098194c92e57ef04abb6b7">victim_line_get_pri</a>, <a class="code" href="ftl_8c.html#a6d8917709dbdb441c13fc5d6ee5204aa">victim_line_set_pri</a>,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <a class="code" href="ftl_8c.html#a3c491d1c863f0b3501bd668a59dec976">victim_line_get_pos</a>, <a class="code" href="ftl_8c.html#ae8e269140ca688f2decf1b684d2e3991">victim_line_set_pos</a>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    QTAILQ_INIT(&amp;lm-&gt;full_line_list);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    lm-&gt;<a class="code" href="structline__mgmt.html#ab3da4f318464b294f5ad5179a0aa7b24">free_line_cnt</a> = 0;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; lm-&gt;<a class="code" href="structline__mgmt.html#a871cace77a18047bec4e8bb62524321e">tt_lines</a>; i++) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <a class="code" href="structline.html">line</a> = &amp;lm-&gt;<a class="code" href="structline__mgmt.html#a52782d1468638fe4b1462bcd2175976c">lines</a>[i];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#aea4a6b372d188d62345ed68656fff577">id</a> = i;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#a7ddd1d1c2be2ce5467a30c30c9a989bd">ipc</a> = 0;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#aeefab665d811bfabfdaca326ab72e79c">vpc</a> = 0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="structline.html">line</a>-&gt;<a class="code" href="structline.html#a089ed2a089e88d1421b88830d98561c2">pos</a> = 0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">/* initialize all the lines as free lines */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        QTAILQ_INSERT_TAIL(&amp;lm-&gt;free_line_list, <a class="code" href="structline.html">line</a>, entry);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        lm-&gt;<a class="code" href="structline__mgmt.html#ab3da4f318464b294f5ad5179a0aa7b24">free_line_cnt</a>++;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a>(lm-&gt;<a class="code" href="structline__mgmt.html#ab3da4f318464b294f5ad5179a0aa7b24">free_line_cnt</a> == lm-&gt;<a class="code" href="structline__mgmt.html#a871cace77a18047bec4e8bb62524321e">tt_lines</a>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    lm-&gt;<a class="code" href="structline__mgmt.html#a7cba4eac7dbe081ea3f943a5bd9b6ab8">victim_line_cnt</a> = 0;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    lm-&gt;<a class="code" href="structline__mgmt.html#a8ebebc34bbd4abeb8fdad4457042ad3b">full_line_cnt</a> = 0;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a75e82f66648a13506f57f7bb0fce7a10_cgraph.png" border="0" usemap="#ftl_8c_a75e82f66648a13506f57f7bb0fce7a10_cgraph" alt=""/></div>
<map name="ftl_8c_a75e82f66648a13506f57f7bb0fce7a10_cgraph" id="ftl_8c_a75e82f66648a13506f57f7bb0fce7a10_cgraph">
<area shape="rect" title=" " alt="" coords="5,132,116,159"/>
<area shape="rect" href="pqueue_8h.html#a2c27c13ed1c988e9fc7b259e6820ca8c" title=" " alt="" coords="191,5,290,32"/>
<area shape="rect" href="ftl_8c.html#ab36d3c54cb8e6ef53588b549a5803172" title=" " alt="" coords="164,56,317,83"/>
<area shape="rect" href="ftl_8c.html#a3c491d1c863f0b3501bd668a59dec976" title=" " alt="" coords="165,107,317,133"/>
<area shape="rect" href="ftl_8c.html#a9417ce02aa098194c92e57ef04abb6b7" title=" " alt="" coords="167,157,314,184"/>
<area shape="rect" href="ftl_8c.html#ae8e269140ca688f2decf1b684d2e3991" title=" " alt="" coords="165,208,316,235"/>
<area shape="rect" href="ftl_8c.html#a6d8917709dbdb441c13fc5d6ee5204aa" title=" " alt="" coords="168,259,313,285"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a75e82f66648a13506f57f7bb0fce7a10_icgraph.png" border="0" usemap="#ftl_8c_a75e82f66648a13506f57f7bb0fce7a10_icgraph" alt=""/></div>
<map name="ftl_8c_a75e82f66648a13506f57f7bb0fce7a10_icgraph" id="ftl_8c_a75e82f66648a13506f57f7bb0fce7a10_icgraph">
<area shape="rect" title=" " alt="" coords="1019,5,1129,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a358979ad49087b2f21ead4eb9a153f14"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a358979ad49087b2f21ead4eb9a153f14">&#9670;&nbsp;</a></span>ssd_init_maptbl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ssd_init_maptbl </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;{</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssdparams.html">ssdparams</a> *spp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a9d1cef93bbb35d5d9ee62073e99e53b0">maptbl</a> = g_malloc0(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structppa.html">ppa</a>) * spp-&gt;<a class="code" href="structssdparams.html#a853908a359571730e9f08e808eec2281">tt_pgs</a>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; spp-&gt;<a class="code" href="structssdparams.html#a853908a359571730e9f08e808eec2281">tt_pgs</a>; i++) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a9d1cef93bbb35d5d9ee62073e99e53b0">maptbl</a>[i].<a class="code" href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8">ppa</a> = <a class="code" href="ftl_8h.html#a4f586d4bebabb8dce738295d42a3671e">UNMAPPED_PPA</a>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a358979ad49087b2f21ead4eb9a153f14_cgraph.png" border="0" usemap="#ftl_8c_a358979ad49087b2f21ead4eb9a153f14_cgraph" alt=""/></div>
<map name="ftl_8c_a358979ad49087b2f21ead4eb9a153f14_cgraph" id="ftl_8c_a358979ad49087b2f21ead4eb9a153f14_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,131,32"/>
<area shape="rect" href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8" title=" " alt="" coords="179,5,257,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a358979ad49087b2f21ead4eb9a153f14_icgraph.png" border="0" usemap="#ftl_8c_a358979ad49087b2f21ead4eb9a153f14_icgraph" alt=""/></div>
<map name="ftl_8c_a358979ad49087b2f21ead4eb9a153f14_icgraph" id="ftl_8c_a358979ad49087b2f21ead4eb9a153f14_icgraph">
<area shape="rect" title=" " alt="" coords="1019,5,1144,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="afd1c030b3a24f516a3eda967bb936f8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd1c030b3a24f516a3eda967bb936f8d">&#9670;&nbsp;</a></span>ssd_init_nand_blk()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ssd_init_nand_blk </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnand__block.html">nand_block</a> *&#160;</td>
          <td class="paramname"><em>blk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structssdparams.html">ssdparams</a> *&#160;</td>
          <td class="paramname"><em>spp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;{</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    blk-&gt;<a class="code" href="structnand__block.html#afd82eb2e8b19ec2dd70b0bfa3e602776">npgs</a> = spp-&gt;<a class="code" href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">pgs_per_blk</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    blk-&gt;<a class="code" href="structnand__block.html#a8670e24bc47c15366be8fe4c238a2922">pg</a> = g_malloc0(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structnand__page.html">nand_page</a>) * blk-&gt;<a class="code" href="structnand__block.html#afd82eb2e8b19ec2dd70b0bfa3e602776">npgs</a>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; blk-&gt;<a class="code" href="structnand__block.html#afd82eb2e8b19ec2dd70b0bfa3e602776">npgs</a>; i++) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <a class="code" href="ftl_8c.html#aa17bd85978e80a1bb61285f026f7a427">ssd_init_nand_page</a>(&amp;blk-&gt;<a class="code" href="structnand__block.html#a8670e24bc47c15366be8fe4c238a2922">pg</a>[i], spp);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    blk-&gt;<a class="code" href="structnand__block.html#a0c979863e9e1648cbf3a129bcd92820b">ipc</a> = 0;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    blk-&gt;<a class="code" href="structnand__block.html#a89ec2fe3aff210edec30210b24dd2039">vpc</a> = 0;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    blk-&gt;<a class="code" href="structnand__block.html#a8629bef6da40ace33902c884d6b0127c">erase_cnt</a> = 0;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    blk-&gt;<a class="code" href="structnand__block.html#a424007f74aa840dea80296224af39d8d">wp</a> = 0;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_afd1c030b3a24f516a3eda967bb936f8d_cgraph.png" border="0" usemap="#ftl_8c_afd1c030b3a24f516a3eda967bb936f8d_cgraph" alt=""/></div>
<map name="ftl_8c_afd1c030b3a24f516a3eda967bb936f8d_cgraph" id="ftl_8c_afd1c030b3a24f516a3eda967bb936f8d_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,144,32"/>
<area shape="rect" href="ftl_8c.html#aa17bd85978e80a1bb61285f026f7a427" title=" " alt="" coords="192,5,343,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_afd1c030b3a24f516a3eda967bb936f8d_icgraph.png" border="0" usemap="#ftl_8c_afd1c030b3a24f516a3eda967bb936f8d_icgraph" alt=""/></div>
<map name="ftl_8c_afd1c030b3a24f516a3eda967bb936f8d_icgraph" id="ftl_8c_afd1c030b3a24f516a3eda967bb936f8d_icgraph">
<area shape="rect" title=" " alt="" coords="1551,5,1689,32"/>
<area shape="rect" href="ftl_8c.html#ac6428955c80a1fb3371e13b2b2f4ea26" title=" " alt="" coords="1348,5,1503,32"/>
<area shape="rect" href="ftl_8c.html#ae77b0af37a85b3285ff26402ca7d03a5" title=" " alt="" coords="1161,5,1300,32"/>
<area shape="rect" href="ftl_8c.html#aa4643e6bbe68de1c047ec1d1745a82e3" title=" " alt="" coords="1019,5,1113,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ae77b0af37a85b3285ff26402ca7d03a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae77b0af37a85b3285ff26402ca7d03a5">&#9670;&nbsp;</a></span>ssd_init_nand_lun()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ssd_init_nand_lun </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnand__lun.html">nand_lun</a> *&#160;</td>
          <td class="paramname"><em>lun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structssdparams.html">ssdparams</a> *&#160;</td>
          <td class="paramname"><em>spp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;{</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    lun-&gt;<a class="code" href="structnand__lun.html#a8f95b70bcd5720c7b081af37dbd3fc70">npls</a> = spp-&gt;<a class="code" href="structssdparams.html#a102161652bd1f9143443bb42c583005d">pls_per_lun</a>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    lun-&gt;<a class="code" href="structnand__lun.html#ae64d00bf7f1ed056065e1a6c91898473">pl</a> = g_malloc0(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structnand__plane.html">nand_plane</a>) * lun-&gt;<a class="code" href="structnand__lun.html#a8f95b70bcd5720c7b081af37dbd3fc70">npls</a>);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; lun-&gt;<a class="code" href="structnand__lun.html#a8f95b70bcd5720c7b081af37dbd3fc70">npls</a>; i++) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="ftl_8c.html#ac6428955c80a1fb3371e13b2b2f4ea26">ssd_init_nand_plane</a>(&amp;lun-&gt;<a class="code" href="structnand__lun.html#ae64d00bf7f1ed056065e1a6c91898473">pl</a>[i], spp);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    lun-&gt;<a class="code" href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">next_lun_avail_time</a> = 0;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    lun-&gt;<a class="code" href="structnand__lun.html#acf81a9df9b43a75795a3f16b6dc52038">busy</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_ae77b0af37a85b3285ff26402ca7d03a5_cgraph.png" border="0" usemap="#ftl_8c_ae77b0af37a85b3285ff26402ca7d03a5_cgraph" alt=""/></div>
<map name="ftl_8c_ae77b0af37a85b3285ff26402ca7d03a5_cgraph" id="ftl_8c_ae77b0af37a85b3285ff26402ca7d03a5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,144,32"/>
<area shape="rect" href="ftl_8c.html#ac6428955c80a1fb3371e13b2b2f4ea26" title=" " alt="" coords="192,5,347,32"/>
<area shape="rect" href="ftl_8c.html#afd1c030b3a24f516a3eda967bb936f8d" title=" " alt="" coords="395,5,533,32"/>
<area shape="rect" href="ftl_8c.html#aa17bd85978e80a1bb61285f026f7a427" title=" " alt="" coords="581,5,732,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_ae77b0af37a85b3285ff26402ca7d03a5_icgraph.png" border="0" usemap="#ftl_8c_ae77b0af37a85b3285ff26402ca7d03a5_icgraph" alt=""/></div>
<map name="ftl_8c_ae77b0af37a85b3285ff26402ca7d03a5_icgraph" id="ftl_8c_ae77b0af37a85b3285ff26402ca7d03a5_icgraph">
<area shape="rect" title=" " alt="" coords="1161,5,1300,32"/>
<area shape="rect" href="ftl_8c.html#aa4643e6bbe68de1c047ec1d1745a82e3" title=" " alt="" coords="1019,5,1113,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="aa17bd85978e80a1bb61285f026f7a427"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa17bd85978e80a1bb61285f026f7a427">&#9670;&nbsp;</a></span>ssd_init_nand_page()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ssd_init_nand_page </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnand__page.html">nand_page</a> *&#160;</td>
          <td class="paramname"><em>pg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structssdparams.html">ssdparams</a> *&#160;</td>
          <td class="paramname"><em>spp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;{</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    pg-&gt;<a class="code" href="structnand__page.html#a07a35cddc22d7c84ced03c17b23ed244">nsecs</a> = spp-&gt;<a class="code" href="structssdparams.html#a93143586362c365e97e39c4b544807ca">secs_per_pg</a>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    pg-&gt;<a class="code" href="structnand__page.html#adc5fd9020df058246b2789b00f7f6609">sec</a> = g_malloc0(<span class="keyword">sizeof</span>(<a class="code" href="ftl_8h.html#af7812108ff2c661fde06cf328637f96c">nand_sec_status_t</a>) * pg-&gt;<a class="code" href="structnand__page.html#a07a35cddc22d7c84ced03c17b23ed244">nsecs</a>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pg-&gt;<a class="code" href="structnand__page.html#a07a35cddc22d7c84ced03c17b23ed244">nsecs</a>; i++) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        pg-&gt;<a class="code" href="structnand__page.html#adc5fd9020df058246b2789b00f7f6609">sec</a>[i] = <a class="code" href="ftl_8h.html#a99fb83031ce9923c84392b4e92f956b5a9c9278e0defed03ac007a9d18a097b10">SEC_FREE</a>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    pg-&gt;<a class="code" href="structnand__page.html#ac238873d503e6fd6530f43b784019dfc">status</a> = <a class="code" href="ftl_8h.html#a99fb83031ce9923c84392b4e92f956b5a0d5f318c3fc765bc802353b6cc599214">PG_FREE</a>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_aa17bd85978e80a1bb61285f026f7a427_icgraph.png" border="0" usemap="#ftl_8c_aa17bd85978e80a1bb61285f026f7a427_icgraph" alt=""/></div>
<map name="ftl_8c_aa17bd85978e80a1bb61285f026f7a427_icgraph" id="ftl_8c_aa17bd85978e80a1bb61285f026f7a427_icgraph">
<area shape="rect" title=" " alt="" coords="1737,5,1888,32"/>
<area shape="rect" href="ftl_8c.html#afd1c030b3a24f516a3eda967bb936f8d" title=" " alt="" coords="1551,5,1689,32"/>
<area shape="rect" href="ftl_8c.html#ac6428955c80a1fb3371e13b2b2f4ea26" title=" " alt="" coords="1348,5,1503,32"/>
<area shape="rect" href="ftl_8c.html#ae77b0af37a85b3285ff26402ca7d03a5" title=" " alt="" coords="1161,5,1300,32"/>
<area shape="rect" href="ftl_8c.html#aa4643e6bbe68de1c047ec1d1745a82e3" title=" " alt="" coords="1019,5,1113,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ac6428955c80a1fb3371e13b2b2f4ea26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6428955c80a1fb3371e13b2b2f4ea26">&#9670;&nbsp;</a></span>ssd_init_nand_plane()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ssd_init_nand_plane </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structnand__plane.html">nand_plane</a> *&#160;</td>
          <td class="paramname"><em>pl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structssdparams.html">ssdparams</a> *&#160;</td>
          <td class="paramname"><em>spp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;{</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    pl-&gt;<a class="code" href="structnand__plane.html#a69781959f7bed3aca9a31a7d2560866a">nblks</a> = spp-&gt;<a class="code" href="structssdparams.html#aaafec0385f6c9c34b05be63526644c5a">blks_per_pl</a>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    pl-&gt;<a class="code" href="structnand__plane.html#a178c78d74aad32ee73f5101bbe5d3af0">blk</a> = g_malloc0(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structnand__block.html">nand_block</a>) * pl-&gt;<a class="code" href="structnand__plane.html#a69781959f7bed3aca9a31a7d2560866a">nblks</a>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pl-&gt;<a class="code" href="structnand__plane.html#a69781959f7bed3aca9a31a7d2560866a">nblks</a>; i++) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <a class="code" href="ftl_8c.html#afd1c030b3a24f516a3eda967bb936f8d">ssd_init_nand_blk</a>(&amp;pl-&gt;<a class="code" href="structnand__plane.html#a178c78d74aad32ee73f5101bbe5d3af0">blk</a>[i], spp);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_ac6428955c80a1fb3371e13b2b2f4ea26_cgraph.png" border="0" usemap="#ftl_8c_ac6428955c80a1fb3371e13b2b2f4ea26_cgraph" alt=""/></div>
<map name="ftl_8c_ac6428955c80a1fb3371e13b2b2f4ea26_cgraph" id="ftl_8c_ac6428955c80a1fb3371e13b2b2f4ea26_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,160,32"/>
<area shape="rect" href="ftl_8c.html#afd1c030b3a24f516a3eda967bb936f8d" title=" " alt="" coords="208,5,347,32"/>
<area shape="rect" href="ftl_8c.html#aa17bd85978e80a1bb61285f026f7a427" title=" " alt="" coords="395,5,545,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_ac6428955c80a1fb3371e13b2b2f4ea26_icgraph.png" border="0" usemap="#ftl_8c_ac6428955c80a1fb3371e13b2b2f4ea26_icgraph" alt=""/></div>
<map name="ftl_8c_ac6428955c80a1fb3371e13b2b2f4ea26_icgraph" id="ftl_8c_ac6428955c80a1fb3371e13b2b2f4ea26_icgraph">
<area shape="rect" title=" " alt="" coords="1348,5,1503,32"/>
<area shape="rect" href="ftl_8c.html#ae77b0af37a85b3285ff26402ca7d03a5" title=" " alt="" coords="1161,5,1300,32"/>
<area shape="rect" href="ftl_8c.html#aa4643e6bbe68de1c047ec1d1745a82e3" title=" " alt="" coords="1019,5,1113,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a96c1b582459f3ccfc0643bac1a8cdf35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96c1b582459f3ccfc0643bac1a8cdf35">&#9670;&nbsp;</a></span>ssd_init_params()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ssd_init_params </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssdparams.html">ssdparams</a> *&#160;</td>
          <td class="paramname"><em>spp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;{</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a0eb0310790389b75f28a5b6dc272a2dc">secsz</a> = 512;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a93143586362c365e97e39c4b544807ca">secs_per_pg</a> = 8;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">pgs_per_blk</a> = 256;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#aaafec0385f6c9c34b05be63526644c5a">blks_per_pl</a> = 256; <span class="comment">/* 16GB */</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a102161652bd1f9143443bb42c583005d">pls_per_lun</a> = 1;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#ad339ca6a9e013ff5d28d408f7e2ad705">luns_per_ch</a> = 8;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a17a649068b0acfe64a1afc67b51236fb">nchs</a> = 8;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#ab8b7f48bd8cae23a4da6dcc8ceeb05ab">pg_rd_lat</a> = <a class="code" href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba159b99876b55d2052590c66614f18e06">NAND_READ_LATENCY</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a584a92a1768fad79586d746562db0ced">pg_wr_lat</a> = <a class="code" href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba473c2d5e1315210c6973d46d1a06d895">NAND_PROG_LATENCY</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a6865de86ba20967f6ef156beeca0d62a">blk_er_lat</a> = <a class="code" href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba961b37b2f319961303251f5ef3d2e93f">NAND_ERASE_LATENCY</a>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#aebc159516f73021767eb96c276f64d08">ch_xfer_lat</a> = 0;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">/* calculated values */</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a957528e972891b69b89040996b061527">secs_per_blk</a> = spp-&gt;<a class="code" href="structssdparams.html#a93143586362c365e97e39c4b544807ca">secs_per_pg</a> * spp-&gt;<a class="code" href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">pgs_per_blk</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#ac1f4590960563c5d35826fae5062ab3c">secs_per_pl</a> = spp-&gt;<a class="code" href="structssdparams.html#a957528e972891b69b89040996b061527">secs_per_blk</a> * spp-&gt;<a class="code" href="structssdparams.html#aaafec0385f6c9c34b05be63526644c5a">blks_per_pl</a>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#ac3f5ee9f571fe392380d5b0e16bab09b">secs_per_lun</a> = spp-&gt;<a class="code" href="structssdparams.html#ac1f4590960563c5d35826fae5062ab3c">secs_per_pl</a> * spp-&gt;<a class="code" href="structssdparams.html#a102161652bd1f9143443bb42c583005d">pls_per_lun</a>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a7ff91681af50eb844c9c5e80d0081e56">secs_per_ch</a> = spp-&gt;<a class="code" href="structssdparams.html#ac3f5ee9f571fe392380d5b0e16bab09b">secs_per_lun</a> * spp-&gt;<a class="code" href="structssdparams.html#ad339ca6a9e013ff5d28d408f7e2ad705">luns_per_ch</a>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#ad1cdb78c795ddac6af6b213977a97719">tt_secs</a> = spp-&gt;<a class="code" href="structssdparams.html#a7ff91681af50eb844c9c5e80d0081e56">secs_per_ch</a> * spp-&gt;<a class="code" href="structssdparams.html#a17a649068b0acfe64a1afc67b51236fb">nchs</a>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#abd6475e516ca9a5b1250d32c52853951">pgs_per_pl</a> = spp-&gt;<a class="code" href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">pgs_per_blk</a> * spp-&gt;<a class="code" href="structssdparams.html#aaafec0385f6c9c34b05be63526644c5a">blks_per_pl</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a0a856000ec8d7d076eef4db2f1c4d87e">pgs_per_lun</a> = spp-&gt;<a class="code" href="structssdparams.html#abd6475e516ca9a5b1250d32c52853951">pgs_per_pl</a> * spp-&gt;<a class="code" href="structssdparams.html#a102161652bd1f9143443bb42c583005d">pls_per_lun</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a618e42c61c1487fbe274ecc9d8b47e26">pgs_per_ch</a> = spp-&gt;<a class="code" href="structssdparams.html#a0a856000ec8d7d076eef4db2f1c4d87e">pgs_per_lun</a> * spp-&gt;<a class="code" href="structssdparams.html#ad339ca6a9e013ff5d28d408f7e2ad705">luns_per_ch</a>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a853908a359571730e9f08e808eec2281">tt_pgs</a> = spp-&gt;<a class="code" href="structssdparams.html#a618e42c61c1487fbe274ecc9d8b47e26">pgs_per_ch</a> * spp-&gt;<a class="code" href="structssdparams.html#a17a649068b0acfe64a1afc67b51236fb">nchs</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a17c866b5ab21200fe863c05201d70144">blks_per_lun</a> = spp-&gt;<a class="code" href="structssdparams.html#aaafec0385f6c9c34b05be63526644c5a">blks_per_pl</a> * spp-&gt;<a class="code" href="structssdparams.html#a102161652bd1f9143443bb42c583005d">pls_per_lun</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a46af9099347b346ed63fd642df5a2262">blks_per_ch</a> = spp-&gt;<a class="code" href="structssdparams.html#a17c866b5ab21200fe863c05201d70144">blks_per_lun</a> * spp-&gt;<a class="code" href="structssdparams.html#ad339ca6a9e013ff5d28d408f7e2ad705">luns_per_ch</a>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a7cd0ad9e577e097738e4bcd6882de2e0">tt_blks</a> = spp-&gt;<a class="code" href="structssdparams.html#a46af9099347b346ed63fd642df5a2262">blks_per_ch</a> * spp-&gt;<a class="code" href="structssdparams.html#a17a649068b0acfe64a1afc67b51236fb">nchs</a>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a5d77d505334c2cc261b44b7c83630424">pls_per_ch</a> =  spp-&gt;<a class="code" href="structssdparams.html#a102161652bd1f9143443bb42c583005d">pls_per_lun</a> * spp-&gt;<a class="code" href="structssdparams.html#ad339ca6a9e013ff5d28d408f7e2ad705">luns_per_ch</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#afef7c89eaa29554e7dca4814136c5756">tt_pls</a> = spp-&gt;<a class="code" href="structssdparams.html#a5d77d505334c2cc261b44b7c83630424">pls_per_ch</a> * spp-&gt;<a class="code" href="structssdparams.html#a17a649068b0acfe64a1afc67b51236fb">nchs</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a8ec920f02aa51d4158e7946e81732645">tt_luns</a> = spp-&gt;<a class="code" href="structssdparams.html#ad339ca6a9e013ff5d28d408f7e2ad705">luns_per_ch</a> * spp-&gt;<a class="code" href="structssdparams.html#a17a649068b0acfe64a1afc67b51236fb">nchs</a>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">/* line is special, put it at the end */</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a82ef103d290bc47db0a2ee5a309b943c">blks_per_line</a> = spp-&gt;<a class="code" href="structssdparams.html#a8ec920f02aa51d4158e7946e81732645">tt_luns</a>; <span class="comment">/* TODO: to fix under multiplanes */</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a09e04352d7b5b2e8f9bb011a37204e3c">pgs_per_line</a> = spp-&gt;<a class="code" href="structssdparams.html#a82ef103d290bc47db0a2ee5a309b943c">blks_per_line</a> * spp-&gt;<a class="code" href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">pgs_per_blk</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a8e1e0e577c9c04b4c10d3d25cbf6957b">secs_per_line</a> = spp-&gt;<a class="code" href="structssdparams.html#a09e04352d7b5b2e8f9bb011a37204e3c">pgs_per_line</a> * spp-&gt;<a class="code" href="structssdparams.html#a93143586362c365e97e39c4b544807ca">secs_per_pg</a>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#acd04d8260ca1b86005ccc56307105b23">tt_lines</a> = spp-&gt;<a class="code" href="structssdparams.html#a17c866b5ab21200fe863c05201d70144">blks_per_lun</a>; <span class="comment">/* TODO: to fix under multiplanes */</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a3f75f55bbbf319375cc45dcf2daaaca4">gc_thres_pcent</a> = 0.75;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a1bccb207bbd6aeca6c7b5fef5d530f6d">gc_thres_lines</a> = (int)((1 - spp-&gt;<a class="code" href="structssdparams.html#a3f75f55bbbf319375cc45dcf2daaaca4">gc_thres_pcent</a>) * spp-&gt;<a class="code" href="structssdparams.html#acd04d8260ca1b86005ccc56307105b23">tt_lines</a>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#a78f1013c9a83c3074ef83cd8782f84dd">gc_thres_pcent_high</a> = 0.95;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#ad72919d3040d8ba48758f0e276aea4ad">gc_thres_lines_high</a> = (int)((1 - spp-&gt;<a class="code" href="structssdparams.html#a78f1013c9a83c3074ef83cd8782f84dd">gc_thres_pcent_high</a>) * spp-&gt;<a class="code" href="structssdparams.html#acd04d8260ca1b86005ccc56307105b23">tt_lines</a>);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    spp-&gt;<a class="code" href="structssdparams.html#ab072044ad8c0107835464ba876b618f2">enable_gc_delay</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="ftl_8c.html#aa555ec9dcfe762eb6c39afa3cb167e3d">check_params</a>(spp);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a96c1b582459f3ccfc0643bac1a8cdf35_cgraph.png" border="0" usemap="#ftl_8c_a96c1b582459f3ccfc0643bac1a8cdf35_cgraph" alt=""/></div>
<map name="ftl_8c_a96c1b582459f3ccfc0643bac1a8cdf35_cgraph" id="ftl_8c_a96c1b582459f3ccfc0643bac1a8cdf35_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,133,32"/>
<area shape="rect" href="ftl_8c.html#aa555ec9dcfe762eb6c39afa3cb167e3d" title=" " alt="" coords="181,5,297,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a96c1b582459f3ccfc0643bac1a8cdf35_icgraph.png" border="0" usemap="#ftl_8c_a96c1b582459f3ccfc0643bac1a8cdf35_icgraph" alt=""/></div>
<map name="ftl_8c_a96c1b582459f3ccfc0643bac1a8cdf35_icgraph" id="ftl_8c_a96c1b582459f3ccfc0643bac1a8cdf35_icgraph">
<area shape="rect" title=" " alt="" coords="1019,5,1147,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ae19a0a686346f1ffbfa9e73035efbaad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae19a0a686346f1ffbfa9e73035efbaad">&#9670;&nbsp;</a></span>ssd_init_rmap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ssd_init_rmap </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;{</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssdparams.html">ssdparams</a> *spp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#ae49bd8bfc26a6a8f1a992d84e0cc862c">rmap</a> = g_malloc0(<span class="keyword">sizeof</span>(uint64_t) * spp-&gt;<a class="code" href="structssdparams.html#a853908a359571730e9f08e808eec2281">tt_pgs</a>);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; spp-&gt;<a class="code" href="structssdparams.html#a853908a359571730e9f08e808eec2281">tt_pgs</a>; i++) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#ae49bd8bfc26a6a8f1a992d84e0cc862c">rmap</a>[i] = <a class="code" href="ftl_8h.html#a1ff9f42f3e3d46b878b713654eab99b7">INVALID_LPN</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_ae19a0a686346f1ffbfa9e73035efbaad_icgraph.png" border="0" usemap="#ftl_8c_ae19a0a686346f1ffbfa9e73035efbaad_icgraph" alt=""/></div>
<map name="ftl_8c_ae19a0a686346f1ffbfa9e73035efbaad_icgraph" id="ftl_8c_ae19a0a686346f1ffbfa9e73035efbaad_icgraph">
<area shape="rect" title=" " alt="" coords="1019,5,1132,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a37afec234fedd2c392569d5ce0af6cb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37afec234fedd2c392569d5ce0af6cb4">&#9670;&nbsp;</a></span>ssd_init_write_pointer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ssd_init_write_pointer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;{</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keyword">struct </span><a class="code" href="structwrite__pointer.html">write_pointer</a> *wpp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a8ce888a31348d5b2fa1d914dde456166">wp</a>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keyword">struct </span><a class="code" href="structline__mgmt.html">line_mgmt</a> *lm = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a58bcbabc96ec3acaa19fac4ecf7956dc">lm</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">struct </span><a class="code" href="structline.html">line</a> *curline = NULL;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    curline = QTAILQ_FIRST(&amp;lm-&gt;free_line_list);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    QTAILQ_REMOVE(&amp;lm-&gt;free_line_list, curline, entry);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    lm-&gt;<a class="code" href="structline__mgmt.html#ab3da4f318464b294f5ad5179a0aa7b24">free_line_cnt</a>--;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">/* wpp-&gt;curline is always our next-to-write super-block */</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    wpp-&gt;<a class="code" href="structwrite__pointer.html#ac533d4150e459ae66a36a1407d74cddc">curline</a> = curline;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    wpp-&gt;<a class="code" href="structwrite__pointer.html#adf3acc53d295719babbd39458dddaa66">ch</a> = 0;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    wpp-&gt;<a class="code" href="structwrite__pointer.html#aac27e9340ffc7900b39c57731fa61dc0">lun</a> = 0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    wpp-&gt;<a class="code" href="structwrite__pointer.html#acbaa6937b756b9cbf3f457973f98b12a">pg</a> = 0;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    wpp-&gt;<a class="code" href="structwrite__pointer.html#a854272876a0fbd867842d16a3620a827">blk</a> = 0;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    wpp-&gt;<a class="code" href="structwrite__pointer.html#a685331c5878278ccaf80c3672ce73f7c">pl</a> = 0;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a37afec234fedd2c392569d5ce0af6cb4_icgraph.png" border="0" usemap="#ftl_8c_a37afec234fedd2c392569d5ce0af6cb4_icgraph" alt=""/></div>
<map name="ftl_8c_a37afec234fedd2c392569d5ce0af6cb4_icgraph" id="ftl_8c_a37afec234fedd2c392569d5ce0af6cb4_icgraph">
<area shape="rect" title=" " alt="" coords="1019,5,1184,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a306780893a49a72da761566ca918b35e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a306780893a49a72da761566ca918b35e">&#9670;&nbsp;</a></span>ssd_read()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint64_t ssd_read </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;{</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssdparams.html">ssdparams</a> *spp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    uint64_t <a class="code" href="oc12_8h.html#aafa9f203f0abc59a4b08b3833f39b92c">lba</a> = req-&gt;<a class="code" href="structNvmeRequest.html#a35d73ae4b2cd7c17e55d20320ac2b1ea">slba</a>;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordtype">int</span> nsecs = req-&gt;<a class="code" href="structNvmeRequest.html#ab9efcb9c4901c697b16f583893abef3a">nlb</a>;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="keyword">struct </span><a class="code" href="structppa.html">ppa</a> <a class="code" href="structppa.html">ppa</a>;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    uint64_t start_lpn = <a class="code" href="oc12_8h.html#aafa9f203f0abc59a4b08b3833f39b92c">lba</a> / spp-&gt;<a class="code" href="structssdparams.html#a93143586362c365e97e39c4b544807ca">secs_per_pg</a>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    uint64_t end_lpn = (<a class="code" href="oc12_8h.html#aafa9f203f0abc59a4b08b3833f39b92c">lba</a> + nsecs - 1) / spp-&gt;<a class="code" href="structssdparams.html#a93143586362c365e97e39c4b544807ca">secs_per_pg</a>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    uint64_t lpn;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    uint64_t sublat, maxlat = 0;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    if (end_lpn &gt;= spp-&gt;<a class="code" href="structssdparams.html#a853908a359571730e9f08e808eec2281">tt_pgs</a>) {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <a class="code" href="ftl_8h.html#ae78ff7bb5a99b8a8ac5fc3c82e0ca403">ftl_err</a>(<span class="stringliteral">&quot;start_lpn=%&quot;</span>PRIu64<span class="stringliteral">&quot;,tt_pgs=%d\n&quot;</span>, start_lpn, <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>.<a class="code" href="structssdparams.html#a853908a359571730e9f08e808eec2281">tt_pgs</a>);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="comment">/* normal IO read path */</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">for</span> (lpn = start_lpn; lpn &lt;= end_lpn; lpn++) {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <a class="code" href="structppa.html">ppa</a> = <a class="code" href="ftl_8c.html#af93eee663d18640559cfd06afdeb5409">get_maptbl_ent</a>(<a class="code" href="structssd.html">ssd</a>, lpn);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="ftl_8c.html#a6e8a2a542e569fe2662cbb8cf647590b">mapped_ppa</a>(&amp;<a class="code" href="structppa.html">ppa</a>) || !<a class="code" href="ftl_8c.html#a4237c1400d2e5e24f32b77e347163ab9">valid_ppa</a>(<a class="code" href="structssd.html">ssd</a>, &amp;<a class="code" href="structppa.html">ppa</a>)) {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            <span class="comment">//printf(&quot;%s,lpn(%&quot; PRId64 &quot;) not mapped to valid ppa\n&quot;, ssd-&gt;ssdname, lpn);</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            <span class="comment">//printf(&quot;Invalid ppa,ch:%d,lun:%d,blk:%d,pl:%d,pg:%d,sec:%d\n&quot;,</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <span class="comment">//ppa.g.ch, ppa.g.lun, ppa.g.blk, ppa.g.pl, ppa.g.pg, ppa.g.sec);</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        }</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="keyword">struct </span><a class="code" href="structnand__cmd.html">nand_cmd</a> srd;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        srd.<a class="code" href="structnand__cmd.html#a364c052be48202ede06e883e4b120409">type</a> = <a class="code" href="ftl_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a2dbf63358e7e23749bc4332d41ec31af">USER_IO</a>;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        srd.cmd = <a class="code" href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba064c38a00639099031cda82711a5ac5d">NAND_READ</a>;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        srd.stime = req-&gt;<a class="code" href="structNvmeRequest.html#ad267c178ee13ebb285604043925b5e78">stime</a>;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        sublat = <a class="code" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8">ssd_advance_status</a>(<a class="code" href="structssd.html">ssd</a>, &amp;<a class="code" href="structppa.html">ppa</a>, &amp;srd);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        maxlat = (sublat &gt; maxlat) ? sublat : maxlat;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">return</span> maxlat;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a306780893a49a72da761566ca918b35e_cgraph.png" border="0" usemap="#ftl_8c_a306780893a49a72da761566ca918b35e_cgraph" alt=""/></div>
<map name="ftl_8c_a306780893a49a72da761566ca918b35e_cgraph" id="ftl_8c_a306780893a49a72da761566ca918b35e_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,85,108"/>
<area shape="rect" href="ftl_8c.html#af93eee663d18640559cfd06afdeb5409" title=" " alt="" coords="148,5,272,32"/>
<area shape="rect" href="ftl_8c.html#a6e8a2a542e569fe2662cbb8cf647590b" title=" " alt="" coords="157,56,263,83"/>
<area shape="rect" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8" title=" " alt="" coords="133,107,287,133"/>
<area shape="rect" href="ftl_8c.html#a4237c1400d2e5e24f32b77e347163ab9" title=" " alt="" coords="167,157,253,184"/>
<area shape="rect" href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8" title=" " alt="" coords="335,56,413,83"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="339,107,409,133"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="461,107,527,133"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a306780893a49a72da761566ca918b35e_icgraph.png" border="0" usemap="#ftl_8c_a306780893a49a72da761566ca918b35e_icgraph" alt=""/></div>
<map name="ftl_8c_a306780893a49a72da761566ca918b35e_icgraph" id="ftl_8c_a306780893a49a72da761566ca918b35e_icgraph">
<area shape="rect" title=" " alt="" coords="1151,5,1231,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a8610a939b22b60851e3b88e0137b7ede"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8610a939b22b60851e3b88e0137b7ede">&#9670;&nbsp;</a></span>ssd_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint64_t ssd_write </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;{</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    uint64_t <a class="code" href="oc12_8h.html#aafa9f203f0abc59a4b08b3833f39b92c">lba</a> = req-&gt;<a class="code" href="structNvmeRequest.html#a35d73ae4b2cd7c17e55d20320ac2b1ea">slba</a>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssdparams.html">ssdparams</a> *spp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordtype">int</span> len = req-&gt;<a class="code" href="structNvmeRequest.html#ab9efcb9c4901c697b16f583893abef3a">nlb</a>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    uint64_t start_lpn = <a class="code" href="oc12_8h.html#aafa9f203f0abc59a4b08b3833f39b92c">lba</a> / spp-&gt;<a class="code" href="structssdparams.html#a93143586362c365e97e39c4b544807ca">secs_per_pg</a>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    uint64_t end_lpn = (<a class="code" href="oc12_8h.html#aafa9f203f0abc59a4b08b3833f39b92c">lba</a> + len - 1) / spp-&gt;<a class="code" href="structssdparams.html#a93143586362c365e97e39c4b544807ca">secs_per_pg</a>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="keyword">struct</span> <a class="code" href="structppa.html">ppa</a> <a class="code" href="structppa.html">ppa</a>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    uint64_t lpn;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    uint64_t curlat = 0, maxlat = 0;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordtype">int</span> r;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    if (end_lpn &gt;= spp-&gt;<a class="code" href="structssdparams.html#a853908a359571730e9f08e808eec2281">tt_pgs</a>) {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <a class="code" href="ftl_8h.html#ae78ff7bb5a99b8a8ac5fc3c82e0ca403">ftl_err</a>(<span class="stringliteral">&quot;start_lpn=%&quot;</span>PRIu64<span class="stringliteral">&quot;,tt_pgs=%d\n&quot;</span>, start_lpn, <a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>.<a class="code" href="structssdparams.html#a853908a359571730e9f08e808eec2281">tt_pgs</a>);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="ftl_8c.html#a4494881726f0faee876d503fa1f2e312">should_gc_high</a>(<a class="code" href="structssd.html">ssd</a>)) {</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <span class="comment">/* perform GC here until !should_gc(ssd) */</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        r = <a class="code" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad">do_gc</a>(<a class="code" href="structssd.html">ssd</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="keywordflow">if</span> (r == -1)</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">for</span> (lpn = start_lpn; lpn &lt;= end_lpn; lpn++) {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <a class="code" href="structppa.html">ppa</a> = <a class="code" href="ftl_8c.html#af93eee663d18640559cfd06afdeb5409">get_maptbl_ent</a>(<a class="code" href="structssd.html">ssd</a>, lpn);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ftl_8c.html#a6e8a2a542e569fe2662cbb8cf647590b">mapped_ppa</a>(&amp;<a class="code" href="structppa.html">ppa</a>)) {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="comment">/* update old page information first */</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <a class="code" href="ftl_8c.html#adaaf0f3e032de3124ddc61a6111b25db">mark_page_invalid</a>(<a class="code" href="structssd.html">ssd</a>, &amp;<a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <a class="code" href="ftl_8c.html#aac3ae48a56045829a6e2f1bf933b1d5b">set_rmap_ent</a>(<a class="code" href="structssd.html">ssd</a>, <a class="code" href="ftl_8h.html#a1ff9f42f3e3d46b878b713654eab99b7">INVALID_LPN</a>, &amp;<a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        }</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="comment">/* new write */</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <a class="code" href="structppa.html">ppa</a> = <a class="code" href="ftl_8c.html#a2db76f519a8218ea9cda35e61552a4ec">get_new_page</a>(<a class="code" href="structssd.html">ssd</a>);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="comment">/* update maptbl */</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <a class="code" href="ftl_8c.html#ab02c4873ff387abfd6f268ae711fd0b5">set_maptbl_ent</a>(<a class="code" href="structssd.html">ssd</a>, lpn, &amp;<a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="comment">/* update rmap */</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <a class="code" href="ftl_8c.html#aac3ae48a56045829a6e2f1bf933b1d5b">set_rmap_ent</a>(<a class="code" href="structssd.html">ssd</a>, lpn, &amp;<a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <a class="code" href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b">mark_page_valid</a>(<a class="code" href="structssd.html">ssd</a>, &amp;<a class="code" href="structppa.html">ppa</a>);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="comment">/* need to advance the write pointer here */</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <a class="code" href="ftl_8c.html#a52df9249316530eb887e0412ca51f048">ssd_advance_write_pointer</a>(<a class="code" href="structssd.html">ssd</a>);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="keyword">struct </span><a class="code" href="structnand__cmd.html">nand_cmd</a> swr;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        swr.<a class="code" href="structnand__cmd.html#a364c052be48202ede06e883e4b120409">type</a> = <a class="code" href="ftl_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a2dbf63358e7e23749bc4332d41ec31af">USER_IO</a>;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        swr.cmd = <a class="code" href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba9eb21f1680871f4d099414752c40a2e4">NAND_WRITE</a>;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        swr.stime = req-&gt;<a class="code" href="structNvmeRequest.html#ad267c178ee13ebb285604043925b5e78">stime</a>;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="comment">/* get latency statistics */</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        curlat = <a class="code" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8">ssd_advance_status</a>(<a class="code" href="structssd.html">ssd</a>, &amp;<a class="code" href="structppa.html">ppa</a>, &amp;swr);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        maxlat = (curlat &gt; maxlat) ? curlat : maxlat;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160; </div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">return</span> maxlat;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a8610a939b22b60851e3b88e0137b7ede_cgraph.png" border="0" usemap="#ftl_8c_a8610a939b22b60851e3b88e0137b7ede_cgraph" alt=""/></div>
<map name="ftl_8c_a8610a939b22b60851e3b88e0137b7ede_cgraph" id="ftl_8c_a8610a939b22b60851e3b88e0137b7ede_cgraph">
<area shape="rect" title=" " alt="" coords="5,816,89,843"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="169,360,229,387"/>
<area shape="rect" href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8" title=" " alt="" coords="675,309,828,336"/>
<area shape="rect" href="ftl_8c.html#a2db76f519a8218ea9cda35e61552a4ec" title=" " alt="" coords="693,867,809,893"/>
<area shape="rect" href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b" title=" " alt="" coords="684,461,819,488"/>
<area shape="rect" href="ftl_8c.html#ab02c4873ff387abfd6f268ae711fd0b5" title=" " alt="" coords="690,917,813,944"/>
<area shape="rect" href="ftl_8c.html#aac3ae48a56045829a6e2f1bf933b1d5b" title=" " alt="" coords="696,563,807,589"/>
<area shape="rect" href="ftl_8c.html#a52df9249316530eb887e0412ca51f048" title=" " alt="" coords="652,1019,851,1045"/>
<area shape="rect" href="ftl_8c.html#af93eee663d18640559cfd06afdeb5409" title=" " alt="" coords="137,917,261,944"/>
<area shape="rect" href="ftl_8c.html#a6e8a2a542e569fe2662cbb8cf647590b" title=" " alt="" coords="493,968,599,995"/>
<area shape="rect" href="ftl_8c.html#adaaf0f3e032de3124ddc61a6111b25db" title=" " alt="" coords="678,183,825,209"/>
<area shape="rect" href="ftl_8c.html#a4494881726f0faee876d503fa1f2e312" title=" " alt="" coords="138,1069,261,1096"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="309,461,440,488"/>
<area shape="rect" href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d" title=" " alt="" coords="1429,715,1500,741"/>
<area shape="rect" href="ftl_8c.html#a5313a5ca429ce56095c0c1052c301c15" title=" " alt="" coords="309,360,440,387"/>
<area shape="rect" href="ftl_8c.html#a2c41ad05315023bfa77846568e4f7282" title=" " alt="" coords="315,259,435,285"/>
<area shape="rect" href="ftl_8c.html#ae5f2680b1c6531f6394723c150f11e1c" title=" " alt="" coords="681,56,821,83"/>
<area shape="rect" href="ftl_8c.html#a4b9026945c9fcc578ba0f7a7a84a1af1" title=" " alt="" coords="490,411,602,437"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="488,715,604,741"/>
<area shape="rect" href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82" title=" " alt="" coords="1153,436,1223,463"/>
<area shape="rect" href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66" title=" " alt="" coords="955,411,1021,437"/>
<area shape="rect" href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3" title=" " alt="" coords="1548,765,1613,792"/>
<area shape="rect" href="ftl_8c.html#a92e6cdd7677ef48c1830b6fbba09a28a" title=" " alt="" coords="695,613,807,640"/>
<area shape="rect" href="ftl_8c.html#a4a3067e8cef7d5c0e777cc82cf9c40c3" title=" " alt="" coords="711,664,792,691"/>
<area shape="rect" href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8" title=" " alt="" coords="949,917,1027,944"/>
<area shape="rect" href="ftl_8c.html#a3c2e22192ca991c459c54bead5b1ff98" title=" " alt="" coords="943,588,1033,615"/>
<area shape="rect" href="ftl_8c.html#a080e38a63b4626bd7cf314fcf74f2fb2" title=" " alt="" coords="951,208,1025,235"/>
<area shape="rect" href="ftl_8c.html#a8f0b10088699a4513219eafe0e2e4bc6" title=" " alt="" coords="1309,549,1371,576"/>
<area shape="rect" href="ftl_8c.html#a0b6eca1c9bf137587f4c3c7aed0ea914" title=" " alt="" coords="940,993,1036,1020"/>
<area shape="rect" href="ftl_8c.html#a659c0c25af9ae17e1771fc5bf7bca444" title=" " alt="" coords="917,1044,1059,1071"/>
<area shape="rect" href="pqueue_8h.html#addd8cdfbc8c47b8cdd7eb4c4560de7aa" title=" " alt="" coords="931,259,1045,285"/>
<area shape="rect" href="pqueue_8c.html#a918fcd7df850b9a0c17111abc9c323b1" title=" " alt="" coords="1143,157,1233,184"/>
<area shape="rect" href="pqueue_8h.html#a2919d3e817688b81da746d4123f51ba3" title=" " alt="" coords="933,56,1043,83"/>
<area shape="rect" href="pqueue_8h.html#abec9363c7a9cc89190bf0925a4a1652c" title=" " alt="" coords="937,5,1039,32"/>
<area shape="rect" href="pqueue_8c.html#a69ad19c161ae75369d1a444c83f4600c" title=" " alt="" coords="1125,56,1251,83"/>
<area shape="rect" href="pqueue_8c.html#a3e99f0cb15bfac6eeee46df9c875073a" title=" " alt="" coords="1299,56,1381,83"/>
<area shape="rect" href="pqueue_8h.html#a7dfaa607ca404b915355d4b123c669ee" title=" " alt="" coords="899,107,1077,133"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a8610a939b22b60851e3b88e0137b7ede_icgraph.png" border="0" usemap="#ftl_8c_a8610a939b22b60851e3b88e0137b7ede_icgraph" alt=""/></div>
<map name="ftl_8c_a8610a939b22b60851e3b88e0137b7ede_icgraph" id="ftl_8c_a8610a939b22b60851e3b88e0137b7ede_icgraph">
<area shape="rect" title=" " alt="" coords="1151,5,1235,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a4a3067e8cef7d5c0e777cc82cf9c40c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a3067e8cef7d5c0e777cc82cf9c40c3">&#9670;&nbsp;</a></span>valid_lpn()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool valid_lpn </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>lpn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;{</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">return</span> (lpn &lt; ssd-&gt;sp.tt_pgs);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a4a3067e8cef7d5c0e777cc82cf9c40c3_icgraph.png" border="0" usemap="#ftl_8c_a4a3067e8cef7d5c0e777cc82cf9c40c3_icgraph" alt=""/></div>
<map name="ftl_8c_a4a3067e8cef7d5c0e777cc82cf9c40c3_icgraph" id="ftl_8c_a4a3067e8cef7d5c0e777cc82cf9c40c3_icgraph">
<area shape="rect" title=" " alt="" coords="1733,5,1815,32"/>
<area shape="rect" href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048" title=" " alt="" coords="1569,5,1685,32"/>
<area shape="rect" href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf" title=" " alt="" coords="1391,5,1521,32"/>
<area shape="rect" href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad" title=" " alt="" coords="1283,5,1343,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede" title=" " alt="" coords="1151,31,1235,57"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a4237c1400d2e5e24f32b77e347163ab9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4237c1400d2e5e24f32b77e347163ab9">&#9670;&nbsp;</a></span>valid_ppa()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool valid_ppa </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structssd.html">ssd</a> *&#160;</td>
          <td class="paramname"><em>ssd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structppa.html">ppa</a> *&#160;</td>
          <td class="paramname"><em>ppa</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;{</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keyword">struct </span><a class="code" href="structssdparams.html">ssdparams</a> *spp = &amp;<a class="code" href="structssd.html">ssd</a>-&gt;<a class="code" href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">sp</a>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordtype">int</span> ch = <a class="code" href="structppa.html">ppa</a>-&gt;<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.ch;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordtype">int</span> lun = <a class="code" href="structppa.html">ppa</a>-&gt;<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.lun;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordtype">int</span> pl = <a class="code" href="structppa.html">ppa</a>-&gt;<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.pl;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordtype">int</span> blk = <a class="code" href="structppa.html">ppa</a>-&gt;<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.blk;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordtype">int</span> pg = <a class="code" href="structppa.html">ppa</a>-&gt;<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.pg;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordtype">int</span> sec = <a class="code" href="structppa.html">ppa</a>-&gt;<a class="code" href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">g</a>.sec;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">if</span> (ch &gt;= 0 &amp;&amp; ch &lt; spp-&gt;<a class="code" href="structssdparams.html#a17a649068b0acfe64a1afc67b51236fb">nchs</a> &amp;&amp; lun &gt;= 0 &amp;&amp; lun &lt; spp-&gt;<a class="code" href="structssdparams.html#ad339ca6a9e013ff5d28d408f7e2ad705">luns_per_ch</a> &amp;&amp; pl &gt;=</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        0 &amp;&amp; pl &lt; spp-&gt;<a class="code" href="structssdparams.html#a102161652bd1f9143443bb42c583005d">pls_per_lun</a> &amp;&amp; blk &gt;= 0 &amp;&amp; blk &lt; spp-&gt;<a class="code" href="structssdparams.html#aaafec0385f6c9c34b05be63526644c5a">blks_per_pl</a> &amp;&amp; pg</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        &gt;= 0 &amp;&amp; pg &lt; spp-&gt;<a class="code" href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">pgs_per_blk</a> &amp;&amp; sec &gt;= 0 &amp;&amp; sec &lt; spp-&gt;<a class="code" href="structssdparams.html#a93143586362c365e97e39c4b544807ca">secs_per_pg</a>)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a4237c1400d2e5e24f32b77e347163ab9_icgraph.png" border="0" usemap="#ftl_8c_a4237c1400d2e5e24f32b77e347163ab9_icgraph" alt=""/></div>
<map name="ftl_8c_a4237c1400d2e5e24f32b77e347163ab9_icgraph" id="ftl_8c_a4237c1400d2e5e24f32b77e347163ab9_icgraph">
<area shape="rect" title=" " alt="" coords="1279,5,1364,32"/>
<area shape="rect" href="ftl_8c.html#a306780893a49a72da761566ca918b35e" title=" " alt="" coords="1151,5,1231,32"/>
<area shape="rect" href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3" title=" " alt="" coords="1019,5,1103,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ab36d3c54cb8e6ef53588b549a5803172"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab36d3c54cb8e6ef53588b549a5803172">&#9670;&nbsp;</a></span>victim_line_cmp_pri()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int victim_line_cmp_pri </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a>&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a>&#160;</td>
          <td class="paramname"><em>curr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;{</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">return</span> (next &gt; curr);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_ab36d3c54cb8e6ef53588b549a5803172_icgraph.png" border="0" usemap="#ftl_8c_ab36d3c54cb8e6ef53588b549a5803172_icgraph" alt=""/></div>
<map name="ftl_8c_ab36d3c54cb8e6ef53588b549a5803172_icgraph" id="ftl_8c_ab36d3c54cb8e6ef53588b549a5803172_icgraph">
<area shape="rect" title=" " alt="" coords="1177,5,1331,32"/>
<area shape="rect" href="ftl_8c.html#a75e82f66648a13506f57f7bb0fce7a10" title=" " alt="" coords="1019,5,1129,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a3c491d1c863f0b3501bd668a59dec976"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c491d1c863f0b3501bd668a59dec976">&#9670;&nbsp;</a></span>victim_line_get_pos()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t victim_line_get_pos </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;{</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">return</span> ((<span class="keyword">struct</span> <a class="code" href="structline.html">line</a> *)a)-&gt;pos;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a3c491d1c863f0b3501bd668a59dec976_icgraph.png" border="0" usemap="#ftl_8c_a3c491d1c863f0b3501bd668a59dec976_icgraph" alt=""/></div>
<map name="ftl_8c_a3c491d1c863f0b3501bd668a59dec976_icgraph" id="ftl_8c_a3c491d1c863f0b3501bd668a59dec976_icgraph">
<area shape="rect" title=" " alt="" coords="1177,5,1329,32"/>
<area shape="rect" href="ftl_8c.html#a75e82f66648a13506f57f7bb0fce7a10" title=" " alt="" coords="1019,5,1129,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a9417ce02aa098194c92e57ef04abb6b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9417ce02aa098194c92e57ef04abb6b7">&#9670;&nbsp;</a></span>victim_line_get_pri()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a> victim_line_get_pri </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">return</span> ((<span class="keyword">struct</span> <a class="code" href="structline.html">line</a> *)a)-&gt;vpc;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a9417ce02aa098194c92e57ef04abb6b7_icgraph.png" border="0" usemap="#ftl_8c_a9417ce02aa098194c92e57ef04abb6b7_icgraph" alt=""/></div>
<map name="ftl_8c_a9417ce02aa098194c92e57ef04abb6b7_icgraph" id="ftl_8c_a9417ce02aa098194c92e57ef04abb6b7_icgraph">
<area shape="rect" title=" " alt="" coords="1177,5,1324,32"/>
<area shape="rect" href="ftl_8c.html#a75e82f66648a13506f57f7bb0fce7a10" title=" " alt="" coords="1019,5,1129,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ae8e269140ca688f2decf1b684d2e3991"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8e269140ca688f2decf1b684d2e3991">&#9670;&nbsp;</a></span>victim_line_set_pos()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void victim_line_set_pos </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;{</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    ((<span class="keyword">struct </span><a class="code" href="structline.html">line</a> *)a)-&gt;pos = <a class="code" href="structline.html#a089ed2a089e88d1421b88830d98561c2">pos</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_ae8e269140ca688f2decf1b684d2e3991_icgraph.png" border="0" usemap="#ftl_8c_ae8e269140ca688f2decf1b684d2e3991_icgraph" alt=""/></div>
<map name="ftl_8c_ae8e269140ca688f2decf1b684d2e3991_icgraph" id="ftl_8c_ae8e269140ca688f2decf1b684d2e3991_icgraph">
<area shape="rect" title=" " alt="" coords="1177,5,1328,32"/>
<area shape="rect" href="ftl_8c.html#a75e82f66648a13506f57f7bb0fce7a10" title=" " alt="" coords="1019,5,1129,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a6d8917709dbdb441c13fc5d6ee5204aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d8917709dbdb441c13fc5d6ee5204aa">&#9670;&nbsp;</a></span>victim_line_set_pri()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void victim_line_set_pri </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a>&#160;</td>
          <td class="paramname"><em>pri</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;{</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    ((<span class="keyword">struct </span><a class="code" href="structline.html">line</a> *)a)-&gt;vpc = pri;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="ftl_8c_a6d8917709dbdb441c13fc5d6ee5204aa_icgraph.png" border="0" usemap="#ftl_8c_a6d8917709dbdb441c13fc5d6ee5204aa_icgraph" alt=""/></div>
<map name="ftl_8c_a6d8917709dbdb441c13fc5d6ee5204aa_icgraph" id="ftl_8c_a6d8917709dbdb441c13fc5d6ee5204aa_icgraph">
<area shape="rect" title=" " alt="" coords="1177,5,1323,32"/>
<area shape="rect" href="ftl_8c.html#a75e82f66648a13506f57f7bb0fce7a10" title=" " alt="" coords="1019,5,1129,32"/>
<area shape="rect" href="ftl_8h.html#af3f6de830b620d1f3060c7de8c8ddec0" title=" " alt="" coords="899,5,971,32"/>
<area shape="rect" href="bb_8c.html#a3fc7384f815cca2f52003206b20324df" title=" " alt="" coords="784,5,851,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aftl_8h_html_adf764cbdea00d65edcd07bb9953ad2b7a20ce8680df93c5e2acbf38a65350e122"><div class="ttname"><a href="ftl_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a20ce8680df93c5e2acbf38a65350e122">GC_IO</a></div><div class="ttdeci">@ GC_IO</div><div class="ttdef"><b>Definition:</b> ftl.h:22</div></div>
<div class="ttc" id="astructnand__block_html_a0c979863e9e1648cbf3a129bcd92820b"><div class="ttname"><a href="structnand__block.html#a0c979863e9e1648cbf3a129bcd92820b">nand_block::ipc</a></div><div class="ttdeci">int ipc</div><div class="ttdef"><b>Definition:</b> ftl.h:83</div></div>
<div class="ttc" id="aftl_8c_html_aedba9d148f29a3ea880cf3abbbc07fad"><div class="ttname"><a href="ftl_8c.html#aedba9d148f29a3ea880cf3abbbc07fad">do_gc</a></div><div class="ttdeci">static int do_gc(struct ssd *ssd, bool force)</div><div class="ttdef"><b>Definition:</b> ftl.c:724</div></div>
<div class="ttc" id="aftl_8c_html_aa17bd85978e80a1bb61285f026f7a427"><div class="ttname"><a href="ftl_8c.html#aa17bd85978e80a1bb61285f026f7a427">ssd_init_nand_page</a></div><div class="ttdeci">static void ssd_init_nand_page(struct nand_page *pg, struct ssdparams *spp)</div><div class="ttdef"><b>Definition:</b> ftl.c:289</div></div>
<div class="ttc" id="aftl_8h_html_a99fb83031ce9923c84392b4e92f956b5a9c9278e0defed03ac007a9d18a097b10"><div class="ttname"><a href="ftl_8h.html#a99fb83031ce9923c84392b4e92f956b5a9c9278e0defed03ac007a9d18a097b10">SEC_FREE</a></div><div class="ttdeci">@ SEC_FREE</div><div class="ttdef"><b>Definition:</b> ftl.h:26</div></div>
<div class="ttc" id="astructppa_html_a9ca7013864c40d83a67ce2d8edf2350e"><div class="ttname"><a href="structppa.html#a9ca7013864c40d83a67ce2d8edf2350e">ppa::lun</a></div><div class="ttdeci">uint64_t lun</div><div class="ttdef"><b>Definition:</b> ftl.h:63</div></div>
<div class="ttc" id="aftl_8c_html_ad1952595f15249cd0335bcf5e12d2048"><div class="ttname"><a href="ftl_8c.html#ad1952595f15249cd0335bcf5e12d2048">gc_write_page</a></div><div class="ttdeci">static uint64_t gc_write_page(struct ssd *ssd, struct ppa *old_ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:630</div></div>
<div class="ttc" id="astructssdparams_html_aebc159516f73021767eb96c276f64d08"><div class="ttname"><a href="structssdparams.html#aebc159516f73021767eb96c276f64d08">ssdparams::ch_xfer_lat</a></div><div class="ttdeci">int ch_xfer_lat</div><div class="ttdef"><b>Definition:</b> ftl.h:122</div></div>
<div class="ttc" id="astructNvmeRequest_html_a335e5b18fb079480b1b1a1f06652c647"><div class="ttname"><a href="structNvmeRequest.html#a335e5b18fb079480b1b1a1f06652c647">NvmeRequest::cmd</a></div><div class="ttdeci">NvmeCmd cmd</div><div class="ttdef"><b>Definition:</b> nvme.h:975</div></div>
<div class="ttc" id="astructnand__cmd_html_a0fda017087a80858b838195f4d8e2b36"><div class="ttname"><a href="structnand__cmd.html#a0fda017087a80858b838195f4d8e2b36">nand_cmd::stime</a></div><div class="ttdeci">int64_t stime</div><div class="ttdef"><b>Definition:</b> ftl.h:194</div></div>
<div class="ttc" id="astructssd_html_a6ffa7f5fbc77044d9fb80e65d477a632"><div class="ttname"><a href="structssd.html#a6ffa7f5fbc77044d9fb80e65d477a632">ssd::ch</a></div><div class="ttdeci">struct ssd_channel * ch</div><div class="ttdef"><b>Definition:</b> ftl.h:200</div></div>
<div class="ttc" id="astructline__mgmt_html_a52782d1468638fe4b1462bcd2175976c"><div class="ttname"><a href="structline__mgmt.html#a52782d1468638fe4b1462bcd2175976c">line_mgmt::lines</a></div><div class="ttdeci">struct line * lines</div><div class="ttdef"><b>Definition:</b> ftl.h:179</div></div>
<div class="ttc" id="aftl_8h_html_a06fc87d81c62e9abb8790b6e5713c55ba961b37b2f319961303251f5ef3d2e93f"><div class="ttname"><a href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba961b37b2f319961303251f5ef3d2e93f">NAND_ERASE_LATENCY</a></div><div class="ttdeci">@ NAND_ERASE_LATENCY</div><div class="ttdef"><b>Definition:</b> ftl.h:17</div></div>
<div class="ttc" id="astructnand__block_html_afd82eb2e8b19ec2dd70b0bfa3e602776"><div class="ttname"><a href="structnand__block.html#afd82eb2e8b19ec2dd70b0bfa3e602776">nand_block::npgs</a></div><div class="ttdeci">int npgs</div><div class="ttdef"><b>Definition:</b> ftl.h:82</div></div>
<div class="ttc" id="astructssdparams_html_ab8b7f48bd8cae23a4da6dcc8ceeb05ab"><div class="ttname"><a href="structssdparams.html#ab8b7f48bd8cae23a4da6dcc8ceeb05ab">ssdparams::pg_rd_lat</a></div><div class="ttdeci">int pg_rd_lat</div><div class="ttdef"><b>Definition:</b> ftl.h:119</div></div>
<div class="ttc" id="astructssd_html"><div class="ttname"><a href="structssd.html">ssd</a></div><div class="ttdef"><b>Definition:</b> ftl.h:197</div></div>
<div class="ttc" id="astructssd__channel_html_a43f4b195efe270acfb3ba6fa229ecf1b"><div class="ttname"><a href="structssd__channel.html#a43f4b195efe270acfb3ba6fa229ecf1b">ssd_channel::lun</a></div><div class="ttdeci">struct nand_lun * lun</div><div class="ttdef"><b>Definition:</b> ftl.h:103</div></div>
<div class="ttc" id="astructssdparams_html_a584a92a1768fad79586d746562db0ced"><div class="ttname"><a href="structssdparams.html#a584a92a1768fad79586d746562db0ced">ssdparams::pg_wr_lat</a></div><div class="ttdeci">int pg_wr_lat</div><div class="ttdef"><b>Definition:</b> ftl.h:120</div></div>
<div class="ttc" id="astructFemuCtrl_html"><div class="ttname"><a href="structFemuCtrl.html">FemuCtrl</a></div><div class="ttdef"><b>Definition:</b> nvme.h:1170</div></div>
<div class="ttc" id="aftl_8c_html_a3c2e22192ca991c459c54bead5b1ff98"><div class="ttname"><a href="ftl_8c.html#a3c2e22192ca991c459c54bead5b1ff98">ppa2pgidx</a></div><div class="ttdeci">static uint64_t ppa2pgidx(struct ssd *ssd, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:28</div></div>
<div class="ttc" id="apqueue_8h_html_abec9363c7a9cc89190bf0925a4a1652c"><div class="ttname"><a href="pqueue_8h.html#abec9363c7a9cc89190bf0925a4a1652c">pqueue_pop</a></div><div class="ttdeci">void * pqueue_pop(pqueue_t *q)</div><div class="ttdef"><b>Definition:</b> pqueue.c:172</div></div>
<div class="ttc" id="astructnand__lun_html_acf81a9df9b43a75795a3f16b6dc52038"><div class="ttname"><a href="structnand__lun.html#acf81a9df9b43a75795a3f16b6dc52038">nand_lun::busy</a></div><div class="ttdeci">bool busy</div><div class="ttdef"><b>Definition:</b> ftl.h:98</div></div>
<div class="ttc" id="astructwrite__pointer_html_ac533d4150e459ae66a36a1407d74cddc"><div class="ttname"><a href="structwrite__pointer.html#ac533d4150e459ae66a36a1407d74cddc">write_pointer::curline</a></div><div class="ttdeci">struct line * curline</div><div class="ttdef"><b>Definition:</b> ftl.h:170</div></div>
<div class="ttc" id="aftl_8c_html_aadf575bf139734453ba8fa6af20b1ac3"><div class="ttname"><a href="ftl_8c.html#aadf575bf139734453ba8fa6af20b1ac3">get_ch</a></div><div class="ttdeci">static struct ssd_channel * get_ch(struct ssd *ssd, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:422</div></div>
<div class="ttc" id="aftl_8c_html_a3cfafde63950110fe49516abc429ef66"><div class="ttname"><a href="ftl_8c.html#a3cfafde63950110fe49516abc429ef66">get_pg</a></div><div class="ttdeci">static struct nand_page * get_pg(struct ssd *ssd, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:450</div></div>
<div class="ttc" id="anvme_8h_html_a01e3a918ff89282c841471f5d797fbf6a324318d7d84def33dd8a53724f14ab10"><div class="ttname"><a href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a324318d7d84def33dd8a53724f14ab10">NVME_CMD_DSM</a></div><div class="ttdeci">@ NVME_CMD_DSM</div><div class="ttdef"><b>Definition:</b> nvme.h:339</div></div>
<div class="ttc" id="aftl_8c_html_ae19a0a686346f1ffbfa9e73035efbaad"><div class="ttname"><a href="ftl_8c.html#ae19a0a686346f1ffbfa9e73035efbaad">ssd_init_rmap</a></div><div class="ttdeci">static void ssd_init_rmap(struct ssd *ssd)</div><div class="ttdef"><b>Definition:</b> ftl.c:353</div></div>
<div class="ttc" id="apqueue_8h_html_a7dfaa607ca404b915355d4b123c669ee"><div class="ttname"><a href="pqueue_8h.html#a7dfaa607ca404b915355d4b123c669ee">pqueue_change_priority</a></div><div class="ttdeci">void pqueue_change_priority(pqueue_t *q, pqueue_pri_t new_pri, void *d)</div><div class="ttdef"><b>Definition:</b> pqueue.c:147</div></div>
<div class="ttc" id="astructline__mgmt_html_a7cba4eac7dbe081ea3f943a5bd9b6ab8"><div class="ttname"><a href="structline__mgmt.html#a7cba4eac7dbe081ea3f943a5bd9b6ab8">line_mgmt::victim_line_cnt</a></div><div class="ttdeci">int victim_line_cnt</div><div class="ttdef"><b>Definition:</b> ftl.h:187</div></div>
<div class="ttc" id="astructssdparams_html_a5d77d505334c2cc261b44b7c83630424"><div class="ttname"><a href="structssdparams.html#a5d77d505334c2cc261b44b7c83630424">ssdparams::pls_per_ch</a></div><div class="ttdeci">int pls_per_ch</div><div class="ttdef"><b>Definition:</b> ftl.h:153</div></div>
<div class="ttc" id="astructssd__channel_html"><div class="ttname"><a href="structssd__channel.html">ssd_channel</a></div><div class="ttdef"><b>Definition:</b> ftl.h:102</div></div>
<div class="ttc" id="astructwrite__pointer_html_a854272876a0fbd867842d16a3620a827"><div class="ttname"><a href="structwrite__pointer.html#a854272876a0fbd867842d16a3620a827">write_pointer::blk</a></div><div class="ttdeci">int blk</div><div class="ttdef"><b>Definition:</b> ftl.h:174</div></div>
<div class="ttc" id="aftl_8c_html_a080e38a63b4626bd7cf314fcf74f2fb2"><div class="ttname"><a href="ftl_8c.html#a080e38a63b4626bd7cf314fcf74f2fb2">get_line</a></div><div class="ttdeci">static struct line * get_line(struct ssd *ssd, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:445</div></div>
<div class="ttc" id="aftl_8c_html_a659c0c25af9ae17e1771fc5bf7bca444"><div class="ttname"><a href="ftl_8c.html#a659c0c25af9ae17e1771fc5bf7bca444">get_next_free_line</a></div><div class="ttdeci">static struct line * get_next_free_line(struct ssd *ssd)</div><div class="ttdef"><b>Definition:</b> ftl.c:141</div></div>
<div class="ttc" id="aftl_8c_html_a306780893a49a72da761566ca918b35e"><div class="ttname"><a href="ftl_8c.html#a306780893a49a72da761566ca918b35e">ssd_read</a></div><div class="ttdeci">static uint64_t ssd_read(struct ssd *ssd, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> ftl.c:770</div></div>
<div class="ttc" id="aftl_8c_html_a3716c928ff3ccf16e82ae281fd3dd6d3"><div class="ttname"><a href="ftl_8c.html#a3716c928ff3ccf16e82ae281fd3dd6d3">ftl_thread</a></div><div class="ttdeci">static void * ftl_thread(void *arg)</div><div class="ttdef"><b>Definition:</b> ftl.c:861</div></div>
<div class="ttc" id="aftl_8c_html_adaaf0f3e032de3124ddc61a6111b25db"><div class="ttname"><a href="ftl_8c.html#adaaf0f3e032de3124ddc61a6111b25db">mark_page_invalid</a></div><div class="ttdeci">static void mark_page_invalid(struct ssd *ssd, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:528</div></div>
<div class="ttc" id="aftl_8c_html_a75e82f66648a13506f57f7bb0fce7a10"><div class="ttname"><a href="ftl_8c.html#a75e82f66648a13506f57f7bb0fce7a10">ssd_init_lines</a></div><div class="ttdeci">static void ssd_init_lines(struct ssd *ssd)</div><div class="ttdef"><b>Definition:</b> ftl.c:84</div></div>
<div class="ttc" id="astructssdparams_html_a17c866b5ab21200fe863c05201d70144"><div class="ttname"><a href="structssdparams.html#a17c866b5ab21200fe863c05201d70144">ssdparams::blks_per_lun</a></div><div class="ttdeci">int blks_per_lun</div><div class="ttdef"><b>Definition:</b> ftl.h:144</div></div>
<div class="ttc" id="aftl_8h_html_a06fc87d81c62e9abb8790b6e5713c55ba21101ced44d7c10f4be3536ccf778399"><div class="ttname"><a href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba21101ced44d7c10f4be3536ccf778399">NAND_ERASE</a></div><div class="ttdeci">@ NAND_ERASE</div><div class="ttdef"><b>Definition:</b> ftl.h:13</div></div>
<div class="ttc" id="aoc12_8h_html_aafa9f203f0abc59a4b08b3833f39b92c"><div class="ttname"><a href="oc12_8h.html#aafa9f203f0abc59a4b08b3833f39b92c">lba</a></div><div class="ttdeci">uint64_t lba</div><div class="ttdef"><b>Definition:</b> oc12.h:2</div></div>
<div class="ttc" id="astructnand__lun_html_a68ecfcc73af2f1103b2612aab0db8c2d"><div class="ttname"><a href="structnand__lun.html#a68ecfcc73af2f1103b2612aab0db8c2d">nand_lun::gc_endtime</a></div><div class="ttdeci">uint64_t gc_endtime</div><div class="ttdef"><b>Definition:</b> ftl.h:99</div></div>
<div class="ttc" id="aftl_8c_html_a5313a5ca429ce56095c0c1052c301c15"><div class="ttname"><a href="ftl_8c.html#a5313a5ca429ce56095c0c1052c301c15">mark_block_free</a></div><div class="ttdeci">static void mark_block_free(struct ssd *ssd, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:597</div></div>
<div class="ttc" id="astructFemuCtrl_html_a78baba4717dd495d81af587a1a95a0b7"><div class="ttname"><a href="structFemuCtrl.html#a78baba4717dd495d81af587a1a95a0b7">FemuCtrl::num_poller</a></div><div class="ttdeci">uint32_t num_poller</div><div class="ttdef"><b>Definition:</b> nvme.h:1323</div></div>
<div class="ttc" id="aftl_8c_html_a4a3067e8cef7d5c0e777cc82cf9c40c3"><div class="ttname"><a href="ftl_8c.html#a4a3067e8cef7d5c0e777cc82cf9c40c3">valid_lpn</a></div><div class="ttdeci">static bool valid_lpn(struct ssd *ssd, uint64_t lpn)</div><div class="ttdef"><b>Definition:</b> ftl.c:412</div></div>
<div class="ttc" id="astructssdparams_html_afef7c89eaa29554e7dca4814136c5756"><div class="ttname"><a href="structssdparams.html#afef7c89eaa29554e7dca4814136c5756">ssdparams::tt_pls</a></div><div class="ttdeci">int tt_pls</div><div class="ttdef"><b>Definition:</b> ftl.h:154</div></div>
<div class="ttc" id="astructssdparams_html_a78f1013c9a83c3074ef83cd8782f84dd"><div class="ttname"><a href="structssdparams.html#a78f1013c9a83c3074ef83cd8782f84dd">ssdparams::gc_thres_pcent_high</a></div><div class="ttdeci">double gc_thres_pcent_high</div><div class="ttdef"><b>Definition:</b> ftl.h:128</div></div>
<div class="ttc" id="aftl_8c_html_aac3ae48a56045829a6e2f1bf933b1d5b"><div class="ttname"><a href="ftl_8c.html#aac3ae48a56045829a6e2f1bf933b1d5b">set_rmap_ent</a></div><div class="ttdeci">static void set_rmap_ent(struct ssd *ssd, uint64_t lpn, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:52</div></div>
<div class="ttc" id="astructNvmeRequest_html_ab9efcb9c4901c697b16f583893abef3a"><div class="ttname"><a href="structNvmeRequest.html#ab9efcb9c4901c697b16f583893abef3a">NvmeRequest::nlb</a></div><div class="ttdeci">uint16_t nlb</div><div class="ttdef"><b>Definition:</b> nvme.h:968</div></div>
<div class="ttc" id="astructppa_html_a62bda76b2d5198e19ba1198df79c39f8"><div class="ttname"><a href="structppa.html#a62bda76b2d5198e19ba1198df79c39f8">ppa::g</a></div><div class="ttdeci">struct ppa::@4::@6 g</div></div>
<div class="ttc" id="astructssd_html_a8ce888a31348d5b2fa1d914dde456166"><div class="ttname"><a href="structssd.html#a8ce888a31348d5b2fa1d914dde456166">ssd::wp</a></div><div class="ttdeci">struct write_pointer wp</div><div class="ttdef"><b>Definition:</b> ftl.h:203</div></div>
<div class="ttc" id="astructline__mgmt_html"><div class="ttname"><a href="structline__mgmt.html">line_mgmt</a></div><div class="ttdef"><b>Definition:</b> ftl.h:178</div></div>
<div class="ttc" id="astructwrite__pointer_html_acbaa6937b756b9cbf3f457973f98b12a"><div class="ttname"><a href="structwrite__pointer.html#acbaa6937b756b9cbf3f457973f98b12a">write_pointer::pg</a></div><div class="ttdeci">int pg</div><div class="ttdef"><b>Definition:</b> ftl.h:173</div></div>
<div class="ttc" id="anvme_8h_html_a01e3a918ff89282c841471f5d797fbf6af12c69a9bdf0ad418e4a144ef5424336"><div class="ttname"><a href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6af12c69a9bdf0ad418e4a144ef5424336">NVME_CMD_WRITE</a></div><div class="ttdeci">@ NVME_CMD_WRITE</div><div class="ttdef"><b>Definition:</b> nvme.h:334</div></div>
<div class="ttc" id="astructssdparams_html_a17a649068b0acfe64a1afc67b51236fb"><div class="ttname"><a href="structssdparams.html#a17a649068b0acfe64a1afc67b51236fb">ssdparams::nchs</a></div><div class="ttdeci">int nchs</div><div class="ttdef"><b>Definition:</b> ftl.h:117</div></div>
<div class="ttc" id="aftl_8c_html_a03834614ca890f0367e871939f0ffc3b"><div class="ttname"><a href="ftl_8c.html#a03834614ca890f0367e871939f0ffc3b">mark_page_valid</a></div><div class="ttdeci">static void mark_page_valid(struct ssd *ssd, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:575</div></div>
<div class="ttc" id="aftl_8c_html_a8f0b10088699a4513219eafe0e2e4bc6"><div class="ttname"><a href="ftl_8c.html#a8f0b10088699a4513219eafe0e2e4bc6">get_pl</a></div><div class="ttdeci">static struct nand_plane * get_pl(struct ssd *ssd, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:433</div></div>
<div class="ttc" id="astructssd_html_a9d1cef93bbb35d5d9ee62073e99e53b0"><div class="ttname"><a href="structssd.html#a9d1cef93bbb35d5d9ee62073e99e53b0">ssd::maptbl</a></div><div class="ttdeci">struct ppa * maptbl</div><div class="ttdef"><b>Definition:</b> ftl.h:201</div></div>
<div class="ttc" id="arte__ring_8h_html_ab2417e0e85ffd0e61ec4b0ee263ab809"><div class="ttname"><a href="rte__ring_8h.html#ab2417e0e85ffd0e61ec4b0ee263ab809">femu_ring_dequeue</a></div><div class="ttdeci">size_t femu_ring_dequeue(struct rte_ring *ring, void **objs, size_t count)</div><div class="ttdef"><b>Definition:</b> rte_ring.c:228</div></div>
<div class="ttc" id="aftl_8c_html_a4b9026945c9fcc578ba0f7a7a84a1af1"><div class="ttname"><a href="ftl_8c.html#a4b9026945c9fcc578ba0f7a7a84a1af1">gc_read_page</a></div><div class="ttdeci">static void gc_read_page(struct ssd *ssd, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:617</div></div>
<div class="ttc" id="astructssd_html_a6952886e09ff0a561ea0f61786904637"><div class="ttname"><a href="structssd.html#a6952886e09ff0a561ea0f61786904637">ssd::ftl_thread</a></div><div class="ttdeci">QemuThread ftl_thread</div><div class="ttdef"><b>Definition:</b> ftl.h:210</div></div>
<div class="ttc" id="aftl_8h_html_a4f586d4bebabb8dce738295d42a3671e"><div class="ttname"><a href="ftl_8h.html#a4f586d4bebabb8dce738295d42a3671e">UNMAPPED_PPA</a></div><div class="ttdeci">#define UNMAPPED_PPA</div><div class="ttdef"><b>Definition:</b> ftl.h:8</div></div>
<div class="ttc" id="aftl_8h_html_a06fc87d81c62e9abb8790b6e5713c55ba9eb21f1680871f4d099414752c40a2e4"><div class="ttname"><a href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba9eb21f1680871f4d099414752c40a2e4">NAND_WRITE</a></div><div class="ttdeci">@ NAND_WRITE</div><div class="ttdef"><b>Definition:</b> ftl.h:12</div></div>
<div class="ttc" id="astructssdparams_html_ad339ca6a9e013ff5d28d408f7e2ad705"><div class="ttname"><a href="structssdparams.html#ad339ca6a9e013ff5d28d408f7e2ad705">ssdparams::luns_per_ch</a></div><div class="ttdeci">int luns_per_ch</div><div class="ttdef"><b>Definition:</b> ftl.h:116</div></div>
<div class="ttc" id="aftl_8c_html_a4494881726f0faee876d503fa1f2e312"><div class="ttname"><a href="ftl_8c.html#a4494881726f0faee876d503fa1f2e312">should_gc_high</a></div><div class="ttdeci">static bool should_gc_high(struct ssd *ssd)</div><div class="ttdef"><b>Definition:</b> ftl.c:12</div></div>
<div class="ttc" id="aftl_8c_html_ae8e269140ca688f2decf1b684d2e3991"><div class="ttname"><a href="ftl_8c.html#ae8e269140ca688f2decf1b684d2e3991">victim_line_set_pos</a></div><div class="ttdeci">static void victim_line_set_pos(void *a, size_t pos)</div><div class="ttdef"><b>Definition:</b> ftl.c:79</div></div>
<div class="ttc" id="apqueue_8h_html_a2c27c13ed1c988e9fc7b259e6820ca8c"><div class="ttname"><a href="pqueue_8h.html#a2c27c13ed1c988e9fc7b259e6820ca8c">pqueue_init</a></div><div class="ttdeci">pqueue_t * pqueue_init(size_t n, pqueue_cmp_pri_f cmppri, pqueue_get_pri_f getpri, pqueue_set_pri_f setpri, pqueue_get_pos_f getpos, pqueue_set_pos_f setpos)</div><div class="ttdef"><b>Definition:</b> pqueue.c:37</div></div>
<div class="ttc" id="astructssd_html_a58bcbabc96ec3acaa19fac4ecf7956dc"><div class="ttname"><a href="structssd.html#a58bcbabc96ec3acaa19fac4ecf7956dc">ssd::lm</a></div><div class="ttdeci">struct line_mgmt lm</div><div class="ttdef"><b>Definition:</b> ftl.h:204</div></div>
<div class="ttc" id="astructppa_html_a4dc2d1cdc8cce18cdf002f309395cba8"><div class="ttname"><a href="structppa.html#a4dc2d1cdc8cce18cdf002f309395cba8">ppa::ppa</a></div><div class="ttdeci">uint64_t ppa</div><div class="ttdef"><b>Definition:</b> ftl.h:68</div></div>
<div class="ttc" id="astructssdparams_html_a6865de86ba20967f6ef156beeca0d62a"><div class="ttname"><a href="structssdparams.html#a6865de86ba20967f6ef156beeca0d62a">ssdparams::blk_er_lat</a></div><div class="ttdeci">int blk_er_lat</div><div class="ttdef"><b>Definition:</b> ftl.h:121</div></div>
<div class="ttc" id="astructnand__page_html_ac238873d503e6fd6530f43b784019dfc"><div class="ttname"><a href="structnand__page.html#ac238873d503e6fd6530f43b784019dfc">nand_page::status</a></div><div class="ttdeci">int status</div><div class="ttdef"><b>Definition:</b> ftl.h:77</div></div>
<div class="ttc" id="aftl_8c_html_a0299da5e7e5dd1eb868d80914de35ee8"><div class="ttname"><a href="ftl_8c.html#a0299da5e7e5dd1eb868d80914de35ee8">ssd_advance_status</a></div><div class="ttdeci">static uint64_t ssd_advance_status(struct ssd *ssd, struct ppa *ppa, struct nand_cmd *ncmd)</div><div class="ttdef"><b>Definition:</b> ftl.c:456</div></div>
<div class="ttc" id="astructssdparams_html_a8ec920f02aa51d4158e7946e81732645"><div class="ttname"><a href="structssdparams.html#a8ec920f02aa51d4158e7946e81732645">ssdparams::tt_luns</a></div><div class="ttdeci">int tt_luns</div><div class="ttdef"><b>Definition:</b> ftl.h:156</div></div>
<div class="ttc" id="aftl_8c_html_a96c1b582459f3ccfc0643bac1a8cdf35"><div class="ttname"><a href="ftl_8c.html#a96c1b582459f3ccfc0643bac1a8cdf35">ssd_init_params</a></div><div class="ttdeci">static void ssd_init_params(struct ssdparams *spp)</div><div class="ttdef"><b>Definition:</b> ftl.c:237</div></div>
<div class="ttc" id="astructNvmeRequest_html_ad267c178ee13ebb285604043925b5e78"><div class="ttname"><a href="structNvmeRequest.html#ad267c178ee13ebb285604043925b5e78">NvmeRequest::stime</a></div><div class="ttdeci">int64_t stime</div><div class="ttdef"><b>Definition:</b> nvme.h:981</div></div>
<div class="ttc" id="aftl_8c_html_a92e6cdd7677ef48c1830b6fbba09a28a"><div class="ttname"><a href="ftl_8c.html#a92e6cdd7677ef48c1830b6fbba09a28a">get_rmap_ent</a></div><div class="ttdeci">static uint64_t get_rmap_ent(struct ssd *ssd, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:44</div></div>
<div class="ttc" id="aftl_8c_html_a2c41ad05315023bfa77846568e4f7282"><div class="ttname"><a href="ftl_8c.html#a2c41ad05315023bfa77846568e4f7282">mark_line_free</a></div><div class="ttdeci">static void mark_line_free(struct ssd *ssd, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:713</div></div>
<div class="ttc" id="astructssdparams_html_a1bccb207bbd6aeca6c7b5fef5d530f6d"><div class="ttname"><a href="structssdparams.html#a1bccb207bbd6aeca6c7b5fef5d530f6d">ssdparams::gc_thres_lines</a></div><div class="ttdeci">int gc_thres_lines</div><div class="ttdef"><b>Definition:</b> ftl.h:127</div></div>
<div class="ttc" id="astructssdparams_html_ac1f4590960563c5d35826fae5062ab3c"><div class="ttname"><a href="structssdparams.html#ac1f4590960563c5d35826fae5062ab3c">ssdparams::secs_per_pl</a></div><div class="ttdeci">int secs_per_pl</div><div class="ttdef"><b>Definition:</b> ftl.h:134</div></div>
<div class="ttc" id="aftl_8h_html_a99fb83031ce9923c84392b4e92f956b5a0d5f318c3fc765bc802353b6cc599214"><div class="ttname"><a href="ftl_8h.html#a99fb83031ce9923c84392b4e92f956b5a0d5f318c3fc765bc802353b6cc599214">PG_FREE</a></div><div class="ttdeci">@ PG_FREE</div><div class="ttdef"><b>Definition:</b> ftl.h:30</div></div>
<div class="ttc" id="aftl_8h_html_ae78ff7bb5a99b8a8ac5fc3c82e0ca403"><div class="ttname"><a href="ftl_8h.html#ae78ff7bb5a99b8a8ac5fc3c82e0ca403">ftl_err</a></div><div class="ttdeci">#define ftl_err(fmt,...)</div><div class="ttdef"><b>Definition:</b> ftl.h:223</div></div>
<div class="ttc" id="astructnand__page_html_a07a35cddc22d7c84ced03c17b23ed244"><div class="ttname"><a href="structnand__page.html#a07a35cddc22d7c84ced03c17b23ed244">nand_page::nsecs</a></div><div class="ttdeci">int nsecs</div><div class="ttdef"><b>Definition:</b> ftl.h:76</div></div>
<div class="ttc" id="astructssd_html_a8724ca69d768471877affbeadbe3c244"><div class="ttname"><a href="structssd.html#a8724ca69d768471877affbeadbe3c244">ssd::ssdname</a></div><div class="ttdeci">char * ssdname</div><div class="ttdef"><b>Definition:</b> ftl.h:198</div></div>
<div class="ttc" id="astructnand__block_html_a89ec2fe3aff210edec30210b24dd2039"><div class="ttname"><a href="structnand__block.html#a89ec2fe3aff210edec30210b24dd2039">nand_block::vpc</a></div><div class="ttdeci">int vpc</div><div class="ttdef"><b>Definition:</b> ftl.h:84</div></div>
<div class="ttc" id="aftl_8c_html_ae5f2680b1c6531f6394723c150f11e1c"><div class="ttname"><a href="ftl_8c.html#ae5f2680b1c6531f6394723c150f11e1c">select_victim_line</a></div><div class="ttdeci">static struct line * select_victim_line(struct ssd *ssd, bool force)</div><div class="ttdef"><b>Definition:</b> ftl.c:668</div></div>
<div class="ttc" id="astructssdparams_html_a82ef103d290bc47db0a2ee5a309b943c"><div class="ttname"><a href="structssdparams.html#a82ef103d290bc47db0a2ee5a309b943c">ssdparams::blks_per_line</a></div><div class="ttdeci">int blks_per_line</div><div class="ttdef"><b>Definition:</b> ftl.h:150</div></div>
<div class="ttc" id="aftl_8c_html_a3c491d1c863f0b3501bd668a59dec976"><div class="ttname"><a href="ftl_8c.html#a3c491d1c863f0b3501bd668a59dec976">victim_line_get_pos</a></div><div class="ttdeci">static size_t victim_line_get_pos(void *a)</div><div class="ttdef"><b>Definition:</b> ftl.c:74</div></div>
<div class="ttc" id="apqueue_8h_html_addd8cdfbc8c47b8cdd7eb4c4560de7aa"><div class="ttname"><a href="pqueue_8h.html#addd8cdfbc8c47b8cdd7eb4c4560de7aa">pqueue_insert</a></div><div class="ttdeci">int pqueue_insert(pqueue_t *q, void *d)</div><div class="ttdef"><b>Definition:</b> pqueue.c:122</div></div>
<div class="ttc" id="astructppa_html_a2b5af16973594981a998ae3328eac8f7"><div class="ttname"><a href="structppa.html#a2b5af16973594981a998ae3328eac8f7">ppa::ch</a></div><div class="ttdeci">uint64_t ch</div><div class="ttdef"><b>Definition:</b> ftl.h:64</div></div>
<div class="ttc" id="astructnand__cmd_html_a364c052be48202ede06e883e4b120409"><div class="ttname"><a href="structnand__cmd.html#a364c052be48202ede06e883e4b120409">nand_cmd::type</a></div><div class="ttdeci">int type</div><div class="ttdef"><b>Definition:</b> ftl.h:192</div></div>
<div class="ttc" id="astructssdparams_html_a7cd0ad9e577e097738e4bcd6882de2e0"><div class="ttname"><a href="structssdparams.html#a7cd0ad9e577e097738e4bcd6882de2e0">ssdparams::tt_blks</a></div><div class="ttdeci">int tt_blks</div><div class="ttdef"><b>Definition:</b> ftl.h:146</div></div>
<div class="ttc" id="astructwrite__pointer_html_adf3acc53d295719babbd39458dddaa66"><div class="ttname"><a href="structwrite__pointer.html#adf3acc53d295719babbd39458dddaa66">write_pointer::ch</a></div><div class="ttdeci">int ch</div><div class="ttdef"><b>Definition:</b> ftl.h:171</div></div>
<div class="ttc" id="aftl_8c_html_a6e8a2a542e569fe2662cbb8cf647590b"><div class="ttname"><a href="ftl_8c.html#a6e8a2a542e569fe2662cbb8cf647590b">mapped_ppa</a></div><div class="ttdeci">static bool mapped_ppa(struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:417</div></div>
<div class="ttc" id="astructnand__lun_html_a8f95b70bcd5720c7b081af37dbd3fc70"><div class="ttname"><a href="structnand__lun.html#a8f95b70bcd5720c7b081af37dbd3fc70">nand_lun::npls</a></div><div class="ttdeci">int npls</div><div class="ttdef"><b>Definition:</b> ftl.h:96</div></div>
<div class="ttc" id="astructssdparams_html_aaafec0385f6c9c34b05be63526644c5a"><div class="ttname"><a href="structssdparams.html#aaafec0385f6c9c34b05be63526644c5a">ssdparams::blks_per_pl</a></div><div class="ttdeci">int blks_per_pl</div><div class="ttdef"><b>Definition:</b> ftl.h:114</div></div>
<div class="ttc" id="astructnand__block_html_a8629bef6da40ace33902c884d6b0127c"><div class="ttname"><a href="structnand__block.html#a8629bef6da40ace33902c884d6b0127c">nand_block::erase_cnt</a></div><div class="ttdeci">int erase_cnt</div><div class="ttdef"><b>Definition:</b> ftl.h:85</div></div>
<div class="ttc" id="astructssd_html_af5ac3e7f4169f686b1279f054413e84f"><div class="ttname"><a href="structssd.html#af5ac3e7f4169f686b1279f054413e84f">ssd::to_poller</a></div><div class="ttdeci">struct rte_ring ** to_poller</div><div class="ttdef"><b>Definition:</b> ftl.h:208</div></div>
<div class="ttc" id="astructssdparams_html_a618e42c61c1487fbe274ecc9d8b47e26"><div class="ttname"><a href="structssdparams.html#a618e42c61c1487fbe274ecc9d8b47e26">ssdparams::pgs_per_ch</a></div><div class="ttdeci">int pgs_per_ch</div><div class="ttdef"><b>Definition:</b> ftl.h:141</div></div>
<div class="ttc" id="aftl_8h_html_a06fc87d81c62e9abb8790b6e5713c55ba064c38a00639099031cda82711a5ac5d"><div class="ttname"><a href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba064c38a00639099031cda82711a5ac5d">NAND_READ</a></div><div class="ttdeci">@ NAND_READ</div><div class="ttdef"><b>Definition:</b> ftl.h:11</div></div>
<div class="ttc" id="astructssdparams_html_ab072044ad8c0107835464ba876b618f2"><div class="ttname"><a href="structssdparams.html#ab072044ad8c0107835464ba876b618f2">ssdparams::enable_gc_delay</a></div><div class="ttdeci">bool enable_gc_delay</div><div class="ttdef"><b>Definition:</b> ftl.h:130</div></div>
<div class="ttc" id="astructnand__lun_html_ae64d00bf7f1ed056065e1a6c91898473"><div class="ttname"><a href="structnand__lun.html#ae64d00bf7f1ed056065e1a6c91898473">nand_lun::pl</a></div><div class="ttdeci">struct nand_plane * pl</div><div class="ttdef"><b>Definition:</b> ftl.h:95</div></div>
<div class="ttc" id="astructNvmeRequest_html_a5b78c8ff9c9bf2a1012976ac9764d5bc"><div class="ttname"><a href="structNvmeRequest.html#a5b78c8ff9c9bf2a1012976ac9764d5bc">NvmeRequest::reqlat</a></div><div class="ttdeci">int64_t reqlat</div><div class="ttdef"><b>Definition:</b> nvme.h:982</div></div>
<div class="ttc" id="aftl_8c_html_aa555ec9dcfe762eb6c39afa3cb167e3d"><div class="ttname"><a href="ftl_8c.html#aa555ec9dcfe762eb6c39afa3cb167e3d">check_params</a></div><div class="ttdeci">static void check_params(struct ssdparams *spp)</div><div class="ttdef"><b>Definition:</b> ftl.c:226</div></div>
<div class="ttc" id="astructssdparams_html_a7ff91681af50eb844c9c5e80d0081e56"><div class="ttname"><a href="structssdparams.html#a7ff91681af50eb844c9c5e80d0081e56">ssdparams::secs_per_ch</a></div><div class="ttdeci">int secs_per_ch</div><div class="ttdef"><b>Definition:</b> ftl.h:136</div></div>
<div class="ttc" id="aftl_8c_html_a6d8917709dbdb441c13fc5d6ee5204aa"><div class="ttname"><a href="ftl_8c.html#a6d8917709dbdb441c13fc5d6ee5204aa">victim_line_set_pri</a></div><div class="ttdeci">static void victim_line_set_pri(void *a, pqueue_pri_t pri)</div><div class="ttdef"><b>Definition:</b> ftl.c:69</div></div>
<div class="ttc" id="astructline_html_aeefab665d811bfabfdaca326ab72e79c"><div class="ttname"><a href="structline.html#aeefab665d811bfabfdaca326ab72e79c">line::vpc</a></div><div class="ttdeci">int vpc</div><div class="ttdef"><b>Definition:</b> ftl.h:162</div></div>
<div class="ttc" id="astructnand__plane_html"><div class="ttname"><a href="structnand__plane.html">nand_plane</a></div><div class="ttdef"><b>Definition:</b> ftl.h:89</div></div>
<div class="ttc" id="aftl_8c_html_ac6428955c80a1fb3371e13b2b2f4ea26"><div class="ttname"><a href="ftl_8c.html#ac6428955c80a1fb3371e13b2b2f4ea26">ssd_init_nand_plane</a></div><div class="ttdeci">static void ssd_init_nand_plane(struct nand_plane *pl, struct ssdparams *spp)</div><div class="ttdef"><b>Definition:</b> ftl.c:312</div></div>
<div class="ttc" id="aftl_8c_html_a2db76f519a8218ea9cda35e61552a4ec"><div class="ttname"><a href="ftl_8c.html#a2db76f519a8218ea9cda35e61552a4ec">get_new_page</a></div><div class="ttdeci">static struct ppa get_new_page(struct ssd *ssd)</div><div class="ttdef"><b>Definition:</b> ftl.c:211</div></div>
<div class="ttc" id="aftl_8c_html_a358979ad49087b2f21ead4eb9a153f14"><div class="ttname"><a href="ftl_8c.html#a358979ad49087b2f21ead4eb9a153f14">ssd_init_maptbl</a></div><div class="ttdeci">static void ssd_init_maptbl(struct ssd *ssd)</div><div class="ttdef"><b>Definition:</b> ftl.c:343</div></div>
<div class="ttc" id="astructssdparams_html_a8e1e0e577c9c04b4c10d3d25cbf6957b"><div class="ttname"><a href="structssdparams.html#a8e1e0e577c9c04b4c10d3d25cbf6957b">ssdparams::secs_per_line</a></div><div class="ttdeci">int secs_per_line</div><div class="ttdef"><b>Definition:</b> ftl.h:148</div></div>
<div class="ttc" id="astructnand__page_html"><div class="ttname"><a href="structnand__page.html">nand_page</a></div><div class="ttdef"><b>Definition:</b> ftl.h:74</div></div>
<div class="ttc" id="astructssdparams_html_a3f75f55bbbf319375cc45dcf2daaaca4"><div class="ttname"><a href="structssdparams.html#a3f75f55bbbf319375cc45dcf2daaaca4">ssdparams::gc_thres_pcent</a></div><div class="ttdeci">double gc_thres_pcent</div><div class="ttdef"><b>Definition:</b> ftl.h:126</div></div>
<div class="ttc" id="aftl_8c_html_a0b6eca1c9bf137587f4c3c7aed0ea914"><div class="ttname"><a href="ftl_8c.html#a0b6eca1c9bf137587f4c3c7aed0ea914">check_addr</a></div><div class="ttdeci">static void check_addr(int a, int max)</div><div class="ttdef"><b>Definition:</b> ftl.c:136</div></div>
<div class="ttc" id="astructssdparams_html_acd04d8260ca1b86005ccc56307105b23"><div class="ttname"><a href="structssdparams.html#acd04d8260ca1b86005ccc56307105b23">ssdparams::tt_lines</a></div><div class="ttdeci">int tt_lines</div><div class="ttdef"><b>Definition:</b> ftl.h:151</div></div>
<div class="ttc" id="astructssdparams_html_ac3f5ee9f571fe392380d5b0e16bab09b"><div class="ttname"><a href="structssdparams.html#ac3f5ee9f571fe392380d5b0e16bab09b">ssdparams::secs_per_lun</a></div><div class="ttdeci">int secs_per_lun</div><div class="ttdef"><b>Definition:</b> ftl.h:135</div></div>
<div class="ttc" id="astructline_html"><div class="ttname"><a href="structline.html">line</a></div><div class="ttdef"><b>Definition:</b> ftl.h:159</div></div>
<div class="ttc" id="aftl_8h_html_a06fc87d81c62e9abb8790b6e5713c55ba159b99876b55d2052590c66614f18e06"><div class="ttname"><a href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba159b99876b55d2052590c66614f18e06">NAND_READ_LATENCY</a></div><div class="ttdeci">@ NAND_READ_LATENCY</div><div class="ttdef"><b>Definition:</b> ftl.h:15</div></div>
<div class="ttc" id="arte__ring_8h_html_a3afc06d02f63e84fe1569c99955af57a"><div class="ttname"><a href="rte__ring_8h.html#a3afc06d02f63e84fe1569c99955af57a">femu_ring_enqueue</a></div><div class="ttdeci">size_t femu_ring_enqueue(struct rte_ring *ring, void **objs, size_t count)</div><div class="ttdef"><b>Definition:</b> rte_ring.c:223</div></div>
<div class="ttc" id="aftl_8h_html_aed1bbdc2f5620a4e59bee553c2cdd5fb"><div class="ttname"><a href="ftl_8h.html#aed1bbdc2f5620a4e59bee553c2cdd5fb">line</a></div><div class="ttdeci">struct line line</div></div>
<div class="ttc" id="astructssdparams_html_a46af9099347b346ed63fd642df5a2262"><div class="ttname"><a href="structssdparams.html#a46af9099347b346ed63fd642df5a2262">ssdparams::blks_per_ch</a></div><div class="ttdeci">int blks_per_ch</div><div class="ttdef"><b>Definition:</b> ftl.h:145</div></div>
<div class="ttc" id="astructssd__channel_html_ad3796afe284a6e0a1980e4f1c0ab291d"><div class="ttname"><a href="structssd__channel.html#ad3796afe284a6e0a1980e4f1c0ab291d">ssd_channel::busy</a></div><div class="ttdeci">bool busy</div><div class="ttdef"><b>Definition:</b> ftl.h:106</div></div>
<div class="ttc" id="astructline_html_a089ed2a089e88d1421b88830d98561c2"><div class="ttname"><a href="structline.html#a089ed2a089e88d1421b88830d98561c2">line::pos</a></div><div class="ttdeci">size_t pos</div><div class="ttdef"><b>Definition:</b> ftl.h:165</div></div>
<div class="ttc" id="astructnand__block_html"><div class="ttname"><a href="structnand__block.html">nand_block</a></div><div class="ttdef"><b>Definition:</b> ftl.h:80</div></div>
<div class="ttc" id="aftl_8h_html_a99fb83031ce9923c84392b4e92f956b5ae15fc2b67b2402b6f167ecccafbbecd2"><div class="ttname"><a href="ftl_8h.html#a99fb83031ce9923c84392b4e92f956b5ae15fc2b67b2402b6f167ecccafbbecd2">PG_VALID</a></div><div class="ttdeci">@ PG_VALID</div><div class="ttdef"><b>Definition:</b> ftl.h:32</div></div>
<div class="ttc" id="astructssdparams_html_ad72919d3040d8ba48758f0e276aea4ad"><div class="ttname"><a href="structssdparams.html#ad72919d3040d8ba48758f0e276aea4ad">ssdparams::gc_thres_lines_high</a></div><div class="ttdeci">int gc_thres_lines_high</div><div class="ttdef"><b>Definition:</b> ftl.h:129</div></div>
<div class="ttc" id="aftl_8c_html_ae77b0af37a85b3285ff26402ca7d03a5"><div class="ttname"><a href="ftl_8c.html#ae77b0af37a85b3285ff26402ca7d03a5">ssd_init_nand_lun</a></div><div class="ttdeci">static void ssd_init_nand_lun(struct nand_lun *lun, struct ssdparams *spp)</div><div class="ttdef"><b>Definition:</b> ftl.c:321</div></div>
<div class="ttc" id="astructFemuCtrl_html_a4464c81978268e5df515d91044ea1ec2"><div class="ttname"><a href="structFemuCtrl.html#a4464c81978268e5df515d91044ea1ec2">FemuCtrl::ssd</a></div><div class="ttdeci">struct ssd * ssd</div><div class="ttdef"><b>Definition:</b> nvme.h:1307</div></div>
<div class="ttc" id="aftl_8c_html_ab02c4873ff387abfd6f268ae711fd0b5"><div class="ttname"><a href="ftl_8c.html#ab02c4873ff387abfd6f268ae711fd0b5">set_maptbl_ent</a></div><div class="ttdeci">static void set_maptbl_ent(struct ssd *ssd, uint64_t lpn, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:22</div></div>
<div class="ttc" id="astructnand__block_html_a424007f74aa840dea80296224af39d8d"><div class="ttname"><a href="structnand__block.html#a424007f74aa840dea80296224af39d8d">nand_block::wp</a></div><div class="ttdeci">int wp</div><div class="ttdef"><b>Definition:</b> ftl.h:86</div></div>
<div class="ttc" id="astructnand__cmd_html"><div class="ttname"><a href="structnand__cmd.html">nand_cmd</a></div><div class="ttdef"><b>Definition:</b> ftl.h:191</div></div>
<div class="ttc" id="astructline__mgmt_html_a871cace77a18047bec4e8bb62524321e"><div class="ttname"><a href="structline__mgmt.html#a871cace77a18047bec4e8bb62524321e">line_mgmt::tt_lines</a></div><div class="ttdeci">int tt_lines</div><div class="ttdef"><b>Definition:</b> ftl.h:185</div></div>
<div class="ttc" id="astructline__mgmt_html_a8ebebc34bbd4abeb8fdad4457042ad3b"><div class="ttname"><a href="structline__mgmt.html#a8ebebc34bbd4abeb8fdad4457042ad3b">line_mgmt::full_line_cnt</a></div><div class="ttdeci">int full_line_cnt</div><div class="ttdef"><b>Definition:</b> ftl.h:188</div></div>
<div class="ttc" id="astructwrite__pointer_html_a685331c5878278ccaf80c3672ce73f7c"><div class="ttname"><a href="structwrite__pointer.html#a685331c5878278ccaf80c3672ce73f7c">write_pointer::pl</a></div><div class="ttdeci">int pl</div><div class="ttdef"><b>Definition:</b> ftl.h:175</div></div>
<div class="ttc" id="astructnand__block_html_a8670e24bc47c15366be8fe4c238a2922"><div class="ttname"><a href="structnand__block.html#a8670e24bc47c15366be8fe4c238a2922">nand_block::pg</a></div><div class="ttdeci">struct nand_page * pg</div><div class="ttdef"><b>Definition:</b> ftl.h:81</div></div>
<div class="ttc" id="astructNvmeCmd_html_a2751bc2a772082d3af81124a1d120a0c"><div class="ttname"><a href="structNvmeCmd.html#a2751bc2a772082d3af81124a1d120a0c">NvmeCmd::opcode</a></div><div class="ttdeci">uint16_t opcode</div><div class="ttdef"><b>Definition:</b> nvme.h:291</div></div>
<div class="ttc" id="aftl_8c_html_a9417ce02aa098194c92e57ef04abb6b7"><div class="ttname"><a href="ftl_8c.html#a9417ce02aa098194c92e57ef04abb6b7">victim_line_get_pri</a></div><div class="ttdeci">static pqueue_pri_t victim_line_get_pri(void *a)</div><div class="ttdef"><b>Definition:</b> ftl.c:64</div></div>
<div class="ttc" id="astructssd_html_ae49bd8bfc26a6a8f1a992d84e0cc862c"><div class="ttname"><a href="structssd.html#ae49bd8bfc26a6a8f1a992d84e0cc862c">ssd::rmap</a></div><div class="ttdeci">uint64_t * rmap</div><div class="ttdef"><b>Definition:</b> ftl.h:202</div></div>
<div class="ttc" id="astructssdparams_html_a853908a359571730e9f08e808eec2281"><div class="ttname"><a href="structssdparams.html#a853908a359571730e9f08e808eec2281">ssdparams::tt_pgs</a></div><div class="ttdeci">int tt_pgs</div><div class="ttdef"><b>Definition:</b> ftl.h:142</div></div>
<div class="ttc" id="astructnand__lun_html"><div class="ttname"><a href="structnand__lun.html">nand_lun</a></div><div class="ttdef"><b>Definition:</b> ftl.h:94</div></div>
<div class="ttc" id="astructFemuCtrl_html_a0ff7c6d5e0e6313cc66e2d62f4e98221"><div class="ttname"><a href="structFemuCtrl.html#a0ff7c6d5e0e6313cc66e2d62f4e98221">FemuCtrl::to_ftl</a></div><div class="ttdeci">struct rte_ring ** to_ftl</div><div class="ttdef"><b>Definition:</b> nvme.h:1312</div></div>
<div class="ttc" id="aftl_8c_html_a6722c643872772d48598187782365209"><div class="ttname"><a href="ftl_8c.html#a6722c643872772d48598187782365209">should_gc</a></div><div class="ttdeci">static bool should_gc(struct ssd *ssd)</div><div class="ttdef"><b>Definition:</b> ftl.c:7</div></div>
<div class="ttc" id="apqueue_8h_html_a2919d3e817688b81da746d4123f51ba3"><div class="ttname"><a href="pqueue_8h.html#a2919d3e817688b81da746d4123f51ba3">pqueue_peek</a></div><div class="ttdeci">void * pqueue_peek(pqueue_t *q)</div><div class="ttdef"><b>Definition:</b> pqueue.c:186</div></div>
<div class="ttc" id="astructline_html_a7ddd1d1c2be2ce5467a30c30c9a989bd"><div class="ttname"><a href="structline.html#a7ddd1d1c2be2ce5467a30c30c9a989bd">line::ipc</a></div><div class="ttdeci">int ipc</div><div class="ttdef"><b>Definition:</b> ftl.h:161</div></div>
<div class="ttc" id="aftl_8h_html_af7812108ff2c661fde06cf328637f96c"><div class="ttname"><a href="ftl_8h.html#af7812108ff2c661fde06cf328637f96c">nand_sec_status_t</a></div><div class="ttdeci">int nand_sec_status_t</div><div class="ttdef"><b>Definition:</b> ftl.h:72</div></div>
<div class="ttc" id="astructssdparams_html_a0eb0310790389b75f28a5b6dc272a2dc"><div class="ttname"><a href="structssdparams.html#a0eb0310790389b75f28a5b6dc272a2dc">ssdparams::secsz</a></div><div class="ttdeci">int secsz</div><div class="ttdef"><b>Definition:</b> ftl.h:111</div></div>
<div class="ttc" id="astructssdparams_html_a0a856000ec8d7d076eef4db2f1c4d87e"><div class="ttname"><a href="structssdparams.html#a0a856000ec8d7d076eef4db2f1c4d87e">ssdparams::pgs_per_lun</a></div><div class="ttdeci">int pgs_per_lun</div><div class="ttdef"><b>Definition:</b> ftl.h:140</div></div>
<div class="ttc" id="aftl_8h_html_adf764cbdea00d65edcd07bb9953ad2b7a2dbf63358e7e23749bc4332d41ec31af"><div class="ttname"><a href="ftl_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a2dbf63358e7e23749bc4332d41ec31af">USER_IO</a></div><div class="ttdeci">@ USER_IO</div><div class="ttdef"><b>Definition:</b> ftl.h:21</div></div>
<div class="ttc" id="astructssd__channel_html_a11dd1bcafa099c1d41787aeac9730aea"><div class="ttname"><a href="structssd__channel.html#a11dd1bcafa099c1d41787aeac9730aea">ssd_channel::next_ch_avail_time</a></div><div class="ttdeci">uint64_t next_ch_avail_time</div><div class="ttdef"><b>Definition:</b> ftl.h:105</div></div>
<div class="ttc" id="aftl_8h_html_a06fc87d81c62e9abb8790b6e5713c55ba473c2d5e1315210c6973d46d1a06d895"><div class="ttname"><a href="ftl_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba473c2d5e1315210c6973d46d1a06d895">NAND_PROG_LATENCY</a></div><div class="ttdeci">@ NAND_PROG_LATENCY</div><div class="ttdef"><b>Definition:</b> ftl.h:16</div></div>
<div class="ttc" id="astructwrite__pointer_html"><div class="ttname"><a href="structwrite__pointer.html">write_pointer</a></div><div class="ttdef"><b>Definition:</b> ftl.h:169</div></div>
<div class="ttc" id="astructnand__cmd_html_ac07e681b9811d160def06261529461c2"><div class="ttname"><a href="structnand__cmd.html#ac07e681b9811d160def06261529461c2">nand_cmd::cmd</a></div><div class="ttdeci">int cmd</div><div class="ttdef"><b>Definition:</b> ftl.h:193</div></div>
<div class="ttc" id="aftl_8c_html_a8610a939b22b60851e3b88e0137b7ede"><div class="ttname"><a href="ftl_8c.html#a8610a939b22b60851e3b88e0137b7ede">ssd_write</a></div><div class="ttdeci">static uint64_t ssd_write(struct ssd *ssd, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> ftl.c:806</div></div>
<div class="ttc" id="astructnand__plane_html_a178c78d74aad32ee73f5101bbe5d3af0"><div class="ttname"><a href="structnand__plane.html#a178c78d74aad32ee73f5101bbe5d3af0">nand_plane::blk</a></div><div class="ttdeci">struct nand_block * blk</div><div class="ttdef"><b>Definition:</b> ftl.h:90</div></div>
<div class="ttc" id="astructFemuCtrl_html_ad818a28bdef83c4bb07c0d4f00942b06"><div class="ttname"><a href="structFemuCtrl.html#ad818a28bdef83c4bb07c0d4f00942b06">FemuCtrl::to_poller</a></div><div class="ttdeci">struct rte_ring ** to_poller</div><div class="ttdef"><b>Definition:</b> nvme.h:1313</div></div>
<div class="ttc" id="astructssdparams_html_a102161652bd1f9143443bb42c583005d"><div class="ttname"><a href="structssdparams.html#a102161652bd1f9143443bb42c583005d">ssdparams::pls_per_lun</a></div><div class="ttdeci">int pls_per_lun</div><div class="ttdef"><b>Definition:</b> ftl.h:115</div></div>
<div class="ttc" id="astructNvmeRequest_html_a135bf3cba23f12bad28c20805a8f5d93"><div class="ttname"><a href="structNvmeRequest.html#a135bf3cba23f12bad28c20805a8f5d93">NvmeRequest::expire_time</a></div><div class="ttdeci">int64_t expire_time</div><div class="ttdef"><b>Definition:</b> nvme.h:984</div></div>
<div class="ttc" id="astructssdparams_html_a93143586362c365e97e39c4b544807ca"><div class="ttname"><a href="structssdparams.html#a93143586362c365e97e39c4b544807ca">ssdparams::secs_per_pg</a></div><div class="ttdeci">int secs_per_pg</div><div class="ttdef"><b>Definition:</b> ftl.h:112</div></div>
<div class="ttc" id="astructssdparams_html_ac2e75971628c7789c5b492a304a56053"><div class="ttname"><a href="structssdparams.html#ac2e75971628c7789c5b492a304a56053">ssdparams::pgs_per_blk</a></div><div class="ttdeci">int pgs_per_blk</div><div class="ttdef"><b>Definition:</b> ftl.h:113</div></div>
<div class="ttc" id="astructssdparams_html_abd6475e516ca9a5b1250d32c52853951"><div class="ttname"><a href="structssdparams.html#abd6475e516ca9a5b1250d32c52853951">ssdparams::pgs_per_pl</a></div><div class="ttdeci">int pgs_per_pl</div><div class="ttdef"><b>Definition:</b> ftl.h:139</div></div>
<div class="ttc" id="aftl_8h_html_ae75f0eba5aa21c83a6590b869a55d152"><div class="ttname"><a href="ftl_8h.html#ae75f0eba5aa21c83a6590b869a55d152">ftl_assert</a></div><div class="ttdeci">#define ftl_assert(expression)</div><div class="ttdef"><b>Definition:</b> ftl.h:234</div></div>
<div class="ttc" id="astructssdparams_html_a09e04352d7b5b2e8f9bb011a37204e3c"><div class="ttname"><a href="structssdparams.html#a09e04352d7b5b2e8f9bb011a37204e3c">ssdparams::pgs_per_line</a></div><div class="ttdeci">int pgs_per_line</div><div class="ttdef"><b>Definition:</b> ftl.h:149</div></div>
<div class="ttc" id="astructssdparams_html_ad1cdb78c795ddac6af6b213977a97719"><div class="ttname"><a href="structssdparams.html#ad1cdb78c795ddac6af6b213977a97719">ssdparams::tt_secs</a></div><div class="ttdeci">int tt_secs</div><div class="ttdef"><b>Definition:</b> ftl.h:137</div></div>
<div class="ttc" id="astructppa_html"><div class="ttname"><a href="structppa.html">ppa</a></div><div class="ttdef"><b>Definition:</b> ftl.h:56</div></div>
<div class="ttc" id="aftl_8c_html_a52df9249316530eb887e0412ca51f048"><div class="ttname"><a href="ftl_8c.html#a52df9249316530eb887e0412ca51f048">ssd_advance_write_pointer</a></div><div class="ttdeci">static void ssd_advance_write_pointer(struct ssd *ssd)</div><div class="ttdef"><b>Definition:</b> ftl.c:157</div></div>
<div class="ttc" id="aftl_8c_html_ab36d3c54cb8e6ef53588b549a5803172"><div class="ttname"><a href="ftl_8c.html#ab36d3c54cb8e6ef53588b549a5803172">victim_line_cmp_pri</a></div><div class="ttdeci">static int victim_line_cmp_pri(pqueue_pri_t next, pqueue_pri_t curr)</div><div class="ttdef"><b>Definition:</b> ftl.c:59</div></div>
<div class="ttc" id="anvme_8h_html_a01e3a918ff89282c841471f5d797fbf6a13421e16e166f06ef616c86258232336"><div class="ttname"><a href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a13421e16e166f06ef616c86258232336">NVME_CMD_READ</a></div><div class="ttdeci">@ NVME_CMD_READ</div><div class="ttdef"><b>Definition:</b> nvme.h:335</div></div>
<div class="ttc" id="aftl_8h_html_adee7fac1ed803808b8fb7ee9ffa785d2"><div class="ttname"><a href="ftl_8h.html#adee7fac1ed803808b8fb7ee9ffa785d2">ftl_debug</a></div><div class="ttdeci">#define ftl_debug(fmt,...)</div><div class="ttdef"><b>Definition:</b> ftl.h:219</div></div>
<div class="ttc" id="astructssdparams_html"><div class="ttname"><a href="structssdparams.html">ssdparams</a></div><div class="ttdef"><b>Definition:</b> ftl.h:110</div></div>
<div class="ttc" id="arte__ring_8h_html_a96ef17a77ac3deecdb8a1fb71b6bdf63"><div class="ttname"><a href="rte__ring_8h.html#a96ef17a77ac3deecdb8a1fb71b6bdf63">femu_ring_count</a></div><div class="ttdeci">size_t femu_ring_count(struct rte_ring *ring)</div><div class="ttdef"><b>Definition:</b> rte_ring.c:218</div></div>
<div class="ttc" id="astructNvmeRequest_html_a35d73ae4b2cd7c17e55d20320ac2b1ea"><div class="ttname"><a href="structNvmeRequest.html#a35d73ae4b2cd7c17e55d20320ac2b1ea">NvmeRequest::slba</a></div><div class="ttdeci">uint64_t slba</div><div class="ttdef"><b>Definition:</b> nvme.h:966</div></div>
<div class="ttc" id="aftl_8c_html_a340d3d702f25d601cb40dbd85a30dd82"><div class="ttname"><a href="ftl_8c.html#a340d3d702f25d601cb40dbd85a30dd82">get_blk</a></div><div class="ttdeci">static struct nand_block * get_blk(struct ssd *ssd, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:439</div></div>
<div class="ttc" id="astructssdparams_html_a957528e972891b69b89040996b061527"><div class="ttname"><a href="structssdparams.html#a957528e972891b69b89040996b061527">ssdparams::secs_per_blk</a></div><div class="ttdeci">int secs_per_blk</div><div class="ttdef"><b>Definition:</b> ftl.h:133</div></div>
<div class="ttc" id="astructssd__channel_html_a8004398246e9bc2a7e48a71d1b58d90f"><div class="ttname"><a href="structssd__channel.html#a8004398246e9bc2a7e48a71d1b58d90f">ssd_channel::nluns</a></div><div class="ttdeci">int nluns</div><div class="ttdef"><b>Definition:</b> ftl.h:104</div></div>
<div class="ttc" id="astructnand__plane_html_a69781959f7bed3aca9a31a7d2560866a"><div class="ttname"><a href="structnand__plane.html#a69781959f7bed3aca9a31a7d2560866a">nand_plane::nblks</a></div><div class="ttdeci">int nblks</div><div class="ttdef"><b>Definition:</b> ftl.h:91</div></div>
<div class="ttc" id="astructnand__lun_html_acdcba71a2176a0bb94eba9bdb24b36fe"><div class="ttname"><a href="structnand__lun.html#acdcba71a2176a0bb94eba9bdb24b36fe">nand_lun::next_lun_avail_time</a></div><div class="ttdeci">uint64_t next_lun_avail_time</div><div class="ttdef"><b>Definition:</b> ftl.h:97</div></div>
<div class="ttc" id="aftl_8c_html_afd1c030b3a24f516a3eda967bb936f8d"><div class="ttname"><a href="ftl_8c.html#afd1c030b3a24f516a3eda967bb936f8d">ssd_init_nand_blk</a></div><div class="ttdeci">static void ssd_init_nand_blk(struct nand_block *blk, struct ssdparams *spp)</div><div class="ttdef"><b>Definition:</b> ftl.c:299</div></div>
<div class="ttc" id="astructssd_html_a2b0e9503ff5811ff40f5b426d137692e"><div class="ttname"><a href="structssd.html#a2b0e9503ff5811ff40f5b426d137692e">ssd::dataplane_started_ptr</a></div><div class="ttdeci">bool * dataplane_started_ptr</div><div class="ttdef"><b>Definition:</b> ftl.h:209</div></div>
<div class="ttc" id="aftl_8c_html_af93eee663d18640559cfd06afdeb5409"><div class="ttname"><a href="ftl_8c.html#af93eee663d18640559cfd06afdeb5409">get_maptbl_ent</a></div><div class="ttdeci">static struct ppa get_maptbl_ent(struct ssd *ssd, uint64_t lpn)</div><div class="ttdef"><b>Definition:</b> ftl.c:17</div></div>
<div class="ttc" id="astructwrite__pointer_html_aac27e9340ffc7900b39c57731fa61dc0"><div class="ttname"><a href="structwrite__pointer.html#aac27e9340ffc7900b39c57731fa61dc0">write_pointer::lun</a></div><div class="ttdeci">int lun</div><div class="ttdef"><b>Definition:</b> ftl.h:172</div></div>
<div class="ttc" id="astructline__mgmt_html_ade69f28e6b03baac256cd1646f95b3d8"><div class="ttname"><a href="structline__mgmt.html#ade69f28e6b03baac256cd1646f95b3d8">line_mgmt::victim_line_pq</a></div><div class="ttdeci">pqueue_t * victim_line_pq</div><div class="ttdef"><b>Definition:</b> ftl.h:182</div></div>
<div class="ttc" id="aftl_8c_html_adc3fd6a4f50d3279de8a77eb9d605a8d"><div class="ttname"><a href="ftl_8c.html#adc3fd6a4f50d3279de8a77eb9d605a8d">get_lun</a></div><div class="ttdeci">static struct nand_lun * get_lun(struct ssd *ssd, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:427</div></div>
<div class="ttc" id="astructNvmeRequest_html"><div class="ttname"><a href="structNvmeRequest.html">NvmeRequest</a></div><div class="ttdef"><b>Definition:</b> nvme.h:961</div></div>
<div class="ttc" id="aftl_8c_html_a37afec234fedd2c392569d5ce0af6cb4"><div class="ttname"><a href="ftl_8c.html#a37afec234fedd2c392569d5ce0af6cb4">ssd_init_write_pointer</a></div><div class="ttdeci">static void ssd_init_write_pointer(struct ssd *ssd)</div><div class="ttdef"><b>Definition:</b> ftl.c:117</div></div>
<div class="ttc" id="aftl_8c_html_aa4643e6bbe68de1c047ec1d1745a82e3"><div class="ttname"><a href="ftl_8c.html#aa4643e6bbe68de1c047ec1d1745a82e3">ssd_init_ch</a></div><div class="ttdeci">static void ssd_init_ch(struct ssd_channel *ch, struct ssdparams *spp)</div><div class="ttdef"><b>Definition:</b> ftl.c:332</div></div>
<div class="ttc" id="astructline_html_aea4a6b372d188d62345ed68656fff577"><div class="ttname"><a href="structline.html#aea4a6b372d188d62345ed68656fff577">line::id</a></div><div class="ttdeci">int id</div><div class="ttdef"><b>Definition:</b> ftl.h:160</div></div>
<div class="ttc" id="astructline__mgmt_html_ab3da4f318464b294f5ad5179a0aa7b24"><div class="ttname"><a href="structline__mgmt.html#ab3da4f318464b294f5ad5179a0aa7b24">line_mgmt::free_line_cnt</a></div><div class="ttdeci">int free_line_cnt</div><div class="ttdef"><b>Definition:</b> ftl.h:186</div></div>
<div class="ttc" id="astructssd_html_a36c0adb782ca9d8a1accf3ec8d7455eb"><div class="ttname"><a href="structssd.html#a36c0adb782ca9d8a1accf3ec8d7455eb">ssd::sp</a></div><div class="ttdeci">struct ssdparams sp</div><div class="ttdef"><b>Definition:</b> ftl.h:199</div></div>
<div class="ttc" id="astructnand__page_html_adc5fd9020df058246b2789b00f7f6609"><div class="ttname"><a href="structnand__page.html#adc5fd9020df058246b2789b00f7f6609">nand_page::sec</a></div><div class="ttdeci">nand_sec_status_t * sec</div><div class="ttdef"><b>Definition:</b> ftl.h:75</div></div>
<div class="ttc" id="astructssd_html_af1863ea3d676d7f2a9db127e2ced4c87"><div class="ttname"><a href="structssd.html#af1863ea3d676d7f2a9db127e2ced4c87">ssd::to_ftl</a></div><div class="ttdeci">struct rte_ring ** to_ftl</div><div class="ttdef"><b>Definition:</b> ftl.h:207</div></div>
<div class="ttc" id="aftl_8h_html_a1ff9f42f3e3d46b878b713654eab99b7"><div class="ttname"><a href="ftl_8h.html#a1ff9f42f3e3d46b878b713654eab99b7">INVALID_LPN</a></div><div class="ttdeci">#define INVALID_LPN</div><div class="ttdef"><b>Definition:</b> ftl.h:7</div></div>
<div class="ttc" id="aftl_8h_html_a99fb83031ce9923c84392b4e92f956b5a46fea2e65406af489e63ac526c7553db"><div class="ttname"><a href="ftl_8h.html#a99fb83031ce9923c84392b4e92f956b5a46fea2e65406af489e63ac526c7553db">PG_INVALID</a></div><div class="ttdeci">@ PG_INVALID</div><div class="ttdef"><b>Definition:</b> ftl.h:31</div></div>
<div class="ttc" id="aftl_8c_html_ae4d530364d4008be453c27d200eacddf"><div class="ttname"><a href="ftl_8c.html#ae4d530364d4008be453c27d200eacddf">clean_one_block</a></div><div class="ttdeci">static void clean_one_block(struct ssd *ssd, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:691</div></div>
<div class="ttc" id="aftl_8c_html_a4237c1400d2e5e24f32b77e347163ab9"><div class="ttname"><a href="ftl_8c.html#a4237c1400d2e5e24f32b77e347163ab9">valid_ppa</a></div><div class="ttdeci">static bool valid_ppa(struct ssd *ssd, struct ppa *ppa)</div><div class="ttdef"><b>Definition:</b> ftl.c:394</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_327f2e1a2fad6d8049b1e90f819f6dfc.html">bbssd</a></li><li class="navelem"><a class="el" href="ftl_8c.html">ftl.c</a></li>
    <li class="footer">制作者
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
