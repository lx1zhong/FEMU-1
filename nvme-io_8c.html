<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FEMU: nvme-io.c 文件参考</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FEMU
   &#160;<span id="projectnumber">原版 master 7e238cc</span>
   </div>
   <div id="projectbrief">FEMU: Accurate, Scalable and Extensible NVMe SSD Emulator (FAST&#39;18)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('nvme-io_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">函数</a>  </div>
  <div class="headertitle">
<div class="title">nvme-io.c 文件参考</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="nvme_8h_source.html">./nvme.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
nvme-io.c 的引用(Include)关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c__incl.png" border="0" usemap="#nvme-io_8c" alt=""/></div>
<map name="nvme-io_8c" id="nvme-io_8c">
<area shape="rect" title=" " alt="" coords="893,5,979,32"/>
<area shape="rect" href="nvme_8h.html" title=" " alt="" coords="897,80,975,107"/>
<area shape="rect" title=" " alt="" coords="5,155,120,181"/>
<area shape="rect" title=" " alt="" coords="145,155,247,181"/>
<area shape="rect" title=" " alt="" coords="272,155,379,181"/>
<area shape="rect" title=" " alt="" coords="403,155,514,181"/>
<area shape="rect" title=" " alt="" coords="539,155,651,181"/>
<area shape="rect" title=" " alt="" coords="675,155,779,181"/>
<area shape="rect" title=" " alt="" coords="803,155,933,181"/>
<area shape="rect" title=" " alt="" coords="957,155,1053,181"/>
<area shape="rect" title=" " alt="" coords="1078,155,1197,181"/>
<area shape="rect" href="dram_8h.html" title=" " alt="" coords="1221,155,1347,181"/>
<area shape="rect" href="rte__ring_8h.html" title=" " alt="" coords="1372,155,1479,181"/>
<area shape="rect" href="pqueue_8h.html" title="Priority Queue function declarations" alt="" coords="1503,155,1609,181"/>
<area shape="rect" href="nand_8h.html" title=" " alt="" coords="1633,155,1735,181"/>
<area shape="rect" href="timing_8h.html" title=" " alt="" coords="1760,155,1928,181"/>
<area shape="rect" title=" " alt="" coords="1134,229,1205,256"/>
<area shape="rect" title=" " alt="" coords="1229,229,1296,256"/>
<area shape="rect" title=" " alt="" coords="1321,229,1421,256"/>
<area shape="rect" title=" " alt="" coords="1445,229,1513,256"/>
<area shape="rect" title=" " alt="" coords="1537,229,1639,256"/>
<area shape="rect" href="rte__atomic__x86_8h.html" title=" " alt="" coords="1663,229,1798,256"/>
<area shape="rect" href="rte__branch__prediction_8h.html" title=" " alt="" coords="1822,229,1997,256"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
函数</h2></td></tr>
<tr class="memitem:ae6d2b4ae7957a876e1e221b7f2ee1fb8"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#ae6d2b4ae7957a876e1e221b7f2ee1fb8">nvme_io_cmd</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeCmd.html">NvmeCmd</a> *cmd, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:ae6d2b4ae7957a876e1e221b7f2ee1fb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8cac05ad399a3b98a28abe2c89b5509"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#aa8cac05ad399a3b98a28abe2c89b5509">nvme_update_sq_eventidx</a> (const <a class="el" href="structNvmeSQueue.html">NvmeSQueue</a> *sq)</td></tr>
<tr class="separator:aa8cac05ad399a3b98a28abe2c89b5509"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9fdaa77f86c065d69d158184951be32"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#aa9fdaa77f86c065d69d158184951be32">nvme_copy_cmd</a> (<a class="el" href="structNvmeCmd.html">NvmeCmd</a> *dst, <a class="el" href="structNvmeCmd.html">NvmeCmd</a> *src)</td></tr>
<tr class="separator:aa9fdaa77f86c065d69d158184951be32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa8fe64369c3e7b33785cabed5a4cbde"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#aaa8fe64369c3e7b33785cabed5a4cbde">nvme_process_sq_io</a> (void *opaque, int index_poller)</td></tr>
<tr class="separator:aaa8fe64369c3e7b33785cabed5a4cbde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa412c2f46a5bc43ac2234173c9743abe"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#aa412c2f46a5bc43ac2234173c9743abe">nvme_post_cqe</a> (<a class="el" href="structNvmeCQueue.html">NvmeCQueue</a> *cq, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:aa412c2f46a5bc43ac2234173c9743abe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a581e208522e056298eed5248b50af242"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#a581e208522e056298eed5248b50af242">nvme_process_cq_cpl</a> (void *arg, int index_poller)</td></tr>
<tr class="separator:a581e208522e056298eed5248b50af242"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb7bf552fb77faee4d0aa021d51af4b7"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#acb7bf552fb77faee4d0aa021d51af4b7">nvme_poller</a> (void *arg)</td></tr>
<tr class="separator:acb7bf552fb77faee4d0aa021d51af4b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a667ab7f8de6f02e513acd0c14c0407e9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#a667ab7f8de6f02e513acd0c14c0407e9">cmp_pri</a> (<a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a> next, <a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a> curr)</td></tr>
<tr class="separator:a667ab7f8de6f02e513acd0c14c0407e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d0ede8cb67c2a87a6af7ba60b878b86"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#a4d0ede8cb67c2a87a6af7ba60b878b86">get_pri</a> (void *a)</td></tr>
<tr class="separator:a4d0ede8cb67c2a87a6af7ba60b878b86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4201ce0351a86f139fa684f7b963f867"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#a4201ce0351a86f139fa684f7b963f867">set_pri</a> (void *a, <a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a> pri)</td></tr>
<tr class="separator:a4201ce0351a86f139fa684f7b963f867"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b5cc5f1e45642543fa0bfe8db2dd428"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#a2b5cc5f1e45642543fa0bfe8db2dd428">get_pos</a> (void *a)</td></tr>
<tr class="separator:a2b5cc5f1e45642543fa0bfe8db2dd428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3708eed16007bc4b715785d1ea06cd0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#af3708eed16007bc4b715785d1ea06cd0">set_pos</a> (void *a, size_t pos)</td></tr>
<tr class="separator:af3708eed16007bc4b715785d1ea06cd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81f7e8af7ddcdfe9bef6af6c0333462d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#a81f7e8af7ddcdfe9bef6af6c0333462d">nvme_create_poller</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n)</td></tr>
<tr class="separator:a81f7e8af7ddcdfe9bef6af6c0333462d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57765d5f7b83e5c6af69f1f5c501beb7"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#a57765d5f7b83e5c6af69f1f5c501beb7">nvme_rw</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeCmd.html">NvmeCmd</a> *cmd, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:a57765d5f7b83e5c6af69f1f5c501beb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1f6c99fbfdd8d6c788ee82c6d13086d"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#ae1f6c99fbfdd8d6c788ee82c6d13086d">nvme_dsm</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeCmd.html">NvmeCmd</a> *cmd, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:ae1f6c99fbfdd8d6c788ee82c6d13086d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ea0938f847741b1399583080d7bd9ae"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#a1ea0938f847741b1399583080d7bd9ae">nvme_compare</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeCmd.html">NvmeCmd</a> *cmd, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:a1ea0938f847741b1399583080d7bd9ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ecae506951d74f3dc9826f76e133d81"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#a0ecae506951d74f3dc9826f76e133d81">nvme_flush</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeCmd.html">NvmeCmd</a> *cmd, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:a0ecae506951d74f3dc9826f76e133d81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3fe0206159ec6d704c59e7393b6d85c"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#ae3fe0206159ec6d704c59e7393b6d85c">nvme_write_zeros</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeCmd.html">NvmeCmd</a> *cmd, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:ae3fe0206159ec6d704c59e7393b6d85c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a646ae4b9455eb7bf01b18eea275a2379"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#a646ae4b9455eb7bf01b18eea275a2379">nvme_write_uncor</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeCmd.html">NvmeCmd</a> *cmd, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:a646ae4b9455eb7bf01b18eea275a2379"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03a3accd495e0b00d01b80e009af5c9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvme-io_8c.html#a03a3accd495e0b00d01b80e009af5c9f">nvme_post_cqes_io</a> (void *opaque)</td></tr>
<tr class="separator:a03a3accd495e0b00d01b80e009af5c9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">函数说明</h2>
<a id="a667ab7f8de6f02e513acd0c14c0407e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a667ab7f8de6f02e513acd0c14c0407e9">&#9670;&nbsp;</a></span>cmp_pri()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int cmp_pri </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a>&#160;</td>
          <td class="paramname"><em>next</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a>&#160;</td>
          <td class="paramname"><em>curr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;{</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">return</span> (next &gt; curr);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a667ab7f8de6f02e513acd0c14c0407e9_icgraph.png" border="0" usemap="#nvme-io_8c_a667ab7f8de6f02e513acd0c14c0407e9_icgraph" alt=""/></div>
<map name="nvme-io_8c_a667ab7f8de6f02e513acd0c14c0407e9_icgraph" id="nvme-io_8c_a667ab7f8de6f02e513acd0c14c0407e9_icgraph">
<area shape="rect" title=" " alt="" coords="1275,5,1349,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="a2b5cc5f1e45642543fa0bfe8db2dd428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b5cc5f1e45642543fa0bfe8db2dd428">&#9670;&nbsp;</a></span>get_pos()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t get_pos </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;{</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">return</span> ((<a class="code" href="structNvmeRequest.html">NvmeRequest</a> *)a)-&gt;pos;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a2b5cc5f1e45642543fa0bfe8db2dd428_icgraph.png" border="0" usemap="#nvme-io_8c_a2b5cc5f1e45642543fa0bfe8db2dd428_icgraph" alt=""/></div>
<map name="nvme-io_8c_a2b5cc5f1e45642543fa0bfe8db2dd428_icgraph" id="nvme-io_8c_a2b5cc5f1e45642543fa0bfe8db2dd428_icgraph">
<area shape="rect" title=" " alt="" coords="1275,5,1348,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="a4d0ede8cb67c2a87a6af7ba60b878b86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d0ede8cb67c2a87a6af7ba60b878b86">&#9670;&nbsp;</a></span>get_pri()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a> get_pri </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;{</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">return</span> ((<a class="code" href="structNvmeRequest.html">NvmeRequest</a> *)a)-&gt;expire_time;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a4d0ede8cb67c2a87a6af7ba60b878b86_icgraph.png" border="0" usemap="#nvme-io_8c_a4d0ede8cb67c2a87a6af7ba60b878b86_icgraph" alt=""/></div>
<map name="nvme-io_8c_a4d0ede8cb67c2a87a6af7ba60b878b86_icgraph" id="nvme-io_8c_a4d0ede8cb67c2a87a6af7ba60b878b86_icgraph">
<area shape="rect" title=" " alt="" coords="1275,5,1341,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="a1ea0938f847741b1399583080d7bd9ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ea0938f847741b1399583080d7bd9ae">&#9670;&nbsp;</a></span>nvme_compare()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t nvme_compare </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeCmd.html">NvmeCmd</a> *&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;{</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *rw = (<a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *)cmd;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    uint32_t nlb  = le16_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a34ba11f86be8f5d4be5518370faf2514">nlb</a>) + 1;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    uint64_t slba = le64_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a0f256de361f51a961d5a44955321b526">slba</a>);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    uint64_t prp1 = le64_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a7bca173ee27c96f14ae009205b6fc5cd">prp1</a>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    uint64_t prp2 = le64_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a15e5effe634f6ed6e9e38e21c6111381">prp2</a>);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    uint64_t elba = slba + nlb;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    uint8_t lba_index = <a class="code" href="nvme_8h.html#a91333268a64e669e088f20aaf0bfd9b7">NVME_ID_NS_FLBAS_INDEX</a>(ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#ac2061ba91f1d2bf0282bfe22221f65a2">flbas</a>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    uint8_t data_shift = ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a751e3c19983752a5acb34244eba649e8">lbaf</a>[lba_index].<a class="code" href="structNvmeLBAF.html#ac0a10526d855cab5ceed66963c0f5a44">lbads</a>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    uint64_t data_size = nlb &lt;&lt; data_shift;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    uint64_t offset  = ns-&gt;<a class="code" href="structNvmeNamespace.html#a0ed912de2d37b54d07b1f27deb7c5bb6">start_block</a> + (slba &lt;&lt; data_shift);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span> ((slba + nlb) &gt; le64_to_cpu(ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a4a814e395ae6ea7b3b7c5cba1c22ad85">nsze</a>)) {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <a class="code" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183">nvme_set_error_page</a>(n, req-&gt;<a class="code" href="structNvmeRequest.html#a18ef977aa1abc169de646d142d6c77d9">sq</a>-&gt;<a class="code" href="structNvmeSQueue.html#ac5aa365b6e571542994f682254a5e457">sqid</a>, cmd-&gt;<a class="code" href="structNvmeCmd.html#a80a15bb450d4810749be585c66eba0af">cid</a>, <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a43aae0e0a370dd16186369148885344f">NVME_LBA_RANGE</a>,</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                            offsetof(<a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a>, nlb), elba, ns-&gt;<a class="code" href="structNvmeNamespace.html#aded48306fad86bd7ca9160443a24604d">id</a>);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a43aae0e0a370dd16186369148885344f">NVME_LBA_RANGE</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#af13a4a3fc3667cdddbd181c34378b406">id_ctrl</a>.<a class="code" href="structNvmeIdCtrl.html#a7aa6155f605fdb78fab28db981e0c5c4">mdts</a> &amp;&amp; data_size &gt; n-&gt;<a class="code" href="structFemuCtrl.html#a6d0418e38e888b2b8980a34198bfd463">page_size</a> * (1 &lt;&lt; n-&gt;<a class="code" href="structFemuCtrl.html#af13a4a3fc3667cdddbd181c34378b406">id_ctrl</a>.<a class="code" href="structNvmeIdCtrl.html#a7aa6155f605fdb78fab28db981e0c5c4">mdts</a>)) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <a class="code" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183">nvme_set_error_page</a>(n, req-&gt;<a class="code" href="structNvmeRequest.html#a18ef977aa1abc169de646d142d6c77d9">sq</a>-&gt;<a class="code" href="structNvmeSQueue.html#ac5aa365b6e571542994f682254a5e457">sqid</a>, cmd-&gt;<a class="code" href="structNvmeCmd.html#a80a15bb450d4810749be585c66eba0af">cid</a>, <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a>,</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                            offsetof(<a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a>, nlb), nlb, ns-&gt;<a class="code" href="structNvmeNamespace.html#aded48306fad86bd7ca9160443a24604d">id</a>);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493">nvme_map_prp</a>(&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a678064f3bc45fbeb366ea44aea7273b2">qsg</a>, &amp;req-&gt;<a class="code" href="structNvmeRequest.html#a22a0c24be595ec2abed21073be01efd9">iov</a>, prp1, prp2, data_size, n)) {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <a class="code" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183">nvme_set_error_page</a>(n, req-&gt;<a class="code" href="structNvmeRequest.html#a18ef977aa1abc169de646d142d6c77d9">sq</a>-&gt;<a class="code" href="structNvmeSQueue.html#ac5aa365b6e571542994f682254a5e457">sqid</a>, cmd-&gt;<a class="code" href="structNvmeCmd.html#a80a15bb450d4810749be585c66eba0af">cid</a>, <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a>,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                            offsetof(<a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a>, prp1), 0, ns-&gt;<a class="code" href="structNvmeNamespace.html#aded48306fad86bd7ca9160443a24604d">id</a>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">if</span> (find_next_bit(ns-&gt;<a class="code" href="structNvmeNamespace.html#a82fb6235b209c097c887181151ad33a1">uncorrectable</a>, elba, slba) &lt; elba) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a5157ff55aedb970b020e6602903bd46a">NVME_UNRECOVERED_READ</a>;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; req-&gt;<a class="code" href="structNvmeRequest.html#a678064f3bc45fbeb366ea44aea7273b2">qsg</a>.nsg; i++) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        uint32_t len = req-&gt;<a class="code" href="structNvmeRequest.html#a678064f3bc45fbeb366ea44aea7273b2">qsg</a>.sg[i].len;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        uint8_t tmp[2][len];</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <a class="code" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484">nvme_addr_read</a>(n, req-&gt;<a class="code" href="structNvmeRequest.html#a678064f3bc45fbeb366ea44aea7273b2">qsg</a>.sg[i].base, tmp[1], len);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">if</span> (memcmp(tmp[0], tmp[1], len)) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            qemu_sglist_destroy(&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a678064f3bc45fbeb366ea44aea7273b2">qsg</a>);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4af18fa6d57f0141bce4f99d6e19965635">NVME_CMP_FAILURE</a>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        offset += len;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    qemu_sglist_destroy(&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a678064f3bc45fbeb366ea44aea7273b2">qsg</a>);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a1ea0938f847741b1399583080d7bd9ae_cgraph.png" border="0" usemap="#nvme-io_8c_a1ea0938f847741b1399583080d7bd9ae_cgraph" alt=""/></div>
<map name="nvme-io_8c_a1ea0938f847741b1399583080d7bd9ae_cgraph" id="nvme-io_8c_a1ea0938f847741b1399583080d7bd9ae_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,128,57"/>
<area shape="rect" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484" title=" " alt="" coords="387,5,517,32"/>
<area shape="rect" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493" title=" " alt="" coords="196,31,319,57"/>
<area shape="rect" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183" title=" " alt="" coords="176,81,339,108"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a1ea0938f847741b1399583080d7bd9ae_icgraph.png" border="0" usemap="#nvme-io_8c_a1ea0938f847741b1399583080d7bd9ae_icgraph" alt=""/></div>
<map name="nvme-io_8c_a1ea0938f847741b1399583080d7bd9ae_icgraph" id="nvme-io_8c_a1ea0938f847741b1399583080d7bd9ae_icgraph">
<area shape="rect" title=" " alt="" coords="1792,5,1915,32"/>
<area shape="rect" href="nvme-io_8c.html#ae6d2b4ae7957a876e1e221b7f2ee1fb8" title=" " alt="" coords="1631,5,1744,32"/>
<area shape="rect" href="nvme-io_8c.html#aaa8fe64369c3e7b33785cabed5a4cbde" title=" " alt="" coords="1425,5,1583,32"/>
<area shape="rect" href="nvme-io_8c.html#acb7bf552fb77faee4d0aa021d51af4b7" title=" " alt="" coords="1275,5,1377,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="aa9fdaa77f86c065d69d158184951be32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9fdaa77f86c065d69d158184951be32">&#9670;&nbsp;</a></span>nvme_copy_cmd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void nvme_copy_cmd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeCmd.html">NvmeCmd</a> *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeCmd.html">NvmeCmd</a> *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#if defined(__AVX__)</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    __m256i *d256 = (__m256i *)dst;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keyword">const</span> __m256i *s256 = (<span class="keyword">const</span> __m256i *)src;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    _mm256_store_si256(&amp;d256[0], _mm256_load_si256(&amp;s256[0]));</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    _mm256_store_si256(&amp;d256[1], _mm256_load_si256(&amp;s256[1]));</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#elif defined(__SSE2__)</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    __m128i *d128 = (__m128i *)dst;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keyword">const</span> __m128i *s128 = (<span class="keyword">const</span> __m128i *)src;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    _mm_store_si128(&amp;d128[0], _mm_load_si128(&amp;s128[0]));</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    _mm_store_si128(&amp;d128[1], _mm_load_si128(&amp;s128[1]));</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    _mm_store_si128(&amp;d128[2], _mm_load_si128(&amp;s128[2]));</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    _mm_store_si128(&amp;d128[3], _mm_load_si128(&amp;s128[3]));</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    *dst = *src;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_aa9fdaa77f86c065d69d158184951be32_icgraph.png" border="0" usemap="#nvme-io_8c_aa9fdaa77f86c065d69d158184951be32_icgraph" alt=""/></div>
<map name="nvme-io_8c_aa9fdaa77f86c065d69d158184951be32_icgraph" id="nvme-io_8c_aa9fdaa77f86c065d69d158184951be32_icgraph">
<area shape="rect" title=" " alt="" coords="1631,5,1763,32"/>
<area shape="rect" href="nvme-io_8c.html#aaa8fe64369c3e7b33785cabed5a4cbde" title=" " alt="" coords="1425,5,1583,32"/>
<area shape="rect" href="nvme-io_8c.html#acb7bf552fb77faee4d0aa021d51af4b7" title=" " alt="" coords="1275,5,1377,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="a81f7e8af7ddcdfe9bef6af6c0333462d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81f7e8af7ddcdfe9bef6af6c0333462d">&#9670;&nbsp;</a></span>nvme_create_poller()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nvme_create_poller </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;{</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#a78003b6c4ed89a589c99c4b01b9c689a">should_isr</a> = g_malloc0(<span class="keyword">sizeof</span>(<span class="keywordtype">bool</span>) * (n-&gt;<a class="code" href="structFemuCtrl.html#ab09f359cd5d2e1882bd8a04046becf28">num_io_queues</a> + 1));</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#a78baba4717dd495d81af587a1a95a0b7">num_poller</a> = n-&gt;<a class="code" href="structFemuCtrl.html#a6635a90258a97f71c6040b6cb9277b04">multipoller_enabled</a> ? n-&gt;<a class="code" href="structFemuCtrl.html#ab09f359cd5d2e1882bd8a04046becf28">num_io_queues</a> : 1;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">/* Coperd: we put NvmeRequest into these rings */</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#a0ff7c6d5e0e6313cc66e2d62f4e98221">to_ftl</a> = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__ring.html">rte_ring</a> *) * (n-&gt;<a class="code" href="structFemuCtrl.html#a78baba4717dd495d81af587a1a95a0b7">num_poller</a> + 1));</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= n-&gt;<a class="code" href="structFemuCtrl.html#a78baba4717dd495d81af587a1a95a0b7">num_poller</a>; i++) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        n-&gt;<a class="code" href="structFemuCtrl.html#a0ff7c6d5e0e6313cc66e2d62f4e98221">to_ftl</a>[i] = <a class="code" href="rte__ring_8h.html#a6bc92444f7239ca27c5a89de99f5f4ac">femu_ring_create</a>(<a class="code" href="rte__ring_8h.html#a40c2b32849ee40a3926720f2ab1cdec7ad2388957eaf21c85bc07f6044f60af88">FEMU_RING_TYPE_MP_SC</a>, <a class="code" href="nvme_8h.html#a01b07373e5d8f8cc9e893a36a01abe9b">FEMU_MAX_INF_REQS</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">if</span> (!n-&gt;<a class="code" href="structFemuCtrl.html#a0ff7c6d5e0e6313cc66e2d62f4e98221">to_ftl</a>[i]) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;failed to create ring (n-&gt;to_ftl) ...\n&quot;</span>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            abort();</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        assert(<a class="code" href="rte__ring_8h.html#abf9a7cda8ef5a62ee0a286c11d45d1bf">rte_ring_empty</a>(n-&gt;<a class="code" href="structFemuCtrl.html#a0ff7c6d5e0e6313cc66e2d62f4e98221">to_ftl</a>[i]));</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#ad818a28bdef83c4bb07c0d4f00942b06">to_poller</a> = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structrte__ring.html">rte_ring</a> *) * (n-&gt;<a class="code" href="structFemuCtrl.html#a78baba4717dd495d81af587a1a95a0b7">num_poller</a> + 1));</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= n-&gt;<a class="code" href="structFemuCtrl.html#a78baba4717dd495d81af587a1a95a0b7">num_poller</a>; i++) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        n-&gt;<a class="code" href="structFemuCtrl.html#ad818a28bdef83c4bb07c0d4f00942b06">to_poller</a>[i] = <a class="code" href="rte__ring_8h.html#a6bc92444f7239ca27c5a89de99f5f4ac">femu_ring_create</a>(<a class="code" href="rte__ring_8h.html#a40c2b32849ee40a3926720f2ab1cdec7ad2388957eaf21c85bc07f6044f60af88">FEMU_RING_TYPE_MP_SC</a>, <a class="code" href="nvme_8h.html#a01b07373e5d8f8cc9e893a36a01abe9b">FEMU_MAX_INF_REQS</a>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">if</span> (!n-&gt;<a class="code" href="structFemuCtrl.html#ad818a28bdef83c4bb07c0d4f00942b06">to_poller</a>[i]) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;failed to create ring (n-&gt;to_poller) ...\n&quot;</span>);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            abort();</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        assert(<a class="code" href="rte__ring_8h.html#abf9a7cda8ef5a62ee0a286c11d45d1bf">rte_ring_empty</a>(n-&gt;<a class="code" href="structFemuCtrl.html#ad818a28bdef83c4bb07c0d4f00942b06">to_poller</a>[i]));</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#a3b6bdba05fa2cf581ace5cc08cd365f5">pq</a> = malloc(<span class="keyword">sizeof</span>(<a class="code" href="structpqueue__t.html">pqueue_t</a> *) * (n-&gt;<a class="code" href="structFemuCtrl.html#a78baba4717dd495d81af587a1a95a0b7">num_poller</a> + 1));</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= n-&gt;<a class="code" href="structFemuCtrl.html#a78baba4717dd495d81af587a1a95a0b7">num_poller</a>; i++) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        n-&gt;<a class="code" href="structFemuCtrl.html#a3b6bdba05fa2cf581ace5cc08cd365f5">pq</a>[i] = <a class="code" href="pqueue_8h.html#a2c27c13ed1c988e9fc7b259e6820ca8c">pqueue_init</a>(<a class="code" href="nvme_8h.html#a01b07373e5d8f8cc9e893a36a01abe9b">FEMU_MAX_INF_REQS</a>, <a class="code" href="nvme-io_8c.html#a667ab7f8de6f02e513acd0c14c0407e9">cmp_pri</a>, <a class="code" href="nvme-io_8c.html#a4d0ede8cb67c2a87a6af7ba60b878b86">get_pri</a>, <a class="code" href="nvme-io_8c.html#a4201ce0351a86f139fa684f7b963f867">set_pri</a>,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                               <a class="code" href="nvme-io_8c.html#a2b5cc5f1e45642543fa0bfe8db2dd428">get_pos</a>, <a class="code" href="nvme-io_8c.html#af3708eed16007bc4b715785d1ea06cd0">set_pos</a>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">if</span> (!n-&gt;<a class="code" href="structFemuCtrl.html#a3b6bdba05fa2cf581ace5cc08cd365f5">pq</a>[i]) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;failed to create pqueue (n-&gt;pq) ...\n&quot;</span>);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            abort();</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#a226acb27573ba9226d9a426b95bfca20">poller</a> = malloc(<span class="keyword">sizeof</span>(QemuThread) * (n-&gt;<a class="code" href="structFemuCtrl.html#a78baba4717dd495d81af587a1a95a0b7">num_poller</a> + 1));</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="structNvmePollerThreadArgument.html">NvmePollerThreadArgument</a> *args = malloc(<span class="keyword">sizeof</span>(<a class="code" href="structNvmePollerThreadArgument.html">NvmePollerThreadArgument</a>) *</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                            (n-&gt;<a class="code" href="structFemuCtrl.html#a78baba4717dd495d81af587a1a95a0b7">num_poller</a> + 1));</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= n-&gt;<a class="code" href="structFemuCtrl.html#a78baba4717dd495d81af587a1a95a0b7">num_poller</a>; i++) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        args[i].<a class="code" href="structNvmePollerThreadArgument.html#abdda07e6f64edaf6ed07493d5197d464">n</a> = n;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        args[i].<a class="code" href="structNvmePollerThreadArgument.html#ae6811a13fb3be05ceb56110fb5882be4">index</a> = i;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        qemu_thread_create(&amp;n-&gt;<a class="code" href="structFemuCtrl.html#a226acb27573ba9226d9a426b95bfca20">poller</a>[i], <span class="stringliteral">&quot;nvme-poller&quot;</span>, <a class="code" href="nvme-io_8c.html#acb7bf552fb77faee4d0aa021d51af4b7">nvme_poller</a>, &amp;args[i],</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                           QEMU_THREAD_JOINABLE);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <a class="code" href="nvme_8h.html#aef2bfc05ccbdba79aef90226efe46ad4">femu_debug</a>(<span class="stringliteral">&quot;nvme-poller [%d] created ...\n&quot;</span>, i - 1);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    }</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a81f7e8af7ddcdfe9bef6af6c0333462d_cgraph.png" border="0" usemap="#nvme-io_8c_a81f7e8af7ddcdfe9bef6af6c0333462d_cgraph" alt=""/></div>
<map name="nvme-io_8c_a81f7e8af7ddcdfe9bef6af6c0333462d_cgraph" id="nvme-io_8c_a81f7e8af7ddcdfe9bef6af6c0333462d_cgraph">
<area shape="rect" title=" " alt="" coords="5,271,156,297"/>
<area shape="rect" href="nvme-io_8c.html#a667ab7f8de6f02e513acd0c14c0407e9" title=" " alt="" coords="235,68,309,95"/>
<area shape="rect" href="rte__ring_8h.html#a6bc92444f7239ca27c5a89de99f5f4ac" title=" " alt="" coords="204,119,340,145"/>
<area shape="rect" href="nvme-io_8c.html#a2b5cc5f1e45642543fa0bfe8db2dd428" title=" " alt="" coords="235,169,309,196"/>
<area shape="rect" href="nvme-io_8c.html#a4d0ede8cb67c2a87a6af7ba60b878b86" title=" " alt="" coords="239,220,305,247"/>
<area shape="rect" href="nvme-io_8c.html#acb7bf552fb77faee4d0aa021d51af4b7" title=" " alt="" coords="221,321,323,348"/>
<area shape="rect" href="pqueue_8h.html#a2c27c13ed1c988e9fc7b259e6820ca8c" title=" " alt="" coords="223,372,321,399"/>
<area shape="rect" href="rte__ring_8h.html#abf9a7cda8ef5a62ee0a286c11d45d1bf" title=" " alt="" coords="409,220,531,247"/>
<area shape="rect" href="nvme-io_8c.html#af3708eed16007bc4b715785d1ea06cd0" title=" " alt="" coords="236,423,308,449"/>
<area shape="rect" href="nvme-io_8c.html#a4201ce0351a86f139fa684f7b963f867" title=" " alt="" coords="239,473,305,500"/>
<area shape="rect" href="rte__ring_8c.html#a122812947c00f9ed3066232accf5fa5a" title=" " alt="" coords="410,81,530,108"/>
<area shape="rect" href="rte__ring_8h.html#a5a85fd1038be9376de166494057e6aa1" title=" " alt="" coords="868,95,999,121"/>
<area shape="rect" href="rte__ring_8c.html#ac29f8523d355c107377858bdeb468486" title=" " alt="" coords="615,56,782,83"/>
<area shape="rect" href="rte__ring_8c.html#a7a44f25853c926ac1b29562857244366" title=" " alt="" coords="649,5,749,32"/>
<area shape="rect" href="nvme-io_8c.html#a581e208522e056298eed5248b50af242" title=" " alt="" coords="388,385,552,412"/>
<area shape="rect" href="nvme-io_8c.html#aaa8fe64369c3e7b33785cabed5a4cbde" title=" " alt="" coords="391,841,549,868"/>
<area shape="rect" href="nvme_8h.html#acd64982aef4cb1864b53952a92068c27" title=" " alt="" coords="665,613,732,640"/>
<area shape="rect" href="rte__ring_8h.html#a96ef17a77ac3deecdb8a1fb71b6bdf63" title=" " alt="" coords="633,208,764,235"/>
<area shape="rect" href="rte__ring_8h.html#ab2417e0e85ffd0e61ec4b0ee263ab809" title=" " alt="" coords="623,309,774,336"/>
<area shape="rect" href="intr_8c.html#ac07d39a331aa32f4da4f27f31f1abc1c" title=" " alt="" coords="626,360,771,387"/>
<area shape="rect" href="nvme-io_8c.html#aa412c2f46a5bc43ac2234173c9743abe" title=" " alt="" coords="637,461,761,488"/>
<area shape="rect" href="pqueue_8h.html#addd8cdfbc8c47b8cdd7eb4c4560de7aa" title=" " alt="" coords="641,411,756,437"/>
<area shape="rect" href="pqueue_8h.html#a2919d3e817688b81da746d4123f51ba3" title=" " alt="" coords="644,512,753,539"/>
<area shape="rect" href="pqueue_8h.html#abec9363c7a9cc89190bf0925a4a1652c" title=" " alt="" coords="648,259,749,285"/>
<area shape="rect" href="pqueue_8h.html#ae0cf88c8360a5f08ada81feaaeb40505" title=" " alt="" coords="647,563,750,589"/>
<area shape="rect" href="rte__ring_8h.html#abc8376d2c6e609707d52032860880b34" title=" " alt="" coords="876,171,991,197"/>
<area shape="rect" href="rte__ring_8h.html#a8742d4b89ce43dbd93cc2ef48518ccf0" title=" " alt="" coords="846,309,1021,336"/>
<area shape="rect" href="rte__ring_8h.html#a201b5c512389dd58216906866aba1ec5" title=" " alt="" coords="1069,309,1241,336"/>
<area shape="rect" href="intr_8c.html#a1bcc1a1b3495a3ea33365a4afaf44b0a" title=" " alt="" coords="845,360,1021,387"/>
<area shape="rect" href="dma_8c.html#a08f51254313a657c3826f77e6bd9a1b8" title=" " alt="" coords="866,667,1001,693"/>
<area shape="rect" href="nvme_8h.html#ab5c77706290dc892f52e14dfe39504b6" title=" " alt="" coords="871,547,996,573"/>
<area shape="rect" href="nvme-util_8c.html#a1983cbf62a2b154bc0c1e8f01f2bb1b6" title=" " alt="" coords="866,461,1001,488"/>
<area shape="rect" href="pqueue_8c.html#a918fcd7df850b9a0c17111abc9c323b1" title=" " alt="" coords="889,411,978,437"/>
<area shape="rect" href="pqueue_8c.html#a69ad19c161ae75369d1a444c83f4600c" title=" " alt="" coords="871,259,996,285"/>
<area shape="rect" href="pqueue_8c.html#a3e99f0cb15bfac6eeee46df9c875073a" title=" " alt="" coords="1114,259,1197,285"/>
<area shape="rect" href="rte__ring_8h.html#a3afc06d02f63e84fe1569c99955af57a" title=" " alt="" coords="623,1107,774,1133"/>
<area shape="rect" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484" title=" " alt="" coords="1090,1005,1221,1032"/>
<area shape="rect" href="nvme-io_8c.html#aa9fdaa77f86c065d69d158184951be32" title=" " alt="" coords="633,765,765,792"/>
<area shape="rect" href="nvme-util_8c.html#a0c728e2926a6efc38005202a2b224647" title=" " alt="" coords="625,867,772,893"/>
<area shape="rect" href="nvme-io_8c.html#ae6d2b4ae7957a876e1e221b7f2ee1fb8" title=" " alt="" coords="642,917,755,944"/>
<area shape="rect" href="nvme-util_8c.html#a4fdc790b9e67ae29e3ef256182ed345b" title=" " alt="" coords="633,715,764,741"/>
<area shape="rect" href="nvme-io_8c.html#aa8cac05ad399a3b98a28abe2c89b5509" title=" " alt="" coords="600,816,797,843"/>
<area shape="rect" href="nvme-util_8c.html#a21b2434a9d5f978d0b4cf9661820ca63" title=" " alt="" coords="853,1005,1014,1032"/>
<area shape="rect" href="rte__ring_8h.html#ab8debfb458e927d559e7ce750048502d" title=" " alt="" coords="848,1107,1019,1133"/>
<area shape="rect" href="rte__ring_8h.html#a388f737bcdf0a8ee4cf6f75464ca5979" title=" " alt="" coords="1069,1107,1241,1133"/>
<area shape="rect" href="nvme-io_8c.html#a1ea0938f847741b1399583080d7bd9ae" title=" " alt="" coords="872,752,995,779"/>
<area shape="rect" href="nvme-io_8c.html#ae1f6c99fbfdd8d6c788ee82c6d13086d" title=" " alt="" coords="886,904,981,931"/>
<area shape="rect" href="nvme-io_8c.html#a0ecae506951d74f3dc9826f76e133d81" title=" " alt="" coords="885,955,982,981"/>
<area shape="rect" href="nvme-io_8c.html#a646ae4b9455eb7bf01b18eea275a2379" title=" " alt="" coords="862,803,1005,829"/>
<area shape="rect" href="nvme-io_8c.html#ae3fe0206159ec6d704c59e7393b6d85c" title=" " alt="" coords="863,853,1004,880"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a81f7e8af7ddcdfe9bef6af6c0333462d_icgraph.png" border="0" usemap="#nvme-io_8c_a81f7e8af7ddcdfe9bef6af6c0333462d_icgraph" alt=""/></div>
<map name="nvme-io_8c_a81f7e8af7ddcdfe9bef6af6c0333462d_icgraph" id="nvme-io_8c_a81f7e8af7ddcdfe9bef6af6c0333462d_icgraph">
<area shape="rect" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="ae1f6c99fbfdd8d6c788ee82c6d13086d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1f6c99fbfdd8d6c788ee82c6d13086d">&#9670;&nbsp;</a></span>nvme_dsm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t nvme_dsm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeCmd.html">NvmeCmd</a> *&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;{</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    uint32_t dw10 = le32_to_cpu(cmd-&gt;<a class="code" href="structNvmeCmd.html#ab217950fc2408f7a848af10f36b0cd8f">cdw10</a>);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    uint32_t dw11 = le32_to_cpu(cmd-&gt;<a class="code" href="structNvmeCmd.html#a542065d60952eff1b4de0fdf3ecb5b29">cdw11</a>);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    uint64_t prp1 = le64_to_cpu(cmd-&gt;<a class="code" href="structNvmeCmd.html#a3b34c627a05e2a86edf1a93567422c8c">dptr</a>.<a class="code" href="unionNvmeCmdDptr.html#aaad95622d868c580eadba6c852bf961d">prp1</a>);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    uint64_t prp2 = le64_to_cpu(cmd-&gt;<a class="code" href="structNvmeCmd.html#a3b34c627a05e2a86edf1a93567422c8c">dptr</a>.<a class="code" href="unionNvmeCmdDptr.html#a9fc9a97c707652c679097b32ffd84bc3">prp2</a>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">if</span> (dw11 &amp; <a class="code" href="nvme_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a2e60c51eabf70f9dd6ea2eb32dd3d915">NVME_DSMGMT_AD</a>) {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        uint16_t nr = (dw10 &amp; 0xff) + 1;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        uint64_t slba;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        uint32_t nlb;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <a class="code" href="structNvmeDsmRange.html">NvmeDsmRange</a> range[nr];</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="dma_8c.html#adef0f21bc237d992b4ae8b29258645a8">dma_write_prp</a>(n, (uint8_t *)range, <span class="keyword">sizeof</span>(range), prp1, prp2)) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <a class="code" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183">nvme_set_error_page</a>(n, req-&gt;<a class="code" href="structNvmeRequest.html#a18ef977aa1abc169de646d142d6c77d9">sq</a>-&gt;<a class="code" href="structNvmeSQueue.html#ac5aa365b6e571542994f682254a5e457">sqid</a>, cmd-&gt;<a class="code" href="structNvmeCmd.html#a80a15bb450d4810749be585c66eba0af">cid</a>, <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a>,</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                offsetof(<a class="code" href="structNvmeCmd.html">NvmeCmd</a>, dptr.prp1), 0, ns-&gt;<a class="code" href="structNvmeNamespace.html#aded48306fad86bd7ca9160443a24604d">id</a>);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        req-&gt;<a class="code" href="structNvmeRequest.html#a6c614d6e18850245fb2b05f087c4cc71">status</a> = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nr; i++) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            slba = le64_to_cpu(range[i].slba);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            nlb = le32_to_cpu(range[i].nlb);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="keywordflow">if</span> (slba + nlb &gt; le64_to_cpu(ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a4a814e395ae6ea7b3b7c5cba1c22ad85">nsze</a>)) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                <a class="code" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183">nvme_set_error_page</a>(n, req-&gt;<a class="code" href="structNvmeRequest.html#a18ef977aa1abc169de646d142d6c77d9">sq</a>-&gt;<a class="code" href="structNvmeSQueue.html#ac5aa365b6e571542994f682254a5e457">sqid</a>, cmd-&gt;<a class="code" href="structNvmeCmd.html#a80a15bb450d4810749be585c66eba0af">cid</a>, <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a43aae0e0a370dd16186369148885344f">NVME_LBA_RANGE</a>,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                    offsetof(<a class="code" href="structNvmeCmd.html">NvmeCmd</a>, cdw10), slba + nlb, ns-&gt;<a class="code" href="structNvmeNamespace.html#aded48306fad86bd7ca9160443a24604d">id</a>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a43aae0e0a370dd16186369148885344f">NVME_LBA_RANGE</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            bitmap_clear(ns-&gt;<a class="code" href="structNvmeNamespace.html#afc01a4df7d13a2a27416a4472efec6d1">util</a>, slba, nlb);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_ae1f6c99fbfdd8d6c788ee82c6d13086d_cgraph.png" border="0" usemap="#nvme-io_8c_ae1f6c99fbfdd8d6c788ee82c6d13086d_cgraph" alt=""/></div>
<map name="nvme-io_8c_ae1f6c99fbfdd8d6c788ee82c6d13086d_cgraph" id="nvme-io_8c_ae1f6c99fbfdd8d6c788ee82c6d13086d_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,100,57"/>
<area shape="rect" href="dma_8c.html#adef0f21bc237d992b4ae8b29258645a8" title=" " alt="" coords="170,5,289,32"/>
<area shape="rect" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183" title=" " alt="" coords="148,56,311,83"/>
<area shape="rect" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493" title=" " alt="" coords="359,5,481,32"/>
<area shape="rect" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484" title=" " alt="" coords="529,5,660,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_ae1f6c99fbfdd8d6c788ee82c6d13086d_icgraph.png" border="0" usemap="#nvme-io_8c_ae1f6c99fbfdd8d6c788ee82c6d13086d_icgraph" alt=""/></div>
<map name="nvme-io_8c_ae1f6c99fbfdd8d6c788ee82c6d13086d_icgraph" id="nvme-io_8c_ae1f6c99fbfdd8d6c788ee82c6d13086d_icgraph">
<area shape="rect" title=" " alt="" coords="1792,5,1887,32"/>
<area shape="rect" href="nvme-io_8c.html#ae6d2b4ae7957a876e1e221b7f2ee1fb8" title=" " alt="" coords="1631,5,1744,32"/>
<area shape="rect" href="nvme-io_8c.html#aaa8fe64369c3e7b33785cabed5a4cbde" title=" " alt="" coords="1425,5,1583,32"/>
<area shape="rect" href="nvme-io_8c.html#acb7bf552fb77faee4d0aa021d51af4b7" title=" " alt="" coords="1275,5,1377,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="a0ecae506951d74f3dc9826f76e133d81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ecae506951d74f3dc9826f76e133d81">&#9670;&nbsp;</a></span>nvme_flush()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t nvme_flush </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeCmd.html">NvmeCmd</a> *&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;{</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a0ecae506951d74f3dc9826f76e133d81_icgraph.png" border="0" usemap="#nvme-io_8c_a0ecae506951d74f3dc9826f76e133d81_icgraph" alt=""/></div>
<map name="nvme-io_8c_a0ecae506951d74f3dc9826f76e133d81_icgraph" id="nvme-io_8c_a0ecae506951d74f3dc9826f76e133d81_icgraph">
<area shape="rect" title=" " alt="" coords="1792,5,1889,32"/>
<area shape="rect" href="nvme-io_8c.html#ae6d2b4ae7957a876e1e221b7f2ee1fb8" title=" " alt="" coords="1631,5,1744,32"/>
<area shape="rect" href="nvme-io_8c.html#aaa8fe64369c3e7b33785cabed5a4cbde" title=" " alt="" coords="1425,5,1583,32"/>
<area shape="rect" href="nvme-io_8c.html#acb7bf552fb77faee4d0aa021d51af4b7" title=" " alt="" coords="1275,5,1377,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="ae6d2b4ae7957a876e1e221b7f2ee1fb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6d2b4ae7957a876e1e221b7f2ee1fb8">&#9670;&nbsp;</a></span>nvme_io_cmd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t nvme_io_cmd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeCmd.html">NvmeCmd</a> *&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;{</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="structNvmeNamespace.html">NvmeNamespace</a> *ns;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    uint32_t nsid = le32_to_cpu(cmd-&gt;<a class="code" href="structNvmeCmd.html#aa0daded9eb948cb9c13ae14a0852ed08">nsid</a>);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span> (nsid == 0 || nsid &gt; n-&gt;<a class="code" href="structFemuCtrl.html#a8bd3f2107e1a59779f7d6a669e29b5af">num_namespaces</a>) {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;%s, NVME_INVALID_NSID %&quot;</span> PRIu32 <span class="stringliteral">&quot;\n&quot;</span>, __func__, nsid);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a4c080463e158441c5b7b4000da2ed3e4">NVME_INVALID_NSID</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    req-&gt;<a class="code" href="structNvmeRequest.html#a3609469c3f31833cb86006bae283e160">ns</a> = ns = &amp;n-&gt;<a class="code" href="structFemuCtrl.html#a98ca6ff3bc65ccc7f98a589e018b7d71">namespaces</a>[nsid - 1];</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">switch</span> (cmd-&gt;<a class="code" href="structNvmeCmd.html#a2751bc2a772082d3af81124a1d120a0c">opcode</a>) {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a95c9b9c84ed8581bc4a06c07611e594c">NVME_CMD_FLUSH</a>:</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keywordflow">if</span> (!n-&gt;<a class="code" href="structFemuCtrl.html#af13a4a3fc3667cdddbd181c34378b406">id_ctrl</a>.<a class="code" href="structNvmeIdCtrl.html#a8f5bcadc35bff664d02357cd411376fe">vwc</a> || !n-&gt;<a class="code" href="structFemuCtrl.html#a4bd5012806e5cda6eb475cb787f4be3d">features</a>.<a class="code" href="structNvmeFeatureVal.html#a3425f02bb96f18760ef44b0e0a055741">volatile_wc</a>) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme-io_8c.html#a0ecae506951d74f3dc9826f76e133d81">nvme_flush</a>(n, ns, cmd, req);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a324318d7d84def33dd8a53724f14ab10">NVME_CMD_DSM</a>:</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="nvme_8h.html#a3137e88859bdb464f96bebbb259bbf8aad3aa66210104808011e11bb2c9a52f14">NVME_ONCS_DSM</a> &amp; n-&gt;<a class="code" href="structFemuCtrl.html#a19b37fe5892ac52aa01e3b8e7e0035f1">oncs</a>) {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="nvme-io_8c.html#ae1f6c99fbfdd8d6c788ee82c6d13086d">nvme_dsm</a>(n, ns, cmd, req);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a778b8f53d6725ef86c455e2e55d46ce7">NVME_INVALID_OPCODE</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6ada1d765c850987feea79854f0141694b">NVME_CMD_COMPARE</a>:</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="nvme_8h.html#a3137e88859bdb464f96bebbb259bbf8aa728dcb2daaf4d4b6fd6f67d441fd3dae">NVME_ONCS_COMPARE</a> &amp; n-&gt;<a class="code" href="structFemuCtrl.html#a19b37fe5892ac52aa01e3b8e7e0035f1">oncs</a>) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="nvme-io_8c.html#a1ea0938f847741b1399583080d7bd9ae">nvme_compare</a>(n, ns, cmd, req);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a778b8f53d6725ef86c455e2e55d46ce7">NVME_INVALID_OPCODE</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a012d1c22c46c99812568a7a7857eff90">NVME_CMD_WRITE_ZEROES</a>:</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="nvme_8h.html#a3137e88859bdb464f96bebbb259bbf8aa1fa2523620b4cf9057cb9d1fed348271">NVME_ONCS_WRITE_ZEROS</a> &amp; n-&gt;<a class="code" href="structFemuCtrl.html#a19b37fe5892ac52aa01e3b8e7e0035f1">oncs</a>) {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="nvme-io_8c.html#ae3fe0206159ec6d704c59e7393b6d85c">nvme_write_zeros</a>(n, ns, cmd, req);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a778b8f53d6725ef86c455e2e55d46ce7">NVME_INVALID_OPCODE</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a27572377c7abfd0692ca6e7a953b1d92">NVME_CMD_WRITE_UNCOR</a>:</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="nvme_8h.html#a3137e88859bdb464f96bebbb259bbf8aa2354e6a55a5d0065b8dfd3a33af6221d">NVME_ONCS_WRITE_UNCORR</a> &amp; n-&gt;<a class="code" href="structFemuCtrl.html#a19b37fe5892ac52aa01e3b8e7e0035f1">oncs</a>) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="nvme-io_8c.html#a646ae4b9455eb7bf01b18eea275a2379">nvme_write_uncor</a>(n, ns, cmd, req);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a778b8f53d6725ef86c455e2e55d46ce7">NVME_INVALID_OPCODE</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#a2b07accc41de60cd0c6de43adde355ad">ext_ops</a>.<a class="code" href="structFemuExtCtrlOps.html#aa481d8673fcc3bd5b890e3d8dc549a6e">io_cmd</a>) {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordflow">return</span> n-&gt;<a class="code" href="structFemuCtrl.html#a2b07accc41de60cd0c6de43adde355ad">ext_ops</a>.<a class="code" href="structFemuExtCtrlOps.html#aa481d8673fcc3bd5b890e3d8dc549a6e">io_cmd</a>(n, ns, cmd, req);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;%s, NVME_INVALID_OPCODE\n&quot;</span>, __func__);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a778b8f53d6725ef86c455e2e55d46ce7">NVME_INVALID_OPCODE</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    }</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_ae6d2b4ae7957a876e1e221b7f2ee1fb8_cgraph.png" border="0" usemap="#nvme-io_8c_ae6d2b4ae7957a876e1e221b7f2ee1fb8_cgraph" alt=""/></div>
<map name="nvme-io_8c_ae6d2b4ae7957a876e1e221b7f2ee1fb8_cgraph" id="nvme-io_8c_ae6d2b4ae7957a876e1e221b7f2ee1fb8_cgraph">
<area shape="rect" title=" " alt="" coords="5,132,119,159"/>
<area shape="rect" href="nvme-io_8c.html#a1ea0938f847741b1399583080d7bd9ae" title=" " alt="" coords="177,31,299,57"/>
<area shape="rect" href="nvme-io_8c.html#ae1f6c99fbfdd8d6c788ee82c6d13086d" title=" " alt="" coords="191,81,285,108"/>
<area shape="rect" href="nvme-io_8c.html#a0ecae506951d74f3dc9826f76e133d81" title=" " alt="" coords="189,233,287,260"/>
<area shape="rect" href="nvme-io_8c.html#a646ae4b9455eb7bf01b18eea275a2379" title=" " alt="" coords="167,183,309,209"/>
<area shape="rect" href="nvme-io_8c.html#ae3fe0206159ec6d704c59e7393b6d85c" title=" " alt="" coords="167,132,309,159"/>
<area shape="rect" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484" title=" " alt="" coords="739,5,869,32"/>
<area shape="rect" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493" title=" " alt="" coords="568,31,691,57"/>
<area shape="rect" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183" title=" " alt="" coords="357,132,520,159"/>
<area shape="rect" href="dma_8c.html#adef0f21bc237d992b4ae8b29258645a8" title=" " alt="" coords="379,81,498,108"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_ae6d2b4ae7957a876e1e221b7f2ee1fb8_icgraph.png" border="0" usemap="#nvme-io_8c_ae6d2b4ae7957a876e1e221b7f2ee1fb8_icgraph" alt=""/></div>
<map name="nvme-io_8c_ae6d2b4ae7957a876e1e221b7f2ee1fb8_icgraph" id="nvme-io_8c_ae6d2b4ae7957a876e1e221b7f2ee1fb8_icgraph">
<area shape="rect" title=" " alt="" coords="1631,5,1744,32"/>
<area shape="rect" href="nvme-io_8c.html#aaa8fe64369c3e7b33785cabed5a4cbde" title=" " alt="" coords="1425,5,1583,32"/>
<area shape="rect" href="nvme-io_8c.html#acb7bf552fb77faee4d0aa021d51af4b7" title=" " alt="" coords="1275,5,1377,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="acb7bf552fb77faee4d0aa021d51af4b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb7bf552fb77faee4d0aa021d51af4b7">&#9670;&nbsp;</a></span>nvme_poller()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* nvme_poller </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;{</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = ((<a class="code" href="structNvmePollerThreadArgument.html">NvmePollerThreadArgument</a> *)arg)-&gt;n;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">int</span> index = ((<a class="code" href="structNvmePollerThreadArgument.html">NvmePollerThreadArgument</a> *)arg)-&gt;index;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">switch</span> (n-&gt;<a class="code" href="structFemuCtrl.html#a6635a90258a97f71c6040b6cb9277b04">multipoller_enabled</a>) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordflow">while</span> (1) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keywordflow">if</span> ((!n-&gt;<a class="code" href="structFemuCtrl.html#a6291ffd43b13aa9c7bc871a7e1bb4a11">dataplane_started</a>)) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                usleep(1000);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <a class="code" href="structNvmeSQueue.html">NvmeSQueue</a> *sq = n-&gt;<a class="code" href="structFemuCtrl.html#a9f37c1e2d56205e4c7d0015aa9af44e2">sq</a>[index];</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <a class="code" href="structNvmeCQueue.html">NvmeCQueue</a> *cq = n-&gt;<a class="code" href="structFemuCtrl.html#a380a277dfc1bb8f2a192f6244a3f4fdb">cq</a>[index];</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="keywordflow">if</span> (sq &amp;&amp; sq-&gt;<a class="code" href="structNvmeSQueue.html#a007bae54f6cd81bd45ddbe5fc64cf993">is_active</a> &amp;&amp; cq &amp;&amp; cq-&gt;<a class="code" href="structNvmeCQueue.html#a8b941ba9a13366bf3348b3b7e73009a1">is_active</a>) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                <a class="code" href="nvme-io_8c.html#aaa8fe64369c3e7b33785cabed5a4cbde">nvme_process_sq_io</a>(sq, index);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <a class="code" href="nvme-io_8c.html#a581e208522e056298eed5248b50af242">nvme_process_cq_cpl</a>(n, index);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">while</span> (1) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="keywordflow">if</span> ((!n-&gt;<a class="code" href="structFemuCtrl.html#a6291ffd43b13aa9c7bc871a7e1bb4a11">dataplane_started</a>)) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                usleep(1000);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= n-&gt;<a class="code" href="structFemuCtrl.html#ab09f359cd5d2e1882bd8a04046becf28">num_io_queues</a>; i++) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <a class="code" href="structNvmeSQueue.html">NvmeSQueue</a> *sq = n-&gt;<a class="code" href="structFemuCtrl.html#a9f37c1e2d56205e4c7d0015aa9af44e2">sq</a>[i];</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <a class="code" href="structNvmeCQueue.html">NvmeCQueue</a> *cq = n-&gt;<a class="code" href="structFemuCtrl.html#a380a277dfc1bb8f2a192f6244a3f4fdb">cq</a>[i];</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                <span class="keywordflow">if</span> (sq &amp;&amp; sq-&gt;<a class="code" href="structNvmeSQueue.html#a007bae54f6cd81bd45ddbe5fc64cf993">is_active</a> &amp;&amp; cq &amp;&amp; cq-&gt;<a class="code" href="structNvmeCQueue.html#a8b941ba9a13366bf3348b3b7e73009a1">is_active</a>) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                    <a class="code" href="nvme-io_8c.html#aaa8fe64369c3e7b33785cabed5a4cbde">nvme_process_sq_io</a>(sq, index);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <a class="code" href="nvme-io_8c.html#a581e208522e056298eed5248b50af242">nvme_process_cq_cpl</a>(n, index);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_acb7bf552fb77faee4d0aa021d51af4b7_cgraph.png" border="0" usemap="#nvme-io_8c_acb7bf552fb77faee4d0aa021d51af4b7_cgraph" alt=""/></div>
<map name="nvme-io_8c_acb7bf552fb77faee4d0aa021d51af4b7_cgraph" id="nvme-io_8c_acb7bf552fb77faee4d0aa021d51af4b7_cgraph">
<area shape="rect" title=" " alt="" coords="5,664,108,691"/>
<area shape="rect" href="nvme-io_8c.html#a581e208522e056298eed5248b50af242" title=" " alt="" coords="156,841,320,868"/>
<area shape="rect" href="nvme-io_8c.html#aaa8fe64369c3e7b33785cabed5a4cbde" title=" " alt="" coords="159,436,317,463"/>
<area shape="rect" href="nvme_8h.html#acd64982aef4cb1864b53952a92068c27" title=" " alt="" coords="433,765,500,792"/>
<area shape="rect" href="rte__ring_8h.html#a96ef17a77ac3deecdb8a1fb71b6bdf63" title=" " alt="" coords="401,816,532,843"/>
<area shape="rect" href="rte__ring_8h.html#ab2417e0e85ffd0e61ec4b0ee263ab809" title=" " alt="" coords="391,715,542,741"/>
<area shape="rect" href="intr_8c.html#ac07d39a331aa32f4da4f27f31f1abc1c" title=" " alt="" coords="394,1069,539,1096"/>
<area shape="rect" href="nvme-io_8c.html#aa412c2f46a5bc43ac2234173c9743abe" title=" " alt="" coords="405,664,529,691"/>
<area shape="rect" href="pqueue_8h.html#addd8cdfbc8c47b8cdd7eb4c4560de7aa" title=" " alt="" coords="409,917,524,944"/>
<area shape="rect" href="pqueue_8h.html#a2919d3e817688b81da746d4123f51ba3" title=" " alt="" coords="412,867,521,893"/>
<area shape="rect" href="pqueue_8h.html#abec9363c7a9cc89190bf0925a4a1652c" title=" " alt="" coords="416,968,517,995"/>
<area shape="rect" href="pqueue_8h.html#ae0cf88c8360a5f08ada81feaaeb40505" title=" " alt="" coords="415,1019,518,1045"/>
<area shape="rect" href="rte__ring_8h.html#abc8376d2c6e609707d52032860880b34" title=" " alt="" coords="644,816,759,843"/>
<area shape="rect" href="rte__ring_8h.html#a8742d4b89ce43dbd93cc2ef48518ccf0" title=" " alt="" coords="614,715,789,741"/>
<area shape="rect" href="rte__ring_8h.html#a201b5c512389dd58216906866aba1ec5" title=" " alt="" coords="837,664,1009,691"/>
<area shape="rect" href="rte__ring_8h.html#a3a4127db74610c522be2a4f8f70c033d" title=" " alt="" coords="1057,664,1264,691"/>
<area shape="rect" href="rte__ring_8h.html#a269bf4b0dad1a7d2bb0396350f5e7976" title=" " alt="" coords="1113,613,1208,640"/>
<area shape="rect" href="rte__atomic__x86_8h.html#a092485d3d43a2cd7ee61a1c2d2178d31" title=" " alt="" coords="1312,613,1475,640"/>
<area shape="rect" href="intr_8c.html#a1bcc1a1b3495a3ea33365a4afaf44b0a" title=" " alt="" coords="613,1069,789,1096"/>
<area shape="rect" href="dma_8c.html#a08f51254313a657c3826f77e6bd9a1b8" title=" " alt="" coords="634,613,769,640"/>
<area shape="rect" href="nvme_8h.html#ab5c77706290dc892f52e14dfe39504b6" title=" " alt="" coords="639,563,764,589"/>
<area shape="rect" href="nvme-util_8c.html#a1983cbf62a2b154bc0c1e8f01f2bb1b6" title=" " alt="" coords="634,664,769,691"/>
<area shape="rect" href="pqueue_8c.html#a918fcd7df850b9a0c17111abc9c323b1" title=" " alt="" coords="657,917,746,944"/>
<area shape="rect" href="pqueue_8c.html#a69ad19c161ae75369d1a444c83f4600c" title=" " alt="" coords="639,968,764,995"/>
<area shape="rect" href="pqueue_8c.html#a3e99f0cb15bfac6eeee46df9c875073a" title=" " alt="" coords="882,968,965,995"/>
<area shape="rect" href="rte__ring_8h.html#a3afc06d02f63e84fe1569c99955af57a" title=" " alt="" coords="391,563,542,589"/>
<area shape="rect" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484" title=" " alt="" coords="1328,145,1459,172"/>
<area shape="rect" href="nvme-io_8c.html#aa9fdaa77f86c065d69d158184951be32" title=" " alt="" coords="401,411,533,437"/>
<area shape="rect" href="nvme-util_8c.html#a0c728e2926a6efc38005202a2b224647" title=" " alt="" coords="393,461,540,488"/>
<area shape="rect" href="nvme-io_8c.html#ae6d2b4ae7957a876e1e221b7f2ee1fb8" title=" " alt="" coords="410,132,523,159"/>
<area shape="rect" href="nvme-util_8c.html#a4fdc790b9e67ae29e3ef256182ed345b" title=" " alt="" coords="401,512,532,539"/>
<area shape="rect" href="nvme-io_8c.html#aa8cac05ad399a3b98a28abe2c89b5509" title=" " alt="" coords="368,613,565,640"/>
<area shape="rect" href="nvme-util_8c.html#a21b2434a9d5f978d0b4cf9661820ca63" title=" " alt="" coords="1080,221,1241,248"/>
<area shape="rect" href="rte__ring_8h.html#ab8debfb458e927d559e7ce750048502d" title=" " alt="" coords="616,512,787,539"/>
<area shape="rect" href="rte__ring_8h.html#a388f737bcdf0a8ee4cf6f75464ca5979" title=" " alt="" coords="837,563,1009,589"/>
<area shape="rect" href="rte__ring_8h.html#a22ab749e8f41b8e232a5c54a5c100d16" title=" " alt="" coords="1058,563,1263,589"/>
<area shape="rect" href="nvme-io_8c.html#a1ea0938f847741b1399583080d7bd9ae" title=" " alt="" coords="640,5,763,32"/>
<area shape="rect" href="nvme-io_8c.html#ae1f6c99fbfdd8d6c788ee82c6d13086d" title=" " alt="" coords="654,107,749,133"/>
<area shape="rect" href="nvme-io_8c.html#a0ecae506951d74f3dc9826f76e133d81" title=" " alt="" coords="653,56,750,83"/>
<area shape="rect" href="nvme-io_8c.html#a646ae4b9455eb7bf01b18eea275a2379" title=" " alt="" coords="630,157,773,184"/>
<area shape="rect" href="nvme-io_8c.html#ae3fe0206159ec6d704c59e7393b6d85c" title=" " alt="" coords="631,208,772,235"/>
<area shape="rect" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493" title=" " alt="" coords="1099,107,1222,133"/>
<area shape="rect" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183" title=" " alt="" coords="842,157,1005,184"/>
<area shape="rect" href="dma_8c.html#adef0f21bc237d992b4ae8b29258645a8" title=" " alt="" coords="864,107,983,133"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_acb7bf552fb77faee4d0aa021d51af4b7_icgraph.png" border="0" usemap="#nvme-io_8c_acb7bf552fb77faee4d0aa021d51af4b7_icgraph" alt=""/></div>
<map name="nvme-io_8c_acb7bf552fb77faee4d0aa021d51af4b7_icgraph" id="nvme-io_8c_acb7bf552fb77faee4d0aa021d51af4b7_icgraph">
<area shape="rect" title=" " alt="" coords="1275,5,1377,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="aa412c2f46a5bc43ac2234173c9743abe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa412c2f46a5bc43ac2234173c9743abe">&#9670;&nbsp;</a></span>nvme_post_cqe()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void nvme_post_cqe </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeCQueue.html">NvmeCQueue</a> *&#160;</td>
          <td class="paramname"><em>cq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;{</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = cq-&gt;<a class="code" href="structNvmeCQueue.html#a83ec5b565d4c97540ef1db6462f3efd2">ctrl</a>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="structNvmeSQueue.html">NvmeSQueue</a> *sq = req-&gt;<a class="code" href="structNvmeRequest.html#a18ef977aa1abc169de646d142d6c77d9">sq</a>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="structNvmeCqe.html">NvmeCqe</a> *cqe = &amp;req-&gt;<a class="code" href="structNvmeRequest.html#a8cec02fb87e647c828d06f533aec8758">cqe</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    uint8_t phase = cq-&gt;<a class="code" href="structNvmeCQueue.html#a550822923ef54d73d7efa7f4bf6159c3">phase</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    hwaddr addr;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#a3a16108410047b6e7d6ac06c3cb5cd76">print_log</a>) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="nvme_8h.html#aef2bfc05ccbdba79aef90226efe46ad4">femu_debug</a>(<span class="stringliteral">&quot;%s,req,lba:%lu,lat:%lu\n&quot;</span>, n-&gt;<a class="code" href="structFemuCtrl.html#a7c69e429f2da05dd6a0ecb4591c2c4fb">devname</a>, req-&gt;<a class="code" href="structNvmeRequest.html#a35d73ae4b2cd7c17e55d20320ac2b1ea">slba</a>, req-&gt;<a class="code" href="structNvmeRequest.html#a5b78c8ff9c9bf2a1012976ac9764d5bc">reqlat</a>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    cqe-&gt;<a class="code" href="structNvmeCqe.html#af30104c7014aee1c55b68672efc0c143">status</a> = cpu_to_le16((req-&gt;<a class="code" href="structNvmeRequest.html#a6c614d6e18850245fb2b05f087c4cc71">status</a> &lt;&lt; 1) | phase);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    cqe-&gt;<a class="code" href="structNvmeCqe.html#a7717de66db45f6ca9c69bc3880825aee">sq_id</a> = cpu_to_le16(sq-&gt;<a class="code" href="structNvmeSQueue.html#ac5aa365b6e571542994f682254a5e457">sqid</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    cqe-&gt;<a class="code" href="structNvmeCqe.html#a4707dde71101275a917c49286b4178c4">sq_head</a> = cpu_to_le16(sq-&gt;<a class="code" href="structNvmeSQueue.html#aec83bc34b2dd3541fda15c0279348264">head</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">if</span> (cq-&gt;<a class="code" href="structNvmeCQueue.html#a376ae99c71a9fb4157bd4fb45b2a5090">phys_contig</a>) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        addr = cq-&gt;<a class="code" href="structNvmeCQueue.html#a212c26a71132a5d3ca6e4c3992773235">dma_addr</a> + cq-&gt;<a class="code" href="structNvmeCQueue.html#a8ecbdfc4863d2633f279c2ae70dff1dd">tail</a> * n-&gt;<a class="code" href="structFemuCtrl.html#ac4f8d305f94dfd341fe6e7f39c06c47c">cqe_size</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        ((<a class="code" href="structNvmeCqe.html">NvmeCqe</a> *)cq-&gt;<a class="code" href="structNvmeCQueue.html#ae71382828723bfcbe3c2430f490c0ac3">dma_addr_hva</a>)[cq-&gt;<a class="code" href="structNvmeCQueue.html#a8ecbdfc4863d2633f279c2ae70dff1dd">tail</a>] = *cqe;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        addr = <a class="code" href="nvme_8h.html#ab5c77706290dc892f52e14dfe39504b6">nvme_discontig</a>(cq-&gt;<a class="code" href="structNvmeCQueue.html#abee73fe2f6a1749b69ee6edf4b08f751">prp_list</a>, cq-&gt;<a class="code" href="structNvmeCQueue.html#a8ecbdfc4863d2633f279c2ae70dff1dd">tail</a>, n-&gt;<a class="code" href="structFemuCtrl.html#a6d0418e38e888b2b8980a34198bfd463">page_size</a>, n-&gt;<a class="code" href="structFemuCtrl.html#ac4f8d305f94dfd341fe6e7f39c06c47c">cqe_size</a>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <a class="code" href="dma_8c.html#a08f51254313a657c3826f77e6bd9a1b8">nvme_addr_write</a>(n, addr, (<span class="keywordtype">void</span> *)cqe, <span class="keyword">sizeof</span>(*cqe));</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="nvme-util_8c.html#a1983cbf62a2b154bc0c1e8f01f2bb1b6">nvme_inc_cq_tail</a>(cq);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_aa412c2f46a5bc43ac2234173c9743abe_cgraph.png" border="0" usemap="#nvme-io_8c_aa412c2f46a5bc43ac2234173c9743abe_cgraph" alt=""/></div>
<map name="nvme-io_8c_aa412c2f46a5bc43ac2234173c9743abe_cgraph" id="nvme-io_8c_aa412c2f46a5bc43ac2234173c9743abe_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,129,83"/>
<area shape="rect" href="dma_8c.html#a08f51254313a657c3826f77e6bd9a1b8" title=" " alt="" coords="177,5,312,32"/>
<area shape="rect" href="nvme_8h.html#ab5c77706290dc892f52e14dfe39504b6" title=" " alt="" coords="182,56,307,83"/>
<area shape="rect" href="nvme-util_8c.html#a1983cbf62a2b154bc0c1e8f01f2bb1b6" title=" " alt="" coords="177,107,312,133"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_aa412c2f46a5bc43ac2234173c9743abe_icgraph.png" border="0" usemap="#nvme-io_8c_aa412c2f46a5bc43ac2234173c9743abe_icgraph" alt=""/></div>
<map name="nvme-io_8c_aa412c2f46a5bc43ac2234173c9743abe_icgraph" id="nvme-io_8c_aa412c2f46a5bc43ac2234173c9743abe_icgraph">
<area shape="rect" title=" " alt="" coords="1637,31,1761,57"/>
<area shape="rect" href="nvme_8h.html#a03a3accd495e0b00d01b80e009af5c9f" title=" " alt="" coords="1432,5,1583,32"/>
<area shape="rect" href="nvme-io_8c.html#a581e208522e056298eed5248b50af242" title=" " alt="" coords="1425,56,1589,83"/>
<area shape="rect" href="nvme-admin_8c.html#a6f5c22b725b5eca5912f17066e95cf67" title=" " alt="" coords="1097,5,1205,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,31,809,57"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,31,619,57"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,31,384,57"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,31,149,57"/>
<area shape="rect" href="nvme-io_8c.html#acb7bf552fb77faee4d0aa021d51af4b7" title=" " alt="" coords="1275,56,1377,83"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,56,1227,83"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,56,1028,83"/>
</map>
</div>

</div>
</div>
<a id="a03a3accd495e0b00d01b80e009af5c9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03a3accd495e0b00d01b80e009af5c9f">&#9670;&nbsp;</a></span>nvme_post_cqes_io()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void nvme_post_cqes_io </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>opaque</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;{</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="structNvmeCQueue.html">NvmeCQueue</a> *cq = opaque;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <a class="code" href="structNvmeRequest.html">NvmeRequest</a> *req, *next;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    int64_t cur_time, ntt = 0;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordtype">int</span> processed = 0;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    QTAILQ_FOREACH_SAFE(req, &amp;cq-&gt;req_list, entry, next) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="nvme-util_8c.html#a4e852fdb44ac17526a5b317eb3e4dac7">nvme_cq_full</a>(cq)) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        cur_time = qemu_clock_get_ns(QEMU_CLOCK_REALTIME);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordflow">if</span> (cq-&gt;<a class="code" href="structNvmeCQueue.html#a81de77c41f0fe454ab844dff5914bae5">cqid</a> != 0 &amp;&amp; cur_time &lt; req-&gt;expire_time) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            ntt = req-&gt;<a class="code" href="structNvmeRequest.html#a135bf3cba23f12bad28c20805a8f5d93">expire_time</a>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <a class="code" href="nvme-io_8c.html#aa412c2f46a5bc43ac2234173c9743abe">nvme_post_cqe</a>(cq, req);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        processed++;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span> (ntt == 0) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        ntt = qemu_clock_get_ns(QEMU_CLOCK_REALTIME) + <a class="code" href="nvme_8h.html#ac91f8d2a189a788ba37134daaeb87afa">CQ_POLLING_PERIOD_NS</a>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="comment">/* Only interrupt guest when we &quot;do&quot; complete some I/Os */</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">if</span> (processed &gt; 0) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <a class="code" href="intr_8c.html#ac07d39a331aa32f4da4f27f31f1abc1c">nvme_isr_notify_io</a>(cq);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a03a3accd495e0b00d01b80e009af5c9f_cgraph.png" border="0" usemap="#nvme-io_8c_a03a3accd495e0b00d01b80e009af5c9f_cgraph" alt=""/></div>
<map name="nvme-io_8c_a03a3accd495e0b00d01b80e009af5c9f_cgraph" id="nvme-io_8c_a03a3accd495e0b00d01b80e009af5c9f_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,156,83"/>
<area shape="rect" href="nvme-util_8c.html#a4e852fdb44ac17526a5b317eb3e4dac7" title=" " alt="" coords="222,5,331,32"/>
<area shape="rect" href="intr_8c.html#ac07d39a331aa32f4da4f27f31f1abc1c" title=" " alt="" coords="204,56,349,83"/>
<area shape="rect" href="nvme-io_8c.html#aa412c2f46a5bc43ac2234173c9743abe" title=" " alt="" coords="215,132,339,159"/>
<area shape="rect" href="nvme-util_8c.html#a2c23400ec899cbc551757929a872089e" title=" " alt="" coords="399,5,571,32"/>
<area shape="rect" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484" title=" " alt="" coords="621,5,752,32"/>
<area shape="rect" href="intr_8c.html#a1bcc1a1b3495a3ea33365a4afaf44b0a" title=" " alt="" coords="397,56,573,83"/>
<area shape="rect" href="dma_8c.html#a08f51254313a657c3826f77e6bd9a1b8" title=" " alt="" coords="418,107,553,133"/>
<area shape="rect" href="nvme_8h.html#ab5c77706290dc892f52e14dfe39504b6" title=" " alt="" coords="423,157,548,184"/>
<area shape="rect" href="nvme-util_8c.html#a1983cbf62a2b154bc0c1e8f01f2bb1b6" title=" " alt="" coords="418,208,553,235"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a03a3accd495e0b00d01b80e009af5c9f_icgraph.png" border="0" usemap="#nvme-io_8c_a03a3accd495e0b00d01b80e009af5c9f_icgraph" alt=""/></div>
<map name="nvme-io_8c_a03a3accd495e0b00d01b80e009af5c9f_icgraph" id="nvme-io_8c_a03a3accd495e0b00d01b80e009af5c9f_icgraph">
<area shape="rect" title=" " alt="" coords="1013,5,1164,32"/>
<area shape="rect" href="nvme-admin_8c.html#a6f5c22b725b5eca5912f17066e95cf67" title=" " alt="" coords="857,5,965,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="a581e208522e056298eed5248b50af242"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a581e208522e056298eed5248b50af242">&#9670;&nbsp;</a></span>nvme_process_cq_cpl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void nvme_process_cq_cpl </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_poller</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;{</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = (<a class="code" href="structFemuCtrl.html">FemuCtrl</a> *)arg;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="structNvmeCQueue.html">NvmeCQueue</a> *cq = NULL;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="structNvmeRequest.html">NvmeRequest</a> *req = NULL;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keyword">struct </span><a class="code" href="structrte__ring.html">rte_ring</a> *rp = n-&gt;<a class="code" href="structFemuCtrl.html#a0ff7c6d5e0e6313cc66e2d62f4e98221">to_ftl</a>[index_poller];</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="structpqueue__t.html">pqueue_t</a> *pq = n-&gt;<a class="code" href="structFemuCtrl.html#a3b6bdba05fa2cf581ace5cc08cd365f5">pq</a>[index_poller];</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    uint64_t now;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">int</span> processed = 0;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">int</span> rc;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="nvme_8h.html#acd64982aef4cb1864b53952a92068c27">BBSSD</a>(n)) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        rp = n-&gt;<a class="code" href="structFemuCtrl.html#ad818a28bdef83c4bb07c0d4f00942b06">to_poller</a>[index_poller];</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="rte__ring_8h.html#a96ef17a77ac3deecdb8a1fb71b6bdf63">femu_ring_count</a>(rp)) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        req = NULL;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        rc = <a class="code" href="rte__ring_8h.html#ab2417e0e85ffd0e61ec4b0ee263ab809">femu_ring_dequeue</a>(rp, (<span class="keywordtype">void</span> *)&amp;req, 1);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">if</span> (rc != 1) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;dequeue from to_poller request failed\n&quot;</span>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        assert(req);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <a class="code" href="pqueue_8h.html#addd8cdfbc8c47b8cdd7eb4c4560de7aa">pqueue_insert</a>(pq, req);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">while</span> ((req = <a class="code" href="pqueue_8h.html#a2919d3e817688b81da746d4123f51ba3">pqueue_peek</a>(pq))) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        now = qemu_clock_get_ns(QEMU_CLOCK_REALTIME);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">if</span> (now &lt; req-&gt;expire_time) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        cq = n-&gt;<a class="code" href="structFemuCtrl.html#a380a277dfc1bb8f2a192f6244a3f4fdb">cq</a>[req-&gt;<a class="code" href="structNvmeRequest.html#a18ef977aa1abc169de646d142d6c77d9">sq</a>-&gt;<a class="code" href="structNvmeSQueue.html#ac5aa365b6e571542994f682254a5e457">sqid</a>];</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">if</span> (!cq-&gt;<a class="code" href="structNvmeCQueue.html#a8b941ba9a13366bf3348b3b7e73009a1">is_active</a>)</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <a class="code" href="nvme-io_8c.html#aa412c2f46a5bc43ac2234173c9743abe">nvme_post_cqe</a>(cq, req);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        QTAILQ_INSERT_TAIL(&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a18ef977aa1abc169de646d142d6c77d9">sq</a>-&gt;req_list, req, entry);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <a class="code" href="pqueue_8h.html#abec9363c7a9cc89190bf0925a4a1652c">pqueue_pop</a>(pq);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        processed++;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        n-&gt;<a class="code" href="structFemuCtrl.html#a252a9c514e961fa6355b50061862bd34">nr_tt_ios</a>++;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">if</span> (now - req-&gt;<a class="code" href="structNvmeRequest.html#a135bf3cba23f12bad28c20805a8f5d93">expire_time</a> &gt;= 20000) {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            n-&gt;<a class="code" href="structFemuCtrl.html#a8da82e5488952cf964ffcb40f29e4f7a">nr_tt_late_ios</a>++;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#a3a16108410047b6e7d6ac06c3cb5cd76">print_log</a>) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                <a class="code" href="nvme_8h.html#aef2bfc05ccbdba79aef90226efe46ad4">femu_debug</a>(<span class="stringliteral">&quot;%s,diff,pq.count=%lu,%&quot;</span> PRId64 <span class="stringliteral">&quot;, %lu/%lu\n&quot;</span>,</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                           n-&gt;<a class="code" href="structFemuCtrl.html#a7c69e429f2da05dd6a0ecb4591c2c4fb">devname</a>, <a class="code" href="pqueue_8h.html#ae0cf88c8360a5f08ada81feaaeb40505">pqueue_size</a>(pq), now - req-&gt;<a class="code" href="structNvmeRequest.html#a135bf3cba23f12bad28c20805a8f5d93">expire_time</a>,</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                           n-&gt;<a class="code" href="structFemuCtrl.html#a8da82e5488952cf964ffcb40f29e4f7a">nr_tt_late_ios</a>, n-&gt;<a class="code" href="structFemuCtrl.html#a252a9c514e961fa6355b50061862bd34">nr_tt_ios</a>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        n-&gt;<a class="code" href="structFemuCtrl.html#a78003b6c4ed89a589c99c4b01b9c689a">should_isr</a>[req-&gt;<a class="code" href="structNvmeRequest.html#a18ef977aa1abc169de646d142d6c77d9">sq</a>-&gt;<a class="code" href="structNvmeSQueue.html#ac5aa365b6e571542994f682254a5e457">sqid</a>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">if</span> (processed == 0)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">switch</span> (n-&gt;<a class="code" href="structFemuCtrl.html#a6635a90258a97f71c6040b6cb9277b04">multipoller_enabled</a>) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <a class="code" href="intr_8c.html#ac07d39a331aa32f4da4f27f31f1abc1c">nvme_isr_notify_io</a>(n-&gt;<a class="code" href="structFemuCtrl.html#a380a277dfc1bb8f2a192f6244a3f4fdb">cq</a>[index_poller]);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= n-&gt;<a class="code" href="structFemuCtrl.html#ab09f359cd5d2e1882bd8a04046becf28">num_io_queues</a>; i++) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#a78003b6c4ed89a589c99c4b01b9c689a">should_isr</a>[i]) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                <a class="code" href="intr_8c.html#ac07d39a331aa32f4da4f27f31f1abc1c">nvme_isr_notify_io</a>(n-&gt;<a class="code" href="structFemuCtrl.html#a380a277dfc1bb8f2a192f6244a3f4fdb">cq</a>[i]);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                n-&gt;<a class="code" href="structFemuCtrl.html#a78003b6c4ed89a589c99c4b01b9c689a">should_isr</a>[i] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a581e208522e056298eed5248b50af242_cgraph.png" border="0" usemap="#nvme-io_8c_a581e208522e056298eed5248b50af242_cgraph" alt=""/></div>
<map name="nvme-io_8c_a581e208522e056298eed5248b50af242_cgraph" id="nvme-io_8c_a581e208522e056298eed5248b50af242_cgraph">
<area shape="rect" title=" " alt="" coords="5,208,169,235"/>
<area shape="rect" href="nvme_8h.html#acd64982aef4cb1864b53952a92068c27" title=" " alt="" coords="259,5,326,32"/>
<area shape="rect" href="rte__ring_8h.html#a96ef17a77ac3deecdb8a1fb71b6bdf63" title=" " alt="" coords="227,56,358,83"/>
<area shape="rect" href="rte__ring_8h.html#ab2417e0e85ffd0e61ec4b0ee263ab809" title=" " alt="" coords="217,107,368,133"/>
<area shape="rect" href="intr_8c.html#ac07d39a331aa32f4da4f27f31f1abc1c" title=" " alt="" coords="220,157,365,184"/>
<area shape="rect" href="nvme-io_8c.html#aa412c2f46a5bc43ac2234173c9743abe" title=" " alt="" coords="231,208,355,235"/>
<area shape="rect" href="pqueue_8h.html#addd8cdfbc8c47b8cdd7eb4c4560de7aa" title=" " alt="" coords="235,259,350,285"/>
<area shape="rect" href="pqueue_8h.html#a2919d3e817688b81da746d4123f51ba3" title=" " alt="" coords="238,309,347,336"/>
<area shape="rect" href="pqueue_8h.html#abec9363c7a9cc89190bf0925a4a1652c" title=" " alt="" coords="242,360,343,387"/>
<area shape="rect" href="pqueue_8h.html#ae0cf88c8360a5f08ada81feaaeb40505" title=" " alt="" coords="241,411,344,437"/>
<area shape="rect" href="rte__ring_8h.html#abc8376d2c6e609707d52032860880b34" title=" " alt="" coords="447,31,561,57"/>
<area shape="rect" href="rte__ring_8h.html#a8742d4b89ce43dbd93cc2ef48518ccf0" title=" " alt="" coords="417,81,591,108"/>
<area shape="rect" href="rte__ring_8h.html#a201b5c512389dd58216906866aba1ec5" title=" " alt="" coords="640,81,812,108"/>
<area shape="rect" href="rte__ring_8h.html#a3a4127db74610c522be2a4f8f70c033d" title=" " alt="" coords="860,56,1067,83"/>
<area shape="rect" href="rte__ring_8h.html#a269bf4b0dad1a7d2bb0396350f5e7976" title=" " alt="" coords="916,107,1011,133"/>
<area shape="rect" href="rte__atomic__x86_8h.html#a092485d3d43a2cd7ee61a1c2d2178d31" title=" " alt="" coords="1115,56,1277,83"/>
<area shape="rect" href="intr_8c.html#a1bcc1a1b3495a3ea33365a4afaf44b0a" title=" " alt="" coords="416,132,592,159"/>
<area shape="rect" href="dma_8c.html#a08f51254313a657c3826f77e6bd9a1b8" title=" " alt="" coords="437,183,571,209"/>
<area shape="rect" href="nvme_8h.html#ab5c77706290dc892f52e14dfe39504b6" title=" " alt="" coords="441,233,567,260"/>
<area shape="rect" href="nvme-util_8c.html#a1983cbf62a2b154bc0c1e8f01f2bb1b6" title=" " alt="" coords="437,284,571,311"/>
<area shape="rect" href="pqueue_8c.html#a918fcd7df850b9a0c17111abc9c323b1" title=" " alt="" coords="459,335,549,361"/>
<area shape="rect" href="pqueue_8c.html#a69ad19c161ae75369d1a444c83f4600c" title=" " alt="" coords="441,385,567,412"/>
<area shape="rect" href="pqueue_8c.html#a3e99f0cb15bfac6eeee46df9c875073a" title=" " alt="" coords="685,385,767,412"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a581e208522e056298eed5248b50af242_icgraph.png" border="0" usemap="#nvme-io_8c_a581e208522e056298eed5248b50af242_icgraph" alt=""/></div>
<map name="nvme-io_8c_a581e208522e056298eed5248b50af242_icgraph" id="nvme-io_8c_a581e208522e056298eed5248b50af242_icgraph">
<area shape="rect" title=" " alt="" coords="1425,5,1589,32"/>
<area shape="rect" href="nvme-io_8c.html#acb7bf552fb77faee4d0aa021d51af4b7" title=" " alt="" coords="1275,5,1377,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="aaa8fe64369c3e7b33785cabed5a4cbde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa8fe64369c3e7b33785cabed5a4cbde">&#9670;&nbsp;</a></span>nvme_process_sq_io()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void nvme_process_sq_io </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>opaque</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index_poller</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="structNvmeSQueue.html">NvmeSQueue</a> *sq = opaque;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = sq-&gt;<a class="code" href="structNvmeSQueue.html#a09944fa7acccfc87c0c8440aeacc3dc7">ctrl</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    uint16_t status;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    hwaddr addr;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="structNvmeCmd.html">NvmeCmd</a> cmd;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="structNvmeRequest.html">NvmeRequest</a> *req;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">int</span> processed = 0;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="nvme-util_8c.html#a21b2434a9d5f978d0b4cf9661820ca63">nvme_update_sq_tail</a>(sq);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">while</span> (!(<a class="code" href="nvme-util_8c.html#a4fdc790b9e67ae29e3ef256182ed345b">nvme_sq_empty</a>(sq))) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">if</span> (sq-&gt;<a class="code" href="structNvmeSQueue.html#abb10aae49e80be9c67dd28f484514adb">phys_contig</a>) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            addr = sq-&gt;<a class="code" href="structNvmeSQueue.html#a7e289d563e907e4a724af16364350602">dma_addr</a> + sq-&gt;<a class="code" href="structNvmeSQueue.html#aec83bc34b2dd3541fda15c0279348264">head</a> * n-&gt;<a class="code" href="structFemuCtrl.html#a3cbec385b70e8c6a03b463e00ac08d92">sqe_size</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            <a class="code" href="nvme-io_8c.html#aa9fdaa77f86c065d69d158184951be32">nvme_copy_cmd</a>(&amp;cmd, (<span class="keywordtype">void</span> *)&amp;(((<a class="code" href="structNvmeCmd.html">NvmeCmd</a> *)sq-&gt;<a class="code" href="structNvmeSQueue.html#ac294c2452da2c57956569dac9c897355">dma_addr_hva</a>)[sq-&gt;<a class="code" href="structNvmeSQueue.html#aec83bc34b2dd3541fda15c0279348264">head</a>]));</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            addr = <a class="code" href="nvme_8h.html#ab5c77706290dc892f52e14dfe39504b6">nvme_discontig</a>(sq-&gt;<a class="code" href="structNvmeSQueue.html#a168092b36fc33b9d4367f36613e9eb9d">prp_list</a>, sq-&gt;<a class="code" href="structNvmeSQueue.html#aec83bc34b2dd3541fda15c0279348264">head</a>, n-&gt;<a class="code" href="structFemuCtrl.html#a6d0418e38e888b2b8980a34198bfd463">page_size</a>,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                                  n-&gt;<a class="code" href="structFemuCtrl.html#a3cbec385b70e8c6a03b463e00ac08d92">sqe_size</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <a class="code" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484">nvme_addr_read</a>(n, addr, (<span class="keywordtype">void</span> *)&amp;cmd, <span class="keyword">sizeof</span>(cmd));</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="nvme-util_8c.html#a0c728e2926a6efc38005202a2b224647">nvme_inc_sq_head</a>(sq);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        req = QTAILQ_FIRST(&amp;sq-&gt;req_list);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        QTAILQ_REMOVE(&amp;sq-&gt;req_list, req, entry);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        memset(&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a8cec02fb87e647c828d06f533aec8758">cqe</a>, 0, <span class="keyword">sizeof</span>(req-&gt;<a class="code" href="structNvmeRequest.html#a8cec02fb87e647c828d06f533aec8758">cqe</a>));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="comment">/* Coperd: record req-&gt;stime at earliest convenience */</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        req-&gt;<a class="code" href="structNvmeRequest.html#a135bf3cba23f12bad28c20805a8f5d93">expire_time</a> = req-&gt;<a class="code" href="structNvmeRequest.html#ad267c178ee13ebb285604043925b5e78">stime</a> = qemu_clock_get_ns(QEMU_CLOCK_REALTIME);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        req-&gt;<a class="code" href="structNvmeRequest.html#a8cec02fb87e647c828d06f533aec8758">cqe</a>.<a class="code" href="structNvmeCqe.html#a8e87b5e0e44fd97e1e92f41c851eb764">cid</a> = cmd.<a class="code" href="structNvmeCmd.html#a80a15bb450d4810749be585c66eba0af">cid</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        req-&gt;<a class="code" href="structNvmeRequest.html#a4469b2b304ba50b7674a4cf4e0ce4a4f">cmd_opcode</a> = cmd.<a class="code" href="structNvmeCmd.html#a2751bc2a772082d3af81124a1d120a0c">opcode</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        memcpy(&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a335e5b18fb079480b1b1a1f06652c647">cmd</a>, &amp;cmd, <span class="keyword">sizeof</span>(<a class="code" href="structNvmeCmd.html">NvmeCmd</a>));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#a3a16108410047b6e7d6ac06c3cb5cd76">print_log</a>) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <a class="code" href="nvme_8h.html#aef2bfc05ccbdba79aef90226efe46ad4">femu_debug</a>(<span class="stringliteral">&quot;%s,cid:%d\n&quot;</span>, __func__, cmd.<a class="code" href="structNvmeCmd.html#a80a15bb450d4810749be585c66eba0af">cid</a>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        status = <a class="code" href="nvme-io_8c.html#ae6d2b4ae7957a876e1e221b7f2ee1fb8">nvme_io_cmd</a>(n, &amp;cmd, req);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordflow">if</span> (1 &amp;&amp; status == <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            req-&gt;<a class="code" href="structNvmeRequest.html#a6c614d6e18850245fb2b05f087c4cc71">status</a> = status;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordtype">int</span> rc = <a class="code" href="rte__ring_8h.html#a3afc06d02f63e84fe1569c99955af57a">femu_ring_enqueue</a>(n-&gt;<a class="code" href="structFemuCtrl.html#a0ff7c6d5e0e6313cc66e2d62f4e98221">to_ftl</a>[index_poller], (<span class="keywordtype">void</span> *)&amp;req, 1);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="keywordflow">if</span> (rc != 1) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;enqueue failed, ret=%d\n&quot;</span>, rc);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (status == <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <span class="comment">/* Normal I/Os that don&#39;t need delay emulation */</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            req-&gt;<a class="code" href="structNvmeRequest.html#a6c614d6e18850245fb2b05f087c4cc71">status</a> = status;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;Error IO processed!\n&quot;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        processed++;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="nvme-io_8c.html#aa8cac05ad399a3b98a28abe2c89b5509">nvme_update_sq_eventidx</a>(sq);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    sq-&gt;<a class="code" href="structNvmeSQueue.html#aaf88cee18475b8a006dfed6793d2a2dd">completed</a> += processed;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_aaa8fe64369c3e7b33785cabed5a4cbde_cgraph.png" border="0" usemap="#nvme-io_8c_aaa8fe64369c3e7b33785cabed5a4cbde_cgraph" alt=""/></div>
<map name="nvme-io_8c_aaa8fe64369c3e7b33785cabed5a4cbde_cgraph" id="nvme-io_8c_aaa8fe64369c3e7b33785cabed5a4cbde_cgraph">
<area shape="rect" title=" " alt="" coords="5,259,163,285"/>
<area shape="rect" href="rte__ring_8h.html#a3afc06d02f63e84fe1569c99955af57a" title=" " alt="" coords="234,56,385,83"/>
<area shape="rect" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484" title=" " alt="" coords="1164,335,1295,361"/>
<area shape="rect" href="nvme-io_8c.html#aa9fdaa77f86c065d69d158184951be32" title=" " alt="" coords="243,157,375,184"/>
<area shape="rect" href="nvme_8h.html#ab5c77706290dc892f52e14dfe39504b6" title=" " alt="" coords="247,208,372,235"/>
<area shape="rect" href="nvme-util_8c.html#a0c728e2926a6efc38005202a2b224647" title=" " alt="" coords="236,259,383,285"/>
<area shape="rect" href="nvme-io_8c.html#ae6d2b4ae7957a876e1e221b7f2ee1fb8" title=" " alt="" coords="253,309,366,336"/>
<area shape="rect" href="nvme-util_8c.html#a4fdc790b9e67ae29e3ef256182ed345b" title=" " alt="" coords="244,360,375,387"/>
<area shape="rect" href="nvme-io_8c.html#aa8cac05ad399a3b98a28abe2c89b5509" title=" " alt="" coords="211,411,408,437"/>
<area shape="rect" href="nvme-util_8c.html#a21b2434a9d5f978d0b4cf9661820ca63" title=" " alt="" coords="680,448,841,475"/>
<area shape="rect" href="rte__ring_8h.html#ab8debfb458e927d559e7ce750048502d" title=" " alt="" coords="456,56,627,83"/>
<area shape="rect" href="rte__ring_8h.html#a388f737bcdf0a8ee4cf6f75464ca5979" title=" " alt="" coords="675,56,847,83"/>
<area shape="rect" href="rte__ring_8h.html#a22ab749e8f41b8e232a5c54a5c100d16" title=" " alt="" coords="895,5,1100,32"/>
<area shape="rect" href="rte__ring_8h.html#a269bf4b0dad1a7d2bb0396350f5e7976" title=" " alt="" coords="950,56,1045,83"/>
<area shape="rect" href="rte__atomic__x86_8h.html#a092485d3d43a2cd7ee61a1c2d2178d31" title=" " alt="" coords="1148,5,1311,32"/>
<area shape="rect" href="nvme-io_8c.html#a1ea0938f847741b1399583080d7bd9ae" title=" " alt="" coords="480,360,603,387"/>
<area shape="rect" href="nvme-io_8c.html#ae1f6c99fbfdd8d6c788ee82c6d13086d" title=" " alt="" coords="494,157,589,184"/>
<area shape="rect" href="nvme-io_8c.html#a0ecae506951d74f3dc9826f76e133d81" title=" " alt="" coords="493,208,590,235"/>
<area shape="rect" href="nvme-io_8c.html#a646ae4b9455eb7bf01b18eea275a2379" title=" " alt="" coords="470,259,613,285"/>
<area shape="rect" href="nvme-io_8c.html#ae3fe0206159ec6d704c59e7393b6d85c" title=" " alt="" coords="471,309,612,336"/>
<area shape="rect" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493" title=" " alt="" coords="936,309,1059,336"/>
<area shape="rect" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183" title=" " alt="" coords="679,259,842,285"/>
<area shape="rect" href="dma_8c.html#adef0f21bc237d992b4ae8b29258645a8" title=" " alt="" coords="701,183,820,209"/>
<area shape="rect" href="dma_8c.html#a08f51254313a657c3826f77e6bd9a1b8" title=" " alt="" coords="474,411,609,437"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_aaa8fe64369c3e7b33785cabed5a4cbde_icgraph.png" border="0" usemap="#nvme-io_8c_aaa8fe64369c3e7b33785cabed5a4cbde_icgraph" alt=""/></div>
<map name="nvme-io_8c_aaa8fe64369c3e7b33785cabed5a4cbde_icgraph" id="nvme-io_8c_aaa8fe64369c3e7b33785cabed5a4cbde_icgraph">
<area shape="rect" title=" " alt="" coords="1425,5,1583,32"/>
<area shape="rect" href="nvme-io_8c.html#acb7bf552fb77faee4d0aa021d51af4b7" title=" " alt="" coords="1275,5,1377,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="a57765d5f7b83e5c6af69f1f5c501beb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57765d5f7b83e5c6af69f1f5c501beb7">&#9670;&nbsp;</a></span>nvme_rw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t nvme_rw </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeCmd.html">NvmeCmd</a> *&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;{</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *rw = (<a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *)cmd;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    uint16_t ctrl = le16_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a7b3727f0aace7fdc211b7c088546cafe">control</a>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    uint32_t nlb  = le16_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a34ba11f86be8f5d4be5518370faf2514">nlb</a>) + 1;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    uint64_t slba = le64_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a0f256de361f51a961d5a44955321b526">slba</a>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    uint64_t prp1 = le64_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a7bca173ee27c96f14ae009205b6fc5cd">prp1</a>);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    uint64_t prp2 = le64_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a15e5effe634f6ed6e9e38e21c6111381">prp2</a>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keyword">const</span> uint8_t lba_index = <a class="code" href="nvme_8h.html#a91333268a64e669e088f20aaf0bfd9b7">NVME_ID_NS_FLBAS_INDEX</a>(ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#ac2061ba91f1d2bf0282bfe22221f65a2">flbas</a>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keyword">const</span> uint16_t ms = le16_to_cpu(ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a751e3c19983752a5acb34244eba649e8">lbaf</a>[lba_index].<a class="code" href="structNvmeLBAF.html#af9a6ca47dd0427de8ce39721e4b79464">ms</a>);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keyword">const</span> uint8_t data_shift = ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a751e3c19983752a5acb34244eba649e8">lbaf</a>[lba_index].<a class="code" href="structNvmeLBAF.html#ac0a10526d855cab5ceed66963c0f5a44">lbads</a>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    uint64_t data_size = (uint64_t)nlb &lt;&lt; data_shift;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    uint64_t data_offset = slba &lt;&lt; data_shift;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    uint64_t meta_size = nlb * ms;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    uint64_t elba = slba + nlb;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    uint16_t err;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    req-&gt;<a class="code" href="structNvmeRequest.html#a6f04006cddb851afcc919412c6e90b60">is_write</a> = (rw-&gt;<a class="code" href="structNvmeRwCmd.html#a3c8ede79fe155517299131fa36319f5a">opcode</a> == <a class="code" href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6af12c69a9bdf0ad418e4a144ef5424336">NVME_CMD_WRITE</a>) ? 1 : 0;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    err = <a class="code" href="nvme-util_8c.html#a13db5864083eb3bdfb33cbb42f2a4350">femu_nvme_rw_check_req</a>(n, ns, cmd, req, slba, elba, nlb, ctrl,</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                 data_size, meta_size);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">if</span> (err)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">return</span> err;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493">nvme_map_prp</a>(&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a678064f3bc45fbeb366ea44aea7273b2">qsg</a>, &amp;req-&gt;<a class="code" href="structNvmeRequest.html#a22a0c24be595ec2abed21073be01efd9">iov</a>, prp1, prp2, data_size, n)) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <a class="code" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183">nvme_set_error_page</a>(n, req-&gt;<a class="code" href="structNvmeRequest.html#a18ef977aa1abc169de646d142d6c77d9">sq</a>-&gt;<a class="code" href="structNvmeSQueue.html#ac5aa365b6e571542994f682254a5e457">sqid</a>, cmd-&gt;<a class="code" href="structNvmeCmd.html#a80a15bb450d4810749be585c66eba0af">cid</a>, <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a>,</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                            offsetof(<a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a>, prp1), 0, ns-&gt;<a class="code" href="structNvmeNamespace.html#aded48306fad86bd7ca9160443a24604d">id</a>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    assert((nlb &lt;&lt; data_shift) == req-&gt;<a class="code" href="structNvmeRequest.html#a678064f3bc45fbeb366ea44aea7273b2">qsg</a>.size);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    req-&gt;<a class="code" href="structNvmeRequest.html#a35d73ae4b2cd7c17e55d20320ac2b1ea">slba</a> = slba;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    req-&gt;<a class="code" href="structNvmeRequest.html#a6c614d6e18850245fb2b05f087c4cc71">status</a> = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    req-&gt;<a class="code" href="structNvmeRequest.html#ab9efcb9c4901c697b16f583893abef3a">nlb</a> = nlb;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    ret = <a class="code" href="dram_8c.html#a1ccbcf0c92b7b084afc9890f3a7e5799">backend_rw</a>(n-&gt;<a class="code" href="structFemuCtrl.html#ab4f555e0b42bfe51c089ab004c88ff48">mbe</a>, &amp;req-&gt;<a class="code" href="structNvmeRequest.html#a678064f3bc45fbeb366ea44aea7273b2">qsg</a>, &amp;data_offset, req-&gt;<a class="code" href="structNvmeRequest.html#a6f04006cddb851afcc919412c6e90b60">is_write</a>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">if</span> (!ret) {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a57765d5f7b83e5c6af69f1f5c501beb7_cgraph.png" border="0" usemap="#nvme-io_8c_a57765d5f7b83e5c6af69f1f5c501beb7_cgraph" alt=""/></div>
<map name="nvme-io_8c_a57765d5f7b83e5c6af69f1f5c501beb7_cgraph" id="nvme-io_8c_a57765d5f7b83e5c6af69f1f5c501beb7_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,88,108"/>
<area shape="rect" href="dram_8c.html#a1ccbcf0c92b7b084afc9890f3a7e5799" title=" " alt="" coords="185,5,283,32"/>
<area shape="rect" href="nvme-util_8c.html#a13db5864083eb3bdfb33cbb42f2a4350" title=" " alt="" coords="136,107,332,133"/>
<area shape="rect" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183" title=" " alt="" coords="380,56,543,83"/>
<area shape="rect" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493" title=" " alt="" coords="173,157,295,184"/>
<area shape="rect" href="nvme_8h.html#a459a9ad482387e92a5fa8fc4c108f3f6" title=" " alt="" coords="428,107,495,133"/>
<area shape="rect" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484" title=" " alt="" coords="396,157,527,184"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a57765d5f7b83e5c6af69f1f5c501beb7_icgraph.png" border="0" usemap="#nvme-io_8c_a57765d5f7b83e5c6af69f1f5c501beb7_icgraph" alt=""/></div>
<map name="nvme-io_8c_a57765d5f7b83e5c6af69f1f5c501beb7_icgraph" id="nvme-io_8c_a57765d5f7b83e5c6af69f1f5c501beb7_icgraph">
<area shape="rect" title=" " alt="" coords="1077,31,1160,57"/>
<area shape="rect" href="bb_8c.html#a3b0eb3030af1311ad77c85da413a32d8" title=" " alt="" coords="924,5,1029,32"/>
<area shape="rect" href="nop_8c.html#a56ad5bb3626f3d51b93f720d91e65e69" title=" " alt="" coords="927,56,1027,83"/>
<area shape="rect" href="bb_8c.html#a86a2ad222c79ea1e3eb798c53f472908" title=" " alt="" coords="784,5,876,32"/>
<area shape="rect" href="nvme_8h.html#a5b8b300920ee99be86c5e3e80a6f7949" title=" " alt="" coords="575,5,736,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
<area shape="rect" href="nvme_8h.html#ad4130ad93f90bb1d6ba3bfd595214751" title=" " alt="" coords="575,56,736,83"/>
</map>
</div>

</div>
</div>
<a id="aa8cac05ad399a3b98a28abe2c89b5509"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8cac05ad399a3b98a28abe2c89b5509">&#9670;&nbsp;</a></span>nvme_update_sq_eventidx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void nvme_update_sq_eventidx </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structNvmeSQueue.html">NvmeSQueue</a> *&#160;</td>
          <td class="paramname"><em>sq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;{</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    <span class="keywordflow">if</span> (sq-&gt;<a class="code" href="structNvmeSQueue.html#a8bb4d3fdefc90c08fb147071153c112d">eventidx_addr_hva</a>) {</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        *((uint32_t *)(sq-&gt;<a class="code" href="structNvmeSQueue.html#a8bb4d3fdefc90c08fb147071153c112d">eventidx_addr_hva</a>)) = sq-&gt;<a class="code" href="structNvmeSQueue.html#a7b8e3b48aee1060ab0095c0dfe449232">tail</a>;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    }</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordflow">if</span> (sq-&gt;<a class="code" href="structNvmeSQueue.html#a019c28f2b0e28a7c7d0f511de65b5045">eventidx_addr</a>) {</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        <a class="code" href="dma_8c.html#a08f51254313a657c3826f77e6bd9a1b8">nvme_addr_write</a>(sq-&gt;<a class="code" href="structNvmeSQueue.html#a09944fa7acccfc87c0c8440aeacc3dc7">ctrl</a>, sq-&gt;<a class="code" href="structNvmeSQueue.html#a019c28f2b0e28a7c7d0f511de65b5045">eventidx_addr</a>, (<span class="keywordtype">void</span> *)&amp;sq-&gt;<a class="code" href="structNvmeSQueue.html#a7b8e3b48aee1060ab0095c0dfe449232">tail</a>,</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                        <span class="keyword">sizeof</span>(sq-&gt;<a class="code" href="structNvmeSQueue.html#a7b8e3b48aee1060ab0095c0dfe449232">tail</a>));</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    }</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_aa8cac05ad399a3b98a28abe2c89b5509_cgraph.png" border="0" usemap="#nvme-io_8c_aa8cac05ad399a3b98a28abe2c89b5509_cgraph" alt=""/></div>
<map name="nvme-io_8c_aa8cac05ad399a3b98a28abe2c89b5509_cgraph" id="nvme-io_8c_aa8cac05ad399a3b98a28abe2c89b5509_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,203,32"/>
<area shape="rect" href="dma_8c.html#a08f51254313a657c3826f77e6bd9a1b8" title=" " alt="" coords="251,5,385,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_aa8cac05ad399a3b98a28abe2c89b5509_icgraph.png" border="0" usemap="#nvme-io_8c_aa8cac05ad399a3b98a28abe2c89b5509_icgraph" alt=""/></div>
<map name="nvme-io_8c_aa8cac05ad399a3b98a28abe2c89b5509_icgraph" id="nvme-io_8c_aa8cac05ad399a3b98a28abe2c89b5509_icgraph">
<area shape="rect" title=" " alt="" coords="1631,5,1828,32"/>
<area shape="rect" href="nvme-io_8c.html#aaa8fe64369c3e7b33785cabed5a4cbde" title=" " alt="" coords="1425,5,1583,32"/>
<area shape="rect" href="nvme-io_8c.html#acb7bf552fb77faee4d0aa021d51af4b7" title=" " alt="" coords="1275,5,1377,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="a646ae4b9455eb7bf01b18eea275a2379"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a646ae4b9455eb7bf01b18eea275a2379">&#9670;&nbsp;</a></span>nvme_write_uncor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t nvme_write_uncor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeCmd.html">NvmeCmd</a> *&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;{</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *rw = (<a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *)cmd;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    uint64_t slba = le64_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a0f256de361f51a961d5a44955321b526">slba</a>);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    uint32_t nlb  = le16_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a34ba11f86be8f5d4be5518370faf2514">nlb</a>) + 1;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">if</span> ((slba + nlb) &gt; ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a4a814e395ae6ea7b3b7c5cba1c22ad85">nsze</a>) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <a class="code" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183">nvme_set_error_page</a>(n, req-&gt;<a class="code" href="structNvmeRequest.html#a18ef977aa1abc169de646d142d6c77d9">sq</a>-&gt;<a class="code" href="structNvmeSQueue.html#ac5aa365b6e571542994f682254a5e457">sqid</a>, cmd-&gt;<a class="code" href="structNvmeCmd.html#a80a15bb450d4810749be585c66eba0af">cid</a>, <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a43aae0e0a370dd16186369148885344f">NVME_LBA_RANGE</a>,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                            offsetof(<a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a>, nlb), slba + nlb, ns-&gt;<a class="code" href="structNvmeNamespace.html#aded48306fad86bd7ca9160443a24604d">id</a>);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a43aae0e0a370dd16186369148885344f">NVME_LBA_RANGE</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    bitmap_set(ns-&gt;<a class="code" href="structNvmeNamespace.html#a82fb6235b209c097c887181151ad33a1">uncorrectable</a>, slba, nlb);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a646ae4b9455eb7bf01b18eea275a2379_cgraph.png" border="0" usemap="#nvme-io_8c_a646ae4b9455eb7bf01b18eea275a2379_cgraph" alt=""/></div>
<map name="nvme-io_8c_a646ae4b9455eb7bf01b18eea275a2379_cgraph" id="nvme-io_8c_a646ae4b9455eb7bf01b18eea275a2379_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,148,32"/>
<area shape="rect" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183" title=" " alt="" coords="196,5,359,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a646ae4b9455eb7bf01b18eea275a2379_icgraph.png" border="0" usemap="#nvme-io_8c_a646ae4b9455eb7bf01b18eea275a2379_icgraph" alt=""/></div>
<map name="nvme-io_8c_a646ae4b9455eb7bf01b18eea275a2379_icgraph" id="nvme-io_8c_a646ae4b9455eb7bf01b18eea275a2379_icgraph">
<area shape="rect" title=" " alt="" coords="1792,5,1935,32"/>
<area shape="rect" href="nvme-io_8c.html#ae6d2b4ae7957a876e1e221b7f2ee1fb8" title=" " alt="" coords="1631,5,1744,32"/>
<area shape="rect" href="nvme-io_8c.html#aaa8fe64369c3e7b33785cabed5a4cbde" title=" " alt="" coords="1425,5,1583,32"/>
<area shape="rect" href="nvme-io_8c.html#acb7bf552fb77faee4d0aa021d51af4b7" title=" " alt="" coords="1275,5,1377,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="ae3fe0206159ec6d704c59e7393b6d85c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3fe0206159ec6d704c59e7393b6d85c">&#9670;&nbsp;</a></span>nvme_write_zeros()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t nvme_write_zeros </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeCmd.html">NvmeCmd</a> *&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;{</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *rw = (<a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *)cmd;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    uint64_t slba = le64_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a0f256de361f51a961d5a44955321b526">slba</a>);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    uint32_t nlb  = le16_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a34ba11f86be8f5d4be5518370faf2514">nlb</a>) + 1;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">if</span> ((slba + nlb) &gt; ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a4a814e395ae6ea7b3b7c5cba1c22ad85">nsze</a>) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <a class="code" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183">nvme_set_error_page</a>(n, req-&gt;<a class="code" href="structNvmeRequest.html#a18ef977aa1abc169de646d142d6c77d9">sq</a>-&gt;<a class="code" href="structNvmeSQueue.html#ac5aa365b6e571542994f682254a5e457">sqid</a>, cmd-&gt;<a class="code" href="structNvmeCmd.html#a80a15bb450d4810749be585c66eba0af">cid</a>, <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a43aae0e0a370dd16186369148885344f">NVME_LBA_RANGE</a>,</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                            offsetof(<a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a>, nlb), slba + nlb, ns-&gt;<a class="code" href="structNvmeNamespace.html#aded48306fad86bd7ca9160443a24604d">id</a>);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a43aae0e0a370dd16186369148885344f">NVME_LBA_RANGE</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_ae3fe0206159ec6d704c59e7393b6d85c_cgraph.png" border="0" usemap="#nvme-io_8c_ae3fe0206159ec6d704c59e7393b6d85c_cgraph" alt=""/></div>
<map name="nvme-io_8c_ae3fe0206159ec6d704c59e7393b6d85c_cgraph" id="nvme-io_8c_ae3fe0206159ec6d704c59e7393b6d85c_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,147,32"/>
<area shape="rect" href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183" title=" " alt="" coords="195,5,357,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_ae3fe0206159ec6d704c59e7393b6d85c_icgraph.png" border="0" usemap="#nvme-io_8c_ae3fe0206159ec6d704c59e7393b6d85c_icgraph" alt=""/></div>
<map name="nvme-io_8c_ae3fe0206159ec6d704c59e7393b6d85c_icgraph" id="nvme-io_8c_ae3fe0206159ec6d704c59e7393b6d85c_icgraph">
<area shape="rect" title=" " alt="" coords="1792,5,1933,32"/>
<area shape="rect" href="nvme-io_8c.html#ae6d2b4ae7957a876e1e221b7f2ee1fb8" title=" " alt="" coords="1631,5,1744,32"/>
<area shape="rect" href="nvme-io_8c.html#aaa8fe64369c3e7b33785cabed5a4cbde" title=" " alt="" coords="1425,5,1583,32"/>
<area shape="rect" href="nvme-io_8c.html#acb7bf552fb77faee4d0aa021d51af4b7" title=" " alt="" coords="1275,5,1377,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="af3708eed16007bc4b715785d1ea06cd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3708eed16007bc4b715785d1ea06cd0">&#9670;&nbsp;</a></span>set_pos()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_pos </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;{</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    ((<a class="code" href="structNvmeRequest.html">NvmeRequest</a> *)a)-&gt;pos = pos;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_af3708eed16007bc4b715785d1ea06cd0_icgraph.png" border="0" usemap="#nvme-io_8c_af3708eed16007bc4b715785d1ea06cd0_icgraph" alt=""/></div>
<map name="nvme-io_8c_af3708eed16007bc4b715785d1ea06cd0_icgraph" id="nvme-io_8c_af3708eed16007bc4b715785d1ea06cd0_icgraph">
<area shape="rect" title=" " alt="" coords="1275,5,1347,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
<a id="a4201ce0351a86f139fa684f7b963f867"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4201ce0351a86f139fa684f7b963f867">&#9670;&nbsp;</a></span>set_pri()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void set_pri </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pqueue_8h.html#ad8239ddc32134716f57e54bb972f6bf0">pqueue_pri_t</a>&#160;</td>
          <td class="paramname"><em>pri</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;{</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    ((<a class="code" href="structNvmeRequest.html">NvmeRequest</a> *)a)-&gt;expire_time = pri;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="nvme-io_8c_a4201ce0351a86f139fa684f7b963f867_icgraph.png" border="0" usemap="#nvme-io_8c_a4201ce0351a86f139fa684f7b963f867_icgraph" alt=""/></div>
<map name="nvme-io_8c_a4201ce0351a86f139fa684f7b963f867_icgraph" id="nvme-io_8c_a4201ce0351a86f139fa684f7b963f867_icgraph">
<area shape="rect" title=" " alt="" coords="1275,5,1341,32"/>
<area shape="rect" href="nvme_8h.html#a81f7e8af7ddcdfe9bef6af6c0333462d" title=" " alt="" coords="1076,5,1227,32"/>
<area shape="rect" href="nvme-admin_8c.html#a8b2764426b75545dfc03229b811607eb" title=" " alt="" coords="857,5,1028,32"/>
<area shape="rect" href="nvme-admin_8c.html#ac726ef5f792706a8a28f07f19c5097b1" title=" " alt="" coords="667,5,809,32"/>
<area shape="rect" href="nvme_8h.html#a7042f589909852500d6f26c36b78850b" title=" " alt="" coords="432,5,619,32"/>
<area shape="rect" href="femu_8c.html#ac83bc83578ac4c5c414ec892ca2169e3" title=" " alt="" coords="197,5,384,32"/>
<area shape="rect" href="femu_8c.html#a78a5db5b8b1cead9d84276dfeeb4b066" title=" " alt="" coords="5,5,149,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="adma_8c_html_adef0f21bc237d992b4ae8b29258645a8"><div class="ttname"><a href="dma_8c.html#adef0f21bc237d992b4ae8b29258645a8">dma_write_prp</a></div><div class="ttdeci">uint16_t dma_write_prp(FemuCtrl *n, uint8_t *ptr, uint32_t len, uint64_t prp1, uint64_t prp2)</div><div class="ttdef"><b>Definition:</b> dma.c:112</div></div>
<div class="ttc" id="astructNvmePollerThreadArgument_html"><div class="ttname"><a href="structNvmePollerThreadArgument.html">NvmePollerThreadArgument</a></div><div class="ttdef"><b>Definition:</b> nvme.h:1329</div></div>
<div class="ttc" id="astructNvmeCQueue_html"><div class="ttname"><a href="structNvmeCQueue.html">NvmeCQueue</a></div><div class="ttdef"><b>Definition:</b> nvme.h:1028</div></div>
<div class="ttc" id="astructNvmeCmd_html"><div class="ttname"><a href="structNvmeCmd.html">NvmeCmd</a></div><div class="ttdef"><b>Definition:</b> nvme.h:290</div></div>
<div class="ttc" id="astructNvmeSQueue_html_a019c28f2b0e28a7c7d0f511de65b5045"><div class="ttname"><a href="structNvmeSQueue.html#a019c28f2b0e28a7c7d0f511de65b5045">NvmeSQueue::eventidx_addr</a></div><div class="ttdeci">uint64_t eventidx_addr</div><div class="ttdef"><b>Definition:</b> nvme.h:1023</div></div>
<div class="ttc" id="aintr_8c_html_ac07d39a331aa32f4da4f27f31f1abc1c"><div class="ttname"><a href="intr_8c.html#ac07d39a331aa32f4da4f27f31f1abc1c">nvme_isr_notify_io</a></div><div class="ttdeci">void nvme_isr_notify_io(void *opaque)</div><div class="ttdef"><b>Definition:</b> intr.c:178</div></div>
<div class="ttc" id="anvme-io_8c_html_aa9fdaa77f86c065d69d158184951be32"><div class="ttname"><a href="nvme-io_8c.html#aa9fdaa77f86c065d69d158184951be32">nvme_copy_cmd</a></div><div class="ttdeci">static void nvme_copy_cmd(NvmeCmd *dst, NvmeCmd *src)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:18</div></div>
<div class="ttc" id="astructNvmeCmd_html_a542065d60952eff1b4de0fdf3ecb5b29"><div class="ttname"><a href="structNvmeCmd.html#a542065d60952eff1b4de0fdf3ecb5b29">NvmeCmd::cdw11</a></div><div class="ttdeci">uint32_t cdw11</div><div class="ttdef"><b>Definition:</b> nvme.h:301</div></div>
<div class="ttc" id="anvme_8h_html_ac91f8d2a189a788ba37134daaeb87afa"><div class="ttname"><a href="nvme_8h.html#ac91f8d2a189a788ba37134daaeb87afa">CQ_POLLING_PERIOD_NS</a></div><div class="ttdeci">#define CQ_POLLING_PERIOD_NS</div><div class="ttdef"><b>Definition:</b> nvme.h:1341</div></div>
<div class="ttc" id="astructNvmeCQueue_html_a8b941ba9a13366bf3348b3b7e73009a1"><div class="ttname"><a href="structNvmeCQueue.html#a8b941ba9a13366bf3348b3b7e73009a1">NvmeCQueue::is_active</a></div><div class="ttdeci">bool is_active</div><div class="ttdef"><b>Definition:</b> nvme.h:1050</div></div>
<div class="ttc" id="astructNvmeRequest_html_a335e5b18fb079480b1b1a1f06652c647"><div class="ttname"><a href="structNvmeRequest.html#a335e5b18fb079480b1b1a1f06652c647">NvmeRequest::cmd</a></div><div class="ttdeci">NvmeCmd cmd</div><div class="ttdef"><b>Definition:</b> nvme.h:975</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a43aae0e0a370dd16186369148885344f"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a43aae0e0a370dd16186369148885344f">NVME_LBA_RANGE</a></div><div class="ttdeci">@ NVME_LBA_RANGE</div><div class="ttdef"><b>Definition:</b> nvme.h:534</div></div>
<div class="ttc" id="astructNvmeNamespace_html_aded48306fad86bd7ca9160443a24604d"><div class="ttname"><a href="structNvmeNamespace.html#aded48306fad86bd7ca9160443a24604d">NvmeNamespace::id</a></div><div class="ttdeci">uint32_t id</div><div class="ttdef"><b>Definition:</b> nvme.h:1065</div></div>
<div class="ttc" id="anvme-io_8c_html_ae6d2b4ae7957a876e1e221b7f2ee1fb8"><div class="ttname"><a href="nvme-io_8c.html#ae6d2b4ae7957a876e1e221b7f2ee1fb8">nvme_io_cmd</a></div><div class="ttdeci">static uint16_t nvme_io_cmd(FemuCtrl *n, NvmeCmd *cmd, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:482</div></div>
<div class="ttc" id="anvme-io_8c_html_a0ecae506951d74f3dc9826f76e133d81"><div class="ttname"><a href="nvme-io_8c.html#a0ecae506951d74f3dc9826f76e133d81">nvme_flush</a></div><div class="ttdeci">static uint16_t nvme_flush(FemuCtrl *n, NvmeNamespace *ns, NvmeCmd *cmd, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:442</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4af18fa6d57f0141bce4f99d6e19965635"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4af18fa6d57f0141bce4f99d6e19965635">NVME_CMP_FAILURE</a></div><div class="ttdeci">@ NVME_CMP_FAILURE</div><div class="ttdef"><b>Definition:</b> nvme.h:571</div></div>
<div class="ttc" id="astructNvmeSQueue_html_a09944fa7acccfc87c0c8440aeacc3dc7"><div class="ttname"><a href="structNvmeSQueue.html#a09944fa7acccfc87c0c8440aeacc3dc7">NvmeSQueue::ctrl</a></div><div class="ttdeci">struct FemuCtrl * ctrl</div><div class="ttdef"><b>Definition:</b> nvme.h:1004</div></div>
<div class="ttc" id="astructFemuCtrl_html"><div class="ttname"><a href="structFemuCtrl.html">FemuCtrl</a></div><div class="ttdef"><b>Definition:</b> nvme.h:1170</div></div>
<div class="ttc" id="astructFemuCtrl_html_a3a16108410047b6e7d6ac06c3cb5cd76"><div class="ttname"><a href="structFemuCtrl.html#a3a16108410047b6e7d6ac06c3cb5cd76">FemuCtrl::print_log</a></div><div class="ttdeci">bool print_log</div><div class="ttdef"><b>Definition:</b> nvme.h:1320</div></div>
<div class="ttc" id="astructFemuCtrl_html_a9f37c1e2d56205e4c7d0015aa9af44e2"><div class="ttname"><a href="structFemuCtrl.html#a9f37c1e2d56205e4c7d0015aa9af44e2">FemuCtrl::sq</a></div><div class="ttdeci">NvmeSQueue ** sq</div><div class="ttdef"><b>Definition:</b> nvme.h:1266</div></div>
<div class="ttc" id="anvme-io_8c_html_a1ea0938f847741b1399583080d7bd9ae"><div class="ttname"><a href="nvme-io_8c.html#a1ea0938f847741b1399583080d7bd9ae">nvme_compare</a></div><div class="ttdeci">static uint16_t nvme_compare(FemuCtrl *n, NvmeNamespace *ns, NvmeCmd *cmd, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:391</div></div>
<div class="ttc" id="apqueue_8h_html_abec9363c7a9cc89190bf0925a4a1652c"><div class="ttname"><a href="pqueue_8h.html#abec9363c7a9cc89190bf0925a4a1652c">pqueue_pop</a></div><div class="ttdeci">void * pqueue_pop(pqueue_t *q)</div><div class="ttdef"><b>Definition:</b> pqueue.c:172</div></div>
<div class="ttc" id="astructFemuCtrl_html_a2b07accc41de60cd0c6de43adde355ad"><div class="ttname"><a href="structFemuCtrl.html#a2b07accc41de60cd0c6de43adde355ad">FemuCtrl::ext_ops</a></div><div class="ttdeci">FemuExtCtrlOps ext_ops</div><div class="ttdef"><b>Definition:</b> nvme.h:1206</div></div>
<div class="ttc" id="astructNvmeCqe_html_af30104c7014aee1c55b68672efc0c143"><div class="ttname"><a href="structNvmeCqe.html#af30104c7014aee1c55b68672efc0c143">NvmeCqe::status</a></div><div class="ttdeci">uint16_t status</div><div class="ttdef"><b>Definition:</b> nvme.h:516</div></div>
<div class="ttc" id="anvme-io_8c_html_aa8cac05ad399a3b98a28abe2c89b5509"><div class="ttname"><a href="nvme-io_8c.html#aa8cac05ad399a3b98a28abe2c89b5509">nvme_update_sq_eventidx</a></div><div class="ttdeci">static void nvme_update_sq_eventidx(const NvmeSQueue *sq)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:5</div></div>
<div class="ttc" id="astructNvmeRequest_html_a678064f3bc45fbeb366ea44aea7273b2"><div class="ttname"><a href="structNvmeRequest.html#a678064f3bc45fbeb366ea44aea7273b2">NvmeRequest::qsg</a></div><div class="ttdeci">QEMUSGList qsg</div><div class="ttdef"><b>Definition:</b> nvme.h:978</div></div>
<div class="ttc" id="astructNvmeCQueue_html_a81de77c41f0fe454ab844dff5914bae5"><div class="ttname"><a href="structNvmeCQueue.html#a81de77c41f0fe454ab844dff5914bae5">NvmeCQueue::cqid</a></div><div class="ttdeci">uint16_t cqid</div><div class="ttdef"><b>Definition:</b> nvme.h:1032</div></div>
<div class="ttc" id="anvme_8h_html_a01e3a918ff89282c841471f5d797fbf6a324318d7d84def33dd8a53724f14ab10"><div class="ttname"><a href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a324318d7d84def33dd8a53724f14ab10">NVME_CMD_DSM</a></div><div class="ttdeci">@ NVME_CMD_DSM</div><div class="ttdef"><b>Definition:</b> nvme.h:339</div></div>
<div class="ttc" id="anvme_8h_html_acd64982aef4cb1864b53952a92068c27"><div class="ttname"><a href="nvme_8h.html#acd64982aef4cb1864b53952a92068c27">BBSSD</a></div><div class="ttdeci">static bool BBSSD(FemuCtrl *n)</div><div class="ttdef"><b>Definition:</b> nvme.h:1368</div></div>
<div class="ttc" id="astructNvmeNamespace_html_a82fb6235b209c097c887181151ad33a1"><div class="ttname"><a href="structNvmeNamespace.html#a82fb6235b209c097c887181151ad33a1">NvmeNamespace::uncorrectable</a></div><div class="ttdeci">unsigned long * uncorrectable</div><div class="ttdef"><b>Definition:</b> nvme.h:1064</div></div>
<div class="ttc" id="astructNvmeRwCmd_html_a7bca173ee27c96f14ae009205b6fc5cd"><div class="ttname"><a href="structNvmeRwCmd.html#a7bca173ee27c96f14ae009205b6fc5cd">NvmeRwCmd::prp1</a></div><div class="ttdeci">uint64_t prp1</div><div class="ttdef"><b>Definition:</b> nvme.h:422</div></div>
<div class="ttc" id="anvme-io_8c_html_a4d0ede8cb67c2a87a6af7ba60b878b86"><div class="ttname"><a href="nvme-io_8c.html#a4d0ede8cb67c2a87a6af7ba60b878b86">get_pri</a></div><div class="ttdeci">static pqueue_pri_t get_pri(void *a)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:240</div></div>
<div class="ttc" id="astructNvmeSQueue_html_ac294c2452da2c57956569dac9c897355"><div class="ttname"><a href="structNvmeSQueue.html#ac294c2452da2c57956569dac9c897355">NvmeSQueue::dma_addr_hva</a></div><div class="ttdeci">uint64_t dma_addr_hva</div><div class="ttdef"><b>Definition:</b> nvme.h:1013</div></div>
<div class="ttc" id="anvme-io_8c_html_a581e208522e056298eed5248b50af242"><div class="ttname"><a href="nvme-io_8c.html#a581e208522e056298eed5248b50af242">nvme_process_cq_cpl</a></div><div class="ttdeci">static void nvme_process_cq_cpl(void *arg, int index_poller)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:123</div></div>
<div class="ttc" id="astructNvmeCmd_html_a80a15bb450d4810749be585c66eba0af"><div class="ttname"><a href="structNvmeCmd.html#a80a15bb450d4810749be585c66eba0af">NvmeCmd::cid</a></div><div class="ttdeci">uint16_t cid</div><div class="ttdef"><b>Definition:</b> nvme.h:295</div></div>
<div class="ttc" id="astructNvmeCQueue_html_a8ecbdfc4863d2633f279c2ae70dff1dd"><div class="ttname"><a href="structNvmeCQueue.html#a8ecbdfc4863d2633f279c2ae70dff1dd">NvmeCQueue::tail</a></div><div class="ttdeci">uint32_t tail</div><div class="ttdef"><b>Definition:</b> nvme.h:1035</div></div>
<div class="ttc" id="astructFemuCtrl_html_a6635a90258a97f71c6040b6cb9277b04"><div class="ttname"><a href="structFemuCtrl.html#a6635a90258a97f71c6040b6cb9277b04">FemuCtrl::multipoller_enabled</a></div><div class="ttdeci">uint8_t multipoller_enabled</div><div class="ttdef"><b>Definition:</b> nvme.h:1322</div></div>
<div class="ttc" id="adram_8c_html_a1ccbcf0c92b7b084afc9890f3a7e5799"><div class="ttname"><a href="dram_8c.html#a1ccbcf0c92b7b084afc9890f3a7e5799">backend_rw</a></div><div class="ttdeci">int backend_rw(SsdDramBackend *b, QEMUSGList *qsg, uint64_t *lbal, bool is_write)</div><div class="ttdef"><b>Definition:</b> dram.c:29</div></div>
<div class="ttc" id="anvme_8h_html_a01e3a918ff89282c841471f5d797fbf6a95c9b9c84ed8581bc4a06c07611e594c"><div class="ttname"><a href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a95c9b9c84ed8581bc4a06c07611e594c">NVME_CMD_FLUSH</a></div><div class="ttdeci">@ NVME_CMD_FLUSH</div><div class="ttdef"><b>Definition:</b> nvme.h:333</div></div>
<div class="ttc" id="anvme_8h_html_aef2bfc05ccbdba79aef90226efe46ad4"><div class="ttname"><a href="nvme_8h.html#aef2bfc05ccbdba79aef90226efe46ad4">femu_debug</a></div><div class="ttdeci">#define femu_debug(fmt,...)</div><div class="ttdef"><b>Definition:</b> nvme.h:1485</div></div>
<div class="ttc" id="astructNvmeRequest_html_a6c614d6e18850245fb2b05f087c4cc71"><div class="ttname"><a href="structNvmeRequest.html#a6c614d6e18850245fb2b05f087c4cc71">NvmeRequest::status</a></div><div class="ttdeci">uint16_t status</div><div class="ttdef"><b>Definition:</b> nvme.h:965</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a></div><div class="ttdeci">@ NVME_SUCCESS</div><div class="ttdef"><b>Definition:</b> nvme.h:520</div></div>
<div class="ttc" id="astructFemuCtrl_html_a78baba4717dd495d81af587a1a95a0b7"><div class="ttname"><a href="structFemuCtrl.html#a78baba4717dd495d81af587a1a95a0b7">FemuCtrl::num_poller</a></div><div class="ttdeci">uint32_t num_poller</div><div class="ttdef"><b>Definition:</b> nvme.h:1323</div></div>
<div class="ttc" id="astructNvmeNamespace_html_afc01a4df7d13a2a27416a4472efec6d1"><div class="ttname"><a href="structNvmeNamespace.html#afc01a4df7d13a2a27416a4472efec6d1">NvmeNamespace::util</a></div><div class="ttdeci">unsigned long * util</div><div class="ttdef"><b>Definition:</b> nvme.h:1063</div></div>
<div class="ttc" id="astructFemuCtrl_html_a3cbec385b70e8c6a03b463e00ac08d92"><div class="ttname"><a href="structFemuCtrl.html#a3cbec385b70e8c6a03b463e00ac08d92">FemuCtrl::sqe_size</a></div><div class="ttdeci">uint16_t sqe_size</div><div class="ttdef"><b>Definition:</b> nvme.h:1214</div></div>
<div class="ttc" id="astructNvmeRwCmd_html_a0f256de361f51a961d5a44955321b526"><div class="ttname"><a href="structNvmeRwCmd.html#a0f256de361f51a961d5a44955321b526">NvmeRwCmd::slba</a></div><div class="ttdeci">uint64_t slba</div><div class="ttdef"><b>Definition:</b> nvme.h:424</div></div>
<div class="ttc" id="astructFemuCtrl_html_a226acb27573ba9226d9a426b95bfca20"><div class="ttname"><a href="structFemuCtrl.html#a226acb27573ba9226d9a426b95bfca20">FemuCtrl::poller</a></div><div class="ttdeci">QemuThread * poller</div><div class="ttdef"><b>Definition:</b> nvme.h:1258</div></div>
<div class="ttc" id="anvme_8h_html_a01e3a918ff89282c841471f5d797fbf6ada1d765c850987feea79854f0141694b"><div class="ttname"><a href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6ada1d765c850987feea79854f0141694b">NVME_CMD_COMPARE</a></div><div class="ttdeci">@ NVME_CMD_COMPARE</div><div class="ttdef"><b>Definition:</b> nvme.h:337</div></div>
<div class="ttc" id="astructNvmeCQueue_html_a212c26a71132a5d3ca6e4c3992773235"><div class="ttname"><a href="structNvmeCQueue.html#a212c26a71132a5d3ca6e4c3992773235">NvmeCQueue::dma_addr</a></div><div class="ttdeci">uint64_t dma_addr</div><div class="ttdef"><b>Definition:</b> nvme.h:1039</div></div>
<div class="ttc" id="arte__ring_8h_html_abf9a7cda8ef5a62ee0a286c11d45d1bf"><div class="ttname"><a href="rte__ring_8h.html#abf9a7cda8ef5a62ee0a286c11d45d1bf">rte_ring_empty</a></div><div class="ttdeci">static int rte_ring_empty(const struct rte_ring *r)</div><div class="ttdef"><b>Definition:</b> rte_ring.h:909</div></div>
<div class="ttc" id="astructNvmeRequest_html_ab9efcb9c4901c697b16f583893abef3a"><div class="ttname"><a href="structNvmeRequest.html#ab9efcb9c4901c697b16f583893abef3a">NvmeRequest::nlb</a></div><div class="ttdeci">uint16_t nlb</div><div class="ttdef"><b>Definition:</b> nvme.h:968</div></div>
<div class="ttc" id="astructFemuCtrl_html_a4bd5012806e5cda6eb475cb787f4be3d"><div class="ttname"><a href="structFemuCtrl.html#a4bd5012806e5cda6eb475cb787f4be3d">FemuCtrl::features</a></div><div class="ttdeci">NvmeFeatureVal features</div><div class="ttdef"><b>Definition:</b> nvme.h:1270</div></div>
<div class="ttc" id="astructNvmeNamespace_html"><div class="ttname"><a href="structNvmeNamespace.html">NvmeNamespace</a></div><div class="ttdef"><b>Definition:</b> nvme.h:1059</div></div>
<div class="ttc" id="anvme_8h_html_ab04a0655cd1e3bcac5e8f48c18df1a57a2e60c51eabf70f9dd6ea2eb32dd3d915"><div class="ttname"><a href="nvme_8h.html#ab04a0655cd1e3bcac5e8f48c18df1a57a2e60c51eabf70f9dd6ea2eb32dd3d915">NVME_DSMGMT_AD</a></div><div class="ttdeci">@ NVME_DSMGMT_AD</div><div class="ttdef"><b>Definition:</b> nvme.h:473</div></div>
<div class="ttc" id="astructNvmeDsmRange_html"><div class="ttname"><a href="structNvmeDsmRange.html">NvmeDsmRange</a></div><div class="ttdef"><b>Definition:</b> nvme.h:476</div></div>
<div class="ttc" id="anvme_8h_html_a01e3a918ff89282c841471f5d797fbf6af12c69a9bdf0ad418e4a144ef5424336"><div class="ttname"><a href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6af12c69a9bdf0ad418e4a144ef5424336">NVME_CMD_WRITE</a></div><div class="ttdeci">@ NVME_CMD_WRITE</div><div class="ttdef"><b>Definition:</b> nvme.h:334</div></div>
<div class="ttc" id="astructNvmeNamespace_html_a0ed912de2d37b54d07b1f27deb7c5bb6"><div class="ttname"><a href="structNvmeNamespace.html#a0ed912de2d37b54d07b1f27deb7c5bb6">NvmeNamespace::start_block</a></div><div class="ttdeci">uint64_t start_block</div><div class="ttdef"><b>Definition:</b> nvme.h:1068</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a></div><div class="ttdeci">@ NVME_DNR</div><div class="ttdef"><b>Definition:</b> nvme.h:575</div></div>
<div class="ttc" id="arte__ring_8h_html_a40c2b32849ee40a3926720f2ab1cdec7ad2388957eaf21c85bc07f6044f60af88"><div class="ttname"><a href="rte__ring_8h.html#a40c2b32849ee40a3926720f2ab1cdec7ad2388957eaf21c85bc07f6044f60af88">FEMU_RING_TYPE_MP_SC</a></div><div class="ttdeci">@ FEMU_RING_TYPE_MP_SC</div><div class="ttdef"><b>Definition:</b> rte_ring.h:1123</div></div>
<div class="ttc" id="anvme-io_8c_html_aaa8fe64369c3e7b33785cabed5a4cbde"><div class="ttname"><a href="nvme-io_8c.html#aaa8fe64369c3e7b33785cabed5a4cbde">nvme_process_sq_io</a></div><div class="ttdeci">static void nvme_process_sq_io(void *opaque, int index_poller)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:39</div></div>
<div class="ttc" id="astructNvmeSQueue_html_a007bae54f6cd81bd45ddbe5fc64cf993"><div class="ttname"><a href="structNvmeSQueue.html#a007bae54f6cd81bd45ddbe5fc64cf993">NvmeSQueue::is_active</a></div><div class="ttdeci">bool is_active</div><div class="ttdef"><b>Definition:</b> nvme.h:1025</div></div>
<div class="ttc" id="astructNvmeCmd_html_aa0daded9eb948cb9c13ae14a0852ed08"><div class="ttname"><a href="structNvmeCmd.html#aa0daded9eb948cb9c13ae14a0852ed08">NvmeCmd::nsid</a></div><div class="ttdeci">uint32_t nsid</div><div class="ttdef"><b>Definition:</b> nvme.h:296</div></div>
<div class="ttc" id="anvme-util_8c_html_a0c728e2926a6efc38005202a2b224647"><div class="ttname"><a href="nvme-util_8c.html#a0c728e2926a6efc38005202a2b224647">nvme_inc_sq_head</a></div><div class="ttdeci">void nvme_inc_sq_head(NvmeSQueue *sq)</div><div class="ttdef"><b>Definition:</b> nvme-util.c:22</div></div>
<div class="ttc" id="arte__ring_8h_html_ab2417e0e85ffd0e61ec4b0ee263ab809"><div class="ttname"><a href="rte__ring_8h.html#ab2417e0e85ffd0e61ec4b0ee263ab809">femu_ring_dequeue</a></div><div class="ttdeci">size_t femu_ring_dequeue(struct rte_ring *ring, void **objs, size_t count)</div><div class="ttdef"><b>Definition:</b> rte_ring.c:228</div></div>
<div class="ttc" id="anvme_8h_html_a3137e88859bdb464f96bebbb259bbf8aa2354e6a55a5d0065b8dfd3a33af6221d"><div class="ttname"><a href="nvme_8h.html#a3137e88859bdb464f96bebbb259bbf8aa2354e6a55a5d0065b8dfd3a33af6221d">NVME_ONCS_WRITE_UNCORR</a></div><div class="ttdeci">@ NVME_ONCS_WRITE_UNCORR</div><div class="ttdef"><b>Definition:</b> nvme.h:763</div></div>
<div class="ttc" id="apqueue_8h_html_a2c27c13ed1c988e9fc7b259e6820ca8c"><div class="ttname"><a href="pqueue_8h.html#a2c27c13ed1c988e9fc7b259e6820ca8c">pqueue_init</a></div><div class="ttdeci">pqueue_t * pqueue_init(size_t n, pqueue_cmp_pri_f cmppri, pqueue_get_pri_f getpri, pqueue_set_pri_f setpri, pqueue_get_pos_f getpos, pqueue_set_pos_f setpos)</div><div class="ttdef"><b>Definition:</b> pqueue.c:37</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a5157ff55aedb970b020e6602903bd46a"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a5157ff55aedb970b020e6602903bd46a">NVME_UNRECOVERED_READ</a></div><div class="ttdeci">@ NVME_UNRECOVERED_READ</div><div class="ttdef"><b>Definition:</b> nvme.h:567</div></div>
<div class="ttc" id="astructNvmeRequest_html_a22a0c24be595ec2abed21073be01efd9"><div class="ttname"><a href="structNvmeRequest.html#a22a0c24be595ec2abed21073be01efd9">NvmeRequest::iov</a></div><div class="ttdeci">QEMUIOVector iov</div><div class="ttdef"><b>Definition:</b> nvme.h:979</div></div>
<div class="ttc" id="astructNvmeSQueue_html"><div class="ttname"><a href="structNvmeSQueue.html">NvmeSQueue</a></div><div class="ttdef"><b>Definition:</b> nvme.h:1003</div></div>
<div class="ttc" id="arte__ring_8h_html_a6bc92444f7239ca27c5a89de99f5f4ac"><div class="ttname"><a href="rte__ring_8h.html#a6bc92444f7239ca27c5a89de99f5f4ac">femu_ring_create</a></div><div class="ttdeci">struct rte_ring * femu_ring_create(enum femu_ring_type type, size_t count)</div><div class="ttdef"><b>Definition:</b> rte_ring.c:187</div></div>
<div class="ttc" id="anvme-util_8c_html_a13db5864083eb3bdfb33cbb42f2a4350"><div class="ttname"><a href="nvme-util_8c.html#a13db5864083eb3bdfb33cbb42f2a4350">femu_nvme_rw_check_req</a></div><div class="ttdeci">uint16_t femu_nvme_rw_check_req(FemuCtrl *n, NvmeNamespace *ns, NvmeCmd *cmd, NvmeRequest *req, uint64_t slba, uint64_t elba, uint32_t nlb, uint16_t ctrl, uint64_t data_size, uint64_t meta_size)</div><div class="ttdef"><b>Definition:</b> nvme-util.c:107</div></div>
<div class="ttc" id="astructNvmeRequest_html_ad267c178ee13ebb285604043925b5e78"><div class="ttname"><a href="structNvmeRequest.html#ad267c178ee13ebb285604043925b5e78">NvmeRequest::stime</a></div><div class="ttdeci">int64_t stime</div><div class="ttdef"><b>Definition:</b> nvme.h:981</div></div>
<div class="ttc" id="astructNvmeNamespace_html_ac5c0ddf3fd8b71e4387062b8a5e1075d"><div class="ttname"><a href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">NvmeNamespace::id_ns</a></div><div class="ttdeci">NvmeIdNs id_ns</div><div class="ttdef"><b>Definition:</b> nvme.h:1061</div></div>
<div class="ttc" id="astructNvmeCQueue_html_a376ae99c71a9fb4157bd4fb45b2a5090"><div class="ttname"><a href="structNvmeCQueue.html#a376ae99c71a9fb4157bd4fb45b2a5090">NvmeCQueue::phys_contig</a></div><div class="ttdeci">uint8_t phys_contig</div><div class="ttdef"><b>Definition:</b> nvme.h:1030</div></div>
<div class="ttc" id="astructNvmeRequest_html_a3609469c3f31833cb86006bae283e160"><div class="ttname"><a href="structNvmeRequest.html#a3609469c3f31833cb86006bae283e160">NvmeRequest::ns</a></div><div class="ttdeci">struct NvmeNamespace * ns</div><div class="ttdef"><b>Definition:</b> nvme.h:964</div></div>
<div class="ttc" id="astructFemuCtrl_html_a252a9c514e961fa6355b50061862bd34"><div class="ttname"><a href="structFemuCtrl.html#a252a9c514e961fa6355b50061862bd34">FemuCtrl::nr_tt_ios</a></div><div class="ttdeci">int64_t nr_tt_ios</div><div class="ttdef"><b>Definition:</b> nvme.h:1318</div></div>
<div class="ttc" id="astructNvmeCqe_html"><div class="ttname"><a href="structNvmeCqe.html">NvmeCqe</a></div><div class="ttdef"><b>Definition:</b> nvme.h:505</div></div>
<div class="ttc" id="astructNvmeRwCmd_html_a7b3727f0aace7fdc211b7c088546cafe"><div class="ttname"><a href="structNvmeRwCmd.html#a7b3727f0aace7fdc211b7c088546cafe">NvmeRwCmd::control</a></div><div class="ttdeci">uint16_t control</div><div class="ttdef"><b>Definition:</b> nvme.h:426</div></div>
<div class="ttc" id="astructFemuCtrl_html_a78003b6c4ed89a589c99c4b01b9c689a"><div class="ttname"><a href="structFemuCtrl.html#a78003b6c4ed89a589c99c4b01b9c689a">FemuCtrl::should_isr</a></div><div class="ttdeci">bool * should_isr</div><div class="ttdef"><b>Definition:</b> nvme.h:1315</div></div>
<div class="ttc" id="astructrte__ring_html"><div class="ttname"><a href="structrte__ring.html">rte_ring</a></div><div class="ttdef"><b>Definition:</b> rte_ring.h:127</div></div>
<div class="ttc" id="apqueue_8h_html_addd8cdfbc8c47b8cdd7eb4c4560de7aa"><div class="ttname"><a href="pqueue_8h.html#addd8cdfbc8c47b8cdd7eb4c4560de7aa">pqueue_insert</a></div><div class="ttdeci">int pqueue_insert(pqueue_t *q, void *d)</div><div class="ttdef"><b>Definition:</b> pqueue.c:122</div></div>
<div class="ttc" id="adma_8c_html_a0ac25a907651fbfbf9710b15dc45e484"><div class="ttname"><a href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484">nvme_addr_read</a></div><div class="ttdeci">void nvme_addr_read(FemuCtrl *n, hwaddr addr, void *buf, int size)</div><div class="ttdef"><b>Definition:</b> dma.c:3</div></div>
<div class="ttc" id="astructNvmeIdCtrl_html_a8f5bcadc35bff664d02357cd411376fe"><div class="ttname"><a href="structNvmeIdCtrl.html#a8f5bcadc35bff664d02357cd411376fe">NvmeIdCtrl::vwc</a></div><div class="ttdeci">uint8_t vwc</div><div class="ttdef"><b>Definition:</b> nvme.h:738</div></div>
<div class="ttc" id="anvme-io_8c_html_a646ae4b9455eb7bf01b18eea275a2379"><div class="ttname"><a href="nvme-io_8c.html#a646ae4b9455eb7bf01b18eea275a2379">nvme_write_uncor</a></div><div class="ttdeci">static uint16_t nvme_write_uncor(FemuCtrl *n, NvmeNamespace *ns, NvmeCmd *cmd, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:464</div></div>
<div class="ttc" id="anvme_8h_html_a3137e88859bdb464f96bebbb259bbf8aa1fa2523620b4cf9057cb9d1fed348271"><div class="ttname"><a href="nvme_8h.html#a3137e88859bdb464f96bebbb259bbf8aa1fa2523620b4cf9057cb9d1fed348271">NVME_ONCS_WRITE_ZEROS</a></div><div class="ttdeci">@ NVME_ONCS_WRITE_ZEROS</div><div class="ttdef"><b>Definition:</b> nvme.h:765</div></div>
<div class="ttc" id="anvme-io_8c_html_a4201ce0351a86f139fa684f7b963f867"><div class="ttname"><a href="nvme-io_8c.html#a4201ce0351a86f139fa684f7b963f867">set_pri</a></div><div class="ttdeci">static void set_pri(void *a, pqueue_pri_t pri)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:245</div></div>
<div class="ttc" id="astructNvmeRwCmd_html"><div class="ttname"><a href="structNvmeRwCmd.html">NvmeRwCmd</a></div><div class="ttdef"><b>Definition:</b> nvme.h:415</div></div>
<div class="ttc" id="astructFemuCtrl_html_ac4f8d305f94dfd341fe6e7f39c06c47c"><div class="ttname"><a href="structFemuCtrl.html#ac4f8d305f94dfd341fe6e7f39c06c47c">FemuCtrl::cqe_size</a></div><div class="ttdeci">uint16_t cqe_size</div><div class="ttdef"><b>Definition:</b> nvme.h:1213</div></div>
<div class="ttc" id="astructFemuCtrl_html_ab09f359cd5d2e1882bd8a04046becf28"><div class="ttname"><a href="structFemuCtrl.html#ab09f359cd5d2e1882bd8a04046becf28">FemuCtrl::num_io_queues</a></div><div class="ttdeci">uint32_t num_io_queues</div><div class="ttdef"><b>Definition:</b> nvme.h:1219</div></div>
<div class="ttc" id="anvme_8h_html_a01e3a918ff89282c841471f5d797fbf6a27572377c7abfd0692ca6e7a953b1d92"><div class="ttname"><a href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a27572377c7abfd0692ca6e7a953b1d92">NVME_CMD_WRITE_UNCOR</a></div><div class="ttdeci">@ NVME_CMD_WRITE_UNCOR</div><div class="ttdef"><b>Definition:</b> nvme.h:336</div></div>
<div class="ttc" id="astructNvmeIdCtrl_html_a7aa6155f605fdb78fab28db981e0c5c4"><div class="ttname"><a href="structNvmeIdCtrl.html#a7aa6155f605fdb78fab28db981e0c5c4">NvmeIdCtrl::mdts</a></div><div class="ttdeci">uint8_t mdts</div><div class="ttdef"><b>Definition:</b> nvme.h:695</div></div>
<div class="ttc" id="astructNvmeRequest_html_a6f04006cddb851afcc919412c6e90b60"><div class="ttname"><a href="structNvmeRequest.html#a6f04006cddb851afcc919412c6e90b60">NvmeRequest::is_write</a></div><div class="ttdeci">uint16_t is_write</div><div class="ttdef"><b>Definition:</b> nvme.h:967</div></div>
<div class="ttc" id="astructNvmeCqe_html_a7717de66db45f6ca9c69bc3880825aee"><div class="ttname"><a href="structNvmeCqe.html#a7717de66db45f6ca9c69bc3880825aee">NvmeCqe::sq_id</a></div><div class="ttdeci">uint16_t sq_id</div><div class="ttdef"><b>Definition:</b> nvme.h:514</div></div>
<div class="ttc" id="adma_8c_html_a08f51254313a657c3826f77e6bd9a1b8"><div class="ttname"><a href="dma_8c.html#a08f51254313a657c3826f77e6bd9a1b8">nvme_addr_write</a></div><div class="ttdeci">void nvme_addr_write(FemuCtrl *n, hwaddr addr, void *buf, int size)</div><div class="ttdef"><b>Definition:</b> dma.c:13</div></div>
<div class="ttc" id="astructpqueue__t_html"><div class="ttname"><a href="structpqueue__t.html">pqueue_t</a></div><div class="ttdef"><b>Definition:</b> pqueue.h:54</div></div>
<div class="ttc" id="astructNvmeRequest_html_a5b78c8ff9c9bf2a1012976ac9764d5bc"><div class="ttname"><a href="structNvmeRequest.html#a5b78c8ff9c9bf2a1012976ac9764d5bc">NvmeRequest::reqlat</a></div><div class="ttdeci">int64_t reqlat</div><div class="ttdef"><b>Definition:</b> nvme.h:982</div></div>
<div class="ttc" id="astructFemuCtrl_html_af13a4a3fc3667cdddbd181c34378b406"><div class="ttname"><a href="structFemuCtrl.html#af13a4a3fc3667cdddbd181c34378b406">FemuCtrl::id_ctrl</a></div><div class="ttdeci">NvmeIdCtrl id_ctrl</div><div class="ttdef"><b>Definition:</b> nvme.h:1271</div></div>
<div class="ttc" id="astructNvmeSQueue_html_abb10aae49e80be9c67dd28f484514adb"><div class="ttname"><a href="structNvmeSQueue.html#abb10aae49e80be9c67dd28f484514adb">NvmeSQueue::phys_contig</a></div><div class="ttdeci">uint8_t phys_contig</div><div class="ttdef"><b>Definition:</b> nvme.h:1005</div></div>
<div class="ttc" id="anvme-io_8c_html_ae1f6c99fbfdd8d6c788ee82c6d13086d"><div class="ttname"><a href="nvme-io_8c.html#ae1f6c99fbfdd8d6c788ee82c6d13086d">nvme_dsm</a></div><div class="ttdeci">static uint16_t nvme_dsm(FemuCtrl *n, NvmeNamespace *ns, NvmeCmd *cmd, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:353</div></div>
<div class="ttc" id="anvme-io_8c_html_a667ab7f8de6f02e513acd0c14c0407e9"><div class="ttname"><a href="nvme-io_8c.html#a667ab7f8de6f02e513acd0c14c0407e9">cmp_pri</a></div><div class="ttdeci">static int cmp_pri(pqueue_pri_t next, pqueue_pri_t curr)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:235</div></div>
<div class="ttc" id="anvme-util_8c_html_a4e852fdb44ac17526a5b317eb3e4dac7"><div class="ttname"><a href="nvme-util_8c.html#a4e852fdb44ac17526a5b317eb3e4dac7">nvme_cq_full</a></div><div class="ttdeci">uint8_t nvme_cq_full(NvmeCQueue *cq)</div><div class="ttdef"><b>Definition:</b> nvme-util.c:51</div></div>
<div class="ttc" id="astructNvmeCmd_html_a3b34c627a05e2a86edf1a93567422c8c"><div class="ttname"><a href="structNvmeCmd.html#a3b34c627a05e2a86edf1a93567422c8c">NvmeCmd::dptr</a></div><div class="ttdeci">NvmeCmdDptr dptr</div><div class="ttdef"><b>Definition:</b> nvme.h:299</div></div>
<div class="ttc" id="anvme_8h_html_a3137e88859bdb464f96bebbb259bbf8aa728dcb2daaf4d4b6fd6f67d441fd3dae"><div class="ttname"><a href="nvme_8h.html#a3137e88859bdb464f96bebbb259bbf8aa728dcb2daaf4d4b6fd6f67d441fd3dae">NVME_ONCS_COMPARE</a></div><div class="ttdeci">@ NVME_ONCS_COMPARE</div><div class="ttdef"><b>Definition:</b> nvme.h:762</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a778b8f53d6725ef86c455e2e55d46ce7"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a778b8f53d6725ef86c455e2e55d46ce7">NVME_INVALID_OPCODE</a></div><div class="ttdeci">@ NVME_INVALID_OPCODE</div><div class="ttdef"><b>Definition:</b> nvme.h:521</div></div>
<div class="ttc" id="anvme_8h_html_a3137e88859bdb464f96bebbb259bbf8aad3aa66210104808011e11bb2c9a52f14"><div class="ttname"><a href="nvme_8h.html#a3137e88859bdb464f96bebbb259bbf8aad3aa66210104808011e11bb2c9a52f14">NVME_ONCS_DSM</a></div><div class="ttdeci">@ NVME_ONCS_DSM</div><div class="ttdef"><b>Definition:</b> nvme.h:764</div></div>
<div class="ttc" id="astructNvmeRwCmd_html_a15e5effe634f6ed6e9e38e21c6111381"><div class="ttname"><a href="structNvmeRwCmd.html#a15e5effe634f6ed6e9e38e21c6111381">NvmeRwCmd::prp2</a></div><div class="ttdeci">uint64_t prp2</div><div class="ttdef"><b>Definition:</b> nvme.h:423</div></div>
<div class="ttc" id="astructFemuCtrl_html_a3b6bdba05fa2cf581ace5cc08cd365f5"><div class="ttname"><a href="structFemuCtrl.html#a3b6bdba05fa2cf581ace5cc08cd365f5">FemuCtrl::pq</a></div><div class="ttdeci">pqueue_t ** pq</div><div class="ttdef"><b>Definition:</b> nvme.h:1314</div></div>
<div class="ttc" id="astructFemuCtrl_html_a8da82e5488952cf964ffcb40f29e4f7a"><div class="ttname"><a href="structFemuCtrl.html#a8da82e5488952cf964ffcb40f29e4f7a">FemuCtrl::nr_tt_late_ios</a></div><div class="ttdeci">int64_t nr_tt_late_ios</div><div class="ttdef"><b>Definition:</b> nvme.h:1319</div></div>
<div class="ttc" id="astructFemuCtrl_html_a380a277dfc1bb8f2a192f6244a3f4fdb"><div class="ttname"><a href="structFemuCtrl.html#a380a277dfc1bb8f2a192f6244a3f4fdb">FemuCtrl::cq</a></div><div class="ttdeci">NvmeCQueue ** cq</div><div class="ttdef"><b>Definition:</b> nvme.h:1267</div></div>
<div class="ttc" id="astructNvmeIdNs_html_a4a814e395ae6ea7b3b7c5cba1c22ad85"><div class="ttname"><a href="structNvmeIdNs.html#a4a814e395ae6ea7b3b7c5cba1c22ad85">NvmeIdNs::nsze</a></div><div class="ttdeci">uint64_t nsze</div><div class="ttdef"><b>Definition:</b> nvme.h:858</div></div>
<div class="ttc" id="arte__ring_8h_html_a3afc06d02f63e84fe1569c99955af57a"><div class="ttname"><a href="rte__ring_8h.html#a3afc06d02f63e84fe1569c99955af57a">femu_ring_enqueue</a></div><div class="ttdeci">size_t femu_ring_enqueue(struct rte_ring *ring, void **objs, size_t count)</div><div class="ttdef"><b>Definition:</b> rte_ring.c:223</div></div>
<div class="ttc" id="anvme_8h_html_a01e3a918ff89282c841471f5d797fbf6a012d1c22c46c99812568a7a7857eff90"><div class="ttname"><a href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a012d1c22c46c99812568a7a7857eff90">NVME_CMD_WRITE_ZEROES</a></div><div class="ttdeci">@ NVME_CMD_WRITE_ZEROES</div><div class="ttdef"><b>Definition:</b> nvme.h:338</div></div>
<div class="ttc" id="anvme_8h_html_a01b07373e5d8f8cc9e893a36a01abe9b"><div class="ttname"><a href="nvme_8h.html#a01b07373e5d8f8cc9e893a36a01abe9b">FEMU_MAX_INF_REQS</a></div><div class="ttdeci">#define FEMU_MAX_INF_REQS</div><div class="ttdef"><b>Definition:</b> nvme.h:1342</div></div>
<div class="ttc" id="aunionNvmeCmdDptr_html_aaad95622d868c580eadba6c852bf961d"><div class="ttname"><a href="unionNvmeCmdDptr.html#aaad95622d868c580eadba6c852bf961d">NvmeCmdDptr::prp1</a></div><div class="ttdeci">uint64_t prp1</div><div class="ttdef"><b>Definition:</b> nvme.h:277</div></div>
<div class="ttc" id="anvme-util_8c_html_a4fdc790b9e67ae29e3ef256182ed345b"><div class="ttname"><a href="nvme-util_8c.html#a4fdc790b9e67ae29e3ef256182ed345b">nvme_sq_empty</a></div><div class="ttdeci">uint8_t nvme_sq_empty(NvmeSQueue *sq)</div><div class="ttdef"><b>Definition:</b> nvme-util.c:58</div></div>
<div class="ttc" id="astructNvmeSQueue_html_ac5aa365b6e571542994f682254a5e457"><div class="ttname"><a href="structNvmeSQueue.html#ac5aa365b6e571542994f682254a5e457">NvmeSQueue::sqid</a></div><div class="ttdeci">uint16_t sqid</div><div class="ttdef"><b>Definition:</b> nvme.h:1007</div></div>
<div class="ttc" id="anvme-util_8c_html_a1983cbf62a2b154bc0c1e8f01f2bb1b6"><div class="ttname"><a href="nvme-util_8c.html#a1983cbf62a2b154bc0c1e8f01f2bb1b6">nvme_inc_cq_tail</a></div><div class="ttdeci">void nvme_inc_cq_tail(NvmeCQueue *cq)</div><div class="ttdef"><b>Definition:</b> nvme-util.c:13</div></div>
<div class="ttc" id="astructNvmeLBAF_html_af9a6ca47dd0427de8ce39721e4b79464"><div class="ttname"><a href="structNvmeLBAF.html#af9a6ca47dd0427de8ce39721e4b79464">NvmeLBAF::ms</a></div><div class="ttdeci">uint16_t ms</div><div class="ttdef"><b>Definition:</b> nvme.h:850</div></div>
<div class="ttc" id="astructNvmeCQueue_html_ae71382828723bfcbe3c2430f490c0ac3"><div class="ttname"><a href="structNvmeCQueue.html#ae71382828723bfcbe3c2430f490c0ac3">NvmeCQueue::dma_addr_hva</a></div><div class="ttdeci">uint64_t dma_addr_hva</div><div class="ttdef"><b>Definition:</b> nvme.h:1040</div></div>
<div class="ttc" id="astructNvmeIdNs_html_a751e3c19983752a5acb34244eba649e8"><div class="ttname"><a href="structNvmeIdNs.html#a751e3c19983752a5acb34244eba649e8">NvmeIdNs::lbaf</a></div><div class="ttdeci">NvmeLBAF lbaf[16]</div><div class="ttdef"><b>Definition:</b> nvme.h:887</div></div>
<div class="ttc" id="astructNvmeCmd_html_ab217950fc2408f7a848af10f36b0cd8f"><div class="ttname"><a href="structNvmeCmd.html#ab217950fc2408f7a848af10f36b0cd8f">NvmeCmd::cdw10</a></div><div class="ttdeci">uint32_t cdw10</div><div class="ttdef"><b>Definition:</b> nvme.h:300</div></div>
<div class="ttc" id="astructNvmeCmd_html_a2751bc2a772082d3af81124a1d120a0c"><div class="ttname"><a href="structNvmeCmd.html#a2751bc2a772082d3af81124a1d120a0c">NvmeCmd::opcode</a></div><div class="ttdeci">uint16_t opcode</div><div class="ttdef"><b>Definition:</b> nvme.h:291</div></div>
<div class="ttc" id="astructFemuCtrl_html_a19b37fe5892ac52aa01e3b8e7e0035f1"><div class="ttname"><a href="structFemuCtrl.html#a19b37fe5892ac52aa01e3b8e7e0035f1">FemuCtrl::oncs</a></div><div class="ttdeci">uint16_t oncs</div><div class="ttdef"><b>Definition:</b> nvme.h:1216</div></div>
<div class="ttc" id="astructNvmeSQueue_html_a8bb4d3fdefc90c08fb147071153c112d"><div class="ttname"><a href="structNvmeSQueue.html#a8bb4d3fdefc90c08fb147071153c112d">NvmeSQueue::eventidx_addr_hva</a></div><div class="ttdeci">uint64_t eventidx_addr_hva</div><div class="ttdef"><b>Definition:</b> nvme.h:1024</div></div>
<div class="ttc" id="anvme-util_8c_html_a21b2434a9d5f978d0b4cf9661820ca63"><div class="ttname"><a href="nvme-util_8c.html#a21b2434a9d5f978d0b4cf9661820ca63">nvme_update_sq_tail</a></div><div class="ttdeci">void nvme_update_sq_tail(NvmeSQueue *sq)</div><div class="ttdef"><b>Definition:</b> nvme-util.c:27</div></div>
<div class="ttc" id="astructNvmeCQueue_html_a83ec5b565d4c97540ef1db6462f3efd2"><div class="ttname"><a href="structNvmeCQueue.html#a83ec5b565d4c97540ef1db6462f3efd2">NvmeCQueue::ctrl</a></div><div class="ttdeci">struct FemuCtrl * ctrl</div><div class="ttdef"><b>Definition:</b> nvme.h:1029</div></div>
<div class="ttc" id="astructFemuCtrl_html_a0ff7c6d5e0e6313cc66e2d62f4e98221"><div class="ttname"><a href="structFemuCtrl.html#a0ff7c6d5e0e6313cc66e2d62f4e98221">FemuCtrl::to_ftl</a></div><div class="ttdeci">struct rte_ring ** to_ftl</div><div class="ttdef"><b>Definition:</b> nvme.h:1312</div></div>
<div class="ttc" id="astructNvmeRwCmd_html_a3c8ede79fe155517299131fa36319f5a"><div class="ttname"><a href="structNvmeRwCmd.html#a3c8ede79fe155517299131fa36319f5a">NvmeRwCmd::opcode</a></div><div class="ttdeci">uint8_t opcode</div><div class="ttdef"><b>Definition:</b> nvme.h:416</div></div>
<div class="ttc" id="adma_8c_html_aff05c76845a6cc08d0131d2761153493"><div class="ttname"><a href="dma_8c.html#aff05c76845a6cc08d0131d2761153493">nvme_map_prp</a></div><div class="ttdeci">uint16_t nvme_map_prp(QEMUSGList *qsg, QEMUIOVector *iov, uint64_t prp1, uint64_t prp2, uint32_t len, FemuCtrl *n)</div><div class="ttdef"><b>Definition:</b> dma.c:23</div></div>
<div class="ttc" id="anvme_8h_html_ab5c77706290dc892f52e14dfe39504b6"><div class="ttname"><a href="nvme_8h.html#ab5c77706290dc892f52e14dfe39504b6">nvme_discontig</a></div><div class="ttdeci">static hwaddr nvme_discontig(uint64_t *dma_addr, uint16_t page_size, uint16_t queue_idx, uint16_t entry_size)</div><div class="ttdef"><b>Definition:</b> nvme.h:1456</div></div>
<div class="ttc" id="apqueue_8h_html_a2919d3e817688b81da746d4123f51ba3"><div class="ttname"><a href="pqueue_8h.html#a2919d3e817688b81da746d4123f51ba3">pqueue_peek</a></div><div class="ttdeci">void * pqueue_peek(pqueue_t *q)</div><div class="ttdef"><b>Definition:</b> pqueue.c:186</div></div>
<div class="ttc" id="astructNvmeCQueue_html_abee73fe2f6a1749b69ee6edf4b08f751"><div class="ttname"><a href="structNvmeCQueue.html#abee73fe2f6a1749b69ee6edf4b08f751">NvmeCQueue::prp_list</a></div><div class="ttdeci">uint64_t * prp_list</div><div class="ttdef"><b>Definition:</b> nvme.h:1041</div></div>
<div class="ttc" id="astructNvmeRequest_html_a8cec02fb87e647c828d06f533aec8758"><div class="ttname"><a href="structNvmeRequest.html#a8cec02fb87e647c828d06f533aec8758">NvmeRequest::cqe</a></div><div class="ttdeci">NvmeCqe cqe</div><div class="ttdef"><b>Definition:</b> nvme.h:976</div></div>
<div class="ttc" id="astructNvmeIdNs_html_ac2061ba91f1d2bf0282bfe22221f65a2"><div class="ttname"><a href="structNvmeIdNs.html#ac2061ba91f1d2bf0282bfe22221f65a2">NvmeIdNs::flbas</a></div><div class="ttdeci">uint8_t flbas</div><div class="ttdef"><b>Definition:</b> nvme.h:863</div></div>
<div class="ttc" id="astructFemuExtCtrlOps_html_aa481d8673fcc3bd5b890e3d8dc549a6e"><div class="ttname"><a href="structFemuExtCtrlOps.html#aa481d8673fcc3bd5b890e3d8dc549a6e">FemuExtCtrlOps::io_cmd</a></div><div class="ttdeci">uint16_t(* io_cmd)(struct FemuCtrl *, NvmeNamespace *, NvmeCmd *, NvmeRequest *)</div><div class="ttdef"><b>Definition:</b> nvme.h:1166</div></div>
<div class="ttc" id="astructFemuCtrl_html_ad818a28bdef83c4bb07c0d4f00942b06"><div class="ttname"><a href="structFemuCtrl.html#ad818a28bdef83c4bb07c0d4f00942b06">FemuCtrl::to_poller</a></div><div class="ttdeci">struct rte_ring ** to_poller</div><div class="ttdef"><b>Definition:</b> nvme.h:1313</div></div>
<div class="ttc" id="astructNvmeLBAF_html_ac0a10526d855cab5ceed66963c0f5a44"><div class="ttname"><a href="structNvmeLBAF.html#ac0a10526d855cab5ceed66963c0f5a44">NvmeLBAF::lbads</a></div><div class="ttdeci">uint8_t lbads</div><div class="ttdef"><b>Definition:</b> nvme.h:851</div></div>
<div class="ttc" id="astructNvmeRequest_html_a135bf3cba23f12bad28c20805a8f5d93"><div class="ttname"><a href="structNvmeRequest.html#a135bf3cba23f12bad28c20805a8f5d93">NvmeRequest::expire_time</a></div><div class="ttdeci">int64_t expire_time</div><div class="ttdef"><b>Definition:</b> nvme.h:984</div></div>
<div class="ttc" id="astructNvmePollerThreadArgument_html_abdda07e6f64edaf6ed07493d5197d464"><div class="ttname"><a href="structNvmePollerThreadArgument.html#abdda07e6f64edaf6ed07493d5197d464">NvmePollerThreadArgument::n</a></div><div class="ttdeci">FemuCtrl * n</div><div class="ttdef"><b>Definition:</b> nvme.h:1330</div></div>
<div class="ttc" id="anvme-io_8c_html_af3708eed16007bc4b715785d1ea06cd0"><div class="ttname"><a href="nvme-io_8c.html#af3708eed16007bc4b715785d1ea06cd0">set_pos</a></div><div class="ttdeci">static void set_pos(void *a, size_t pos)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:255</div></div>
<div class="ttc" id="astructNvmeRequest_html_a18ef977aa1abc169de646d142d6c77d9"><div class="ttname"><a href="structNvmeRequest.html#a18ef977aa1abc169de646d142d6c77d9">NvmeRequest::sq</a></div><div class="ttdeci">struct NvmeSQueue * sq</div><div class="ttdef"><b>Definition:</b> nvme.h:962</div></div>
<div class="ttc" id="astructFemuCtrl_html_a8bd3f2107e1a59779f7d6a669e29b5af"><div class="ttname"><a href="structFemuCtrl.html#a8bd3f2107e1a59779f7d6a669e29b5af">FemuCtrl::num_namespaces</a></div><div class="ttdeci">uint32_t num_namespaces</div><div class="ttdef"><b>Definition:</b> nvme.h:1218</div></div>
<div class="ttc" id="astructNvmeCqe_html_a4707dde71101275a917c49286b4178c4"><div class="ttname"><a href="structNvmeCqe.html#a4707dde71101275a917c49286b4178c4">NvmeCqe::sq_head</a></div><div class="ttdeci">uint16_t sq_head</div><div class="ttdef"><b>Definition:</b> nvme.h:513</div></div>
<div class="ttc" id="astructNvmeSQueue_html_a168092b36fc33b9d4367f36613e9eb9d"><div class="ttname"><a href="structNvmeSQueue.html#a168092b36fc33b9d4367f36613e9eb9d">NvmeSQueue::prp_list</a></div><div class="ttdeci">uint64_t * prp_list</div><div class="ttdef"><b>Definition:</b> nvme.h:1015</div></div>
<div class="ttc" id="astructNvmeSQueue_html_a7b8e3b48aee1060ab0095c0dfe449232"><div class="ttname"><a href="structNvmeSQueue.html#a7b8e3b48aee1060ab0095c0dfe449232">NvmeSQueue::tail</a></div><div class="ttdeci">uint32_t tail</div><div class="ttdef"><b>Definition:</b> nvme.h:1010</div></div>
<div class="ttc" id="astructNvmeSQueue_html_aec83bc34b2dd3541fda15c0279348264"><div class="ttname"><a href="structNvmeSQueue.html#aec83bc34b2dd3541fda15c0279348264">NvmeSQueue::head</a></div><div class="ttdeci">uint32_t head</div><div class="ttdef"><b>Definition:</b> nvme.h:1009</div></div>
<div class="ttc" id="astructFemuCtrl_html_ab4f555e0b42bfe51c089ab004c88ff48"><div class="ttname"><a href="structFemuCtrl.html#ab4f555e0b42bfe51c089ab004c88ff48">FemuCtrl::mbe</a></div><div class="ttdeci">SsdDramBackend * mbe</div><div class="ttdef"><b>Definition:</b> nvme.h:1308</div></div>
<div class="ttc" id="astructNvmeRequest_html_a4469b2b304ba50b7674a4cf4e0ce4a4f"><div class="ttname"><a href="structNvmeRequest.html#a4469b2b304ba50b7674a4cf4e0ce4a4f">NvmeRequest::cmd_opcode</a></div><div class="ttdeci">uint8_t cmd_opcode</div><div class="ttdef"><b>Definition:</b> nvme.h:977</div></div>
<div class="ttc" id="astructFemuCtrl_html_a7c69e429f2da05dd6a0ecb4591c2c4fb"><div class="ttname"><a href="structFemuCtrl.html#a7c69e429f2da05dd6a0ecb4591c2c4fb">FemuCtrl::devname</a></div><div class="ttdeci">char devname[64]</div><div class="ttdef"><b>Definition:</b> nvme.h:1311</div></div>
<div class="ttc" id="arte__ring_8h_html_a96ef17a77ac3deecdb8a1fb71b6bdf63"><div class="ttname"><a href="rte__ring_8h.html#a96ef17a77ac3deecdb8a1fb71b6bdf63">femu_ring_count</a></div><div class="ttdeci">size_t femu_ring_count(struct rte_ring *ring)</div><div class="ttdef"><b>Definition:</b> rte_ring.c:218</div></div>
<div class="ttc" id="astructNvmeRequest_html_a35d73ae4b2cd7c17e55d20320ac2b1ea"><div class="ttname"><a href="structNvmeRequest.html#a35d73ae4b2cd7c17e55d20320ac2b1ea">NvmeRequest::slba</a></div><div class="ttdeci">uint64_t slba</div><div class="ttdef"><b>Definition:</b> nvme.h:966</div></div>
<div class="ttc" id="astructNvmePollerThreadArgument_html_ae6811a13fb3be05ceb56110fb5882be4"><div class="ttname"><a href="structNvmePollerThreadArgument.html#ae6811a13fb3be05ceb56110fb5882be4">NvmePollerThreadArgument::index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> nvme.h:1331</div></div>
<div class="ttc" id="anvme-util_8c_html_a6ad5e0fb9283798af6a6b70e7254a183"><div class="ttname"><a href="nvme-util_8c.html#a6ad5e0fb9283798af6a6b70e7254a183">nvme_set_error_page</a></div><div class="ttdeci">void nvme_set_error_page(FemuCtrl *n, uint16_t sqid, uint16_t cid, uint16_t status, uint16_t location, uint64_t lba, uint32_t nsid)</div><div class="ttdef"><b>Definition:</b> nvme-util.c:90</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a4c080463e158441c5b7b4000da2ed3e4"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a4c080463e158441c5b7b4000da2ed3e4">NVME_INVALID_NSID</a></div><div class="ttdeci">@ NVME_INVALID_NSID</div><div class="ttdef"><b>Definition:</b> nvme.h:531</div></div>
<div class="ttc" id="apqueue_8h_html_ae0cf88c8360a5f08ada81feaaeb40505"><div class="ttname"><a href="pqueue_8h.html#ae0cf88c8360a5f08ada81feaaeb40505">pqueue_size</a></div><div class="ttdeci">size_t pqueue_size(pqueue_t *q)</div><div class="ttdef"><b>Definition:</b> pqueue.c:68</div></div>
<div class="ttc" id="aunionNvmeCmdDptr_html_a9fc9a97c707652c679097b32ffd84bc3"><div class="ttname"><a href="unionNvmeCmdDptr.html#a9fc9a97c707652c679097b32ffd84bc3">NvmeCmdDptr::prp2</a></div><div class="ttdeci">uint64_t prp2</div><div class="ttdef"><b>Definition:</b> nvme.h:278</div></div>
<div class="ttc" id="astructFemuCtrl_html_a98ca6ff3bc65ccc7f98a589e018b7d71"><div class="ttname"><a href="structFemuCtrl.html#a98ca6ff3bc65ccc7f98a589e018b7d71">FemuCtrl::namespaces</a></div><div class="ttdeci">NvmeNamespace * namespaces</div><div class="ttdef"><b>Definition:</b> nvme.h:1265</div></div>
<div class="ttc" id="astructNvmeRwCmd_html_a34ba11f86be8f5d4be5518370faf2514"><div class="ttname"><a href="structNvmeRwCmd.html#a34ba11f86be8f5d4be5518370faf2514">NvmeRwCmd::nlb</a></div><div class="ttdeci">uint16_t nlb</div><div class="ttdef"><b>Definition:</b> nvme.h:425</div></div>
<div class="ttc" id="astructNvmeFeatureVal_html_a3425f02bb96f18760ef44b0e0a055741"><div class="ttname"><a href="structNvmeFeatureVal.html#a3425f02bb96f18760ef44b0e0a055741">NvmeFeatureVal::volatile_wc</a></div><div class="ttdeci">uint32_t volatile_wc</div><div class="ttdef"><b>Definition:</b> nvme.h:790</div></div>
<div class="ttc" id="astructFemuCtrl_html_a6291ffd43b13aa9c7bc871a7e1bb4a11"><div class="ttname"><a href="structFemuCtrl.html#a6291ffd43b13aa9c7bc871a7e1bb4a11">FemuCtrl::dataplane_started</a></div><div class="ttdeci">bool dataplane_started</div><div class="ttdef"><b>Definition:</b> nvme.h:1259</div></div>
<div class="ttc" id="anvme-io_8c_html_a2b5cc5f1e45642543fa0bfe8db2dd428"><div class="ttname"><a href="nvme-io_8c.html#a2b5cc5f1e45642543fa0bfe8db2dd428">get_pos</a></div><div class="ttdeci">static size_t get_pos(void *a)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:250</div></div>
<div class="ttc" id="anvme-io_8c_html_acb7bf552fb77faee4d0aa021d51af4b7"><div class="ttname"><a href="nvme-io_8c.html#acb7bf552fb77faee4d0aa021d51af4b7">nvme_poller</a></div><div class="ttdeci">static void * nvme_poller(void *arg)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:192</div></div>
<div class="ttc" id="astructNvmeRequest_html"><div class="ttname"><a href="structNvmeRequest.html">NvmeRequest</a></div><div class="ttdef"><b>Definition:</b> nvme.h:961</div></div>
<div class="ttc" id="anvme-io_8c_html_ae3fe0206159ec6d704c59e7393b6d85c"><div class="ttname"><a href="nvme-io_8c.html#ae3fe0206159ec6d704c59e7393b6d85c">nvme_write_zeros</a></div><div class="ttdeci">static uint16_t nvme_write_zeros(FemuCtrl *n, NvmeNamespace *ns, NvmeCmd *cmd, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:448</div></div>
<div class="ttc" id="astructNvmeCQueue_html_a550822923ef54d73d7efa7f4bf6159c3"><div class="ttname"><a href="structNvmeCQueue.html#a550822923ef54d73d7efa7f4bf6159c3">NvmeCQueue::phase</a></div><div class="ttdeci">uint8_t phase</div><div class="ttdef"><b>Definition:</b> nvme.h:1031</div></div>
<div class="ttc" id="astructFemuCtrl_html_a6d0418e38e888b2b8980a34198bfd463"><div class="ttname"><a href="structFemuCtrl.html#a6d0418e38e888b2b8980a34198bfd463">FemuCtrl::page_size</a></div><div class="ttdeci">uint16_t page_size</div><div class="ttdef"><b>Definition:</b> nvme.h:1210</div></div>
<div class="ttc" id="anvme-io_8c_html_aa412c2f46a5bc43ac2234173c9743abe"><div class="ttname"><a href="nvme-io_8c.html#aa412c2f46a5bc43ac2234173c9743abe">nvme_post_cqe</a></div><div class="ttdeci">static void nvme_post_cqe(NvmeCQueue *cq, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> nvme-io.c:97</div></div>
<div class="ttc" id="astructNvmeSQueue_html_a7e289d563e907e4a724af16364350602"><div class="ttname"><a href="structNvmeSQueue.html#a7e289d563e907e4a724af16364350602">NvmeSQueue::dma_addr</a></div><div class="ttdeci">uint64_t dma_addr</div><div class="ttdef"><b>Definition:</b> nvme.h:1012</div></div>
<div class="ttc" id="astructNvmeSQueue_html_aaf88cee18475b8a006dfed6793d2a2dd"><div class="ttname"><a href="structNvmeSQueue.html#aaf88cee18475b8a006dfed6793d2a2dd">NvmeSQueue::completed</a></div><div class="ttdeci">uint64_t completed</div><div class="ttdef"><b>Definition:</b> nvme.h:1014</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a></div><div class="ttdeci">@ NVME_INVALID_FIELD</div><div class="ttdef"><b>Definition:</b> nvme.h:522</div></div>
<div class="ttc" id="anvme_8h_html_a91333268a64e669e088f20aaf0bfd9b7"><div class="ttname"><a href="nvme_8h.html#a91333268a64e669e088f20aaf0bfd9b7">NVME_ID_NS_FLBAS_INDEX</a></div><div class="ttdeci">#define NVME_ID_NS_FLBAS_INDEX(flbas)</div><div class="ttdef"><b>Definition:</b> nvme.h:914</div></div>
<div class="ttc" id="astructNvmeCqe_html_a8e87b5e0e44fd97e1e92f41c851eb764"><div class="ttname"><a href="structNvmeCqe.html#a8e87b5e0e44fd97e1e92f41c851eb764">NvmeCqe::cid</a></div><div class="ttdeci">uint16_t cid</div><div class="ttdef"><b>Definition:</b> nvme.h:515</div></div>
<div class="ttc" id="anvme_8h_html_a50171c329ed9567d9e35cd7bade09800"><div class="ttname"><a href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a></div><div class="ttdeci">#define femu_err(fmt,...)</div><div class="ttdef"><b>Definition:</b> nvme.h:1489</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="nvme-io_8c.html">nvme-io.c</a></li>
    <li class="footer">制作者
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
