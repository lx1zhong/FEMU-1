<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FEMU: zns/zns.c 文件参考</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FEMU
   &#160;<span id="projectnumber">原版 master 7e238cc</span>
   </div>
   <div id="projectbrief">FEMU: Accurate, Scalable and Extensible NVMe SSD Emulator (FAST&#39;18)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('zns_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">结构体</a> &#124;
<a href="#define-members">宏定义</a> &#124;
<a href="#typedef-members">类型定义</a> &#124;
<a href="#enum-members">枚举</a> &#124;
<a href="#func-members">函数</a>  </div>
  <div class="headertitle">
<div class="title">zns.c 文件参考</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="zns_8h_source.html">./zns.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
zns.c 的引用(Include)关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c__incl.png" border="0" usemap="#zns_2zns_8c" alt=""/></div>
<map name="zns_2zns_8c" id="zns_2zns_8c">
<area shape="rect" title=" " alt="" coords="895,5,977,32"/>
<area shape="rect" href="zns_8h.html" title=" " alt="" coords="904,80,968,107"/>
<area shape="rect" href="nvme_8h.html" title=" " alt="" coords="895,155,977,181"/>
<area shape="rect" title=" " alt="" coords="5,229,120,256"/>
<area shape="rect" title=" " alt="" coords="145,229,247,256"/>
<area shape="rect" title=" " alt="" coords="272,229,379,256"/>
<area shape="rect" title=" " alt="" coords="403,229,514,256"/>
<area shape="rect" title=" " alt="" coords="539,229,651,256"/>
<area shape="rect" title=" " alt="" coords="675,229,779,256"/>
<area shape="rect" title=" " alt="" coords="803,229,933,256"/>
<area shape="rect" title=" " alt="" coords="957,229,1053,256"/>
<area shape="rect" title=" " alt="" coords="1078,229,1197,256"/>
<area shape="rect" href="dram_8h.html" title=" " alt="" coords="1221,229,1347,256"/>
<area shape="rect" href="rte__ring_8h.html" title=" " alt="" coords="1372,229,1479,256"/>
<area shape="rect" href="pqueue_8h.html" title="Priority Queue function declarations" alt="" coords="1503,229,1609,256"/>
<area shape="rect" href="nand_8h.html" title=" " alt="" coords="1633,229,1735,256"/>
<area shape="rect" href="timing_8h.html" title=" " alt="" coords="1760,229,1928,256"/>
<area shape="rect" title=" " alt="" coords="1134,304,1205,331"/>
<area shape="rect" title=" " alt="" coords="1229,304,1296,331"/>
<area shape="rect" title=" " alt="" coords="1321,304,1421,331"/>
<area shape="rect" title=" " alt="" coords="1445,304,1513,331"/>
<area shape="rect" title=" " alt="" coords="1537,304,1639,331"/>
<area shape="rect" href="rte__atomic__x86_8h.html" title=" " alt="" coords="1663,304,1798,331"/>
<area shape="rect" href="rte__branch__prediction_8h.html" title=" " alt="" coords="1822,304,1997,331"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
结构体</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structzns__zone__reset__ctx.html">zns_zone_reset_ctx</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
宏定义</h2></td></tr>
<tr class="memitem:aa622cba6014f13bea0b2ac94455d7262"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#aa622cba6014f13bea0b2ac94455d7262">MIN_DISCARD_GRANULARITY</a>&#160;&#160;&#160;(4 * KiB)</td></tr>
<tr class="separator:aa622cba6014f13bea0b2ac94455d7262"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af08b9977a8c3f36290e243506b5222d6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#af08b9977a8c3f36290e243506b5222d6">NVME_DEFAULT_ZONE_SIZE</a>&#160;&#160;&#160;(128 * MiB)</td></tr>
<tr class="separator:af08b9977a8c3f36290e243506b5222d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06c9f096d365e730b91eb297bf71961e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a06c9f096d365e730b91eb297bf71961e">NVME_DEFAULT_MAX_AZ_SIZE</a>&#160;&#160;&#160;(128 * KiB)</td></tr>
<tr class="separator:a06c9f096d365e730b91eb297bf71961e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
类型定义</h2></td></tr>
<tr class="memitem:ac747d5391c03151d537edfcc1f577df7"><td class="memItemLeft" align="right" valign="top">typedef uint16_t(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#ac747d5391c03151d537edfcc1f577df7">op_handler_t</a>) (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *, <a class="el" href="structNvmeZone.html">NvmeZone</a> *, <a class="el" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a>, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *)</td></tr>
<tr class="separator:ac747d5391c03151d537edfcc1f577df7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
枚举</h2></td></tr>
<tr class="memitem:a0759e855e2f759918191c8abe275500c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a0759e855e2f759918191c8abe275500c">NvmeZoneProcessingMask</a> { <br />
&#160;&#160;<a class="el" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca0f07a84b957a078ed2a401ebdee9fc0d">NVME_PROC_CURRENT_ZONE</a> = 0, 
<a class="el" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca3606a12acd83bf8178443ffaa3e72ac9">NVME_PROC_OPENED_ZONES</a> = 1 &lt;&lt; 0, 
<a class="el" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca18d09cd4a0933aceda32e432dd97faf8">NVME_PROC_CLOSED_ZONES</a> = 1 &lt;&lt; 1, 
<a class="el" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca03e0191366f1f0b541aed2014625d6d2">NVME_PROC_READ_ONLY_ZONES</a> = 1 &lt;&lt; 2, 
<br />
&#160;&#160;<a class="el" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca3bed639d7837a92a297e4df431c7ed9f">NVME_PROC_FULL_ZONES</a> = 1 &lt;&lt; 3
<br />
 }</td></tr>
<tr class="separator:a0759e855e2f759918191c8abe275500c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
函数</h2></td></tr>
<tr class="memitem:a755fef089b9a7fc5ddd4be2d53455955"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a755fef089b9a7fc5ddd4be2d53455955">zns_zone_idx</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, uint64_t slba)</td></tr>
<tr class="separator:a755fef089b9a7fc5ddd4be2d53455955"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9674ef207fca784d45d2b13fe63e31f5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a9674ef207fca784d45d2b13fe63e31f5">zns_get_zone_by_slba</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, uint64_t slba)</td></tr>
<tr class="separator:a9674ef207fca784d45d2b13fe63e31f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4fd6eccdc41d46c3c9ad323e89019d2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#ac4fd6eccdc41d46c3c9ad323e89019d2">zns_init_zone_geometry</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, Error **errp)</td></tr>
<tr class="separator:ac4fd6eccdc41d46c3c9ad323e89019d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12ca668cf37e73d231f247d41d5990f9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a12ca668cf37e73d231f247d41d5990f9">zns_init_zoned_state</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns)</td></tr>
<tr class="separator:a12ca668cf37e73d231f247d41d5990f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54625ca641142f536befa8182db6164e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a54625ca641142f536befa8182db6164e">zns_init_zone_identify</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, int lba_index)</td></tr>
<tr class="separator:a54625ca641142f536befa8182db6164e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f09f2d274ee382c164ad442bb4f3e47"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a8f09f2d274ee382c164ad442bb4f3e47">zns_clear_zone</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeZone.html">NvmeZone</a> *zone)</td></tr>
<tr class="separator:a8f09f2d274ee382c164ad442bb4f3e47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a340f34f865c916bb163abd16dc637f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a5a340f34f865c916bb163abd16dc637f">zns_zoned_ns_shutdown</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns)</td></tr>
<tr class="separator:a5a340f34f865c916bb163abd16dc637f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23ed6cd90a43d43bad4b9196673fd1bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a23ed6cd90a43d43bad4b9196673fd1bf">zns_ns_shutdown</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns)</td></tr>
<tr class="separator:a23ed6cd90a43d43bad4b9196673fd1bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0aeaacfe11cad1ce307443e1a420ec4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a0aeaacfe11cad1ce307443e1a420ec4a">zns_ns_cleanup</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns)</td></tr>
<tr class="separator:a0aeaacfe11cad1ce307443e1a420ec4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a819d2621fbd145acef21bd41486156a3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3">zns_assign_zone_state</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeZone.html">NvmeZone</a> *zone, <a class="el" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a> <a class="el" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a>)</td></tr>
<tr class="separator:a819d2621fbd145acef21bd41486156a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bd0e00434954d61e13cfe8a65a02e34"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a2bd0e00434954d61e13cfe8a65a02e34">zns_aor_check</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, uint32_t act, uint32_t opn)</td></tr>
<tr class="separator:a2bd0e00434954d61e13cfe8a65a02e34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a841382c8c3024053a641811800230a23"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a841382c8c3024053a641811800230a23">zns_check_zone_state_for_write</a> (<a class="el" href="structNvmeZone.html">NvmeZone</a> *zone)</td></tr>
<tr class="separator:a841382c8c3024053a641811800230a23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fa5b88257a067bda683c7f981b39524"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a5fa5b88257a067bda683c7f981b39524">zns_check_zone_write</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeZone.html">NvmeZone</a> *zone, uint64_t slba, uint32_t nlb, bool append)</td></tr>
<tr class="separator:a5fa5b88257a067bda683c7f981b39524"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3357eef3f827fdab1d88e5c95ae3c386"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a3357eef3f827fdab1d88e5c95ae3c386">zns_check_zone_state_for_read</a> (<a class="el" href="structNvmeZone.html">NvmeZone</a> *zone)</td></tr>
<tr class="separator:a3357eef3f827fdab1d88e5c95ae3c386"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a270c9ffa0fb88a1c6d57ecfe3e6815"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a9a270c9ffa0fb88a1c6d57ecfe3e6815">zns_check_zone_read</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, uint64_t slba, uint32_t nlb)</td></tr>
<tr class="separator:a9a270c9ffa0fb88a1c6d57ecfe3e6815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02ec33ad0c6f39ad701ac9ea780811c4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a02ec33ad0c6f39ad701ac9ea780811c4">zns_auto_transition_zone</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns)</td></tr>
<tr class="separator:a02ec33ad0c6f39ad701ac9ea780811c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5f4088354d2555f9d66e2ba441592ff"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#ad5f4088354d2555f9d66e2ba441592ff">zns_auto_open_zone</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeZone.html">NvmeZone</a> *zone)</td></tr>
<tr class="separator:ad5f4088354d2555f9d66e2ba441592ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61f038c076c83ca5f99341b71c9b8e10"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a61f038c076c83ca5f99341b71c9b8e10">zns_finalize_zoned_write</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req, bool failed)</td></tr>
<tr class="separator:a61f038c076c83ca5f99341b71c9b8e10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94c5876f1b68a759a109b78003852924"><td class="memItemLeft" align="right" valign="top">static uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a94c5876f1b68a759a109b78003852924">zns_advance_zone_wp</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeZone.html">NvmeZone</a> *zone, uint32_t nlb)</td></tr>
<tr class="separator:a94c5876f1b68a759a109b78003852924"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cf84991a322dded9376491f5d98dedb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a7cf84991a322dded9376491f5d98dedb">zns_aio_zone_reset_cb</a> (<a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req, <a class="el" href="structNvmeZone.html">NvmeZone</a> *zone)</td></tr>
<tr class="separator:a7cf84991a322dded9376491f5d98dedb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea339e52add6067aeb466ab8b0f56a1d"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#aea339e52add6067aeb466ab8b0f56a1d">zns_open_zone</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeZone.html">NvmeZone</a> *zone, <a class="el" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a> <a class="el" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a>, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:aea339e52add6067aeb466ab8b0f56a1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af29e49b46b70e9dc142f1bb3bf7e65da"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#af29e49b46b70e9dc142f1bb3bf7e65da">zns_close_zone</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeZone.html">NvmeZone</a> *zone, <a class="el" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a> <a class="el" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a>, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:af29e49b46b70e9dc142f1bb3bf7e65da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad642783946555e5f78ea1651c02404cb"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#ad642783946555e5f78ea1651c02404cb">zns_finish_zone</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeZone.html">NvmeZone</a> *zone, <a class="el" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a> <a class="el" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a>, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:ad642783946555e5f78ea1651c02404cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c7e09c6f357c1f77c724c664f6c0128"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a7c7e09c6f357c1f77c724c664f6c0128">zns_reset_zone</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeZone.html">NvmeZone</a> *zone, <a class="el" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a> <a class="el" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a>, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:a7c7e09c6f357c1f77c724c664f6c0128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21f29cc79d1f772a1244c0f512171c0a"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a21f29cc79d1f772a1244c0f512171c0a">zns_offline_zone</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeZone.html">NvmeZone</a> *zone, <a class="el" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a> <a class="el" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a>, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:a21f29cc79d1f772a1244c0f512171c0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52eacdcbc504ab2769e6b194295e2355"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a52eacdcbc504ab2769e6b194295e2355">zns_set_zd_ext</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeZone.html">NvmeZone</a> *zone)</td></tr>
<tr class="separator:a52eacdcbc504ab2769e6b194295e2355"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9deb4d27a553448ab81440798d09fb7"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#aa9deb4d27a553448ab81440798d09fb7">zns_bulk_proc_zone</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeZone.html">NvmeZone</a> *zone, enum <a class="el" href="zns_8c.html#a0759e855e2f759918191c8abe275500c">NvmeZoneProcessingMask</a> proc_mask, <a class="el" href="zns_8c.html#ac747d5391c03151d537edfcc1f577df7">op_handler_t</a> op_hndlr, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:aa9deb4d27a553448ab81440798d09fb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48ae04e0f8dcb34ff3803282d5b0ad17"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a48ae04e0f8dcb34ff3803282d5b0ad17">zns_do_zone_op</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeZone.html">NvmeZone</a> *zone, enum <a class="el" href="zns_8c.html#a0759e855e2f759918191c8abe275500c">NvmeZoneProcessingMask</a> proc_mask, <a class="el" href="zns_8c.html#ac747d5391c03151d537edfcc1f577df7">op_handler_t</a> op_hndlr, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:a48ae04e0f8dcb34ff3803282d5b0ad17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6719fe173fec9e6e538ab3f449491bd2"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a6719fe173fec9e6e538ab3f449491bd2">zns_get_mgmt_zone_slba_idx</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeCmd.html">NvmeCmd</a> *c, uint64_t *slba, uint32_t *zone_idx)</td></tr>
<tr class="separator:a6719fe173fec9e6e538ab3f449491bd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbd33ad1ba3c29a67e6f3f7d2d63859c"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c">zns_zone_mgmt_send</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:afbd33ad1ba3c29a67e6f3f7d2d63859c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81321b3c5f8d3e0069c181e2dfa4f452"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a81321b3c5f8d3e0069c181e2dfa4f452">zns_zone_matches_filter</a> (uint32_t zafs, <a class="el" href="structNvmeZone.html">NvmeZone</a> *zl)</td></tr>
<tr class="separator:a81321b3c5f8d3e0069c181e2dfa4f452"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e03af0f3d0b7c597d9137a0b18bca56"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a6e03af0f3d0b7c597d9137a0b18bca56">zns_zone_mgmt_recv</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:a6e03af0f3d0b7c597d9137a0b18bca56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59ac97b9a3caead40c6651273483ed4c"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a59ac97b9a3caead40c6651273483ed4c">nvme_csi_has_nvm_support</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns)</td></tr>
<tr class="separator:a59ac97b9a3caead40c6651273483ed4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9ed91ad4901fe7f2cd4f9df6c333901"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#ae9ed91ad4901fe7f2cd4f9df6c333901">zns_check_bounds</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, uint64_t slba, uint32_t nlb)</td></tr>
<tr class="separator:ae9ed91ad4901fe7f2cd4f9df6c333901"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab56987b404fc29d662252ee6f15e9012"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#ab56987b404fc29d662252ee6f15e9012">zns_map_dptr</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, size_t len, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:ab56987b404fc29d662252ee6f15e9012"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84203495e6de57d698b7e393f7106984"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a84203495e6de57d698b7e393f7106984">zns_do_write</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req, bool append, bool wrz)</td></tr>
<tr class="separator:a84203495e6de57d698b7e393f7106984"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88a38b39db2e6829a576bebd97ece799"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a88a38b39db2e6829a576bebd97ece799">zns_admin_cmd</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeCmd.html">NvmeCmd</a> *cmd)</td></tr>
<tr class="separator:a88a38b39db2e6829a576bebd97ece799"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4285aad08edb64a1c6aea72ad77f8338"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338">zns_zone_append</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:a4285aad08edb64a1c6aea72ad77f8338"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52ee538a6713c7b29769f23b61dad575"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a52ee538a6713c7b29769f23b61dad575">zns_check_dulbe</a> (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, uint64_t slba, uint32_t nlb)</td></tr>
<tr class="separator:a52ee538a6713c7b29769f23b61dad575"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a232d1c0fc6117ae692ff092d05f473e6"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a232d1c0fc6117ae692ff092d05f473e6">zns_read</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeCmd.html">NvmeCmd</a> *cmd, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:a232d1c0fc6117ae692ff092d05f473e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcb43c9722f5f6a3346b15dfd3872008"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008">zns_write</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeCmd.html">NvmeCmd</a> *cmd, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:abcb43c9722f5f6a3346b15dfd3872008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab23b42610e0276e68ccaac4d13e18bfa"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa">zns_io_cmd</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, <a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *ns, <a class="el" href="structNvmeCmd.html">NvmeCmd</a> *cmd, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *req)</td></tr>
<tr class="separator:ab23b42610e0276e68ccaac4d13e18bfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05f7689d91910e1a2f865b30a9bc5393"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a05f7689d91910e1a2f865b30a9bc5393">zns_set_ctrl_str</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n)</td></tr>
<tr class="separator:a05f7689d91910e1a2f865b30a9bc5393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace4f37fd873afd711375d7c88dc333ff"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#ace4f37fd873afd711375d7c88dc333ff">zns_set_ctrl</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n)</td></tr>
<tr class="separator:ace4f37fd873afd711375d7c88dc333ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299230188329a14db7c7542d2764c7ce"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a299230188329a14db7c7542d2764c7ce">zns_init_zone_cap</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n)</td></tr>
<tr class="separator:a299230188329a14db7c7542d2764c7ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c27f4956bf97dcabba73019e80b191a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a4c27f4956bf97dcabba73019e80b191a">zns_start_ctrl</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n)</td></tr>
<tr class="separator:a4c27f4956bf97dcabba73019e80b191a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa65a4a4ae802bdd6f8cc362247c6325b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#aa65a4a4ae802bdd6f8cc362247c6325b">zns_init</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n, Error **errp)</td></tr>
<tr class="separator:aa65a4a4ae802bdd6f8cc362247c6325b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8910113c66e3bce77dbbdbb560d9aefd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a8910113c66e3bce77dbbdbb560d9aefd">zns_exit</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n)</td></tr>
<tr class="separator:a8910113c66e3bce77dbbdbb560d9aefd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08aeb05994f79207836886d8a1475372"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="zns_8c.html#a08aeb05994f79207836886d8a1475372">nvme_register_znssd</a> (<a class="el" href="structFemuCtrl.html">FemuCtrl</a> *n)</td></tr>
<tr class="separator:a08aeb05994f79207836886d8a1475372"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">宏定义说明</h2>
<a id="aa622cba6014f13bea0b2ac94455d7262"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa622cba6014f13bea0b2ac94455d7262">&#9670;&nbsp;</a></span>MIN_DISCARD_GRANULARITY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN_DISCARD_GRANULARITY&#160;&#160;&#160;(4 * KiB)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a06c9f096d365e730b91eb297bf71961e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06c9f096d365e730b91eb297bf71961e">&#9670;&nbsp;</a></span>NVME_DEFAULT_MAX_AZ_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NVME_DEFAULT_MAX_AZ_SIZE&#160;&#160;&#160;(128 * KiB)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af08b9977a8c3f36290e243506b5222d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af08b9977a8c3f36290e243506b5222d6">&#9670;&nbsp;</a></span>NVME_DEFAULT_ZONE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NVME_DEFAULT_ZONE_SIZE&#160;&#160;&#160;(128 * MiB)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">类型定义说明</h2>
<a id="ac747d5391c03151d537edfcc1f577df7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac747d5391c03151d537edfcc1f577df7">&#9670;&nbsp;</a></span>op_handler_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint16_t(* op_handler_t) (<a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *, <a class="el" href="structNvmeZone.html">NvmeZone</a> *, <a class="el" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a>, <a class="el" href="structNvmeRequest.html">NvmeRequest</a> *)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">枚举类型说明</h2>
<a id="a0759e855e2f759918191c8abe275500c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0759e855e2f759918191c8abe275500c">&#9670;&nbsp;</a></span>NvmeZoneProcessingMask</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="zns_8c.html#a0759e855e2f759918191c8abe275500c">NvmeZoneProcessingMask</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">枚举值</th></tr><tr><td class="fieldname"><a id="a0759e855e2f759918191c8abe275500ca0f07a84b957a078ed2a401ebdee9fc0d"></a>NVME_PROC_CURRENT_ZONE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0759e855e2f759918191c8abe275500ca3606a12acd83bf8178443ffaa3e72ac9"></a>NVME_PROC_OPENED_ZONES&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0759e855e2f759918191c8abe275500ca18d09cd4a0933aceda32e432dd97faf8"></a>NVME_PROC_CLOSED_ZONES&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0759e855e2f759918191c8abe275500ca03e0191366f1f0b541aed2014625d6d2"></a>NVME_PROC_READ_ONLY_ZONES&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a0759e855e2f759918191c8abe275500ca3bed639d7837a92a297e4df431c7ed9f"></a>NVME_PROC_FULL_ZONES&#160;</td><td class="fielddoc"></td></tr>
</table>
<div class="fragment"><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                            {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca0f07a84b957a078ed2a401ebdee9fc0d">NVME_PROC_CURRENT_ZONE</a>    = 0,</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca3606a12acd83bf8178443ffaa3e72ac9">NVME_PROC_OPENED_ZONES</a>    = 1 &lt;&lt; 0,</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca18d09cd4a0933aceda32e432dd97faf8">NVME_PROC_CLOSED_ZONES</a>    = 1 &lt;&lt; 1,</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca03e0191366f1f0b541aed2014625d6d2">NVME_PROC_READ_ONLY_ZONES</a> = 1 &lt;&lt; 2,</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca3bed639d7837a92a297e4df431c7ed9f">NVME_PROC_FULL_ZONES</a>      = 1 &lt;&lt; 3,</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;};</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">函数说明</h2>
<a id="a59ac97b9a3caead40c6651273483ed4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59ac97b9a3caead40c6651273483ed4c">&#9670;&nbsp;</a></span>nvme_csi_has_nvm_support()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool nvme_csi_has_nvm_support </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;{</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordflow">switch</span> (ns-&gt;<a class="code" href="structNvmeNamespace.html#a8354f38841896795412b089fdfbe1528">ctrl</a>-&gt;<a class="code" href="structFemuCtrl.html#a0b48d3c6cc09b094369348af59a3b096">csi</a>) {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a2342f477442526e6bc2aa046f9bd4a94a28181a48fe56de9ccab6eb11dd3fc9cc">NVME_CSI_NVM</a>:</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a2342f477442526e6bc2aa046f9bd4a94a64b23085931f2a85c7105d303bb4a495">NVME_CSI_ZONED</a>:</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    }</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a08aeb05994f79207836886d8a1475372"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08aeb05994f79207836886d8a1475372">&#9670;&nbsp;</a></span>nvme_register_znssd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int nvme_register_znssd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;{</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#a2b07accc41de60cd0c6de43adde355ad">ext_ops</a> = (<a class="code" href="nvme_8h.html#a5d9fde4912328e2ecf4f80e41e1da013">FemuExtCtrlOps</a>) {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        .<a class="code" href="structFemuExtCtrlOps.html#a5a0b55a8db93619bd96e347ed4c7a930">state</a>            = NULL,</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        .init             = <a class="code" href="zns_8c.html#aa65a4a4ae802bdd6f8cc362247c6325b">zns_init</a>,</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        .exit             = <a class="code" href="zns_8c.html#a8910113c66e3bce77dbbdbb560d9aefd">zns_exit</a>,</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        .rw_check_req     = NULL,</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        .start_ctrl       = <a class="code" href="zns_8c.html#a4c27f4956bf97dcabba73019e80b191a">zns_start_ctrl</a>,</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        .admin_cmd        = <a class="code" href="zns_8c.html#a88a38b39db2e6829a576bebd97ece799">zns_admin_cmd</a>,</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        .io_cmd           = <a class="code" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa">zns_io_cmd</a>,</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        .get_log          = NULL,</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    };</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160; </div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a08aeb05994f79207836886d8a1475372_cgraph.png" border="0" usemap="#zns_8c_a08aeb05994f79207836886d8a1475372_cgraph" alt=""/></div>
<map name="zns_8c_a08aeb05994f79207836886d8a1475372_cgraph" id="zns_8c_a08aeb05994f79207836886d8a1475372_cgraph">
<area shape="rect" title=" " alt="" coords="5,132,165,159"/>
<area shape="rect" href="zns_8c.html#a88a38b39db2e6829a576bebd97ece799" title=" " alt="" coords="213,31,340,57"/>
<area shape="rect" href="zns_8c.html#a8910113c66e3bce77dbbdbb560d9aefd" title=" " alt="" coords="239,81,315,108"/>
<area shape="rect" href="zns_8c.html#aa65a4a4ae802bdd6f8cc362247c6325b" title=" " alt="" coords="241,132,313,159"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="227,528,326,555"/>
<area shape="rect" href="zns_8c.html#a4c27f4956bf97dcabba73019e80b191a" title=" " alt="" coords="222,579,331,605"/>
<area shape="rect" href="zns_8c.html#a299230188329a14db7c7542d2764c7ce" title=" " alt="" coords="408,157,548,184"/>
<area shape="rect" href="zns_8c.html#ac4fd6eccdc41d46c3c9ad323e89019d2" title=" " alt="" coords="388,107,568,133"/>
<area shape="rect" href="zns_8c.html#a54625ca641142f536befa8182db6164e" title=" " alt="" coords="395,56,561,83"/>
<area shape="rect" href="zns_8c.html#ace4f37fd873afd711375d7c88dc333ff" title=" " alt="" coords="429,5,527,32"/>
<area shape="rect" href="zns_8h.html#a63a81710dc2a7e2e61f2b7ace02a538a" title=" " alt="" coords="1315,503,1423,529"/>
<area shape="rect" href="zns_8h.html#a04721281dcdb77acc610b362cb5085ad" title=" " alt="" coords="1471,503,1569,529"/>
<area shape="rect" href="zns_8c.html#a12ca668cf37e73d231f247d41d5990f9" title=" " alt="" coords="620,56,779,83"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="865,56,1014,83"/>
<area shape="rect" href="zns_8c.html#a05f7689d91910e1a2f865b30a9bc5393" title=" " alt="" coords="638,5,761,32"/>
<area shape="rect" href="nvme-util_8c.html#a9e84e8328646dcb1f24be9c79018e6a0" title=" " alt="" coords="860,5,1019,32"/>
<area shape="rect" href="zns_8c.html#a232d1c0fc6117ae692ff092d05f473e6" title=" " alt="" coords="659,705,739,732"/>
<area shape="rect" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008" title=" " alt="" coords="657,528,741,555"/>
<area shape="rect" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338" title=" " alt="" coords="409,477,547,504"/>
<area shape="rect" href="zns_8c.html#a6e03af0f3d0b7c597d9137a0b18bca56" title=" " alt="" coords="618,1009,781,1036"/>
<area shape="rect" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c" title=" " alt="" coords="616,1339,783,1365"/>
<area shape="rect" href="dram_8c.html#a1ccbcf0c92b7b084afc9890f3a7e5799" title=" " alt="" coords="890,680,989,707"/>
<area shape="rect" href="nvme_8h.html#ae412c484b40ac7903597a299757a7a83" title=" " alt="" coords="867,731,1011,757"/>
<area shape="rect" href="zns_8c.html#ae9ed91ad4901fe7f2cd4f9df6c333901" title=" " alt="" coords="868,579,1011,605"/>
<area shape="rect" href="zns_8c.html#a52ee538a6713c7b29769f23b61dad575" title=" " alt="" coords="873,832,1005,859"/>
<area shape="rect" href="zns_8c.html#a9a270c9ffa0fb88a1c6d57ecfe3e6815" title=" " alt="" coords="858,883,1021,909"/>
<area shape="rect" href="zns_8h.html#a686c1e6209d4c3eaf3897e73484bdf9f" title=" " alt="" coords="1146,503,1217,529"/>
<area shape="rect" href="zns_8c.html#ab56987b404fc29d662252ee6f15e9012" title=" " alt="" coords="883,629,996,656"/>
<area shape="rect" href="zns_8c.html#a3357eef3f827fdab1d88e5c95ae3c386" title=" " alt="" coords="1098,867,1265,909"/>
<area shape="rect" href="zns_8c.html#a9674ef207fca784d45d2b13fe63e31f5" title=" " alt="" coords="1098,397,1265,424"/>
<area shape="rect" href="zns_8h.html#aa03c395f4bba42d5fc5b8ef247b082ae" title=" " alt="" coords="1096,816,1267,843"/>
<area shape="rect" href="zns_8c.html#a94c5876f1b68a759a109b78003852924" title=" " alt="" coords="854,259,1025,285"/>
<area shape="rect" href="zns_8c.html#ad5f4088354d2555f9d66e2ba441592ff" title=" " alt="" coords="861,309,1018,336"/>
<area shape="rect" href="zns_8c.html#a5fa5b88257a067bda683c7f981b39524" title=" " alt="" coords="856,528,1023,555"/>
<area shape="rect" href="zns_8c.html#a61f038c076c83ca5f99341b71c9b8e10" title=" " alt="" coords="867,361,1011,402"/>
<area shape="rect" href="zns_8h.html#ad064d2d81e65c1f8d539bafbee8cf353" title=" " alt="" coords="1118,933,1245,960"/>
<area shape="rect" href="zns_8c.html#a84203495e6de57d698b7e393f7106984" title=" " alt="" coords="646,477,753,504"/>
<area shape="rect" href="dma_8c.html#a83e01cb3ebf3721ca1fd024940ed6aa6" title=" " alt="" coords="882,1085,997,1112"/>
<area shape="rect" href="zns_8c.html#a6719fe173fec9e6e538ab3f449491bd2" title=" " alt="" coords="831,1136,1048,1163"/>
<area shape="rect" href="zns_8h.html#af2c9d24f2afaea78ba6081a0cbb5c6cf" title=" " alt="" coords="857,1187,1022,1213"/>
<area shape="rect" href="zns_8h.html#a0b9c3e6b619d9dca6883a7fe3cb4daa9" title=" " alt="" coords="1127,984,1235,1011"/>
<area shape="rect" href="zns_8c.html#a81321b3c5f8d3e0069c181e2dfa4f452" title=" " alt="" coords="848,1035,1031,1061"/>
<area shape="rect" href="dma_8c.html#adef0f21bc237d992b4ae8b29258645a8" title=" " alt="" coords="880,1237,999,1264"/>
<area shape="rect" href="zns_8c.html#af29e49b46b70e9dc142f1bb3bf7e65da" title=" " alt="" coords="878,1288,1001,1315"/>
<area shape="rect" href="zns_8c.html#a48ae04e0f8dcb34ff3803282d5b0ad17" title=" " alt="" coords="875,1339,1003,1365"/>
<area shape="rect" href="zns_8c.html#ad642783946555e5f78ea1651c02404cb" title=" " alt="" coords="877,1389,1001,1416"/>
<area shape="rect" href="zns_8c.html#a21f29cc79d1f772a1244c0f512171c0a" title=" " alt="" coords="874,1440,1005,1467"/>
<area shape="rect" href="zns_8c.html#aea339e52add6067aeb466ab8b0f56a1d" title=" " alt="" coords="879,1491,1000,1517"/>
<area shape="rect" href="zns_8c.html#a7c7e09c6f357c1f77c724c664f6c0128" title=" " alt="" coords="878,1541,1001,1568"/>
<area shape="rect" href="zns_8c.html#a52eacdcbc504ab2769e6b194295e2355" title=" " alt="" coords="879,1592,1000,1619"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a08aeb05994f79207836886d8a1475372_icgraph.png" border="0" usemap="#zns_8c_a08aeb05994f79207836886d8a1475372_icgraph" alt=""/></div>
<map name="zns_8c_a08aeb05994f79207836886d8a1475372_icgraph" id="zns_8c_a08aeb05994f79207836886d8a1475372_icgraph">
<area shape="rect" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a88a38b39db2e6829a576bebd97ece799"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88a38b39db2e6829a576bebd97ece799">&#9670;&nbsp;</a></span>zns_admin_cmd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_admin_cmd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeCmd.html">NvmeCmd</a> *&#160;</td>
          <td class="paramname"><em>cmd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;{</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">switch</span> (cmd-&gt;<a class="code" href="structNvmeCmd.html#a2751bc2a772082d3af81124a1d120a0c">opcode</a>) {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a778b8f53d6725ef86c455e2e55d46ce7">NVME_INVALID_OPCODE</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a88a38b39db2e6829a576bebd97ece799_icgraph.png" border="0" usemap="#zns_8c_a88a38b39db2e6829a576bebd97ece799_icgraph" alt=""/></div>
<map name="zns_8c_a88a38b39db2e6829a576bebd97ece799_icgraph" id="zns_8c_a88a38b39db2e6829a576bebd97ece799_icgraph">
<area shape="rect" title=" " alt="" coords="783,5,909,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a94c5876f1b68a759a109b78003852924"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94c5876f1b68a759a109b78003852924">&#9670;&nbsp;</a></span>zns_advance_zone_wp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint64_t zns_advance_zone_wp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>nlb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;{</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    uint64_t result = zone-&gt;<a class="code" href="structNvmeZone.html#ad456c9d5b78f51ba486371ab73d7465e">w_ptr</a>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    uint8_t zs;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    zone-&gt;<a class="code" href="structNvmeZone.html#ad456c9d5b78f51ba486371ab73d7465e">w_ptr</a> += nlb;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">if</span> (zone-&gt;<a class="code" href="structNvmeZone.html#ad456c9d5b78f51ba486371ab73d7465e">w_ptr</a> &lt; <a class="code" href="zns_8h.html#a1f2a423f30678b841f4aaf3f09d0e7de">zns_zone_wr_boundary</a>(zone)) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        zs = <a class="code" href="zns_8h.html#a677294d02c732b61b18d610041851e4b">zns_get_zone_state</a>(zone);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">switch</span> (zs) {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08">NVME_ZONE_STATE_EMPTY</a>:</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <a class="code" href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c">zns_aor_inc_active</a>(ns);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <span class="comment">/* fall through */</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>:</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <a class="code" href="zns_8h.html#a456d13e8923adbff0acc0ab45e47ec8f">zns_aor_inc_open</a>(ns);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            <a class="code" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3">zns_assign_zone_state</a>(ns, zone, <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a044a8bce6652c9e617f784a37f643d38">NVME_ZONE_STATE_IMPLICITLY_OPEN</a>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a94c5876f1b68a759a109b78003852924_cgraph.png" border="0" usemap="#zns_8c_a94c5876f1b68a759a109b78003852924_cgraph" alt=""/></div>
<map name="zns_8c_a94c5876f1b68a759a109b78003852924_cgraph" id="zns_8c_a94c5876f1b68a759a109b78003852924_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,176,133"/>
<area shape="rect" href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c" title=" " alt="" coords="238,5,383,32"/>
<area shape="rect" href="zns_8h.html#a456d13e8923adbff0acc0ab45e47ec8f" title=" " alt="" coords="242,56,379,83"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="225,157,396,184"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="445,107,596,133"/>
<area shape="rect" href="zns_8h.html#a1f2a423f30678b841f4aaf3f09d0e7de" title=" " alt="" coords="224,208,397,235"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="446,157,595,184"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a94c5876f1b68a759a109b78003852924_icgraph.png" border="0" usemap="#zns_8c_a94c5876f1b68a759a109b78003852924_icgraph" alt=""/></div>
<map name="zns_8c_a94c5876f1b68a759a109b78003852924_icgraph" id="zns_8c_a94c5876f1b68a759a109b78003852924_icgraph">
<area shape="rect" title=" " alt="" coords="1269,31,1440,57"/>
<area shape="rect" href="zns_8c.html#a84203495e6de57d698b7e393f7106984" title=" " alt="" coords="1115,5,1221,32"/>
<area shape="rect" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008" title=" " alt="" coords="956,56,1040,83"/>
<area shape="rect" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338" title=" " alt="" coords="929,5,1067,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,31,881,57"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,31,735,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="a7cf84991a322dded9376491f5d98dedb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cf84991a322dded9376491f5d98dedb">&#9670;&nbsp;</a></span>zns_aio_zone_reset_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void zns_aio_zone_reset_cb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;{</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="structNvmeNamespace.html">NvmeNamespace</a> *ns = req-&gt;<a class="code" href="structNvmeRequest.html#a3609469c3f31833cb86006bae283e160">ns</a>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">/* FIXME, We always assume reset SUCCESS */</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="zns_8h.html#a677294d02c732b61b18d610041851e4b">zns_get_zone_state</a>(zone)) {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a65105422decdfd6860779463c8964b55">NVME_ZONE_STATE_EXPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a044a8bce6652c9e617f784a37f643d38">NVME_ZONE_STATE_IMPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <a class="code" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b">zns_aor_dec_open</a>(ns);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>:</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <a class="code" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16">zns_aor_dec_active</a>(ns);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9afc7fe17858da6497474a2307ab239967">NVME_ZONE_STATE_FULL</a>:</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        zone-&gt;<a class="code" href="structNvmeZone.html#ad456c9d5b78f51ba486371ab73d7465e">w_ptr</a> = zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#a626c7b988cfde334d69cae1ff7a9fe2c">zslba</a>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#ada6f1e571b88b3ef9bcd3a70a69c44d4">wp</a> = zone-&gt;<a class="code" href="structNvmeZone.html#ad456c9d5b78f51ba486371ab73d7465e">w_ptr</a>;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <a class="code" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3">zns_assign_zone_state</a>(ns, zone, <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08">NVME_ZONE_STATE_EMPTY</a>);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a7cf84991a322dded9376491f5d98dedb_cgraph.png" border="0" usemap="#zns_8c_a7cf84991a322dded9376491f5d98dedb_cgraph" alt=""/></div>
<map name="zns_8c_a7cf84991a322dded9376491f5d98dedb_cgraph" id="zns_8c_a7cf84991a322dded9376491f5d98dedb_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,176,108"/>
<area shape="rect" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16" title=" " alt="" coords="235,5,384,32"/>
<area shape="rect" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b" title=" " alt="" coords="239,56,380,83"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="224,157,395,184"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="443,107,593,133"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="443,157,593,184"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a7cf84991a322dded9376491f5d98dedb_icgraph.png" border="0" usemap="#zns_8c_a7cf84991a322dded9376491f5d98dedb_icgraph" alt=""/></div>
<map name="zns_8c_a7cf84991a322dded9376491f5d98dedb_icgraph" id="zns_8c_a7cf84991a322dded9376491f5d98dedb_icgraph">
<area shape="rect" title=" " alt="" coords="1315,5,1485,32"/>
<area shape="rect" href="zns_8c.html#a7c7e09c6f357c1f77c724c664f6c0128" title=" " alt="" coords="1144,5,1267,32"/>
<area shape="rect" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c" title=" " alt="" coords="929,5,1096,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a2bd0e00434954d61e13cfe8a65a02e34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bd0e00434954d61e13cfe8a65a02e34">&#9670;&nbsp;</a></span>zns_aor_check()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int zns_aor_check </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>act</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>opn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;{</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = ns-&gt;<a class="code" href="structNvmeNamespace.html#a8354f38841896795412b089fdfbe1528">ctrl</a>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#af7aabe80b46d1d28417b5f757b25f8d7">max_active_zones</a> != 0 &amp;&amp;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        n-&gt;<a class="code" href="structFemuCtrl.html#ad35028fa04e029ef80fb4da8a501bb02">nr_active_zones</a> + act &gt; n-&gt;<a class="code" href="structFemuCtrl.html#af7aabe80b46d1d28417b5f757b25f8d7">max_active_zones</a>) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4aa0de61bbc9c674158a3acd6d6abbafd5">NVME_ZONE_TOO_MANY_ACTIVE</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#ade2c007bdb0d6d63de0b2ef92eba5339">max_open_zones</a> != 0 &amp;&amp;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        n-&gt;<a class="code" href="structFemuCtrl.html#a33144e9a783e4a96c1149c2fc04b4704">nr_open_zones</a> + opn &gt; n-&gt;<a class="code" href="structFemuCtrl.html#ade2c007bdb0d6d63de0b2ef92eba5339">max_open_zones</a>) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a93e2646391dead4a07fa746cb4c6c75d">NVME_ZONE_TOO_MANY_OPEN</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a2bd0e00434954d61e13cfe8a65a02e34_icgraph.png" border="0" usemap="#zns_8c_a2bd0e00434954d61e13cfe8a65a02e34_icgraph" alt=""/></div>
<map name="zns_8c_a2bd0e00434954d61e13cfe8a65a02e34_icgraph" id="zns_8c_a2bd0e00434954d61e13cfe8a65a02e34_icgraph">
<area shape="rect" title=" " alt="" coords="1535,81,1652,108"/>
<area shape="rect" href="zns_8c.html#ad5f4088354d2555f9d66e2ba441592ff" title=" " alt="" coords="1329,31,1487,57"/>
<area shape="rect" href="zns_8c.html#aea339e52add6067aeb466ab8b0f56a1d" title=" " alt="" coords="1347,81,1469,108"/>
<area shape="rect" href="zns_8c.html#a52eacdcbc504ab2769e6b194295e2355" title=" " alt="" coords="1347,132,1469,159"/>
<area shape="rect" href="zns_8c.html#a84203495e6de57d698b7e393f7106984" title=" " alt="" coords="1145,5,1251,32"/>
<area shape="rect" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008" title=" " alt="" coords="956,56,1040,83"/>
<area shape="rect" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338" title=" " alt="" coords="929,5,1067,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,56,881,83"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,56,735,83"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,56,527,83"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,56,284,83"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,56,129,83"/>
<area shape="rect" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c" title=" " alt="" coords="1115,107,1281,133"/>
</map>
</div>

</div>
</div>
<a id="a819d2621fbd145acef21bd41486156a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a819d2621fbd145acef21bd41486156a3">&#9670;&nbsp;</a></span>zns_assign_zone_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void zns_assign_zone_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a>&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;{</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = ns-&gt;<a class="code" href="structNvmeNamespace.html#a8354f38841896795412b089fdfbe1528">ctrl</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">if</span> (QTAILQ_IN_USE(zone, entry)) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="zns_8h.html#a677294d02c732b61b18d610041851e4b">zns_get_zone_state</a>(zone)) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a65105422decdfd6860779463c8964b55">NVME_ZONE_STATE_EXPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            QTAILQ_REMOVE(&amp;n-&gt;exp_open_zones, zone, entry);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a044a8bce6652c9e617f784a37f643d38">NVME_ZONE_STATE_IMPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            QTAILQ_REMOVE(&amp;n-&gt;imp_open_zones, zone, entry);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>:</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            QTAILQ_REMOVE(&amp;n-&gt;closed_zones, zone, entry);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9afc7fe17858da6497474a2307ab239967">NVME_ZONE_STATE_FULL</a>:</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            QTAILQ_REMOVE(&amp;n-&gt;full_zones, zone, entry);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            ;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="zns_8h.html#afdc856385776185b67188b43c7569469">zns_set_zone_state</a>(zone, <a class="code" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a>) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a65105422decdfd6860779463c8964b55">NVME_ZONE_STATE_EXPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        QTAILQ_INSERT_TAIL(&amp;n-&gt;exp_open_zones, zone, entry);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a044a8bce6652c9e617f784a37f643d38">NVME_ZONE_STATE_IMPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        QTAILQ_INSERT_TAIL(&amp;n-&gt;imp_open_zones, zone, entry);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>:</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        QTAILQ_INSERT_TAIL(&amp;n-&gt;closed_zones, zone, entry);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9afc7fe17858da6497474a2307ab239967">NVME_ZONE_STATE_FULL</a>:</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        QTAILQ_INSERT_TAIL(&amp;n-&gt;full_zones, zone, entry);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a9f9310a3aab3b20b1dc6ea8a2b658add">NVME_ZONE_STATE_READ_ONLY</a>:</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#aad408ac3045c84d106809b7a2b684afd">za</a> = 0;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a819d2621fbd145acef21bd41486156a3_cgraph.png" border="0" usemap="#zns_8c_a819d2621fbd145acef21bd41486156a3_cgraph" alt=""/></div>
<map name="zns_8c_a819d2621fbd145acef21bd41486156a3_cgraph" id="zns_8c_a819d2621fbd145acef21bd41486156a3_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,176,57"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="224,5,375,32"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="225,56,374,83"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a819d2621fbd145acef21bd41486156a3_icgraph.png" border="0" usemap="#zns_8c_a819d2621fbd145acef21bd41486156a3_icgraph" alt=""/></div>
<map name="zns_8c_a819d2621fbd145acef21bd41486156a3_icgraph" id="zns_8c_a819d2621fbd145acef21bd41486156a3_icgraph">
<area shape="rect" title=" " alt="" coords="1783,224,1953,251"/>
<area shape="rect" href="zns_8c.html#a94c5876f1b68a759a109b78003852924" title=" " alt="" coords="1329,5,1500,32"/>
<area shape="rect" href="zns_8c.html#a7cf84991a322dded9376491f5d98dedb" title=" " alt="" coords="1556,325,1727,352"/>
<area shape="rect" href="zns_8c.html#a02ec33ad0c6f39ad701ac9ea780811c4" title=" " alt="" coords="1548,63,1735,89"/>
<area shape="rect" href="zns_8c.html#af29e49b46b70e9dc142f1bb3bf7e65da" title=" " alt="" coords="1353,376,1476,403"/>
<area shape="rect" href="zns_8c.html#a61f038c076c83ca5f99341b71c9b8e10" title=" " alt="" coords="1343,107,1487,149"/>
<area shape="rect" href="zns_8c.html#ad642783946555e5f78ea1651c02404cb" title=" " alt="" coords="1353,427,1477,453"/>
<area shape="rect" href="zns_8c.html#a21f29cc79d1f772a1244c0f512171c0a" title=" " alt="" coords="1576,173,1707,200"/>
<area shape="rect" href="zns_8c.html#aea339e52add6067aeb466ab8b0f56a1d" title=" " alt="" coords="1581,224,1702,251"/>
<area shape="rect" href="zns_8c.html#a52eacdcbc504ab2769e6b194295e2355" title=" " alt="" coords="1581,275,1702,301"/>
<area shape="rect" href="zns_8c.html#a84203495e6de57d698b7e393f7106984" title=" " alt="" coords="1145,107,1251,133"/>
<area shape="rect" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008" title=" " alt="" coords="1156,56,1240,83"/>
<area shape="rect" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338" title=" " alt="" coords="929,107,1067,133"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,107,881,133"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,107,735,133"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,107,527,133"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,107,284,133"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,107,129,133"/>
<area shape="rect" href="zns_8c.html#a7c7e09c6f357c1f77c724c664f6c0128" title=" " alt="" coords="1353,325,1476,352"/>
<area shape="rect" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c" title=" " alt="" coords="1115,275,1281,301"/>
<area shape="rect" href="zns_8c.html#ad5f4088354d2555f9d66e2ba441592ff" title=" " alt="" coords="1336,56,1493,83"/>
</map>
</div>

</div>
</div>
<a id="ad5f4088354d2555f9d66e2ba441592ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5f4088354d2555f9d66e2ba441592ff">&#9670;&nbsp;</a></span>zns_auto_open_zone()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_auto_open_zone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;{</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    uint16_t status = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    uint8_t zs = <a class="code" href="zns_8h.html#a677294d02c732b61b18d610041851e4b">zns_get_zone_state</a>(zone);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span> (zs == <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08">NVME_ZONE_STATE_EMPTY</a>) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <a class="code" href="zns_8c.html#a02ec33ad0c6f39ad701ac9ea780811c4">zns_auto_transition_zone</a>(ns);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        status = <a class="code" href="zns_8c.html#a2bd0e00434954d61e13cfe8a65a02e34">zns_aor_check</a>(ns, 1, 1);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (zs == <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <a class="code" href="zns_8c.html#a02ec33ad0c6f39ad701ac9ea780811c4">zns_auto_transition_zone</a>(ns);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        status = <a class="code" href="zns_8c.html#a2bd0e00434954d61e13cfe8a65a02e34">zns_aor_check</a>(ns, 0, 1);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_ad5f4088354d2555f9d66e2ba441592ff_cgraph.png" border="0" usemap="#zns_8c_ad5f4088354d2555f9d66e2ba441592ff_cgraph" alt=""/></div>
<map name="zns_8c_ad5f4088354d2555f9d66e2ba441592ff_cgraph" id="zns_8c_ad5f4088354d2555f9d66e2ba441592ff_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,163,83"/>
<area shape="rect" href="zns_8c.html#a2bd0e00434954d61e13cfe8a65a02e34" title=" " alt="" coords="245,5,363,32"/>
<area shape="rect" href="zns_8c.html#a02ec33ad0c6f39ad701ac9ea780811c4" title=" " alt="" coords="211,56,397,83"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="664,107,815,133"/>
<area shape="rect" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b" title=" " alt="" coords="460,5,601,32"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="445,56,616,83"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="665,56,814,83"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_ad5f4088354d2555f9d66e2ba441592ff_icgraph.png" border="0" usemap="#zns_8c_ad5f4088354d2555f9d66e2ba441592ff_icgraph" alt=""/></div>
<map name="zns_8c_ad5f4088354d2555f9d66e2ba441592ff_icgraph" id="zns_8c_ad5f4088354d2555f9d66e2ba441592ff_icgraph">
<area shape="rect" title=" " alt="" coords="1269,31,1427,57"/>
<area shape="rect" href="zns_8c.html#a84203495e6de57d698b7e393f7106984" title=" " alt="" coords="1115,5,1221,32"/>
<area shape="rect" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008" title=" " alt="" coords="956,56,1040,83"/>
<area shape="rect" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338" title=" " alt="" coords="929,5,1067,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,31,881,57"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,31,735,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="a02ec33ad0c6f39ad701ac9ea780811c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02ec33ad0c6f39ad701ac9ea780811c4">&#9670;&nbsp;</a></span>zns_auto_transition_zone()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void zns_auto_transition_zone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;{</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = ns-&gt;<a class="code" href="structNvmeNamespace.html#a8354f38841896795412b089fdfbe1528">ctrl</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <a class="code" href="structNvmeZone.html">NvmeZone</a> *zone;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#ade2c007bdb0d6d63de0b2ef92eba5339">max_open_zones</a> &amp;&amp;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        n-&gt;<a class="code" href="structFemuCtrl.html#a33144e9a783e4a96c1149c2fc04b4704">nr_open_zones</a> == n-&gt;<a class="code" href="structFemuCtrl.html#ade2c007bdb0d6d63de0b2ef92eba5339">max_open_zones</a>) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        zone = QTAILQ_FIRST(&amp;n-&gt;imp_open_zones);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">if</span> (zone) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;             <span class="comment">/* Automatically close this implicitly open zone */</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            QTAILQ_REMOVE(&amp;n-&gt;imp_open_zones, zone, entry);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <a class="code" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b">zns_aor_dec_open</a>(ns);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <a class="code" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3">zns_assign_zone_state</a>(ns, zone, <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a02ec33ad0c6f39ad701ac9ea780811c4_cgraph.png" border="0" usemap="#zns_8c_a02ec33ad0c6f39ad701ac9ea780811c4_cgraph" alt=""/></div>
<map name="zns_8c_a02ec33ad0c6f39ad701ac9ea780811c4_cgraph" id="zns_8c_a02ec33ad0c6f39ad701ac9ea780811c4_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,192,57"/>
<area shape="rect" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b" title=" " alt="" coords="255,5,396,32"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="240,56,411,83"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="459,31,609,57"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="459,81,609,108"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a02ec33ad0c6f39ad701ac9ea780811c4_icgraph.png" border="0" usemap="#zns_8c_a02ec33ad0c6f39ad701ac9ea780811c4_icgraph" alt=""/></div>
<map name="zns_8c_a02ec33ad0c6f39ad701ac9ea780811c4_icgraph" id="zns_8c_a02ec33ad0c6f39ad701ac9ea780811c4_icgraph">
<area shape="rect" title=" " alt="" coords="1475,31,1661,57"/>
<area shape="rect" href="zns_8c.html#ad5f4088354d2555f9d66e2ba441592ff" title=" " alt="" coords="1269,31,1427,57"/>
<area shape="rect" href="zns_8c.html#a84203495e6de57d698b7e393f7106984" title=" " alt="" coords="1115,5,1221,32"/>
<area shape="rect" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008" title=" " alt="" coords="956,56,1040,83"/>
<area shape="rect" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338" title=" " alt="" coords="929,5,1067,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,31,881,57"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,31,735,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="aa9deb4d27a553448ab81440798d09fb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9deb4d27a553448ab81440798d09fb7">&#9670;&nbsp;</a></span>zns_bulk_proc_zone()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_bulk_proc_zone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="zns_8c.html#a0759e855e2f759918191c8abe275500c">NvmeZoneProcessingMask</a>&#160;</td>
          <td class="paramname"><em>proc_mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="zns_8c.html#ac747d5391c03151d537edfcc1f577df7">op_handler_t</a>&#160;</td>
          <td class="paramname"><em>op_hndlr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;{</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    uint16_t status = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a> zs = <a class="code" href="zns_8h.html#a677294d02c732b61b18d610041851e4b">zns_get_zone_state</a>(zone);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordtype">bool</span> proc_zone;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">switch</span> (zs) {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a044a8bce6652c9e617f784a37f643d38">NVME_ZONE_STATE_IMPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a65105422decdfd6860779463c8964b55">NVME_ZONE_STATE_EXPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        proc_zone = proc_mask &amp; <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca3606a12acd83bf8178443ffaa3e72ac9">NVME_PROC_OPENED_ZONES</a>;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>:</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        proc_zone = proc_mask &amp; <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca18d09cd4a0933aceda32e432dd97faf8">NVME_PROC_CLOSED_ZONES</a>;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a9f9310a3aab3b20b1dc6ea8a2b658add">NVME_ZONE_STATE_READ_ONLY</a>:</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        proc_zone = proc_mask &amp; <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca03e0191366f1f0b541aed2014625d6d2">NVME_PROC_READ_ONLY_ZONES</a>;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9afc7fe17858da6497474a2307ab239967">NVME_ZONE_STATE_FULL</a>:</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        proc_zone = proc_mask &amp; <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca3bed639d7837a92a297e4df431c7ed9f">NVME_PROC_FULL_ZONES</a>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        proc_zone = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">if</span> (proc_zone) {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        status = op_hndlr(ns, zone, zs, req);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; </div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_aa9deb4d27a553448ab81440798d09fb7_cgraph.png" border="0" usemap="#zns_8c_aa9deb4d27a553448ab81440798d09fb7_cgraph" alt=""/></div>
<map name="zns_8c_aa9deb4d27a553448ab81440798d09fb7_cgraph" id="zns_8c_aa9deb4d27a553448ab81440798d09fb7_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,157,32"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="205,5,356,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_aa9deb4d27a553448ab81440798d09fb7_icgraph.png" border="0" usemap="#zns_8c_aa9deb4d27a553448ab81440798d09fb7_icgraph" alt=""/></div>
<map name="zns_8c_aa9deb4d27a553448ab81440798d09fb7_icgraph" id="zns_8c_aa9deb4d27a553448ab81440798d09fb7_icgraph">
<area shape="rect" title=" " alt="" coords="1320,5,1472,32"/>
<area shape="rect" href="zns_8c.html#a48ae04e0f8dcb34ff3803282d5b0ad17" title=" " alt="" coords="1144,5,1272,32"/>
<area shape="rect" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c" title=" " alt="" coords="929,5,1096,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ae9ed91ad4901fe7f2cd4f9df6c333901"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9ed91ad4901fe7f2cd4f9df6c333901">&#9670;&nbsp;</a></span>zns_check_bounds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_check_bounds </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>slba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>nlb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;{</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    uint64_t nsze = le64_to_cpu(ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a4a814e395ae6ea7b3b7c5cba1c22ad85">nsze</a>);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(UINT64_MAX - slba &lt; nlb || slba + nlb &gt; nsze)) {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a43aae0e0a370dd16186369148885344f">NVME_LBA_RANGE</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    }</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_ae9ed91ad4901fe7f2cd4f9df6c333901_icgraph.png" border="0" usemap="#zns_8c_ae9ed91ad4901fe7f2cd4f9df6c333901_icgraph" alt=""/></div>
<map name="zns_8c_ae9ed91ad4901fe7f2cd4f9df6c333901_icgraph" id="zns_8c_ae9ed91ad4901fe7f2cd4f9df6c333901_icgraph">
<area shape="rect" title=" " alt="" coords="1269,56,1412,83"/>
<area shape="rect" href="zns_8c.html#a84203495e6de57d698b7e393f7106984" title=" " alt="" coords="1115,5,1221,32"/>
<area shape="rect" href="zns_8c.html#a232d1c0fc6117ae692ff092d05f473e6" title=" " alt="" coords="958,56,1038,83"/>
<area shape="rect" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008" title=" " alt="" coords="1126,107,1210,133"/>
<area shape="rect" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338" title=" " alt="" coords="929,5,1067,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,56,881,83"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,56,735,83"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,56,527,83"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,56,284,83"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,56,129,83"/>
</map>
</div>

</div>
</div>
<a id="a52ee538a6713c7b29769f23b61dad575"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52ee538a6713c7b29769f23b61dad575">&#9670;&nbsp;</a></span>zns_check_dulbe()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_check_dulbe </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>slba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>nlb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;{</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a52ee538a6713c7b29769f23b61dad575_icgraph.png" border="0" usemap="#zns_8c_a52ee538a6713c7b29769f23b61dad575_icgraph" alt=""/></div>
<map name="zns_8c_a52ee538a6713c7b29769f23b61dad575_icgraph" id="zns_8c_a52ee538a6713c7b29769f23b61dad575_icgraph">
<area shape="rect" title=" " alt="" coords="1057,5,1189,32"/>
<area shape="rect" href="zns_8c.html#a232d1c0fc6117ae692ff092d05f473e6" title=" " alt="" coords="929,5,1009,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a9a270c9ffa0fb88a1c6d57ecfe3e6815"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a270c9ffa0fb88a1c6d57ecfe3e6815">&#9670;&nbsp;</a></span>zns_check_zone_read()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_check_zone_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>slba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>nlb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;{</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = ns-&gt;<a class="code" href="structNvmeNamespace.html#a8354f38841896795412b089fdfbe1528">ctrl</a>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="structNvmeZone.html">NvmeZone</a> *zone = <a class="code" href="zns_8c.html#a9674ef207fca784d45d2b13fe63e31f5">zns_get_zone_by_slba</a>(ns, slba);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    uint64_t bndry = <a class="code" href="zns_8h.html#aa03c395f4bba42d5fc5b8ef247b082ae">zns_zone_rd_boundary</a>(ns, zone);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    uint64_t end = slba + nlb;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    uint16_t status;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    status = <a class="code" href="zns_8c.html#a3357eef3f827fdab1d88e5c95ae3c386">zns_check_zone_state_for_read</a>(zone);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> (status != <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        ;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(end &gt; bndry)) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordflow">if</span> (!n-&gt;<a class="code" href="structFemuCtrl.html#aa7cfd4a7ec5ef933c85eeee459b97a7d">cross_zone_read</a>) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            status = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4ae600f4ddbb7e75f8a0031c5f2cc78371">NVME_ZONE_BOUNDARY_ERROR</a>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">             * Read across zone boundary - check that all subsequent</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">             * zones that are being read have an appropriate state.</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">             */</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                zone++;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                status = <a class="code" href="zns_8c.html#a3357eef3f827fdab1d88e5c95ae3c386">zns_check_zone_state_for_read</a>(zone);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <span class="keywordflow">if</span> (status != <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>) {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            } <span class="keywordflow">while</span> (end &gt; <a class="code" href="zns_8h.html#aa03c395f4bba42d5fc5b8ef247b082ae">zns_zone_rd_boundary</a>(ns, zone));</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a9a270c9ffa0fb88a1c6d57ecfe3e6815_cgraph.png" border="0" usemap="#zns_8c_a9a270c9ffa0fb88a1c6d57ecfe3e6815_cgraph" alt=""/></div>
<map name="zns_8c_a9a270c9ffa0fb88a1c6d57ecfe3e6815_cgraph" id="zns_8c_a9a270c9ffa0fb88a1c6d57ecfe3e6815_cgraph">
<area shape="rect" title=" " alt="" coords="5,71,168,98"/>
<area shape="rect" href="zns_8c.html#a3357eef3f827fdab1d88e5c95ae3c386" title=" " alt="" coords="218,5,385,47"/>
<area shape="rect" href="zns_8c.html#a9674ef207fca784d45d2b13fe63e31f5" title=" " alt="" coords="218,71,385,98"/>
<area shape="rect" href="zns_8h.html#aa03c395f4bba42d5fc5b8ef247b082ae" title=" " alt="" coords="216,122,387,149"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="435,13,585,39"/>
<area shape="rect" href="zns_8c.html#a755fef089b9a7fc5ddd4be2d53455955" title=" " alt="" coords="455,71,565,98"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a9a270c9ffa0fb88a1c6d57ecfe3e6815_icgraph.png" border="0" usemap="#zns_8c_a9a270c9ffa0fb88a1c6d57ecfe3e6815_icgraph" alt=""/></div>
<map name="zns_8c_a9a270c9ffa0fb88a1c6d57ecfe3e6815_icgraph" id="zns_8c_a9a270c9ffa0fb88a1c6d57ecfe3e6815_icgraph">
<area shape="rect" title=" " alt="" coords="1057,5,1220,32"/>
<area shape="rect" href="zns_8c.html#a232d1c0fc6117ae692ff092d05f473e6" title=" " alt="" coords="929,5,1009,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a3357eef3f827fdab1d88e5c95ae3c386"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3357eef3f827fdab1d88e5c95ae3c386">&#9670;&nbsp;</a></span>zns_check_zone_state_for_read()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_check_zone_state_for_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;{</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    uint16_t status;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="zns_8h.html#a677294d02c732b61b18d610041851e4b">zns_get_zone_state</a>(zone)) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08">NVME_ZONE_STATE_EMPTY</a>:</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a044a8bce6652c9e617f784a37f643d38">NVME_ZONE_STATE_IMPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a65105422decdfd6860779463c8964b55">NVME_ZONE_STATE_EXPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9afc7fe17858da6497474a2307ab239967">NVME_ZONE_STATE_FULL</a>:</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>:</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a9f9310a3aab3b20b1dc6ea8a2b658add">NVME_ZONE_STATE_READ_ONLY</a>:</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        status = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a5a871630ac0aaff6794aaed5587d7fd3">NVME_ZONE_STATE_OFFLINE</a>:</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        status = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a6bf2d17d215aefaee1b47f4af6e6b6b6">NVME_ZONE_OFFLINE</a>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        assert(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a3357eef3f827fdab1d88e5c95ae3c386_cgraph.png" border="0" usemap="#zns_8c_a3357eef3f827fdab1d88e5c95ae3c386_cgraph" alt=""/></div>
<map name="zns_8c_a3357eef3f827fdab1d88e5c95ae3c386_cgraph" id="zns_8c_a3357eef3f827fdab1d88e5c95ae3c386_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,172,47"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="220,13,371,39"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a3357eef3f827fdab1d88e5c95ae3c386_icgraph.png" border="0" usemap="#zns_8c_a3357eef3f827fdab1d88e5c95ae3c386_icgraph" alt=""/></div>
<map name="zns_8c_a3357eef3f827fdab1d88e5c95ae3c386_icgraph" id="zns_8c_a3357eef3f827fdab1d88e5c95ae3c386_icgraph">
<area shape="rect" title=" " alt="" coords="1268,5,1435,47"/>
<area shape="rect" href="zns_8c.html#a9a270c9ffa0fb88a1c6d57ecfe3e6815" title=" " alt="" coords="1057,13,1220,39"/>
<area shape="rect" href="zns_8c.html#a232d1c0fc6117ae692ff092d05f473e6" title=" " alt="" coords="929,13,1009,39"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,13,881,39"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,13,735,39"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,13,527,39"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,13,284,39"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,13,129,39"/>
</map>
</div>

</div>
</div>
<a id="a841382c8c3024053a641811800230a23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a841382c8c3024053a641811800230a23">&#9670;&nbsp;</a></span>zns_check_zone_state_for_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_check_zone_state_for_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;{</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    uint16_t status;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="zns_8h.html#a677294d02c732b61b18d610041851e4b">zns_get_zone_state</a>(zone)) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08">NVME_ZONE_STATE_EMPTY</a>:</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a044a8bce6652c9e617f784a37f643d38">NVME_ZONE_STATE_IMPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a65105422decdfd6860779463c8964b55">NVME_ZONE_STATE_EXPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>:</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        status = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9afc7fe17858da6497474a2307ab239967">NVME_ZONE_STATE_FULL</a>:</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        status = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8afc2d666d7ef8839d71b360fd1087d9">NVME_ZONE_FULL</a>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a5a871630ac0aaff6794aaed5587d7fd3">NVME_ZONE_STATE_OFFLINE</a>:</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        status = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a6bf2d17d215aefaee1b47f4af6e6b6b6">NVME_ZONE_OFFLINE</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a9f9310a3aab3b20b1dc6ea8a2b658add">NVME_ZONE_STATE_READ_ONLY</a>:</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        status = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4ac15d4a175d76002c99d321be8104866c">NVME_ZONE_READ_ONLY</a>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        assert(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a841382c8c3024053a641811800230a23_cgraph.png" border="0" usemap="#zns_8c_a841382c8c3024053a641811800230a23_cgraph" alt=""/></div>
<map name="zns_8c_a841382c8c3024053a641811800230a23_cgraph" id="zns_8c_a841382c8c3024053a641811800230a23_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,172,47"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="220,13,371,39"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a841382c8c3024053a641811800230a23_icgraph.png" border="0" usemap="#zns_8c_a841382c8c3024053a641811800230a23_icgraph" alt=""/></div>
<map name="zns_8c_a841382c8c3024053a641811800230a23_icgraph" id="zns_8c_a841382c8c3024053a641811800230a23_icgraph">
<area shape="rect" title=" " alt="" coords="1484,23,1651,65"/>
<area shape="rect" href="zns_8c.html#a5fa5b88257a067bda683c7f981b39524" title=" " alt="" coords="1269,31,1436,57"/>
<area shape="rect" href="zns_8c.html#a84203495e6de57d698b7e393f7106984" title=" " alt="" coords="1115,5,1221,32"/>
<area shape="rect" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008" title=" " alt="" coords="956,56,1040,83"/>
<area shape="rect" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338" title=" " alt="" coords="929,5,1067,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,31,881,57"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,31,735,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="a5fa5b88257a067bda683c7f981b39524"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fa5b88257a067bda683c7f981b39524">&#9670;&nbsp;</a></span>zns_check_zone_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_check_zone_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>slba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>nlb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>append</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;{</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    uint16_t status;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>((slba + nlb) &gt; <a class="code" href="zns_8h.html#a1f2a423f30678b841f4aaf3f09d0e7de">zns_zone_wr_boundary</a>(zone))) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        status = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4ae600f4ddbb7e75f8a0031c5f2cc78371">NVME_ZONE_BOUNDARY_ERROR</a>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        status = <a class="code" href="zns_8c.html#a841382c8c3024053a641811800230a23">zns_check_zone_state_for_write</a>(zone);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">if</span> (status != <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>) {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        assert(<a class="code" href="zns_8h.html#ad064d2d81e65c1f8d539bafbee8cf353">zns_wp_is_valid</a>(zone));</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">if</span> (append) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(slba != zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#a626c7b988cfde334d69cae1ff7a9fe2c">zslba</a>)) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                status = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="zns_8h.html#a686c1e6209d4c3eaf3897e73484bdf9f">zns_l2b</a>(ns, nlb) &gt; (n-&gt;<a class="code" href="structFemuCtrl.html#a6d0418e38e888b2b8980a34198bfd463">page_size</a> &lt;&lt; n-&gt;<a class="code" href="structFemuCtrl.html#a8dc93dbc4b721983afa203722a769e7a">zasl</a>)) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                status = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(slba != zone-&gt;<a class="code" href="structNvmeZone.html#ad456c9d5b78f51ba486371ab73d7465e">w_ptr</a>)) {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            status = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4aea82bfe7be2189eb2b5cb5f18cfd50ab">NVME_ZONE_INVALID_WRITE</a>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a5fa5b88257a067bda683c7f981b39524_cgraph.png" border="0" usemap="#zns_8c_a5fa5b88257a067bda683c7f981b39524_cgraph" alt=""/></div>
<map name="zns_8c_a5fa5b88257a067bda683c7f981b39524_cgraph" id="zns_8c_a5fa5b88257a067bda683c7f981b39524_cgraph">
<area shape="rect" title=" " alt="" coords="5,97,172,123"/>
<area shape="rect" href="zns_8c.html#a841382c8c3024053a641811800230a23" title=" " alt="" coords="223,5,390,47"/>
<area shape="rect" href="zns_8h.html#a686c1e6209d4c3eaf3897e73484bdf9f" title=" " alt="" coords="271,122,342,149"/>
<area shape="rect" href="zns_8h.html#ad064d2d81e65c1f8d539bafbee8cf353" title=" " alt="" coords="243,71,370,98"/>
<area shape="rect" href="zns_8h.html#a1f2a423f30678b841f4aaf3f09d0e7de" title=" " alt="" coords="220,173,393,199"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="441,42,592,69"/>
<area shape="rect" href="zns_8h.html#a63a81710dc2a7e2e61f2b7ace02a538a" title=" " alt="" coords="463,122,571,149"/>
<area shape="rect" href="zns_8h.html#a04721281dcdb77acc610b362cb5085ad" title=" " alt="" coords="640,122,739,149"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a5fa5b88257a067bda683c7f981b39524_icgraph.png" border="0" usemap="#zns_8c_a5fa5b88257a067bda683c7f981b39524_icgraph" alt=""/></div>
<map name="zns_8c_a5fa5b88257a067bda683c7f981b39524_icgraph" id="zns_8c_a5fa5b88257a067bda683c7f981b39524_icgraph">
<area shape="rect" title=" " alt="" coords="1269,31,1436,57"/>
<area shape="rect" href="zns_8c.html#a84203495e6de57d698b7e393f7106984" title=" " alt="" coords="1115,5,1221,32"/>
<area shape="rect" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008" title=" " alt="" coords="956,56,1040,83"/>
<area shape="rect" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338" title=" " alt="" coords="929,5,1067,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,31,881,57"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,31,735,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="a8f09f2d274ee382c164ad442bb4f3e47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f09f2d274ee382c164ad442bb4f3e47">&#9670;&nbsp;</a></span>zns_clear_zone()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void zns_clear_zone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;{</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = ns-&gt;<a class="code" href="structNvmeNamespace.html#a8354f38841896795412b089fdfbe1528">ctrl</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    uint8_t <a class="code" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    zone-&gt;<a class="code" href="structNvmeZone.html#ad456c9d5b78f51ba486371ab73d7465e">w_ptr</a> = zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#ada6f1e571b88b3ef9bcd3a70a69c44d4">wp</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a> = <a class="code" href="zns_8h.html#a677294d02c732b61b18d610041851e4b">zns_get_zone_state</a>(zone);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span> (zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#ada6f1e571b88b3ef9bcd3a70a69c44d4">wp</a> != zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#a626c7b988cfde334d69cae1ff7a9fe2c">zslba</a> ||</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        (zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#aad408ac3045c84d106809b7a2b684afd">za</a> &amp; <a class="code" href="zns_8h.html#a5b5faae59db38c0e3b1c5c6be4f90e99a0befe230ab3de39e04876554c3506be3">NVME_ZA_ZD_EXT_VALID</a>)) {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a> != <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <a class="code" href="zns_8h.html#afdc856385776185b67188b43c7569469">zns_set_zone_state</a>(zone, <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <a class="code" href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c">zns_aor_inc_active</a>(ns);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        QTAILQ_INSERT_HEAD(&amp;n-&gt;closed_zones, zone, entry);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <a class="code" href="zns_8h.html#afdc856385776185b67188b43c7569469">zns_set_zone_state</a>(zone, <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08">NVME_ZONE_STATE_EMPTY</a>);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a8f09f2d274ee382c164ad442bb4f3e47_cgraph.png" border="0" usemap="#zns_8c_a8f09f2d274ee382c164ad442bb4f3e47_cgraph" alt=""/></div>
<map name="zns_8c_a8f09f2d274ee382c164ad442bb4f3e47_cgraph" id="zns_8c_a8f09f2d274ee382c164ad442bb4f3e47_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,127,83"/>
<area shape="rect" href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c" title=" " alt="" coords="177,5,323,32"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="175,56,325,83"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="175,107,325,133"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a8f09f2d274ee382c164ad442bb4f3e47_icgraph.png" border="0" usemap="#zns_8c_a8f09f2d274ee382c164ad442bb4f3e47_icgraph" alt=""/></div>
<map name="zns_8c_a8f09f2d274ee382c164ad442bb4f3e47_icgraph" id="zns_8c_a8f09f2d274ee382c164ad442bb4f3e47_icgraph">
<area shape="rect" title=" " alt="" coords="420,5,541,32"/>
<area shape="rect" href="zns_8c.html#a5a340f34f865c916bb163abd16dc637f" title=" " alt="" coords="189,5,372,32"/>
<area shape="rect" href="zns_8h.html#a23ed6cd90a43d43bad4b9196673fd1bf" title=" " alt="" coords="5,5,141,32"/>
</map>
</div>

</div>
</div>
<a id="af29e49b46b70e9dc142f1bb3bf7e65da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af29e49b46b70e9dc142f1bb3bf7e65da">&#9670;&nbsp;</a></span>zns_close_zone()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_close_zone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a>&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;{</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a>) {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a65105422decdfd6860779463c8964b55">NVME_ZONE_STATE_EXPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a044a8bce6652c9e617f784a37f643d38">NVME_ZONE_STATE_IMPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <a class="code" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b">zns_aor_dec_open</a>(ns);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <a class="code" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3">zns_assign_zone_state</a>(ns, zone, <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>:</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4aa17e6457f1ee4cbc398f2da7fcf2fc4f">NVME_ZONE_INVAL_TRANSITION</a>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_af29e49b46b70e9dc142f1bb3bf7e65da_cgraph.png" border="0" usemap="#zns_8c_af29e49b46b70e9dc142f1bb3bf7e65da_cgraph" alt=""/></div>
<map name="zns_8c_af29e49b46b70e9dc142f1bb3bf7e65da_cgraph" id="zns_8c_af29e49b46b70e9dc142f1bb3bf7e65da_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,128,57"/>
<area shape="rect" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b" title=" " alt="" coords="191,5,332,32"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="176,56,347,83"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="395,31,545,57"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="395,81,545,108"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_af29e49b46b70e9dc142f1bb3bf7e65da_icgraph.png" border="0" usemap="#zns_8c_af29e49b46b70e9dc142f1bb3bf7e65da_icgraph" alt=""/></div>
<map name="zns_8c_af29e49b46b70e9dc142f1bb3bf7e65da_icgraph" id="zns_8c_af29e49b46b70e9dc142f1bb3bf7e65da_icgraph">
<area shape="rect" title=" " alt="" coords="1144,5,1267,32"/>
<area shape="rect" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c" title=" " alt="" coords="929,5,1096,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a84203495e6de57d698b7e393f7106984"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84203495e6de57d698b7e393f7106984">&#9670;&nbsp;</a></span>zns_do_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_do_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>append</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>wrz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;{</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *rw = (<a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *)&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a335e5b18fb079480b1b1a1f06652c647">cmd</a>;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <a class="code" href="structNvmeNamespace.html">NvmeNamespace</a> *ns = req-&gt;<a class="code" href="structNvmeRequest.html#a3609469c3f31833cb86006bae283e160">ns</a>;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    uint64_t slba = le64_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a0f256de361f51a961d5a44955321b526">slba</a>);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    uint32_t nlb = (uint32_t)le16_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a34ba11f86be8f5d4be5518370faf2514">nlb</a>) + 1;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    uint64_t data_size = <a class="code" href="zns_8h.html#a686c1e6209d4c3eaf3897e73484bdf9f">zns_l2b</a>(ns, nlb);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    uint64_t data_offset;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <a class="code" href="structNvmeZone.html">NvmeZone</a> *zone;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <a class="code" href="structNvmeZonedResult.html">NvmeZonedResult</a> *<a class="code" href="structOc12IdAddrFormat.html#a732423af24585adde3b4003bfed623a2">res</a> = (<a class="code" href="structNvmeZonedResult.html">NvmeZonedResult</a> *)&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a8cec02fb87e647c828d06f533aec8758">cqe</a>;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    uint16_t status;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160; </div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    if (!wrz) {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        status = <a class="code" href="nvme_8h.html#ae412c484b40ac7903597a299757a7a83">nvme_check_mdts</a>(n, data_size);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        }</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    }</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; </div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    status = <a class="code" href="zns_8c.html#ae9ed91ad4901fe7f2cd4f9df6c333901">zns_check_bounds</a>(ns, slba, nlb);</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    zone = <a class="code" href="zns_8c.html#a9674ef207fca784d45d2b13fe63e31f5">zns_get_zone_by_slba</a>(ns, slba);</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    status = <a class="code" href="zns_8c.html#a5fa5b88257a067bda683c7f981b39524">zns_check_zone_write</a>(n, ns, zone, slba, nlb, append);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    }</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    status = <a class="code" href="zns_8c.html#ad5f4088354d2555f9d66e2ba441592ff">zns_auto_open_zone</a>(ns, zone);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordflow">if</span> (append) {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        slba = zone-&gt;<a class="code" href="structNvmeZone.html#ad456c9d5b78f51ba486371ab73d7465e">w_ptr</a>;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <a class="code" href="structOc12IdAddrFormat.html#a732423af24585adde3b4003bfed623a2">res</a>-&gt;slba = <a class="code" href="zns_8c.html#a94c5876f1b68a759a109b78003852924">zns_advance_zone_wp</a>(ns, zone, nlb);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    data_offset = <a class="code" href="zns_8h.html#a686c1e6209d4c3eaf3897e73484bdf9f">zns_l2b</a>(ns, slba);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordflow">if</span> (!wrz) {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        status = <a class="code" href="zns_8c.html#ab56987b404fc29d662252ee6f15e9012">zns_map_dptr</a>(n, data_size, req);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        }</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <a class="code" href="dram_8c.html#a1ccbcf0c92b7b084afc9890f3a7e5799">backend_rw</a>(n-&gt;<a class="code" href="structFemuCtrl.html#ab4f555e0b42bfe51c089ab004c88ff48">mbe</a>, &amp;req-&gt;<a class="code" href="structNvmeRequest.html#a678064f3bc45fbeb366ea44aea7273b2">qsg</a>, &amp;data_offset, req-&gt;<a class="code" href="structNvmeRequest.html#a6f04006cddb851afcc919412c6e90b60">is_write</a>);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    }</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160; </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <a class="code" href="zns_8c.html#a61f038c076c83ca5f99341b71c9b8e10">zns_finalize_zoned_write</a>(ns, req, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;err:</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    printf(<span class="stringliteral">&quot;****************Append Failed***************\n&quot;</span>);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keywordflow">return</span> status | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a84203495e6de57d698b7e393f7106984_cgraph.png" border="0" usemap="#zns_8c_a84203495e6de57d698b7e393f7106984_cgraph" alt=""/></div>
<map name="zns_8c_a84203495e6de57d698b7e393f7106984_cgraph" id="zns_8c_a84203495e6de57d698b7e393f7106984_cgraph">
<area shape="rect" title=" " alt="" coords="5,387,112,413"/>
<area shape="rect" href="dram_8c.html#a1ccbcf0c92b7b084afc9890f3a7e5799" title=" " alt="" coords="189,173,288,200"/>
<area shape="rect" href="nvme_8h.html#ae412c484b40ac7903597a299757a7a83" title=" " alt="" coords="167,224,311,251"/>
<area shape="rect" href="zns_8c.html#a94c5876f1b68a759a109b78003852924" title=" " alt="" coords="373,132,544,159"/>
<area shape="rect" href="zns_8c.html#ad5f4088354d2555f9d66e2ba441592ff" title=" " alt="" coords="160,325,317,352"/>
<area shape="rect" href="zns_8c.html#ae9ed91ad4901fe7f2cd4f9df6c333901" title=" " alt="" coords="167,615,310,641"/>
<area shape="rect" href="zns_8c.html#a5fa5b88257a067bda683c7f981b39524" title=" " alt="" coords="375,463,542,489"/>
<area shape="rect" href="zns_8h.html#a686c1e6209d4c3eaf3897e73484bdf9f" title=" " alt="" coords="651,579,722,605"/>
<area shape="rect" href="zns_8c.html#a61f038c076c83ca5f99341b71c9b8e10" title=" " alt="" coords="387,373,531,414"/>
<area shape="rect" href="zns_8c.html#a9674ef207fca784d45d2b13fe63e31f5" title=" " alt="" coords="603,629,770,656"/>
<area shape="rect" href="zns_8c.html#ab56987b404fc29d662252ee6f15e9012" title=" " alt="" coords="182,667,295,693"/>
<area shape="rect" href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c" title=" " alt="" coords="614,56,759,83"/>
<area shape="rect" href="zns_8h.html#a456d13e8923adbff0acc0ab45e47ec8f" title=" " alt="" coords="618,5,755,32"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="601,157,772,184"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="821,284,972,311"/>
<area shape="rect" href="zns_8h.html#a1f2a423f30678b841f4aaf3f09d0e7de" title=" " alt="" coords="600,360,773,387"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="822,157,971,184"/>
<area shape="rect" href="zns_8c.html#a2bd0e00434954d61e13cfe8a65a02e34" title=" " alt="" coords="400,321,517,348"/>
<area shape="rect" href="zns_8c.html#a02ec33ad0c6f39ad701ac9ea780811c4" title=" " alt="" coords="365,208,552,235"/>
<area shape="rect" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b" title=" " alt="" coords="616,208,757,235"/>
<area shape="rect" href="zns_8c.html#a841382c8c3024053a641811800230a23" title=" " alt="" coords="603,462,770,503"/>
<area shape="rect" href="zns_8h.html#ad064d2d81e65c1f8d539bafbee8cf353" title=" " alt="" coords="623,528,750,555"/>
<area shape="rect" href="zns_8h.html#a63a81710dc2a7e2e61f2b7ace02a538a" title=" " alt="" coords="843,579,951,605"/>
<area shape="rect" href="zns_8h.html#a04721281dcdb77acc610b362cb5085ad" title=" " alt="" coords="1020,579,1119,605"/>
<area shape="rect" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16" title=" " alt="" coords="612,411,761,437"/>
<area shape="rect" href="zns_8c.html#a755fef089b9a7fc5ddd4be2d53455955" title=" " alt="" coords="842,629,951,656"/>
<area shape="rect" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493" title=" " alt="" coords="397,671,520,697"/>
<area shape="rect" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484" title=" " alt="" coords="621,680,752,707"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a84203495e6de57d698b7e393f7106984_icgraph.png" border="0" usemap="#zns_8c_a84203495e6de57d698b7e393f7106984_icgraph" alt=""/></div>
<map name="zns_8c_a84203495e6de57d698b7e393f7106984_icgraph" id="zns_8c_a84203495e6de57d698b7e393f7106984_icgraph">
<area shape="rect" title=" " alt="" coords="1115,5,1221,32"/>
<area shape="rect" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338" title=" " alt="" coords="929,5,1067,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a48ae04e0f8dcb34ff3803282d5b0ad17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48ae04e0f8dcb34ff3803282d5b0ad17">&#9670;&nbsp;</a></span>zns_do_zone_op()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_do_zone_op </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="zns_8c.html#a0759e855e2f759918191c8abe275500c">NvmeZoneProcessingMask</a>&#160;</td>
          <td class="paramname"><em>proc_mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="zns_8c.html#ac747d5391c03151d537edfcc1f577df7">op_handler_t</a>&#160;</td>
          <td class="paramname"><em>op_hndlr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;{</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = ns-&gt;<a class="code" href="structNvmeNamespace.html#a8354f38841896795412b089fdfbe1528">ctrl</a>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <a class="code" href="structNvmeZone.html">NvmeZone</a> *next;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    uint16_t status = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordflow">if</span> (!proc_mask) {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        status = op_hndlr(ns, zone, <a class="code" href="zns_8h.html#a677294d02c732b61b18d610041851e4b">zns_get_zone_state</a>(zone), req);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordflow">if</span> (proc_mask &amp; <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca18d09cd4a0933aceda32e432dd97faf8">NVME_PROC_CLOSED_ZONES</a>) {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            QTAILQ_FOREACH_SAFE(zone, &amp;n-&gt;closed_zones, entry, next) {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                status = <a class="code" href="zns_8c.html#aa9deb4d27a553448ab81440798d09fb7">zns_bulk_proc_zone</a>(ns, zone, proc_mask, op_hndlr,</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                                             req);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                <span class="keywordflow">if</span> (status &amp;&amp; status != <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a5fa9131cf96f83f34916a127d8b7d312">NVME_NO_COMPLETE</a>) {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                    <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">if</span> (proc_mask &amp; <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca3606a12acd83bf8178443ffaa3e72ac9">NVME_PROC_OPENED_ZONES</a>) {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            QTAILQ_FOREACH_SAFE(zone, &amp;n-&gt;imp_open_zones, entry, next) {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                status = <a class="code" href="zns_8c.html#aa9deb4d27a553448ab81440798d09fb7">zns_bulk_proc_zone</a>(ns, zone, proc_mask, op_hndlr,</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                                             req);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                <span class="keywordflow">if</span> (status &amp;&amp; status != <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a5fa9131cf96f83f34916a127d8b7d312">NVME_NO_COMPLETE</a>) {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                    <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;            }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            QTAILQ_FOREACH_SAFE(zone, &amp;n-&gt;exp_open_zones, entry, next) {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                status = <a class="code" href="zns_8c.html#aa9deb4d27a553448ab81440798d09fb7">zns_bulk_proc_zone</a>(ns, zone, proc_mask, op_hndlr,</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                             req);</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                <span class="keywordflow">if</span> (status &amp;&amp; status != <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a5fa9131cf96f83f34916a127d8b7d312">NVME_NO_COMPLETE</a>) {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            }</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">if</span> (proc_mask &amp; <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca3bed639d7837a92a297e4df431c7ed9f">NVME_PROC_FULL_ZONES</a>) {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            QTAILQ_FOREACH_SAFE(zone, &amp;n-&gt;full_zones, entry, next) {</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                status = <a class="code" href="zns_8c.html#aa9deb4d27a553448ab81440798d09fb7">zns_bulk_proc_zone</a>(ns, zone, proc_mask, op_hndlr,</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                                             req);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                <span class="keywordflow">if</span> (status &amp;&amp; status != <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a5fa9131cf96f83f34916a127d8b7d312">NVME_NO_COMPLETE</a>) {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                    <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keywordflow">if</span> (proc_mask &amp; <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca03e0191366f1f0b541aed2014625d6d2">NVME_PROC_READ_ONLY_ZONES</a>) {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="keywordflow">for</span> (i = 0; i &lt; n-&gt;<a class="code" href="structFemuCtrl.html#a101d7d739551ef1fafb2df650b9cf155">num_zones</a>; i++, zone++) {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                status = <a class="code" href="zns_8c.html#aa9deb4d27a553448ab81440798d09fb7">zns_bulk_proc_zone</a>(ns, zone, proc_mask, op_hndlr,</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                                             req);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                <span class="keywordflow">if</span> (status &amp;&amp; status != <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a5fa9131cf96f83f34916a127d8b7d312">NVME_NO_COMPLETE</a>) {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                    <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                }</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        }</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;out:</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a48ae04e0f8dcb34ff3803282d5b0ad17_cgraph.png" border="0" usemap="#zns_8c_a48ae04e0f8dcb34ff3803282d5b0ad17_cgraph" alt=""/></div>
<map name="zns_8c_a48ae04e0f8dcb34ff3803282d5b0ad17_cgraph" id="zns_8c_a48ae04e0f8dcb34ff3803282d5b0ad17_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,133,57"/>
<area shape="rect" href="zns_8c.html#aa9deb4d27a553448ab81440798d09fb7" title=" " alt="" coords="181,5,333,32"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="381,31,532,57"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a48ae04e0f8dcb34ff3803282d5b0ad17_icgraph.png" border="0" usemap="#zns_8c_a48ae04e0f8dcb34ff3803282d5b0ad17_icgraph" alt=""/></div>
<map name="zns_8c_a48ae04e0f8dcb34ff3803282d5b0ad17_icgraph" id="zns_8c_a48ae04e0f8dcb34ff3803282d5b0ad17_icgraph">
<area shape="rect" title=" " alt="" coords="1144,5,1272,32"/>
<area shape="rect" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c" title=" " alt="" coords="929,5,1096,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a8910113c66e3bce77dbbdbb560d9aefd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8910113c66e3bce77dbbdbb560d9aefd">&#9670;&nbsp;</a></span>zns_exit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void zns_exit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;{</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">     * Release any extra resource (zones) allocated for ZNS mode</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a8910113c66e3bce77dbbdbb560d9aefd_icgraph.png" border="0" usemap="#zns_8c_a8910113c66e3bce77dbbdbb560d9aefd_icgraph" alt=""/></div>
<map name="zns_8c_a8910113c66e3bce77dbbdbb560d9aefd_icgraph" id="zns_8c_a8910113c66e3bce77dbbdbb560d9aefd_icgraph">
<area shape="rect" title=" " alt="" coords="783,5,859,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a61f038c076c83ca5f99341b71c9b8e10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61f038c076c83ca5f99341b71c9b8e10">&#9670;&nbsp;</a></span>zns_finalize_zoned_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void zns_finalize_zoned_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>failed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;{</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *rw = (<a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *)&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a335e5b18fb079480b1b1a1f06652c647">cmd</a>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="structNvmeZone.html">NvmeZone</a> *zone;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="structNvmeZonedResult.html">NvmeZonedResult</a> *<a class="code" href="structOc12IdAddrFormat.html#a732423af24585adde3b4003bfed623a2">res</a> = (<a class="code" href="structNvmeZonedResult.html">NvmeZonedResult</a> *)&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a8cec02fb87e647c828d06f533aec8758">cqe</a>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    uint64_t slba;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    uint32_t nlb;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    slba = le64_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a0f256de361f51a961d5a44955321b526">slba</a>);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    nlb = le16_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a34ba11f86be8f5d4be5518370faf2514">nlb</a>) + 1;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    zone = <a class="code" href="zns_8c.html#a9674ef207fca784d45d2b13fe63e31f5">zns_get_zone_by_slba</a>(ns, slba);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    zone-&gt;d.wp += nlb;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">if</span> (failed) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <a class="code" href="structOc12IdAddrFormat.html#a732423af24585adde3b4003bfed623a2">res</a>-&gt;slba = 0;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span> (zone-&gt;d.wp == <a class="code" href="zns_8h.html#a1f2a423f30678b841f4aaf3f09d0e7de">zns_zone_wr_boundary</a>(zone)) {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="zns_8h.html#a677294d02c732b61b18d610041851e4b">zns_get_zone_state</a>(zone)) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a044a8bce6652c9e617f784a37f643d38">NVME_ZONE_STATE_IMPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a65105422decdfd6860779463c8964b55">NVME_ZONE_STATE_EXPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <a class="code" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b">zns_aor_dec_open</a>(ns);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <span class="comment">/* fall through */</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>:</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <a class="code" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16">zns_aor_dec_active</a>(ns);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            <span class="comment">/* fall through */</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08">NVME_ZONE_STATE_EMPTY</a>:</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <a class="code" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3">zns_assign_zone_state</a>(ns, zone, <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9afc7fe17858da6497474a2307ab239967">NVME_ZONE_STATE_FULL</a>);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="comment">/* fall through */</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9afc7fe17858da6497474a2307ab239967">NVME_ZONE_STATE_FULL</a>:</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            assert(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a61f038c076c83ca5f99341b71c9b8e10_cgraph.png" border="0" usemap="#zns_8c_a61f038c076c83ca5f99341b71c9b8e10_cgraph" alt=""/></div>
<map name="zns_8c_a61f038c076c83ca5f99341b71c9b8e10_cgraph" id="zns_8c_a61f038c076c83ca5f99341b71c9b8e10_cgraph">
<area shape="rect" title=" " alt="" coords="5,125,149,166"/>
<area shape="rect" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16" title=" " alt="" coords="209,5,359,32"/>
<area shape="rect" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b" title=" " alt="" coords="213,56,355,83"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="199,157,369,184"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="419,107,569,133"/>
<area shape="rect" href="zns_8c.html#a9674ef207fca784d45d2b13fe63e31f5" title=" " alt="" coords="201,208,367,235"/>
<area shape="rect" href="zns_8h.html#a1f2a423f30678b841f4aaf3f09d0e7de" title=" " alt="" coords="197,259,371,285"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="419,157,569,184"/>
<area shape="rect" href="zns_8c.html#a755fef089b9a7fc5ddd4be2d53455955" title=" " alt="" coords="439,208,549,235"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a61f038c076c83ca5f99341b71c9b8e10_icgraph.png" border="0" usemap="#zns_8c_a61f038c076c83ca5f99341b71c9b8e10_icgraph" alt=""/></div>
<map name="zns_8c_a61f038c076c83ca5f99341b71c9b8e10_icgraph" id="zns_8c_a61f038c076c83ca5f99341b71c9b8e10_icgraph">
<area shape="rect" title=" " alt="" coords="1269,23,1413,65"/>
<area shape="rect" href="zns_8c.html#a84203495e6de57d698b7e393f7106984" title=" " alt="" coords="1115,5,1221,32"/>
<area shape="rect" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008" title=" " alt="" coords="956,56,1040,83"/>
<area shape="rect" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338" title=" " alt="" coords="929,5,1067,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,31,881,57"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,31,735,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="ad642783946555e5f78ea1651c02404cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad642783946555e5f78ea1651c02404cb">&#9670;&nbsp;</a></span>zns_finish_zone()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_finish_zone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a>&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;{</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a>) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a65105422decdfd6860779463c8964b55">NVME_ZONE_STATE_EXPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a044a8bce6652c9e617f784a37f643d38">NVME_ZONE_STATE_IMPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <a class="code" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b">zns_aor_dec_open</a>(ns);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>:</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <a class="code" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16">zns_aor_dec_active</a>(ns);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08">NVME_ZONE_STATE_EMPTY</a>:</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        zone-&gt;<a class="code" href="structNvmeZone.html#ad456c9d5b78f51ba486371ab73d7465e">w_ptr</a> = <a class="code" href="zns_8h.html#a1f2a423f30678b841f4aaf3f09d0e7de">zns_zone_wr_boundary</a>(zone);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#ada6f1e571b88b3ef9bcd3a70a69c44d4">wp</a> = zone-&gt;<a class="code" href="structNvmeZone.html#ad456c9d5b78f51ba486371ab73d7465e">w_ptr</a>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <a class="code" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3">zns_assign_zone_state</a>(ns, zone, <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9afc7fe17858da6497474a2307ab239967">NVME_ZONE_STATE_FULL</a>);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9afc7fe17858da6497474a2307ab239967">NVME_ZONE_STATE_FULL</a>:</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4aa17e6457f1ee4cbc398f2da7fcf2fc4f">NVME_ZONE_INVAL_TRANSITION</a>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_ad642783946555e5f78ea1651c02404cb_cgraph.png" border="0" usemap="#zns_8c_ad642783946555e5f78ea1651c02404cb_cgraph" alt=""/></div>
<map name="zns_8c_ad642783946555e5f78ea1651c02404cb_cgraph" id="zns_8c_ad642783946555e5f78ea1651c02404cb_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,129,108"/>
<area shape="rect" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16" title=" " alt="" coords="189,5,339,32"/>
<area shape="rect" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b" title=" " alt="" coords="193,56,335,83"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="179,107,349,133"/>
<area shape="rect" href="zns_8h.html#a1f2a423f30678b841f4aaf3f09d0e7de" title=" " alt="" coords="177,157,351,184"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="399,81,549,108"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="399,132,549,159"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_ad642783946555e5f78ea1651c02404cb_icgraph.png" border="0" usemap="#zns_8c_ad642783946555e5f78ea1651c02404cb_icgraph" alt=""/></div>
<map name="zns_8c_ad642783946555e5f78ea1651c02404cb_icgraph" id="zns_8c_ad642783946555e5f78ea1651c02404cb_icgraph">
<area shape="rect" title=" " alt="" coords="1144,5,1268,32"/>
<area shape="rect" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c" title=" " alt="" coords="929,5,1096,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a6719fe173fec9e6e538ab3f449491bd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6719fe173fec9e6e538ab3f449491bd2">&#9670;&nbsp;</a></span>zns_get_mgmt_zone_slba_idx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_get_mgmt_zone_slba_idx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeCmd.html">NvmeCmd</a> *&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t *&#160;</td>
          <td class="paramname"><em>slba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>zone_idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;{</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <a class="code" href="structNvmeNamespace.html">NvmeNamespace</a> *ns = &amp;n-&gt;<a class="code" href="structFemuCtrl.html#a98ca6ff3bc65ccc7f98a589e018b7d71">namespaces</a>[0];</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    uint32_t dw10 = le32_to_cpu(c-&gt;<a class="code" href="structNvmeCmd.html#ab217950fc2408f7a848af10f36b0cd8f">cdw10</a>);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    uint32_t dw11 = le32_to_cpu(c-&gt;<a class="code" href="structNvmeCmd.html#a542065d60952eff1b4de0fdf3ecb5b29">cdw11</a>);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordflow">if</span> (!n-&gt;<a class="code" href="structFemuCtrl.html#a22f0cfaa256d6bc65497853249789c83">zoned</a>) {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a778b8f53d6725ef86c455e2e55d46ce7">NVME_INVALID_OPCODE</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    *slba = ((uint64_t)dw11) &lt;&lt; 32 | dw10;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a>(*slba &gt;= ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a4a814e395ae6ea7b3b7c5cba1c22ad85">nsze</a>)) {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        *slba = 0;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a43aae0e0a370dd16186369148885344f">NVME_LBA_RANGE</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    *zone_idx = <a class="code" href="zns_8c.html#a755fef089b9a7fc5ddd4be2d53455955">zns_zone_idx</a>(ns, *slba);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    assert(*zone_idx &lt; n-&gt;num_zones);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a6719fe173fec9e6e538ab3f449491bd2_cgraph.png" border="0" usemap="#zns_8c_a6719fe173fec9e6e538ab3f449491bd2_cgraph" alt=""/></div>
<map name="zns_8c_a6719fe173fec9e6e538ab3f449491bd2_cgraph" id="zns_8c_a6719fe173fec9e6e538ab3f449491bd2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,223,32"/>
<area shape="rect" href="zns_8c.html#a755fef089b9a7fc5ddd4be2d53455955" title=" " alt="" coords="271,5,380,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a6719fe173fec9e6e538ab3f449491bd2_icgraph.png" border="0" usemap="#zns_8c_a6719fe173fec9e6e538ab3f449491bd2_icgraph" alt=""/></div>
<map name="zns_8c_a6719fe173fec9e6e538ab3f449491bd2_icgraph" id="zns_8c_a6719fe173fec9e6e538ab3f449491bd2_icgraph">
<area shape="rect" title=" " alt="" coords="1144,31,1361,57"/>
<area shape="rect" href="zns_8c.html#a6e03af0f3d0b7c597d9137a0b18bca56" title=" " alt="" coords="931,5,1094,32"/>
<area shape="rect" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c" title=" " alt="" coords="929,56,1096,83"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,31,881,57"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,31,735,57"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,31,527,57"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,31,284,57"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,31,129,57"/>
</map>
</div>

</div>
</div>
<a id="a9674ef207fca784d45d2b13fe63e31f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9674ef207fca784d45d2b13fe63e31f5">&#9670;&nbsp;</a></span>zns_get_zone_by_slba()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structNvmeZone.html">NvmeZone</a>* zns_get_zone_by_slba </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>slba</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = ns-&gt;<a class="code" href="structNvmeNamespace.html#a8354f38841896795412b089fdfbe1528">ctrl</a>;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    uint32_t zone_idx = <a class="code" href="zns_8c.html#a755fef089b9a7fc5ddd4be2d53455955">zns_zone_idx</a>(ns, slba);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    assert(zone_idx &lt; n-&gt;num_zones);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">return</span> &amp;n-&gt;<a class="code" href="structFemuCtrl.html#aaad2dc59565b90a54c8b118032d67801">zone_array</a>[zone_idx];</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a9674ef207fca784d45d2b13fe63e31f5_cgraph.png" border="0" usemap="#zns_8c_a9674ef207fca784d45d2b13fe63e31f5_cgraph" alt=""/></div>
<map name="zns_8c_a9674ef207fca784d45d2b13fe63e31f5_cgraph" id="zns_8c_a9674ef207fca784d45d2b13fe63e31f5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,172,32"/>
<area shape="rect" href="zns_8c.html#a755fef089b9a7fc5ddd4be2d53455955" title=" " alt="" coords="220,5,329,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a9674ef207fca784d45d2b13fe63e31f5_icgraph.png" border="0" usemap="#zns_8c_a9674ef207fca784d45d2b13fe63e31f5_icgraph" alt=""/></div>
<map name="zns_8c_a9674ef207fca784d45d2b13fe63e31f5_icgraph" id="zns_8c_a9674ef207fca784d45d2b13fe63e31f5_icgraph">
<area shape="rect" title=" " alt="" coords="1480,85,1647,112"/>
<area shape="rect" href="zns_8c.html#a9a270c9ffa0fb88a1c6d57ecfe3e6815" title=" " alt="" coords="1269,5,1432,32"/>
<area shape="rect" href="zns_8c.html#a84203495e6de57d698b7e393f7106984" title=" " alt="" coords="1115,59,1221,85"/>
<area shape="rect" href="zns_8c.html#a61f038c076c83ca5f99341b71c9b8e10" title=" " alt="" coords="1279,107,1423,149"/>
<area shape="rect" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008" title=" " alt="" coords="1126,115,1210,141"/>
<area shape="rect" href="zns_8c.html#a232d1c0fc6117ae692ff092d05f473e6" title=" " alt="" coords="958,7,1038,33"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,59,881,85"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,59,735,85"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,59,527,85"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,59,284,85"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,59,129,85"/>
<area shape="rect" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338" title=" " alt="" coords="929,59,1067,85"/>
</map>
</div>

</div>
</div>
<a id="aa65a4a4ae802bdd6f8cc362247c6325b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa65a4a4ae802bdd6f8cc362247c6325b">&#9670;&nbsp;</a></span>zns_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void zns_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Error **&#160;</td>
          <td class="paramname"><em>errp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;{</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <a class="code" href="structNvmeNamespace.html">NvmeNamespace</a> *ns = &amp;n-&gt;<a class="code" href="structFemuCtrl.html#a98ca6ff3bc65ccc7f98a589e018b7d71">namespaces</a>[0];</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160; </div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <a class="code" href="zns_8c.html#ace4f37fd873afd711375d7c88dc333ff">zns_set_ctrl</a>(n);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <a class="code" href="zns_8c.html#a299230188329a14db7c7542d2764c7ce">zns_init_zone_cap</a>(n);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160; </div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="zns_8c.html#ac4fd6eccdc41d46c3c9ad323e89019d2">zns_init_zone_geometry</a>(ns, errp) != 0) {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    }</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160; </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <a class="code" href="zns_8c.html#a54625ca641142f536befa8182db6164e">zns_init_zone_identify</a>(n, ns, 0);</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_aa65a4a4ae802bdd6f8cc362247c6325b_cgraph.png" border="0" usemap="#zns_8c_aa65a4a4ae802bdd6f8cc362247c6325b_cgraph" alt=""/></div>
<map name="zns_8c_aa65a4a4ae802bdd6f8cc362247c6325b_cgraph" id="zns_8c_aa65a4a4ae802bdd6f8cc362247c6325b_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,77,108"/>
<area shape="rect" href="zns_8c.html#a299230188329a14db7c7542d2764c7ce" title=" " alt="" coords="145,5,285,32"/>
<area shape="rect" href="zns_8c.html#ac4fd6eccdc41d46c3c9ad323e89019d2" title=" " alt="" coords="125,56,305,83"/>
<area shape="rect" href="zns_8c.html#a54625ca641142f536befa8182db6164e" title=" " alt="" coords="132,107,299,133"/>
<area shape="rect" href="zns_8c.html#ace4f37fd873afd711375d7c88dc333ff" title=" " alt="" coords="166,157,265,184"/>
<area shape="rect" href="zns_8h.html#a63a81710dc2a7e2e61f2b7ace02a538a" title=" " alt="" coords="379,56,487,83"/>
<area shape="rect" href="zns_8h.html#a04721281dcdb77acc610b362cb5085ad" title=" " alt="" coords="590,56,689,83"/>
<area shape="rect" href="zns_8c.html#a12ca668cf37e73d231f247d41d5990f9" title=" " alt="" coords="353,107,512,133"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="565,107,714,133"/>
<area shape="rect" href="zns_8c.html#a05f7689d91910e1a2f865b30a9bc5393" title=" " alt="" coords="371,157,494,184"/>
<area shape="rect" href="nvme-util_8c.html#a9e84e8328646dcb1f24be9c79018e6a0" title=" " alt="" coords="560,157,719,184"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_aa65a4a4ae802bdd6f8cc362247c6325b_icgraph.png" border="0" usemap="#zns_8c_aa65a4a4ae802bdd6f8cc362247c6325b_icgraph" alt=""/></div>
<map name="zns_8c_aa65a4a4ae802bdd6f8cc362247c6325b_icgraph" id="zns_8c_aa65a4a4ae802bdd6f8cc362247c6325b_icgraph">
<area shape="rect" title=" " alt="" coords="783,5,855,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a299230188329a14db7c7542d2764c7ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a299230188329a14db7c7542d2764c7ce">&#9670;&nbsp;</a></span>zns_init_zone_cap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int zns_init_zone_cap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;{</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#a22f0cfaa256d6bc65497853249789c83">zoned</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#ac6e80e0bc39d8878bee79720f0733909">zasl_bs</a> = <a class="code" href="zns_8c.html#a06c9f096d365e730b91eb297bf71961e">NVME_DEFAULT_MAX_AZ_SIZE</a>;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#abb0af9e86a49398d043a81869f2c89da">zone_size_bs</a> = <a class="code" href="zns_8c.html#af08b9977a8c3f36290e243506b5222d6">NVME_DEFAULT_ZONE_SIZE</a>;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#ac3284df15757fa3c9e773199fa426d51">zone_cap_bs</a> = 0;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#aa7cfd4a7ec5ef933c85eeee459b97a7d">cross_zone_read</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#af7aabe80b46d1d28417b5f757b25f8d7">max_active_zones</a> = 0;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#ade2c007bdb0d6d63de0b2ef92eba5339">max_open_zones</a> = 0;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#ac31c5055e8db3e4124d1bceb15d16f6b">zd_extension_size</a> = 0;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a299230188329a14db7c7542d2764c7ce_icgraph.png" border="0" usemap="#zns_8c_a299230188329a14db7c7542d2764c7ce_icgraph" alt=""/></div>
<map name="zns_8c_a299230188329a14db7c7542d2764c7ce_icgraph" id="zns_8c_a299230188329a14db7c7542d2764c7ce_icgraph">
<area shape="rect" title=" " alt="" coords="903,5,1043,32"/>
<area shape="rect" href="zns_8c.html#aa65a4a4ae802bdd6f8cc362247c6325b" title=" " alt="" coords="783,5,855,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ac4fd6eccdc41d46c3c9ad323e89019d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4fd6eccdc41d46c3c9ad323e89019d2">&#9670;&nbsp;</a></span>zns_init_zone_geometry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int zns_init_zone_geometry </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Error **&#160;</td>
          <td class="paramname"><em>errp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = ns-&gt;<a class="code" href="structNvmeNamespace.html#a8354f38841896795412b089fdfbe1528">ctrl</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    uint64_t zone_size, zone_cap;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    uint32_t lbasz = 1 &lt;&lt; <a class="code" href="zns_8h.html#a63a81710dc2a7e2e61f2b7ace02a538a">zns_ns_lbads</a>(ns);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#abb0af9e86a49398d043a81869f2c89da">zone_size_bs</a>) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        zone_size = n-&gt;<a class="code" href="structFemuCtrl.html#abb0af9e86a49398d043a81869f2c89da">zone_size_bs</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        zone_size = <a class="code" href="zns_8c.html#af08b9977a8c3f36290e243506b5222d6">NVME_DEFAULT_ZONE_SIZE</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#ac3284df15757fa3c9e773199fa426d51">zone_cap_bs</a>) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        zone_cap = n-&gt;<a class="code" href="structFemuCtrl.html#ac3284df15757fa3c9e773199fa426d51">zone_cap_bs</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        zone_cap = zone_size;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span> (zone_cap &gt; zone_size) {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;zone capacity %luB &gt; zone size %luB&quot;</span>, zone_cap, zone_size);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">if</span> (zone_size &lt; lbasz) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;zone size %luB too small, must &gt;= %uB&quot;</span>, zone_size, lbasz);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keywordflow">if</span> (zone_cap &lt; lbasz) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;zone capacity %luB too small, must &gt;= %uB&quot;</span>, zone_cap, lbasz);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#adaa9832711cd5744244c2cd80e0b027c">zone_size</a> = zone_size / lbasz;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#aacb80a44168a3ad90772b9e623dfed94">zone_capacity</a> = zone_cap / lbasz;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#a101d7d739551ef1fafb2df650b9cf155">num_zones</a> = ns-&gt;<a class="code" href="structNvmeNamespace.html#a1868691a915c0a0cc8eeef08fe969f51">size</a> / lbasz / n-&gt;<a class="code" href="structFemuCtrl.html#adaa9832711cd5744244c2cd80e0b027c">zone_size</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#ade2c007bdb0d6d63de0b2ef92eba5339">max_open_zones</a> &gt; n-&gt;<a class="code" href="structFemuCtrl.html#a101d7d739551ef1fafb2df650b9cf155">num_zones</a>) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;max_open_zones value %u exceeds the number of zones %u&quot;</span>,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                 n-&gt;<a class="code" href="structFemuCtrl.html#ade2c007bdb0d6d63de0b2ef92eba5339">max_open_zones</a>, n-&gt;<a class="code" href="structFemuCtrl.html#a101d7d739551ef1fafb2df650b9cf155">num_zones</a>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#af7aabe80b46d1d28417b5f757b25f8d7">max_active_zones</a> &gt; n-&gt;<a class="code" href="structFemuCtrl.html#a101d7d739551ef1fafb2df650b9cf155">num_zones</a>) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;max_active_zones value %u exceeds the number of zones %u&quot;</span>,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                 n-&gt;<a class="code" href="structFemuCtrl.html#af7aabe80b46d1d28417b5f757b25f8d7">max_active_zones</a>, n-&gt;<a class="code" href="structFemuCtrl.html#a101d7d739551ef1fafb2df650b9cf155">num_zones</a>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#ac31c5055e8db3e4124d1bceb15d16f6b">zd_extension_size</a>) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#ac31c5055e8db3e4124d1bceb15d16f6b">zd_extension_size</a> &amp; 0x3f) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;zone descriptor extension size must be multiples of 64B&quot;</span>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">if</span> ((n-&gt;<a class="code" href="structFemuCtrl.html#ac31c5055e8db3e4124d1bceb15d16f6b">zd_extension_size</a> &gt;&gt; 6) &gt; 0xff) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;zone descriptor extension size is too large&quot;</span>);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_ac4fd6eccdc41d46c3c9ad323e89019d2_cgraph.png" border="0" usemap="#zns_8c_ac4fd6eccdc41d46c3c9ad323e89019d2_cgraph" alt=""/></div>
<map name="zns_8c_ac4fd6eccdc41d46c3c9ad323e89019d2_cgraph" id="zns_8c_ac4fd6eccdc41d46c3c9ad323e89019d2_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,185,32"/>
<area shape="rect" href="zns_8h.html#a63a81710dc2a7e2e61f2b7ace02a538a" title=" " alt="" coords="233,5,341,32"/>
<area shape="rect" href="zns_8h.html#a04721281dcdb77acc610b362cb5085ad" title=" " alt="" coords="389,5,488,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_ac4fd6eccdc41d46c3c9ad323e89019d2_icgraph.png" border="0" usemap="#zns_8c_ac4fd6eccdc41d46c3c9ad323e89019d2_icgraph" alt=""/></div>
<map name="zns_8c_ac4fd6eccdc41d46c3c9ad323e89019d2_icgraph" id="zns_8c_ac4fd6eccdc41d46c3c9ad323e89019d2_icgraph">
<area shape="rect" title=" " alt="" coords="903,5,1083,32"/>
<area shape="rect" href="zns_8c.html#aa65a4a4ae802bdd6f8cc362247c6325b" title=" " alt="" coords="783,5,855,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a54625ca641142f536befa8182db6164e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54625ca641142f536befa8182db6164e">&#9670;&nbsp;</a></span>zns_init_zone_identify()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void zns_init_zone_identify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lba_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;{</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="structNvmeIdNsZoned.html">NvmeIdNsZoned</a> *id_ns_z;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="zns_8c.html#a12ca668cf37e73d231f247d41d5990f9">zns_init_zoned_state</a>(ns);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    id_ns_z = g_malloc0(<span class="keyword">sizeof</span>(<a class="code" href="structNvmeIdNsZoned.html">NvmeIdNsZoned</a>));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">/* MAR/MOR are zeroes-based, 0xffffffff means no limit */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    id_ns_z-&gt;<a class="code" href="structNvmeIdNsZoned.html#a500b54d39a4323d0b3b0445d3b0158ec">mar</a> = cpu_to_le32(n-&gt;<a class="code" href="structFemuCtrl.html#af7aabe80b46d1d28417b5f757b25f8d7">max_active_zones</a> - 1);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    id_ns_z-&gt;<a class="code" href="structNvmeIdNsZoned.html#ae3a418cba7dee27d904fc063b6312524">mor</a> = cpu_to_le32(n-&gt;<a class="code" href="structFemuCtrl.html#ade2c007bdb0d6d63de0b2ef92eba5339">max_open_zones</a> - 1);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    id_ns_z-&gt;<a class="code" href="structNvmeIdNsZoned.html#a9e353280dd471a8ea6cb2c96ff6018e8">zoc</a> = 0;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    id_ns_z-&gt;<a class="code" href="structNvmeIdNsZoned.html#ae5cc4700899bf362fa57a6ee56913bf9">ozcs</a> = n-&gt;<a class="code" href="structFemuCtrl.html#aa7cfd4a7ec5ef933c85eeee459b97a7d">cross_zone_read</a> ? 0x01 : 0x00;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    id_ns_z-&gt;<a class="code" href="structNvmeIdNsZoned.html#a939eab059a9bb921f2c63b5f426ca700">lbafe</a>[lba_index].<a class="code" href="structNvmeLBAFE.html#aa8a5633997607babbd25a84cc3ab2495">zsze</a> = cpu_to_le64(n-&gt;<a class="code" href="structFemuCtrl.html#adaa9832711cd5744244c2cd80e0b027c">zone_size</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    id_ns_z-&gt;<a class="code" href="structNvmeIdNsZoned.html#a939eab059a9bb921f2c63b5f426ca700">lbafe</a>[lba_index].<a class="code" href="structNvmeLBAFE.html#ad42d0fa49eccc65d5e9510de7dd38c53">zdes</a> = n-&gt;<a class="code" href="structFemuCtrl.html#ac31c5055e8db3e4124d1bceb15d16f6b">zd_extension_size</a> &gt;&gt; 6; <span class="comment">/* Units of 64B */</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#a0b48d3c6cc09b094369348af59a3b096">csi</a> = <a class="code" href="nvme_8h.html#a2342f477442526e6bc2aa046f9bd4a94a64b23085931f2a85c7105d303bb4a495">NVME_CSI_ZONED</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a4a814e395ae6ea7b3b7c5cba1c22ad85">nsze</a> = cpu_to_le64(n-&gt;<a class="code" href="structFemuCtrl.html#a101d7d739551ef1fafb2df650b9cf155">num_zones</a> * n-&gt;<a class="code" href="structFemuCtrl.html#adaa9832711cd5744244c2cd80e0b027c">zone_size</a>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a0588b7533fd0a4d1d56fd12b8fb7502d">ncap</a> = ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a4a814e395ae6ea7b3b7c5cba1c22ad85">nsze</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#ad67c077eb81ad2014ec2d9217c2c537d">nuse</a> = ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a0588b7533fd0a4d1d56fd12b8fb7502d">ncap</a>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">/* NvmeIdNs */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">     * The device uses the BDRV_BLOCK_ZERO flag to determine the &quot;deallocated&quot;</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">     * status of logical blocks. Since the spec defines that logical blocks</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">     * SHALL be deallocated when then zone is in the Empty or Offline states,</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">     * we can only support DULBE if the zone size is a multiple of the</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">     * calculated NPDG.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#adaa9832711cd5744244c2cd80e0b027c">zone_size</a> % (ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a253f93bc4614efc3b4c21732ea40d36f">npdg</a> + 1)) {</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;the zone size (%&quot;</span>PRIu64<span class="stringliteral">&quot; blocks) is not a multiple of the&quot;</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                 <span class="stringliteral">&quot;calculated deallocation granularity (%&quot;</span>PRIu16<span class="stringliteral">&quot; blocks); DULBE&quot;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                 <span class="stringliteral">&quot;support disabled&quot;</span>, n-&gt;<a class="code" href="structFemuCtrl.html#adaa9832711cd5744244c2cd80e0b027c">zone_size</a>, ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a253f93bc4614efc3b4c21732ea40d36f">npdg</a> + 1);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        ns-&gt;<a class="code" href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">id_ns</a>.<a class="code" href="structNvmeIdNs.html#a37d82bc83c29f8eb8040f48a5262980c">nsfeat</a> &amp;= ~0x4;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#aeaa1d7586c6d9356cc321cc86b7ebb62">id_ns_zoned</a> = id_ns_z;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a54625ca641142f536befa8182db6164e_cgraph.png" border="0" usemap="#zns_8c_a54625ca641142f536befa8182db6164e_cgraph" alt=""/></div>
<map name="zns_8c_a54625ca641142f536befa8182db6164e_cgraph" id="zns_8c_a54625ca641142f536befa8182db6164e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,172,32"/>
<area shape="rect" href="zns_8c.html#a12ca668cf37e73d231f247d41d5990f9" title=" " alt="" coords="220,5,379,32"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="427,5,576,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a54625ca641142f536befa8182db6164e_icgraph.png" border="0" usemap="#zns_8c_a54625ca641142f536befa8182db6164e_icgraph" alt=""/></div>
<map name="zns_8c_a54625ca641142f536befa8182db6164e_icgraph" id="zns_8c_a54625ca641142f536befa8182db6164e_icgraph">
<area shape="rect" title=" " alt="" coords="903,5,1069,32"/>
<area shape="rect" href="zns_8c.html#aa65a4a4ae802bdd6f8cc362247c6325b" title=" " alt="" coords="783,5,855,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a12ca668cf37e73d231f247d41d5990f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12ca668cf37e73d231f247d41d5990f9">&#9670;&nbsp;</a></span>zns_init_zoned_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void zns_init_zoned_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = ns-&gt;<a class="code" href="structNvmeNamespace.html#a8354f38841896795412b089fdfbe1528">ctrl</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    uint64_t start = 0, zone_size = n-&gt;<a class="code" href="structFemuCtrl.html#adaa9832711cd5744244c2cd80e0b027c">zone_size</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    uint64_t capacity = n-&gt;<a class="code" href="structFemuCtrl.html#a101d7d739551ef1fafb2df650b9cf155">num_zones</a> * zone_size;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="structNvmeZone.html">NvmeZone</a> *zone;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#aaad2dc59565b90a54c8b118032d67801">zone_array</a> = g_new0(<a class="code" href="structNvmeZone.html">NvmeZone</a>, n-&gt;<a class="code" href="structFemuCtrl.html#a101d7d739551ef1fafb2df650b9cf155">num_zones</a>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#ac31c5055e8db3e4124d1bceb15d16f6b">zd_extension_size</a>) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        n-&gt;<a class="code" href="structFemuCtrl.html#aad9ab3272256c2c2a4dea360e3392032">zd_extensions</a> = g_malloc0(n-&gt;<a class="code" href="structFemuCtrl.html#ac31c5055e8db3e4124d1bceb15d16f6b">zd_extension_size</a> * n-&gt;<a class="code" href="structFemuCtrl.html#a101d7d739551ef1fafb2df650b9cf155">num_zones</a>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    QTAILQ_INIT(&amp;n-&gt;exp_open_zones);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    QTAILQ_INIT(&amp;n-&gt;imp_open_zones);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    QTAILQ_INIT(&amp;n-&gt;closed_zones);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    QTAILQ_INIT(&amp;n-&gt;full_zones);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    zone = n-&gt;<a class="code" href="structFemuCtrl.html#aaad2dc59565b90a54c8b118032d67801">zone_array</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; n-&gt;<a class="code" href="structFemuCtrl.html#a101d7d739551ef1fafb2df650b9cf155">num_zones</a>; i++, zone++) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">if</span> (start + zone_size &gt; capacity) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            zone_size = capacity - start;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#a068bbc643247a8243a5c8aaaa7e9380b">zt</a> = <a class="code" href="zns_8h.html#a71c2dafc519a9ac21e152ff2167ac42ca493593fedcfbf64c0571f0b8cb4cc603">NVME_ZONE_TYPE_SEQ_WRITE</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="zns_8h.html#afdc856385776185b67188b43c7569469">zns_set_zone_state</a>(zone, <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08">NVME_ZONE_STATE_EMPTY</a>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#aad408ac3045c84d106809b7a2b684afd">za</a> = 0;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#a5360d246a3f047192480695171e0d37f">zcap</a> = n-&gt;<a class="code" href="structFemuCtrl.html#aacb80a44168a3ad90772b9e623dfed94">zone_capacity</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#a626c7b988cfde334d69cae1ff7a9fe2c">zslba</a> = start;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#ada6f1e571b88b3ef9bcd3a70a69c44d4">wp</a> = start;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        zone-&gt;<a class="code" href="structNvmeZone.html#ad456c9d5b78f51ba486371ab73d7465e">w_ptr</a> = start;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        start += zone_size;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    n-&gt;<a class="code" href="structFemuCtrl.html#afdc1d22ac9fbea382272a39bfdd52db7">zone_size_log2</a> = 0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">if</span> (is_power_of_2(n-&gt;<a class="code" href="structFemuCtrl.html#adaa9832711cd5744244c2cd80e0b027c">zone_size</a>)) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        n-&gt;<a class="code" href="structFemuCtrl.html#afdc1d22ac9fbea382272a39bfdd52db7">zone_size_log2</a> = 63 - clz64(n-&gt;<a class="code" href="structFemuCtrl.html#adaa9832711cd5744244c2cd80e0b027c">zone_size</a>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a12ca668cf37e73d231f247d41d5990f9_cgraph.png" border="0" usemap="#zns_8c_a12ca668cf37e73d231f247d41d5990f9_cgraph" alt=""/></div>
<map name="zns_8c_a12ca668cf37e73d231f247d41d5990f9_cgraph" id="zns_8c_a12ca668cf37e73d231f247d41d5990f9_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,164,32"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="212,5,361,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a12ca668cf37e73d231f247d41d5990f9_icgraph.png" border="0" usemap="#zns_8c_a12ca668cf37e73d231f247d41d5990f9_icgraph" alt=""/></div>
<map name="zns_8c_a12ca668cf37e73d231f247d41d5990f9_icgraph" id="zns_8c_a12ca668cf37e73d231f247d41d5990f9_icgraph">
<area shape="rect" title=" " alt="" coords="1117,5,1276,32"/>
<area shape="rect" href="zns_8c.html#a54625ca641142f536befa8182db6164e" title=" " alt="" coords="903,5,1069,32"/>
<area shape="rect" href="zns_8c.html#aa65a4a4ae802bdd6f8cc362247c6325b" title=" " alt="" coords="783,5,855,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ab23b42610e0276e68ccaac4d13e18bfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab23b42610e0276e68ccaac4d13e18bfa">&#9670;&nbsp;</a></span>zns_io_cmd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_io_cmd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeCmd.html">NvmeCmd</a> *&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;{</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">switch</span> (cmd-&gt;<a class="code" href="structNvmeCmd.html#a2751bc2a772082d3af81124a1d120a0c">opcode</a>) {</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a13421e16e166f06ef616c86258232336">NVME_CMD_READ</a>:</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="zns_8c.html#a232d1c0fc6117ae692ff092d05f473e6">zns_read</a>(n, ns, cmd, req);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6af12c69a9bdf0ad418e4a144ef5424336">NVME_CMD_WRITE</a>:</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008">zns_write</a>(n, ns, cmd, req);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a9c323c2099e3f3da156bb6896b824724">NVME_CMD_ZONE_MGMT_SEND</a>:</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c">zns_zone_mgmt_send</a>(n, req);</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6aa4fe58ce24eda3bf7e1e5e3c22470b30">NVME_CMD_ZONE_MGMT_RECV</a>:</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="zns_8c.html#a6e03af0f3d0b7c597d9137a0b18bca56">zns_zone_mgmt_recv</a>(n, req);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6af03a6460a154989e7816c9518c281422">NVME_CMD_ZONE_APPEND</a>:</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338">zns_zone_append</a>(n, req);</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    }</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a778b8f53d6725ef86c455e2e55d46ce7">NVME_INVALID_OPCODE</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_ab23b42610e0276e68ccaac4d13e18bfa_cgraph.png" border="0" usemap="#zns_8c_ab23b42610e0276e68ccaac4d13e18bfa_cgraph" alt=""/></div>
<map name="zns_8c_ab23b42610e0276e68ccaac4d13e18bfa_cgraph" id="zns_8c_ab23b42610e0276e68ccaac4d13e18bfa_cgraph">
<area shape="rect" title=" " alt="" coords="5,601,104,628"/>
<area shape="rect" href="zns_8c.html#a232d1c0fc6117ae692ff092d05f473e6" title=" " alt="" coords="381,284,461,311"/>
<area shape="rect" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008" title=" " alt="" coords="379,512,463,539"/>
<area shape="rect" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338" title=" " alt="" coords="152,601,289,628"/>
<area shape="rect" href="zns_8c.html#a6e03af0f3d0b7c597d9137a0b18bca56" title=" " alt="" coords="339,867,502,893"/>
<area shape="rect" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c" title=" " alt="" coords="337,1272,504,1299"/>
<area shape="rect" href="dram_8c.html#a1ccbcf0c92b7b084afc9890f3a7e5799" title=" " alt="" coords="611,309,710,336"/>
<area shape="rect" href="nvme_8h.html#ae412c484b40ac7903597a299757a7a83" title=" " alt="" coords="589,664,733,691"/>
<area shape="rect" href="zns_8c.html#ae9ed91ad4901fe7f2cd4f9df6c333901" title=" " alt="" coords="589,259,732,285"/>
<area shape="rect" href="zns_8c.html#a52ee538a6713c7b29769f23b61dad575" title=" " alt="" coords="595,5,727,32"/>
<area shape="rect" href="zns_8c.html#a9a270c9ffa0fb88a1c6d57ecfe3e6815" title=" " alt="" coords="829,56,992,83"/>
<area shape="rect" href="zns_8h.html#a686c1e6209d4c3eaf3897e73484bdf9f" title=" " alt="" coords="875,411,946,437"/>
<area shape="rect" href="zns_8c.html#ab56987b404fc29d662252ee6f15e9012" title=" " alt="" coords="604,613,717,640"/>
<area shape="rect" href="zns_8c.html#a3357eef3f827fdab1d88e5c95ae3c386" title=" " alt="" coords="1060,201,1227,242"/>
<area shape="rect" href="zns_8c.html#a9674ef207fca784d45d2b13fe63e31f5" title=" " alt="" coords="1060,360,1227,387"/>
<area shape="rect" href="zns_8h.html#aa03c395f4bba42d5fc5b8ef247b082ae" title=" " alt="" coords="1058,56,1229,83"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="1283,917,1433,944"/>
<area shape="rect" href="zns_8c.html#a755fef089b9a7fc5ddd4be2d53455955" title=" " alt="" coords="1303,449,1413,476"/>
<area shape="rect" href="zns_8h.html#a63a81710dc2a7e2e61f2b7ace02a538a" title=" " alt="" coords="1089,453,1197,480"/>
<area shape="rect" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493" title=" " alt="" coords="849,1019,972,1045"/>
<area shape="rect" href="zns_8c.html#a94c5876f1b68a759a109b78003852924" title=" " alt="" coords="825,800,996,827"/>
<area shape="rect" href="zns_8c.html#ad5f4088354d2555f9d66e2ba441592ff" title=" " alt="" coords="582,867,739,893"/>
<area shape="rect" href="zns_8c.html#a5fa5b88257a067bda683c7f981b39524" title=" " alt="" coords="577,461,744,488"/>
<area shape="rect" href="zns_8c.html#a61f038c076c83ca5f99341b71c9b8e10" title=" " alt="" coords="839,851,983,893"/>
<area shape="rect" href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c" title=" " alt="" coords="1071,1019,1216,1045"/>
<area shape="rect" href="zns_8h.html#a456d13e8923adbff0acc0ab45e47ec8f" title=" " alt="" coords="1075,917,1212,944"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="1058,1221,1229,1248"/>
<area shape="rect" href="zns_8h.html#a1f2a423f30678b841f4aaf3f09d0e7de" title=" " alt="" coords="1057,816,1230,843"/>
<area shape="rect" href="zns_8c.html#a2bd0e00434954d61e13cfe8a65a02e34" title=" " alt="" coords="1085,1069,1202,1096"/>
<area shape="rect" href="zns_8c.html#a02ec33ad0c6f39ad701ac9ea780811c4" title=" " alt="" coords="817,1272,1004,1299"/>
<area shape="rect" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b" title=" " alt="" coords="1073,1272,1214,1299"/>
<area shape="rect" href="zns_8c.html#a841382c8c3024053a641811800230a23" title=" " alt="" coords="1060,590,1227,631"/>
<area shape="rect" href="zns_8h.html#ad064d2d81e65c1f8d539bafbee8cf353" title=" " alt="" coords="847,597,974,624"/>
<area shape="rect" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16" title=" " alt="" coords="1069,1171,1218,1197"/>
<area shape="rect" href="zns_8c.html#a84203495e6de57d698b7e393f7106984" title=" " alt="" coords="367,601,474,628"/>
<area shape="rect" href="dma_8c.html#a83e01cb3ebf3721ca1fd024940ed6aa6" title=" " alt="" coords="603,1069,718,1096"/>
<area shape="rect" href="zns_8c.html#a6719fe173fec9e6e538ab3f449491bd2" title=" " alt="" coords="552,1019,769,1045"/>
<area shape="rect" href="zns_8h.html#af2c9d24f2afaea78ba6081a0cbb5c6cf" title=" " alt="" coords="578,1120,743,1147"/>
<area shape="rect" href="zns_8h.html#a0b9c3e6b619d9dca6883a7fe3cb4daa9" title=" " alt="" coords="857,537,965,564"/>
<area shape="rect" href="zns_8c.html#a81321b3c5f8d3e0069c181e2dfa4f452" title=" " alt="" coords="1052,968,1235,995"/>
<area shape="rect" href="dma_8c.html#adef0f21bc237d992b4ae8b29258645a8" title=" " alt="" coords="601,1171,720,1197"/>
<area shape="rect" href="zns_8c.html#af29e49b46b70e9dc142f1bb3bf7e65da" title=" " alt="" coords="849,1323,972,1349"/>
<area shape="rect" href="zns_8c.html#a48ae04e0f8dcb34ff3803282d5b0ad17" title=" " alt="" coords="847,1424,975,1451"/>
<area shape="rect" href="zns_8c.html#ad642783946555e5f78ea1651c02404cb" title=" " alt="" coords="849,1171,973,1197"/>
<area shape="rect" href="zns_8c.html#a21f29cc79d1f772a1244c0f512171c0a" title=" " alt="" coords="595,1373,726,1400"/>
<area shape="rect" href="zns_8c.html#aea339e52add6067aeb466ab8b0f56a1d" title=" " alt="" coords="850,1069,971,1096"/>
<area shape="rect" href="zns_8c.html#a7c7e09c6f357c1f77c724c664f6c0128" title=" " alt="" coords="599,1475,722,1501"/>
<area shape="rect" href="zns_8c.html#a52eacdcbc504ab2769e6b194295e2355" title=" " alt="" coords="850,1120,971,1147"/>
<area shape="rect" href="zns_8c.html#aa9deb4d27a553448ab81440798d09fb7" title=" " alt="" coords="1067,1373,1219,1400"/>
<area shape="rect" href="zns_8c.html#a7cf84991a322dded9376491f5d98dedb" title=" " alt="" coords="825,1373,996,1400"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_ab23b42610e0276e68ccaac4d13e18bfa_icgraph.png" border="0" usemap="#zns_8c_ab23b42610e0276e68ccaac4d13e18bfa_icgraph" alt=""/></div>
<map name="zns_8c_ab23b42610e0276e68ccaac4d13e18bfa_icgraph" id="zns_8c_ab23b42610e0276e68ccaac4d13e18bfa_icgraph">
<area shape="rect" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ab56987b404fc29d662252ee6f15e9012"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab56987b404fc29d662252ee6f15e9012">&#9670;&nbsp;</a></span>zns_map_dptr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_map_dptr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;{</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    uint64_t prp1, prp2;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keywordflow">switch</span> (req-&gt;<a class="code" href="structNvmeRequest.html#a335e5b18fb079480b1b1a1f06652c647">cmd</a>.<a class="code" href="structNvmeCmd.html#a520cb16bdabbb80e149a2696357ae01c">psdt</a>) {</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="nvme_8h.html#a11cbb7fe027f15d75255035b8993bd4ea0493c6b9a42545699964aba6dc94d342">NVME_PSDT_PRP</a>:</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        prp1 = le64_to_cpu(req-&gt;<a class="code" href="structNvmeRequest.html#a335e5b18fb079480b1b1a1f06652c647">cmd</a>.<a class="code" href="structNvmeCmd.html#a3b34c627a05e2a86edf1a93567422c8c">dptr</a>.<a class="code" href="unionNvmeCmdDptr.html#aaad95622d868c580eadba6c852bf961d">prp1</a>);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        prp2 = le64_to_cpu(req-&gt;<a class="code" href="structNvmeRequest.html#a335e5b18fb079480b1b1a1f06652c647">cmd</a>.<a class="code" href="structNvmeCmd.html#a3b34c627a05e2a86edf1a93567422c8c">dptr</a>.<a class="code" href="unionNvmeCmdDptr.html#a9fc9a97c707652c679097b32ffd84bc3">prp2</a>);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493">nvme_map_prp</a>(&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a678064f3bc45fbeb366ea44aea7273b2">qsg</a>, &amp;req-&gt;<a class="code" href="structNvmeRequest.html#a22a0c24be595ec2abed21073be01efd9">iov</a>, prp1, prp2, len, n);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a>;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    }</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_ab56987b404fc29d662252ee6f15e9012_cgraph.png" border="0" usemap="#zns_8c_ab56987b404fc29d662252ee6f15e9012_cgraph" alt=""/></div>
<map name="zns_8c_ab56987b404fc29d662252ee6f15e9012_cgraph" id="zns_8c_ab56987b404fc29d662252ee6f15e9012_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,119,32"/>
<area shape="rect" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493" title=" " alt="" coords="167,5,289,32"/>
<area shape="rect" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484" title=" " alt="" coords="337,5,468,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_ab56987b404fc29d662252ee6f15e9012_icgraph.png" border="0" usemap="#zns_8c_ab56987b404fc29d662252ee6f15e9012_icgraph" alt=""/></div>
<map name="zns_8c_ab56987b404fc29d662252ee6f15e9012_icgraph" id="zns_8c_ab56987b404fc29d662252ee6f15e9012_icgraph">
<area shape="rect" title=" " alt="" coords="1269,56,1383,83"/>
<area shape="rect" href="zns_8c.html#a84203495e6de57d698b7e393f7106984" title=" " alt="" coords="1115,5,1221,32"/>
<area shape="rect" href="zns_8c.html#a232d1c0fc6117ae692ff092d05f473e6" title=" " alt="" coords="958,56,1038,83"/>
<area shape="rect" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008" title=" " alt="" coords="1126,107,1210,133"/>
<area shape="rect" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338" title=" " alt="" coords="929,5,1067,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,56,881,83"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,56,735,83"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,56,527,83"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,56,284,83"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,56,129,83"/>
</map>
</div>

</div>
</div>
<a id="a0aeaacfe11cad1ce307443e1a420ec4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0aeaacfe11cad1ce307443e1a420ec4a">&#9670;&nbsp;</a></span>zns_ns_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zns_ns_cleanup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;{</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = ns-&gt;<a class="code" href="structNvmeNamespace.html#a8354f38841896795412b089fdfbe1528">ctrl</a>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#a22f0cfaa256d6bc65497853249789c83">zoned</a>) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        g_free(n-&gt;<a class="code" href="structFemuCtrl.html#aeaa1d7586c6d9356cc321cc86b7ebb62">id_ns_zoned</a>);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        g_free(n-&gt;<a class="code" href="structFemuCtrl.html#aaad2dc59565b90a54c8b118032d67801">zone_array</a>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        g_free(n-&gt;<a class="code" href="structFemuCtrl.html#aad9ab3272256c2c2a4dea360e3392032">zd_extensions</a>);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a23ed6cd90a43d43bad4b9196673fd1bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23ed6cd90a43d43bad4b9196673fd1bf">&#9670;&nbsp;</a></span>zns_ns_shutdown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zns_ns_shutdown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;{</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = ns-&gt;<a class="code" href="structNvmeNamespace.html#a8354f38841896795412b089fdfbe1528">ctrl</a>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#a22f0cfaa256d6bc65497853249789c83">zoned</a>) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="zns_8c.html#a5a340f34f865c916bb163abd16dc637f">zns_zoned_ns_shutdown</a>(ns);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a23ed6cd90a43d43bad4b9196673fd1bf_cgraph.png" border="0" usemap="#zns_8c_a23ed6cd90a43d43bad4b9196673fd1bf_cgraph" alt=""/></div>
<map name="zns_8c_a23ed6cd90a43d43bad4b9196673fd1bf_cgraph" id="zns_8c_a23ed6cd90a43d43bad4b9196673fd1bf_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,141,83"/>
<area shape="rect" href="zns_8c.html#a5a340f34f865c916bb163abd16dc637f" title=" " alt="" coords="189,56,372,83"/>
<area shape="rect" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16" title=" " alt="" coords="420,5,569,32"/>
<area shape="rect" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b" title=" " alt="" coords="424,56,565,83"/>
<area shape="rect" href="zns_8c.html#a8f09f2d274ee382c164ad442bb4f3e47" title=" " alt="" coords="434,107,555,133"/>
<area shape="rect" href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c" title=" " alt="" coords="620,56,765,83"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="617,107,768,133"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="618,157,767,184"/>
</map>
</div>

</div>
</div>
<a id="a21f29cc79d1f772a1244c0f512171c0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21f29cc79d1f772a1244c0f512171c0a">&#9670;&nbsp;</a></span>zns_offline_zone()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_offline_zone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a>&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;{</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a>) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a9f9310a3aab3b20b1dc6ea8a2b658add">NVME_ZONE_STATE_READ_ONLY</a>:</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <a class="code" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3">zns_assign_zone_state</a>(ns, zone, <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a5a871630ac0aaff6794aaed5587d7fd3">NVME_ZONE_STATE_OFFLINE</a>);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a5a871630ac0aaff6794aaed5587d7fd3">NVME_ZONE_STATE_OFFLINE</a>:</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4aa17e6457f1ee4cbc398f2da7fcf2fc4f">NVME_ZONE_INVAL_TRANSITION</a>;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a21f29cc79d1f772a1244c0f512171c0a_cgraph.png" border="0" usemap="#zns_8c_a21f29cc79d1f772a1244c0f512171c0a_cgraph" alt=""/></div>
<map name="zns_8c_a21f29cc79d1f772a1244c0f512171c0a_cgraph" id="zns_8c_a21f29cc79d1f772a1244c0f512171c0a_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,136,57"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="184,31,355,57"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="403,5,553,32"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="403,56,553,83"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a21f29cc79d1f772a1244c0f512171c0a_icgraph.png" border="0" usemap="#zns_8c_a21f29cc79d1f772a1244c0f512171c0a_icgraph" alt=""/></div>
<map name="zns_8c_a21f29cc79d1f772a1244c0f512171c0a_icgraph" id="zns_8c_a21f29cc79d1f772a1244c0f512171c0a_icgraph">
<area shape="rect" title=" " alt="" coords="1144,5,1275,32"/>
<area shape="rect" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c" title=" " alt="" coords="929,5,1096,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="aea339e52add6067aeb466ab8b0f56a1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea339e52add6067aeb466ab8b0f56a1d">&#9670;&nbsp;</a></span>zns_open_zone()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_open_zone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a>&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;{</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    uint16_t status;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a>) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08">NVME_ZONE_STATE_EMPTY</a>:</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        status = <a class="code" href="zns_8c.html#a2bd0e00434954d61e13cfe8a65a02e34">zns_aor_check</a>(ns, 1, 0);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordflow">if</span> (status != <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>) {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <a class="code" href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c">zns_aor_inc_active</a>(ns);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>:</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        status = <a class="code" href="zns_8c.html#a2bd0e00434954d61e13cfe8a65a02e34">zns_aor_check</a>(ns, 0, 1);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="keywordflow">if</span> (status != <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>) {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a> == <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08">NVME_ZONE_STATE_EMPTY</a>) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                <a class="code" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16">zns_aor_dec_active</a>(ns);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;            }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <a class="code" href="zns_8h.html#a456d13e8923adbff0acc0ab45e47ec8f">zns_aor_inc_open</a>(ns);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a044a8bce6652c9e617f784a37f643d38">NVME_ZONE_STATE_IMPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <a class="code" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3">zns_assign_zone_state</a>(ns, zone, <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a65105422decdfd6860779463c8964b55">NVME_ZONE_STATE_EXPLICITLY_OPEN</a>);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a65105422decdfd6860779463c8964b55">NVME_ZONE_STATE_EXPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4aa17e6457f1ee4cbc398f2da7fcf2fc4f">NVME_ZONE_INVAL_TRANSITION</a>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_aea339e52add6067aeb466ab8b0f56a1d_cgraph.png" border="0" usemap="#zns_8c_aea339e52add6067aeb466ab8b0f56a1d_cgraph" alt=""/></div>
<map name="zns_8c_aea339e52add6067aeb466ab8b0f56a1d_cgraph" id="zns_8c_aea339e52add6067aeb466ab8b0f56a1d_cgraph">
<area shape="rect" title=" " alt="" coords="5,107,127,133"/>
<area shape="rect" href="zns_8c.html#a2bd0e00434954d61e13cfe8a65a02e34" title=" " alt="" coords="201,5,319,32"/>
<area shape="rect" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16" title=" " alt="" coords="185,56,335,83"/>
<area shape="rect" href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c" title=" " alt="" coords="187,107,333,133"/>
<area shape="rect" href="zns_8h.html#a456d13e8923adbff0acc0ab45e47ec8f" title=" " alt="" coords="191,157,329,184"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="175,208,345,235"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="393,183,544,209"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="394,233,543,260"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_aea339e52add6067aeb466ab8b0f56a1d_icgraph.png" border="0" usemap="#zns_8c_aea339e52add6067aeb466ab8b0f56a1d_icgraph" alt=""/></div>
<map name="zns_8c_aea339e52add6067aeb466ab8b0f56a1d_icgraph" id="zns_8c_aea339e52add6067aeb466ab8b0f56a1d_icgraph">
<area shape="rect" title=" " alt="" coords="1144,5,1265,32"/>
<area shape="rect" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c" title=" " alt="" coords="929,5,1096,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a232d1c0fc6117ae692ff092d05f473e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a232d1c0fc6117ae692ff092d05f473e6">&#9670;&nbsp;</a></span>zns_read()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeCmd.html">NvmeCmd</a> *&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;{</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *rw = (<a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *)&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a335e5b18fb079480b1b1a1f06652c647">cmd</a>;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    uint64_t slba = le64_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a0f256de361f51a961d5a44955321b526">slba</a>);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    uint32_t nlb = (uint32_t)le16_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a34ba11f86be8f5d4be5518370faf2514">nlb</a>) + 1;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    uint64_t data_size = <a class="code" href="zns_8h.html#a686c1e6209d4c3eaf3897e73484bdf9f">zns_l2b</a>(ns, nlb);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    uint64_t data_offset;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    uint16_t status;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160; </div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    assert(n-&gt;<a class="code" href="structFemuCtrl.html#a22f0cfaa256d6bc65497853249789c83">zoned</a>);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    req-&gt;<a class="code" href="structNvmeRequest.html#a6f04006cddb851afcc919412c6e90b60">is_write</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    status = <a class="code" href="nvme_8h.html#ae412c484b40ac7903597a299757a7a83">nvme_check_mdts</a>(n, data_size);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    }</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    status = <a class="code" href="zns_8c.html#ae9ed91ad4901fe7f2cd4f9df6c333901">zns_check_bounds</a>(ns, slba, nlb);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    }</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    status = <a class="code" href="zns_8c.html#a9a270c9ffa0fb88a1c6d57ecfe3e6815">zns_check_zone_read</a>(ns, slba, nlb);</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    }</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160; </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    status = <a class="code" href="zns_8c.html#ab56987b404fc29d662252ee6f15e9012">zns_map_dptr</a>(n, data_size, req);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="nvme_8h.html#aa0cbe71eec16c64680b81f88140fa928">NVME_ERR_REC_DULBE</a>(n-&gt;<a class="code" href="structFemuCtrl.html#a4bd5012806e5cda6eb475cb787f4be3d">features</a>.<a class="code" href="structNvmeFeatureVal.html#a63adb2ba3685f4bf39e7375c37be8b14">err_rec</a>)) {</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        status = <a class="code" href="zns_8c.html#a52ee538a6713c7b29769f23b61dad575">zns_check_dulbe</a>(ns, slba, nlb);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        }</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    }</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160; </div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    data_offset = <a class="code" href="zns_8h.html#a686c1e6209d4c3eaf3897e73484bdf9f">zns_l2b</a>(ns, slba);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <a class="code" href="dram_8c.html#a1ccbcf0c92b7b084afc9890f3a7e5799">backend_rw</a>(n-&gt;<a class="code" href="structFemuCtrl.html#ab4f555e0b42bfe51c089ab004c88ff48">mbe</a>, &amp;req-&gt;<a class="code" href="structNvmeRequest.html#a678064f3bc45fbeb366ea44aea7273b2">qsg</a>, &amp;data_offset, req-&gt;<a class="code" href="structNvmeRequest.html#a6f04006cddb851afcc919412c6e90b60">is_write</a>);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;err:</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keywordflow">return</span> status | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a232d1c0fc6117ae692ff092d05f473e6_cgraph.png" border="0" usemap="#zns_8c_a232d1c0fc6117ae692ff092d05f473e6_cgraph" alt=""/></div>
<map name="zns_8c_a232d1c0fc6117ae692ff092d05f473e6_cgraph" id="zns_8c_a232d1c0fc6117ae692ff092d05f473e6_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,85,184"/>
<area shape="rect" href="dram_8c.html#a1ccbcf0c92b7b084afc9890f3a7e5799" title=" " alt="" coords="165,5,264,32"/>
<area shape="rect" href="nvme_8h.html#ae412c484b40ac7903597a299757a7a83" title=" " alt="" coords="143,56,287,83"/>
<area shape="rect" href="zns_8c.html#ae9ed91ad4901fe7f2cd4f9df6c333901" title=" " alt="" coords="143,107,286,133"/>
<area shape="rect" href="zns_8c.html#a52ee538a6713c7b29769f23b61dad575" title=" " alt="" coords="149,157,281,184"/>
<area shape="rect" href="zns_8c.html#a9a270c9ffa0fb88a1c6d57ecfe3e6815" title=" " alt="" coords="133,208,296,235"/>
<area shape="rect" href="zns_8h.html#a686c1e6209d4c3eaf3897e73484bdf9f" title=" " alt="" coords="179,259,250,285"/>
<area shape="rect" href="zns_8c.html#ab56987b404fc29d662252ee6f15e9012" title=" " alt="" coords="158,309,271,336"/>
<area shape="rect" href="zns_8c.html#a3357eef3f827fdab1d88e5c95ae3c386" title=" " alt="" coords="346,91,513,133"/>
<area shape="rect" href="zns_8c.html#a9674ef207fca784d45d2b13fe63e31f5" title=" " alt="" coords="346,157,513,184"/>
<area shape="rect" href="zns_8h.html#aa03c395f4bba42d5fc5b8ef247b082ae" title=" " alt="" coords="344,208,515,235"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="563,99,713,125"/>
<area shape="rect" href="zns_8c.html#a755fef089b9a7fc5ddd4be2d53455955" title=" " alt="" coords="583,157,693,184"/>
<area shape="rect" href="zns_8h.html#a63a81710dc2a7e2e61f2b7ace02a538a" title=" " alt="" coords="375,259,483,285"/>
<area shape="rect" href="zns_8h.html#a04721281dcdb77acc610b362cb5085ad" title=" " alt="" coords="589,259,687,285"/>
<area shape="rect" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493" title=" " alt="" coords="368,309,491,336"/>
<area shape="rect" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484" title=" " alt="" coords="573,309,703,336"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a232d1c0fc6117ae692ff092d05f473e6_icgraph.png" border="0" usemap="#zns_8c_a232d1c0fc6117ae692ff092d05f473e6_icgraph" alt=""/></div>
<map name="zns_8c_a232d1c0fc6117ae692ff092d05f473e6_icgraph" id="zns_8c_a232d1c0fc6117ae692ff092d05f473e6_icgraph">
<area shape="rect" title=" " alt="" coords="929,5,1009,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a7c7e09c6f357c1f77c724c664f6c0128"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c7e09c6f357c1f77c724c664f6c0128">&#9670;&nbsp;</a></span>zns_reset_zone()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_reset_zone </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a>&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;{</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a>) {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08">NVME_ZONE_STATE_EMPTY</a>:</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a65105422decdfd6860779463c8964b55">NVME_ZONE_STATE_EXPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a044a8bce6652c9e617f784a37f643d38">NVME_ZONE_STATE_IMPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>:</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9afc7fe17858da6497474a2307ab239967">NVME_ZONE_STATE_FULL</a>:</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4aa17e6457f1ee4cbc398f2da7fcf2fc4f">NVME_ZONE_INVAL_TRANSITION</a>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <a class="code" href="zns_8c.html#a7cf84991a322dded9376491f5d98dedb">zns_aio_zone_reset_cb</a>(req, zone);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a7c7e09c6f357c1f77c724c664f6c0128_cgraph.png" border="0" usemap="#zns_8c_a7c7e09c6f357c1f77c724c664f6c0128_cgraph" alt=""/></div>
<map name="zns_8c_a7c7e09c6f357c1f77c724c664f6c0128_cgraph" id="zns_8c_a7c7e09c6f357c1f77c724c664f6c0128_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,128,108"/>
<area shape="rect" href="zns_8c.html#a7cf84991a322dded9376491f5d98dedb" title=" " alt="" coords="176,81,347,108"/>
<area shape="rect" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16" title=" " alt="" coords="405,5,555,32"/>
<area shape="rect" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b" title=" " alt="" coords="409,56,551,83"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="395,157,565,184"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="613,107,764,133"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="614,157,763,184"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a7c7e09c6f357c1f77c724c664f6c0128_icgraph.png" border="0" usemap="#zns_8c_a7c7e09c6f357c1f77c724c664f6c0128_icgraph" alt=""/></div>
<map name="zns_8c_a7c7e09c6f357c1f77c724c664f6c0128_icgraph" id="zns_8c_a7c7e09c6f357c1f77c724c664f6c0128_icgraph">
<area shape="rect" title=" " alt="" coords="1144,5,1267,32"/>
<area shape="rect" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c" title=" " alt="" coords="929,5,1096,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="ace4f37fd873afd711375d7c88dc333ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace4f37fd873afd711375d7c88dc333ff">&#9670;&nbsp;</a></span>zns_set_ctrl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void zns_set_ctrl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;{</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    uint8_t *pci_conf = n-&gt;<a class="code" href="structFemuCtrl.html#a9d862ea82682f6232413280b92ddc4d1">parent_obj</a>.config;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160; </div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <a class="code" href="zns_8c.html#a05f7689d91910e1a2f865b30a9bc5393">zns_set_ctrl_str</a>(n);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    pci_config_set_vendor_id(pci_conf, PCI_VENDOR_ID_INTEL);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    pci_config_set_device_id(pci_conf, 0x5845);</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_ace4f37fd873afd711375d7c88dc333ff_cgraph.png" border="0" usemap="#zns_8c_ace4f37fd873afd711375d7c88dc333ff_cgraph" alt=""/></div>
<map name="zns_8c_ace4f37fd873afd711375d7c88dc333ff_cgraph" id="zns_8c_ace4f37fd873afd711375d7c88dc333ff_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,104,32"/>
<area shape="rect" href="zns_8c.html#a05f7689d91910e1a2f865b30a9bc5393" title=" " alt="" coords="152,5,275,32"/>
<area shape="rect" href="nvme-util_8c.html#a9e84e8328646dcb1f24be9c79018e6a0" title=" " alt="" coords="323,5,481,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_ace4f37fd873afd711375d7c88dc333ff_icgraph.png" border="0" usemap="#zns_8c_ace4f37fd873afd711375d7c88dc333ff_icgraph" alt=""/></div>
<map name="zns_8c_ace4f37fd873afd711375d7c88dc333ff_icgraph" id="zns_8c_ace4f37fd873afd711375d7c88dc333ff_icgraph">
<area shape="rect" title=" " alt="" coords="903,5,1001,32"/>
<area shape="rect" href="zns_8c.html#aa65a4a4ae802bdd6f8cc362247c6325b" title=" " alt="" coords="783,5,855,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a05f7689d91910e1a2f865b30a9bc5393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05f7689d91910e1a2f865b30a9bc5393">&#9670;&nbsp;</a></span>zns_set_ctrl_str()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void zns_set_ctrl_str </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;{</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">int</span> fsid_zns = 0;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *zns_mn = <span class="stringliteral">&quot;FEMU ZNS-SSD Controller&quot;</span>;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *zns_sn = <span class="stringliteral">&quot;vZNSSD&quot;</span>;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <a class="code" href="nvme-util_8c.html#a9e84e8328646dcb1f24be9c79018e6a0">nvme_set_ctrl_name</a>(n, zns_mn, zns_sn, &amp;fsid_zns);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a05f7689d91910e1a2f865b30a9bc5393_cgraph.png" border="0" usemap="#zns_8c_a05f7689d91910e1a2f865b30a9bc5393_cgraph" alt=""/></div>
<map name="zns_8c_a05f7689d91910e1a2f865b30a9bc5393_cgraph" id="zns_8c_a05f7689d91910e1a2f865b30a9bc5393_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,128,32"/>
<area shape="rect" href="nvme-util_8c.html#a9e84e8328646dcb1f24be9c79018e6a0" title=" " alt="" coords="176,5,335,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a05f7689d91910e1a2f865b30a9bc5393_icgraph.png" border="0" usemap="#zns_8c_a05f7689d91910e1a2f865b30a9bc5393_icgraph" alt=""/></div>
<map name="zns_8c_a05f7689d91910e1a2f865b30a9bc5393_icgraph" id="zns_8c_a05f7689d91910e1a2f865b30a9bc5393_icgraph">
<area shape="rect" title=" " alt="" coords="1049,5,1172,32"/>
<area shape="rect" href="zns_8c.html#ace4f37fd873afd711375d7c88dc333ff" title=" " alt="" coords="903,5,1001,32"/>
<area shape="rect" href="zns_8c.html#aa65a4a4ae802bdd6f8cc362247c6325b" title=" " alt="" coords="783,5,855,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a52eacdcbc504ab2769e6b194295e2355"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52eacdcbc504ab2769e6b194295e2355">&#9670;&nbsp;</a></span>zns_set_zd_ext()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_set_zd_ext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zone</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;{</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    uint16_t status;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    uint8_t <a class="code" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a> = <a class="code" href="zns_8h.html#a677294d02c732b61b18d610041851e4b">zns_get_zone_state</a>(zone);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a> == <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08">NVME_ZONE_STATE_EMPTY</a>) {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        status = <a class="code" href="zns_8c.html#a2bd0e00434954d61e13cfe8a65a02e34">zns_aor_check</a>(ns, 1, 0);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="keywordflow">if</span> (status != <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>) {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        <a class="code" href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c">zns_aor_inc_active</a>(ns);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#aad408ac3045c84d106809b7a2b684afd">za</a> |= <a class="code" href="zns_8h.html#a5b5faae59db38c0e3b1c5c6be4f90e99a0befe230ab3de39e04876554c3506be3">NVME_ZA_ZD_EXT_VALID</a>;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <a class="code" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3">zns_assign_zone_state</a>(ns, zone, <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4aa17e6457f1ee4cbc398f2da7fcf2fc4f">NVME_ZONE_INVAL_TRANSITION</a>;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a52eacdcbc504ab2769e6b194295e2355_cgraph.png" border="0" usemap="#zns_8c_a52eacdcbc504ab2769e6b194295e2355_cgraph" alt=""/></div>
<map name="zns_8c_a52eacdcbc504ab2769e6b194295e2355_cgraph" id="zns_8c_a52eacdcbc504ab2769e6b194295e2355_cgraph">
<area shape="rect" title=" " alt="" coords="5,81,127,108"/>
<area shape="rect" href="zns_8c.html#a2bd0e00434954d61e13cfe8a65a02e34" title=" " alt="" coords="201,5,319,32"/>
<area shape="rect" href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c" title=" " alt="" coords="187,56,333,83"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="175,157,345,184"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="393,107,544,133"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="394,157,543,184"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a52eacdcbc504ab2769e6b194295e2355_icgraph.png" border="0" usemap="#zns_8c_a52eacdcbc504ab2769e6b194295e2355_icgraph" alt=""/></div>
<map name="zns_8c_a52eacdcbc504ab2769e6b194295e2355_icgraph" id="zns_8c_a52eacdcbc504ab2769e6b194295e2355_icgraph">
<area shape="rect" title=" " alt="" coords="1144,5,1265,32"/>
<area shape="rect" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c" title=" " alt="" coords="929,5,1096,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a4c27f4956bf97dcabba73019e80b191a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c27f4956bf97dcabba73019e80b191a">&#9670;&nbsp;</a></span>zns_start_ctrl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int zns_start_ctrl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;{</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="comment">/* Coperd: let&#39;s fail early before anything crazy happens */</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    assert(n-&gt;<a class="code" href="structFemuCtrl.html#a6d0418e38e888b2b8980a34198bfd463">page_size</a> == 4096);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160; </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keywordflow">if</span> (!n-&gt;<a class="code" href="structFemuCtrl.html#ac6e80e0bc39d8878bee79720f0733909">zasl_bs</a>) {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        n-&gt;<a class="code" href="structFemuCtrl.html#a8dc93dbc4b721983afa203722a769e7a">zasl</a> = n-&gt;<a class="code" href="structFemuCtrl.html#ab5a216b7e1406665640e42409e2c8de8">mdts</a>;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <span class="keywordflow">if</span> (n-&gt;<a class="code" href="structFemuCtrl.html#ac6e80e0bc39d8878bee79720f0733909">zasl_bs</a> &lt; n-&gt;<a class="code" href="structFemuCtrl.html#a6d0418e38e888b2b8980a34198bfd463">page_size</a>) {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;ZASL too small (%dB), must &gt;= 1 page (4K)\n&quot;</span>, n-&gt;<a class="code" href="structFemuCtrl.html#ac6e80e0bc39d8878bee79720f0733909">zasl_bs</a>);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;            <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        }</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        n-&gt;<a class="code" href="structFemuCtrl.html#a8dc93dbc4b721983afa203722a769e7a">zasl</a> = 31 - clz32(n-&gt;<a class="code" href="structFemuCtrl.html#ac6e80e0bc39d8878bee79720f0733909">zasl_bs</a> / n-&gt;<a class="code" href="structFemuCtrl.html#a6d0418e38e888b2b8980a34198bfd463">page_size</a>);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a4c27f4956bf97dcabba73019e80b191a_icgraph.png" border="0" usemap="#zns_8c_a4c27f4956bf97dcabba73019e80b191a_icgraph" alt=""/></div>
<map name="zns_8c_a4c27f4956bf97dcabba73019e80b191a_icgraph" id="zns_8c_a4c27f4956bf97dcabba73019e80b191a_icgraph">
<area shape="rect" title=" " alt="" coords="783,5,892,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="abcb43c9722f5f6a3346b15dfd3872008"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcb43c9722f5f6a3346b15dfd3872008">&#9670;&nbsp;</a></span>zns_write()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeCmd.html">NvmeCmd</a> *&#160;</td>
          <td class="paramname"><em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;{</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *rw = (<a class="code" href="structNvmeRwCmd.html">NvmeRwCmd</a> *)cmd;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    uint64_t slba = le64_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a0f256de361f51a961d5a44955321b526">slba</a>);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    uint32_t nlb = (uint32_t)le16_to_cpu(rw-&gt;<a class="code" href="structNvmeRwCmd.html#a34ba11f86be8f5d4be5518370faf2514">nlb</a>) + 1;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    uint64_t data_size = <a class="code" href="zns_8h.html#a686c1e6209d4c3eaf3897e73484bdf9f">zns_l2b</a>(ns, nlb);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    uint64_t data_offset;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <a class="code" href="structNvmeZone.html">NvmeZone</a> *zone;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <a class="code" href="structNvmeZonedResult.html">NvmeZonedResult</a> *<a class="code" href="structOc12IdAddrFormat.html#a732423af24585adde3b4003bfed623a2">res</a> = (<a class="code" href="structNvmeZonedResult.html">NvmeZonedResult</a> *)&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a8cec02fb87e647c828d06f533aec8758">cqe</a>;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    uint16_t status;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    assert(n-&gt;<a class="code" href="structFemuCtrl.html#a22f0cfaa256d6bc65497853249789c83">zoned</a>);</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    req-&gt;<a class="code" href="structNvmeRequest.html#a6f04006cddb851afcc919412c6e90b60">is_write</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    status = <a class="code" href="nvme_8h.html#ae412c484b40ac7903597a299757a7a83">nvme_check_mdts</a>(n, data_size);</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    }</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    status = <a class="code" href="zns_8c.html#ae9ed91ad4901fe7f2cd4f9df6c333901">zns_check_bounds</a>(ns, slba, nlb);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    }</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    zone = <a class="code" href="zns_8c.html#a9674ef207fca784d45d2b13fe63e31f5">zns_get_zone_by_slba</a>(ns, slba);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160; </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    status = <a class="code" href="zns_8c.html#a5fa5b88257a067bda683c7f981b39524">zns_check_zone_write</a>(n, ns, zone, slba, nlb, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    }</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160; </div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    status = <a class="code" href="zns_8c.html#ad5f4088354d2555f9d66e2ba441592ff">zns_auto_open_zone</a>(ns, zone);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    }</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <a class="code" href="structOc12IdAddrFormat.html#a732423af24585adde3b4003bfed623a2">res</a>-&gt;slba = <a class="code" href="zns_8c.html#a94c5876f1b68a759a109b78003852924">zns_advance_zone_wp</a>(ns, zone, nlb);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; </div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    data_offset = <a class="code" href="zns_8h.html#a686c1e6209d4c3eaf3897e73484bdf9f">zns_l2b</a>(ns, slba);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160; </div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    status = <a class="code" href="zns_8c.html#ab56987b404fc29d662252ee6f15e9012">zns_map_dptr</a>(n, data_size, req);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="keywordflow">goto</span> err;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    }</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <a class="code" href="dram_8c.html#a1ccbcf0c92b7b084afc9890f3a7e5799">backend_rw</a>(n-&gt;<a class="code" href="structFemuCtrl.html#ab4f555e0b42bfe51c089ab004c88ff48">mbe</a>, &amp;req-&gt;<a class="code" href="structNvmeRequest.html#a678064f3bc45fbeb366ea44aea7273b2">qsg</a>, &amp;data_offset, req-&gt;<a class="code" href="structNvmeRequest.html#a6f04006cddb851afcc919412c6e90b60">is_write</a>);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <a class="code" href="zns_8c.html#a61f038c076c83ca5f99341b71c9b8e10">zns_finalize_zoned_write</a>(ns, req, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160; </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;err:</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <a class="code" href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a>(<span class="stringliteral">&quot;*********ZONE WRITE FAILED*********\n&quot;</span>);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordflow">return</span> status | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_abcb43c9722f5f6a3346b15dfd3872008_cgraph.png" border="0" usemap="#zns_8c_abcb43c9722f5f6a3346b15dfd3872008_cgraph" alt=""/></div>
<map name="zns_8c_abcb43c9722f5f6a3346b15dfd3872008_cgraph" id="zns_8c_abcb43c9722f5f6a3346b15dfd3872008_cgraph">
<area shape="rect" title=" " alt="" coords="5,387,89,413"/>
<area shape="rect" href="dram_8c.html#a1ccbcf0c92b7b084afc9890f3a7e5799" title=" " alt="" coords="167,173,265,200"/>
<area shape="rect" href="nvme_8h.html#ae412c484b40ac7903597a299757a7a83" title=" " alt="" coords="144,224,288,251"/>
<area shape="rect" href="zns_8c.html#a94c5876f1b68a759a109b78003852924" title=" " alt="" coords="351,132,521,159"/>
<area shape="rect" href="zns_8c.html#ad5f4088354d2555f9d66e2ba441592ff" title=" " alt="" coords="137,325,295,352"/>
<area shape="rect" href="zns_8c.html#ae9ed91ad4901fe7f2cd4f9df6c333901" title=" " alt="" coords="145,615,287,641"/>
<area shape="rect" href="zns_8c.html#a5fa5b88257a067bda683c7f981b39524" title=" " alt="" coords="353,463,519,489"/>
<area shape="rect" href="zns_8h.html#a686c1e6209d4c3eaf3897e73484bdf9f" title=" " alt="" coords="629,579,699,605"/>
<area shape="rect" href="zns_8c.html#a61f038c076c83ca5f99341b71c9b8e10" title=" " alt="" coords="364,373,508,414"/>
<area shape="rect" href="zns_8c.html#a9674ef207fca784d45d2b13fe63e31f5" title=" " alt="" coords="581,629,747,656"/>
<area shape="rect" href="zns_8c.html#ab56987b404fc29d662252ee6f15e9012" title=" " alt="" coords="159,667,273,693"/>
<area shape="rect" href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c" title=" " alt="" coords="591,56,737,83"/>
<area shape="rect" href="zns_8h.html#a456d13e8923adbff0acc0ab45e47ec8f" title=" " alt="" coords="595,5,733,32"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="579,157,749,184"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="799,284,949,311"/>
<area shape="rect" href="zns_8h.html#a1f2a423f30678b841f4aaf3f09d0e7de" title=" " alt="" coords="577,360,751,387"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="799,157,949,184"/>
<area shape="rect" href="zns_8c.html#a2bd0e00434954d61e13cfe8a65a02e34" title=" " alt="" coords="377,321,495,348"/>
<area shape="rect" href="zns_8c.html#a02ec33ad0c6f39ad701ac9ea780811c4" title=" " alt="" coords="343,208,529,235"/>
<area shape="rect" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b" title=" " alt="" coords="593,208,735,235"/>
<area shape="rect" href="zns_8c.html#a841382c8c3024053a641811800230a23" title=" " alt="" coords="581,462,747,503"/>
<area shape="rect" href="zns_8h.html#ad064d2d81e65c1f8d539bafbee8cf353" title=" " alt="" coords="601,528,727,555"/>
<area shape="rect" href="zns_8h.html#a63a81710dc2a7e2e61f2b7ace02a538a" title=" " alt="" coords="820,579,928,605"/>
<area shape="rect" href="zns_8h.html#a04721281dcdb77acc610b362cb5085ad" title=" " alt="" coords="997,579,1096,605"/>
<area shape="rect" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16" title=" " alt="" coords="589,411,739,437"/>
<area shape="rect" href="zns_8c.html#a755fef089b9a7fc5ddd4be2d53455955" title=" " alt="" coords="819,629,929,656"/>
<area shape="rect" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493" title=" " alt="" coords="375,671,497,697"/>
<area shape="rect" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484" title=" " alt="" coords="599,680,729,707"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_abcb43c9722f5f6a3346b15dfd3872008_icgraph.png" border="0" usemap="#zns_8c_abcb43c9722f5f6a3346b15dfd3872008_icgraph" alt=""/></div>
<map name="zns_8c_abcb43c9722f5f6a3346b15dfd3872008_icgraph" id="zns_8c_abcb43c9722f5f6a3346b15dfd3872008_icgraph">
<area shape="rect" title=" " alt="" coords="929,5,1013,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a4285aad08edb64a1c6aea72ad77f8338"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4285aad08edb64a1c6aea72ad77f8338">&#9670;&nbsp;</a></span>zns_zone_append()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_zone_append </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;{</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="zns_8c.html#a84203495e6de57d698b7e393f7106984">zns_do_write</a>(n, req, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a4285aad08edb64a1c6aea72ad77f8338_cgraph.png" border="0" usemap="#zns_8c_a4285aad08edb64a1c6aea72ad77f8338_cgraph" alt=""/></div>
<map name="zns_8c_a4285aad08edb64a1c6aea72ad77f8338_cgraph" id="zns_8c_a4285aad08edb64a1c6aea72ad77f8338_cgraph">
<area shape="rect" title=" " alt="" coords="5,387,143,413"/>
<area shape="rect" href="zns_8c.html#a84203495e6de57d698b7e393f7106984" title=" " alt="" coords="191,387,297,413"/>
<area shape="rect" href="dram_8c.html#a1ccbcf0c92b7b084afc9890f3a7e5799" title=" " alt="" coords="375,173,473,200"/>
<area shape="rect" href="nvme_8h.html#ae412c484b40ac7903597a299757a7a83" title=" " alt="" coords="352,224,496,251"/>
<area shape="rect" href="zns_8c.html#a94c5876f1b68a759a109b78003852924" title=" " alt="" coords="559,132,729,159"/>
<area shape="rect" href="zns_8c.html#ad5f4088354d2555f9d66e2ba441592ff" title=" " alt="" coords="345,325,503,352"/>
<area shape="rect" href="zns_8c.html#ae9ed91ad4901fe7f2cd4f9df6c333901" title=" " alt="" coords="353,615,495,641"/>
<area shape="rect" href="zns_8c.html#a5fa5b88257a067bda683c7f981b39524" title=" " alt="" coords="561,463,727,489"/>
<area shape="rect" href="zns_8h.html#a686c1e6209d4c3eaf3897e73484bdf9f" title=" " alt="" coords="837,579,907,605"/>
<area shape="rect" href="zns_8c.html#a61f038c076c83ca5f99341b71c9b8e10" title=" " alt="" coords="572,373,716,414"/>
<area shape="rect" href="zns_8c.html#a9674ef207fca784d45d2b13fe63e31f5" title=" " alt="" coords="789,629,955,656"/>
<area shape="rect" href="zns_8c.html#ab56987b404fc29d662252ee6f15e9012" title=" " alt="" coords="367,667,481,693"/>
<area shape="rect" href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c" title=" " alt="" coords="799,56,945,83"/>
<area shape="rect" href="zns_8h.html#a456d13e8923adbff0acc0ab45e47ec8f" title=" " alt="" coords="803,5,941,32"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="787,157,957,184"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="1007,284,1157,311"/>
<area shape="rect" href="zns_8h.html#a1f2a423f30678b841f4aaf3f09d0e7de" title=" " alt="" coords="785,360,959,387"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="1007,157,1157,184"/>
<area shape="rect" href="zns_8c.html#a2bd0e00434954d61e13cfe8a65a02e34" title=" " alt="" coords="585,321,703,348"/>
<area shape="rect" href="zns_8c.html#a02ec33ad0c6f39ad701ac9ea780811c4" title=" " alt="" coords="551,208,737,235"/>
<area shape="rect" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b" title=" " alt="" coords="801,208,943,235"/>
<area shape="rect" href="zns_8c.html#a841382c8c3024053a641811800230a23" title=" " alt="" coords="789,462,955,503"/>
<area shape="rect" href="zns_8h.html#ad064d2d81e65c1f8d539bafbee8cf353" title=" " alt="" coords="809,528,935,555"/>
<area shape="rect" href="zns_8h.html#a63a81710dc2a7e2e61f2b7ace02a538a" title=" " alt="" coords="1028,579,1136,605"/>
<area shape="rect" href="zns_8h.html#a04721281dcdb77acc610b362cb5085ad" title=" " alt="" coords="1205,579,1304,605"/>
<area shape="rect" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16" title=" " alt="" coords="797,411,947,437"/>
<area shape="rect" href="zns_8c.html#a755fef089b9a7fc5ddd4be2d53455955" title=" " alt="" coords="1027,629,1137,656"/>
<area shape="rect" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493" title=" " alt="" coords="583,671,705,697"/>
<area shape="rect" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484" title=" " alt="" coords="807,680,937,707"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a4285aad08edb64a1c6aea72ad77f8338_icgraph.png" border="0" usemap="#zns_8c_a4285aad08edb64a1c6aea72ad77f8338_icgraph" alt=""/></div>
<map name="zns_8c_a4285aad08edb64a1c6aea72ad77f8338_icgraph" id="zns_8c_a4285aad08edb64a1c6aea72ad77f8338_icgraph">
<area shape="rect" title=" " alt="" coords="929,5,1067,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a755fef089b9a7fc5ddd4be2d53455955"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a755fef089b9a7fc5ddd4be2d53455955">&#9670;&nbsp;</a></span>zns_zone_idx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint32_t zns_zone_idx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>slba</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = ns-&gt;<a class="code" href="structNvmeNamespace.html#a8354f38841896795412b089fdfbe1528">ctrl</a>;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <span class="keywordflow">return</span> (n-&gt;<a class="code" href="structFemuCtrl.html#afdc1d22ac9fbea382272a39bfdd52db7">zone_size_log2</a> &gt; 0 ? slba &gt;&gt; n-&gt;<a class="code" href="structFemuCtrl.html#afdc1d22ac9fbea382272a39bfdd52db7">zone_size_log2</a> : slba /</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;            n-&gt;<a class="code" href="structFemuCtrl.html#adaa9832711cd5744244c2cd80e0b027c">zone_size</a>);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a755fef089b9a7fc5ddd4be2d53455955_icgraph.png" border="0" usemap="#zns_8c_a755fef089b9a7fc5ddd4be2d53455955_icgraph" alt=""/></div>
<map name="zns_8c_a755fef089b9a7fc5ddd4be2d53455955_icgraph" id="zns_8c_a755fef089b9a7fc5ddd4be2d53455955_icgraph">
<area shape="rect" title=" " alt="" coords="1835,104,1944,131"/>
<area shape="rect" href="zns_8c.html#a6719fe173fec9e6e538ab3f449491bd2" title=" " alt="" coords="1144,53,1361,80"/>
<area shape="rect" href="zns_8c.html#a9674ef207fca784d45d2b13fe63e31f5" title=" " alt="" coords="1620,155,1787,181"/>
<area shape="rect" href="zns_8c.html#a6e03af0f3d0b7c597d9137a0b18bca56" title=" " alt="" coords="931,5,1094,32"/>
<area shape="rect" href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c" title=" " alt="" coords="929,56,1096,83"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,107,881,133"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,107,735,133"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,107,527,133"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,107,284,133"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,107,129,133"/>
<area shape="rect" href="zns_8c.html#a9a270c9ffa0fb88a1c6d57ecfe3e6815" title=" " alt="" coords="1409,104,1572,131"/>
<area shape="rect" href="zns_8c.html#a84203495e6de57d698b7e393f7106984" title=" " alt="" coords="1199,157,1306,184"/>
<area shape="rect" href="zns_8c.html#a61f038c076c83ca5f99341b71c9b8e10" title=" " alt="" coords="1419,206,1563,247"/>
<area shape="rect" href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008" title=" " alt="" coords="1211,213,1295,240"/>
<area shape="rect" href="zns_8c.html#a232d1c0fc6117ae692ff092d05f473e6" title=" " alt="" coords="973,107,1053,133"/>
<area shape="rect" href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338" title=" " alt="" coords="944,157,1081,184"/>
</map>
</div>

</div>
</div>
<a id="a81321b3c5f8d3e0069c181e2dfa4f452"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81321b3c5f8d3e0069c181e2dfa4f452">&#9670;&nbsp;</a></span>zns_zone_matches_filter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool zns_zone_matches_filter </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>zafs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeZone.html">NvmeZone</a> *&#160;</td>
          <td class="paramname"><em>zl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;{</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a> zs = <a class="code" href="zns_8h.html#a677294d02c732b61b18d610041851e4b">zns_get_zone_state</a>(zl);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <span class="keywordflow">switch</span> (zafs) {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96ab5d96bcc1fd68002871e534bb0e88679">NVME_ZONE_REPORT_ALL</a>:</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96aeb60f762c578dc20b988c5f5d0895cab">NVME_ZONE_REPORT_EMPTY</a>:</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="keywordflow">return</span> zs == <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08">NVME_ZONE_STATE_EMPTY</a>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96a41833392f0ae7d34840885a6ed822e57">NVME_ZONE_REPORT_IMPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <span class="keywordflow">return</span> zs == <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a044a8bce6652c9e617f784a37f643d38">NVME_ZONE_STATE_IMPLICITLY_OPEN</a>;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96aed799eebe132cead31e3192550f5fafe">NVME_ZONE_REPORT_EXPLICITLY_OPEN</a>:</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="keywordflow">return</span> zs == <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a65105422decdfd6860779463c8964b55">NVME_ZONE_STATE_EXPLICITLY_OPEN</a>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96aa7bb2898d42b87813864238178fa9354">NVME_ZONE_REPORT_CLOSED</a>:</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordflow">return</span> zs == <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a>;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96a92520822547e2ce8c33ec460a94d4240">NVME_ZONE_REPORT_FULL</a>:</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordflow">return</span> zs == <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9afc7fe17858da6497474a2307ab239967">NVME_ZONE_STATE_FULL</a>;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96a1470a143eb11896fd977b96133736274">NVME_ZONE_REPORT_READ_ONLY</a>:</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordflow">return</span> zs == <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a9f9310a3aab3b20b1dc6ea8a2b658add">NVME_ZONE_STATE_READ_ONLY</a>;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96a4c0c7febda38f49b8f19fd9cc2e4fc03">NVME_ZONE_REPORT_OFFLINE</a>:</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="keywordflow">return</span> zs == <a class="code" href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a5a871630ac0aaff6794aaed5587d7fd3">NVME_ZONE_STATE_OFFLINE</a>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    }</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a81321b3c5f8d3e0069c181e2dfa4f452_cgraph.png" border="0" usemap="#zns_8c_a81321b3c5f8d3e0069c181e2dfa4f452_cgraph" alt=""/></div>
<map name="zns_8c_a81321b3c5f8d3e0069c181e2dfa4f452_cgraph" id="zns_8c_a81321b3c5f8d3e0069c181e2dfa4f452_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,188,32"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="236,5,387,32"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a81321b3c5f8d3e0069c181e2dfa4f452_icgraph.png" border="0" usemap="#zns_8c_a81321b3c5f8d3e0069c181e2dfa4f452_icgraph" alt=""/></div>
<map name="zns_8c_a81321b3c5f8d3e0069c181e2dfa4f452_icgraph" id="zns_8c_a81321b3c5f8d3e0069c181e2dfa4f452_icgraph">
<area shape="rect" title=" " alt="" coords="1140,5,1323,32"/>
<area shape="rect" href="zns_8c.html#a6e03af0f3d0b7c597d9137a0b18bca56" title=" " alt="" coords="929,5,1092,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a6e03af0f3d0b7c597d9137a0b18bca56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e03af0f3d0b7c597d9137a0b18bca56">&#9670;&nbsp;</a></span>zns_zone_mgmt_recv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_zone_mgmt_recv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;{</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <a class="code" href="structNvmeCmd.html">NvmeCmd</a> *cmd = (<a class="code" href="structNvmeCmd.html">NvmeCmd</a> *)&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a335e5b18fb079480b1b1a1f06652c647">cmd</a>;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <a class="code" href="structNvmeNamespace.html">NvmeNamespace</a> *ns = req-&gt;<a class="code" href="structNvmeRequest.html#a3609469c3f31833cb86006bae283e160">ns</a>;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    uint64_t prp1 = le64_to_cpu(cmd-&gt;<a class="code" href="structNvmeCmd.html#a3b34c627a05e2a86edf1a93567422c8c">dptr</a>.<a class="code" href="unionNvmeCmdDptr.html#aaad95622d868c580eadba6c852bf961d">prp1</a>);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    uint64_t prp2 = le64_to_cpu(cmd-&gt;<a class="code" href="structNvmeCmd.html#a3b34c627a05e2a86edf1a93567422c8c">dptr</a>.<a class="code" href="unionNvmeCmdDptr.html#a9fc9a97c707652c679097b32ffd84bc3">prp2</a>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="comment">/* cdw12 is zero-based number of dwords to return. Convert to bytes */</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    uint32_t data_size = (le32_to_cpu(cmd-&gt;<a class="code" href="structNvmeCmd.html#ab8451175fd2fa5932757675268633fab">cdw12</a>) + 1) &lt;&lt; 2;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    uint32_t dw13 = le32_to_cpu(cmd-&gt;<a class="code" href="structNvmeCmd.html#abe88eab6edc75248f89446542ae46eed">cdw13</a>);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    uint32_t zone_idx, zra, zrasf, partial;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    uint64_t max_zones, nr_zones = 0;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    uint16_t status;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    uint64_t slba, capacity = <a class="code" href="zns_8h.html#a0b9c3e6b619d9dca6883a7fe3cb4daa9">zns_ns_nlbas</a>(ns);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <a class="code" href="structNvmeZoneDescr.html">NvmeZoneDescr</a> *z;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <a class="code" href="structNvmeZone.html">NvmeZone</a> *zone;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <a class="code" href="structNvmeZoneReportHeader.html">NvmeZoneReportHeader</a> *header;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordtype">void</span> *buf, *buf_p;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="keywordtype">size_t</span> zone_entry_sz;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    req-&gt;<a class="code" href="structNvmeRequest.html#a6c614d6e18850245fb2b05f087c4cc71">status</a> = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    status = <a class="code" href="zns_8c.html#a6719fe173fec9e6e538ab3f449491bd2">zns_get_mgmt_zone_slba_idx</a>(n, cmd, &amp;slba, &amp;zone_idx);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    zra = dw13 &amp; 0xff;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">if</span> (zra != <a class="code" href="zns_8h.html#a175b9ee53a65f84e7ede4410eca5686cae7fa22feb03f5e24adf5a3d1e8c62872">NVME_ZONE_REPORT</a> &amp;&amp; zra != <a class="code" href="zns_8h.html#a175b9ee53a65f84e7ede4410eca5686cad3280c3e4f22285e4865aff0184b7144">NVME_ZONE_REPORT_EXTENDED</a>) {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    }</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">if</span> (zra == <a class="code" href="zns_8h.html#a175b9ee53a65f84e7ede4410eca5686cad3280c3e4f22285e4865aff0184b7144">NVME_ZONE_REPORT_EXTENDED</a> &amp;&amp; !n-&gt;<a class="code" href="structFemuCtrl.html#ac31c5055e8db3e4124d1bceb15d16f6b">zd_extension_size</a>) {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    zrasf = (dw13 &gt;&gt; 8) &amp; 0xff;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">if</span> (zrasf &gt; <a class="code" href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96a4c0c7febda38f49b8f19fd9cc2e4fc03">NVME_ZONE_REPORT_OFFLINE</a>) {</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    }</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160; </div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <span class="keywordflow">if</span> (data_size &lt; <span class="keyword">sizeof</span>(<a class="code" href="structNvmeZoneReportHeader.html">NvmeZoneReportHeader</a>)) {</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    status = <a class="code" href="nvme_8h.html#ae412c484b40ac7903597a299757a7a83">nvme_check_mdts</a>(n, data_size);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    }</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    partial = (dw13 &gt;&gt; 16) &amp; 0x01;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    zone_entry_sz = <span class="keyword">sizeof</span>(<a class="code" href="zns_8h.html#af6b7cd466fb58a480d24a7c8ed1fb2ee">NvmeZoneDescr</a>);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keywordflow">if</span> (zra == <a class="code" href="zns_8h.html#a175b9ee53a65f84e7ede4410eca5686cad3280c3e4f22285e4865aff0184b7144">NVME_ZONE_REPORT_EXTENDED</a>) {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        zone_entry_sz += n-&gt;<a class="code" href="structFemuCtrl.html#ac31c5055e8db3e4124d1bceb15d16f6b">zd_extension_size</a>;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    max_zones = (data_size - <span class="keyword">sizeof</span>(<a class="code" href="zns_8h.html#a4f19d3f42d1013ffcb74de021711223b">NvmeZoneReportHeader</a>)) / zone_entry_sz;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    buf = g_malloc0(data_size);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    zone = &amp;n-&gt;<a class="code" href="structFemuCtrl.html#aaad2dc59565b90a54c8b118032d67801">zone_array</a>[zone_idx];</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordflow">for</span> (; slba &lt; capacity; slba += n-&gt;<a class="code" href="structFemuCtrl.html#adaa9832711cd5744244c2cd80e0b027c">zone_size</a>) {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="keywordflow">if</span> (partial &amp;&amp; nr_zones &gt;= max_zones) {</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        }</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="zns_8c.html#a81321b3c5f8d3e0069c181e2dfa4f452">zns_zone_matches_filter</a>(zrasf, zone++)) {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            nr_zones++;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    }</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    header = (<a class="code" href="structNvmeZoneReportHeader.html">NvmeZoneReportHeader</a> *)buf;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    header-&gt;<a class="code" href="structNvmeZoneReportHeader.html#a95ea3874aec112d532276a06fd2afbd7">nr_zones</a> = cpu_to_le64(nr_zones);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    buf_p = buf + <span class="keyword">sizeof</span>(<a class="code" href="zns_8h.html#a4f19d3f42d1013ffcb74de021711223b">NvmeZoneReportHeader</a>);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">for</span> (; zone_idx &lt; n-&gt;<a class="code" href="structFemuCtrl.html#a101d7d739551ef1fafb2df650b9cf155">num_zones</a> &amp;&amp; max_zones &gt; 0; zone_idx++) {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        zone = &amp;n-&gt;<a class="code" href="structFemuCtrl.html#aaad2dc59565b90a54c8b118032d67801">zone_array</a>[zone_idx];</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="zns_8c.html#a81321b3c5f8d3e0069c181e2dfa4f452">zns_zone_matches_filter</a>(zrasf, zone)) {</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            z = (<a class="code" href="structNvmeZoneDescr.html">NvmeZoneDescr</a> *)buf_p;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            buf_p += <span class="keyword">sizeof</span>(<a class="code" href="zns_8h.html#af6b7cd466fb58a480d24a7c8ed1fb2ee">NvmeZoneDescr</a>);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160; </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            z-&gt;<a class="code" href="structNvmeZoneDescr.html#a068bbc643247a8243a5c8aaaa7e9380b">zt</a> = zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#a068bbc643247a8243a5c8aaaa7e9380b">zt</a>;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            z-&gt;<a class="code" href="structNvmeZoneDescr.html#a8a7ee2fa67d9368e1a3eb9b8a72f0759">zs</a> = zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#a8a7ee2fa67d9368e1a3eb9b8a72f0759">zs</a>;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            z-&gt;<a class="code" href="structNvmeZoneDescr.html#a5360d246a3f047192480695171e0d37f">zcap</a> = cpu_to_le64(zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#a5360d246a3f047192480695171e0d37f">zcap</a>);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            z-&gt;<a class="code" href="structNvmeZoneDescr.html#a626c7b988cfde334d69cae1ff7a9fe2c">zslba</a> = cpu_to_le64(zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#a626c7b988cfde334d69cae1ff7a9fe2c">zslba</a>);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            z-&gt;<a class="code" href="structNvmeZoneDescr.html#aad408ac3045c84d106809b7a2b684afd">za</a> = zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#aad408ac3045c84d106809b7a2b684afd">za</a>;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="zns_8h.html#ad064d2d81e65c1f8d539bafbee8cf353">zns_wp_is_valid</a>(zone)) {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                z-&gt;<a class="code" href="structNvmeZoneDescr.html#ada6f1e571b88b3ef9bcd3a70a69c44d4">wp</a> = cpu_to_le64(zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#ada6f1e571b88b3ef9bcd3a70a69c44d4">wp</a>);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                z-&gt;<a class="code" href="structNvmeZoneDescr.html#ada6f1e571b88b3ef9bcd3a70a69c44d4">wp</a> = cpu_to_le64(~0ULL);</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <span class="keywordflow">if</span> (zra == <a class="code" href="zns_8h.html#a175b9ee53a65f84e7ede4410eca5686cad3280c3e4f22285e4865aff0184b7144">NVME_ZONE_REPORT_EXTENDED</a>) {</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                <span class="keywordflow">if</span> (zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#aad408ac3045c84d106809b7a2b684afd">za</a> &amp; <a class="code" href="zns_8h.html#a5b5faae59db38c0e3b1c5c6be4f90e99a0befe230ab3de39e04876554c3506be3">NVME_ZA_ZD_EXT_VALID</a>) {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                    memcpy(buf_p, <a class="code" href="zns_8h.html#af2c9d24f2afaea78ba6081a0cbb5c6cf">zns_get_zd_extension</a>(ns, zone_idx),</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                           n-&gt;<a class="code" href="structFemuCtrl.html#ac31c5055e8db3e4124d1bceb15d16f6b">zd_extension_size</a>);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                }</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                buf_p += n-&gt;<a class="code" href="structFemuCtrl.html#ac31c5055e8db3e4124d1bceb15d16f6b">zd_extension_size</a>;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            max_zones--;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    status = <a class="code" href="dma_8c.html#a83e01cb3ebf3721ca1fd024940ed6aa6">dma_read_prp</a>(n, (uint8_t *)buf, data_size, prp1, prp2);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    g_free(buf);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a6e03af0f3d0b7c597d9137a0b18bca56_cgraph.png" border="0" usemap="#zns_8c_a6e03af0f3d0b7c597d9137a0b18bca56_cgraph" alt=""/></div>
<map name="zns_8c_a6e03af0f3d0b7c597d9137a0b18bca56_cgraph" id="zns_8c_a6e03af0f3d0b7c597d9137a0b18bca56_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,168,184"/>
<area shape="rect" href="dma_8c.html#a83e01cb3ebf3721ca1fd024940ed6aa6" title=" " alt="" coords="267,5,382,32"/>
<area shape="rect" href="nvme_8h.html#ae412c484b40ac7903597a299757a7a83" title=" " alt="" coords="253,56,397,83"/>
<area shape="rect" href="zns_8c.html#a6719fe173fec9e6e538ab3f449491bd2" title=" " alt="" coords="216,107,433,133"/>
<area shape="rect" href="zns_8h.html#af2c9d24f2afaea78ba6081a0cbb5c6cf" title=" " alt="" coords="242,157,407,184"/>
<area shape="rect" href="zns_8h.html#a0b9c3e6b619d9dca6883a7fe3cb4daa9" title=" " alt="" coords="271,208,379,235"/>
<area shape="rect" href="zns_8h.html#ad064d2d81e65c1f8d539bafbee8cf353" title=" " alt="" coords="261,259,388,285"/>
<area shape="rect" href="zns_8c.html#a81321b3c5f8d3e0069c181e2dfa4f452" title=" " alt="" coords="233,309,416,336"/>
<area shape="rect" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493" title=" " alt="" coords="495,5,618,32"/>
<area shape="rect" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484" title=" " alt="" coords="680,5,811,32"/>
<area shape="rect" href="zns_8c.html#a755fef089b9a7fc5ddd4be2d53455955" title=" " alt="" coords="502,107,611,133"/>
<area shape="rect" href="zns_8h.html#a63a81710dc2a7e2e61f2b7ace02a538a" title=" " alt="" coords="503,208,611,235"/>
<area shape="rect" href="zns_8h.html#a04721281dcdb77acc610b362cb5085ad" title=" " alt="" coords="696,208,795,235"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="481,284,632,311"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a6e03af0f3d0b7c597d9137a0b18bca56_icgraph.png" border="0" usemap="#zns_8c_a6e03af0f3d0b7c597d9137a0b18bca56_icgraph" alt=""/></div>
<map name="zns_8c_a6e03af0f3d0b7c597d9137a0b18bca56_icgraph" id="zns_8c_a6e03af0f3d0b7c597d9137a0b18bca56_icgraph">
<area shape="rect" title=" " alt="" coords="929,5,1092,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="afbd33ad1ba3c29a67e6f3f7d2d63859c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbd33ad1ba3c29a67e6f3f7d2d63859c">&#9670;&nbsp;</a></span>zns_zone_mgmt_send()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t zns_zone_mgmt_send </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structFemuCtrl.html">FemuCtrl</a> *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structNvmeRequest.html">NvmeRequest</a> *&#160;</td>
          <td class="paramname"><em>req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;{</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <a class="code" href="structNvmeCmd.html">NvmeCmd</a> *cmd = (<a class="code" href="structNvmeCmd.html">NvmeCmd</a> *)&amp;req-&gt;<a class="code" href="structNvmeRequest.html#a335e5b18fb079480b1b1a1f06652c647">cmd</a>;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <a class="code" href="structNvmeNamespace.html">NvmeNamespace</a> *ns = req-&gt;<a class="code" href="structNvmeRequest.html#a3609469c3f31833cb86006bae283e160">ns</a>;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    uint64_t prp1 = le64_to_cpu(cmd-&gt;<a class="code" href="structNvmeCmd.html#a3b34c627a05e2a86edf1a93567422c8c">dptr</a>.<a class="code" href="unionNvmeCmdDptr.html#aaad95622d868c580eadba6c852bf961d">prp1</a>);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    uint64_t prp2 = le64_to_cpu(cmd-&gt;<a class="code" href="structNvmeCmd.html#a3b34c627a05e2a86edf1a93567422c8c">dptr</a>.<a class="code" href="unionNvmeCmdDptr.html#a9fc9a97c707652c679097b32ffd84bc3">prp2</a>);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <a class="code" href="structNvmeZone.html">NvmeZone</a> *zone;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    uintptr_t *resets;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    uint8_t *zd_ext;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    uint32_t dw13 = le32_to_cpu(cmd-&gt;<a class="code" href="structNvmeCmd.html#abe88eab6edc75248f89446542ae46eed">cdw13</a>);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    uint64_t slba = 0;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    uint32_t zone_idx = 0;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    uint16_t status;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    uint8_t action;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordtype">bool</span> all;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keyword">enum</span> <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500c">NvmeZoneProcessingMask</a> proc_mask = <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca0f07a84b957a078ed2a401ebdee9fc0d">NVME_PROC_CURRENT_ZONE</a>;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    action = dw13 &amp; 0xff;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    all = dw13 &amp; 0x100;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    req-&gt;<a class="code" href="structNvmeRequest.html#a6c614d6e18850245fb2b05f087c4cc71">status</a> = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">if</span> (!all) {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        status = <a class="code" href="zns_8c.html#a6719fe173fec9e6e538ab3f449491bd2">zns_get_mgmt_zone_slba_idx</a>(n, cmd, &amp;slba, &amp;zone_idx);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        }</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    zone = &amp;n-&gt;<a class="code" href="structFemuCtrl.html#aaad2dc59565b90a54c8b118032d67801">zone_array</a>[zone_idx];</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">if</span> (slba != zone-&gt;<a class="code" href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">d</a>.<a class="code" href="structNvmeZoneDescr.html#a626c7b988cfde334d69cae1ff7a9fe2c">zslba</a>) {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">switch</span> (action) {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#aaa8cc4b8399a19cd06d0f905ee30206bad14bc4f2128512e5370d033f7a11368c">NVME_ZONE_ACTION_OPEN</a>:</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="keywordflow">if</span> (all) {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            proc_mask = <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca18d09cd4a0933aceda32e432dd97faf8">NVME_PROC_CLOSED_ZONES</a>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        status = <a class="code" href="zns_8c.html#a48ae04e0f8dcb34ff3803282d5b0ad17">zns_do_zone_op</a>(ns, zone, proc_mask, <a class="code" href="zns_8c.html#aea339e52add6067aeb466ab8b0f56a1d">zns_open_zone</a>, req);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#aaa8cc4b8399a19cd06d0f905ee30206ba07ee30b06c2463c2264f7c73f2179674">NVME_ZONE_ACTION_CLOSE</a>:</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordflow">if</span> (all) {</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            proc_mask = <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca3606a12acd83bf8178443ffaa3e72ac9">NVME_PROC_OPENED_ZONES</a>;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        status = <a class="code" href="zns_8c.html#a48ae04e0f8dcb34ff3803282d5b0ad17">zns_do_zone_op</a>(ns, zone, proc_mask, <a class="code" href="zns_8c.html#af29e49b46b70e9dc142f1bb3bf7e65da">zns_close_zone</a>, req);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#aaa8cc4b8399a19cd06d0f905ee30206ba011be216afb1020ab9d50fea6164cd1b">NVME_ZONE_ACTION_FINISH</a>:</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="keywordflow">if</span> (all) {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            proc_mask = <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca3606a12acd83bf8178443ffaa3e72ac9">NVME_PROC_OPENED_ZONES</a> | <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca18d09cd4a0933aceda32e432dd97faf8">NVME_PROC_CLOSED_ZONES</a>;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        }</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        status = <a class="code" href="zns_8c.html#a48ae04e0f8dcb34ff3803282d5b0ad17">zns_do_zone_op</a>(ns, zone, proc_mask, <a class="code" href="zns_8c.html#ad642783946555e5f78ea1651c02404cb">zns_finish_zone</a>, req);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#aaa8cc4b8399a19cd06d0f905ee30206ba3f1b6afd3836d3050b2c0c1e3f8af672">NVME_ZONE_ACTION_RESET</a>:</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        resets = (uintptr_t *)&amp;req-&gt;<a class="code" href="structNvmeRequest.html#ac97874623323ab8b0699246da22eb696">opaque</a>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        if (all) {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            proc_mask = <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca3606a12acd83bf8178443ffaa3e72ac9">NVME_PROC_OPENED_ZONES</a> | <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca18d09cd4a0933aceda32e432dd97faf8">NVME_PROC_CLOSED_ZONES</a> |</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca3bed639d7837a92a297e4df431c7ed9f">NVME_PROC_FULL_ZONES</a>;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        *resets = 1;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        status = <a class="code" href="zns_8c.html#a48ae04e0f8dcb34ff3803282d5b0ad17">zns_do_zone_op</a>(ns, zone, proc_mask, <a class="code" href="zns_8c.html#a7c7e09c6f357c1f77c724c664f6c0128">zns_reset_zone</a>, req);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        (*resets)--;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#aaa8cc4b8399a19cd06d0f905ee30206baf20618c3c1b0653fe4075b072cd6409a">NVME_ZONE_ACTION_OFFLINE</a>:</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="keywordflow">if</span> (all) {</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            proc_mask = <a class="code" href="zns_8c.html#a0759e855e2f759918191c8abe275500ca03e0191366f1f0b541aed2014625d6d2">NVME_PROC_READ_ONLY_ZONES</a>;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        status = <a class="code" href="zns_8c.html#a48ae04e0f8dcb34ff3803282d5b0ad17">zns_do_zone_op</a>(ns, zone, proc_mask, <a class="code" href="zns_8c.html#a21f29cc79d1f772a1244c0f512171c0a">zns_offline_zone</a>, req);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="zns_8h.html#aaa8cc4b8399a19cd06d0f905ee30206bab89ed14a825ba30c52e5f5ef3829e375">NVME_ZONE_ACTION_SET_ZD_EXT</a>:</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="keywordflow">if</span> (all || !n-&gt;<a class="code" href="structFemuCtrl.html#ac31c5055e8db3e4124d1bceb15d16f6b">zd_extension_size</a>) {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a> | <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        zd_ext = <a class="code" href="zns_8h.html#af2c9d24f2afaea78ba6081a0cbb5c6cf">zns_get_zd_extension</a>(ns, zone_idx);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        status = <a class="code" href="dma_8c.html#adef0f21bc237d992b4ae8b29258645a8">dma_write_prp</a>(n, (uint8_t *)zd_ext, n-&gt;<a class="code" href="structFemuCtrl.html#ac31c5055e8db3e4124d1bceb15d16f6b">zd_extension_size</a>, prp1,</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                               prp2);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        status = <a class="code" href="zns_8c.html#a52eacdcbc504ab2769e6b194295e2355">zns_set_zd_ext</a>(ns, zone);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <span class="keywordflow">if</span> (status == <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a>) {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        status = <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160; </div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">if</span> (status) {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        status |= <a class="code" href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_afbd33ad1ba3c29a67e6f3f7d2d63859c_cgraph.png" border="0" usemap="#zns_8c_afbd33ad1ba3c29a67e6f3f7d2d63859c_cgraph" alt=""/></div>
<map name="zns_8c_afbd33ad1ba3c29a67e6f3f7d2d63859c_cgraph" id="zns_8c_afbd33ad1ba3c29a67e6f3f7d2d63859c_cgraph">
<area shape="rect" title=" " alt="" coords="5,233,172,260"/>
<area shape="rect" href="dma_8c.html#adef0f21bc237d992b4ae8b29258645a8" title=" " alt="" coords="269,5,388,32"/>
<area shape="rect" href="zns_8c.html#af29e49b46b70e9dc142f1bb3bf7e65da" title=" " alt="" coords="509,107,632,133"/>
<area shape="rect" href="zns_8c.html#a48ae04e0f8dcb34ff3803282d5b0ad17" title=" " alt="" coords="507,512,635,539"/>
<area shape="rect" href="zns_8c.html#ad642783946555e5f78ea1651c02404cb" title=" " alt="" coords="509,56,633,83"/>
<area shape="rect" href="zns_8c.html#a6719fe173fec9e6e538ab3f449491bd2" title=" " alt="" coords="220,208,437,235"/>
<area shape="rect" href="zns_8h.html#af2c9d24f2afaea78ba6081a0cbb5c6cf" title=" " alt="" coords="246,259,411,285"/>
<area shape="rect" href="zns_8c.html#a21f29cc79d1f772a1244c0f512171c0a" title=" " alt="" coords="263,309,394,336"/>
<area shape="rect" href="zns_8c.html#aea339e52add6067aeb466ab8b0f56a1d" title=" " alt="" coords="510,348,631,375"/>
<area shape="rect" href="zns_8c.html#a7c7e09c6f357c1f77c724c664f6c0128" title=" " alt="" coords="267,157,390,184"/>
<area shape="rect" href="zns_8c.html#a52eacdcbc504ab2769e6b194295e2355" title=" " alt="" coords="510,411,631,437"/>
<area shape="rect" href="dma_8c.html#aff05c76845a6cc08d0131d2761153493" title=" " alt="" coords="509,5,632,32"/>
<area shape="rect" href="dma_8c.html#a0ac25a907651fbfbf9710b15dc45e484" title=" " alt="" coords="725,5,856,32"/>
<area shape="rect" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b" title=" " alt="" coords="720,107,861,133"/>
<area shape="rect" href="zns_8c.html#a819d2621fbd145acef21bd41486156a3" title=" " alt="" coords="705,259,876,285"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="925,461,1076,488"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="926,259,1075,285"/>
<area shape="rect" href="zns_8c.html#aa9deb4d27a553448ab81440798d09fb7" title=" " alt="" coords="715,512,867,539"/>
<area shape="rect" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16" title=" " alt="" coords="716,208,865,235"/>
<area shape="rect" href="zns_8h.html#a1f2a423f30678b841f4aaf3f09d0e7de" title=" " alt="" coords="704,56,877,83"/>
<area shape="rect" href="zns_8c.html#a755fef089b9a7fc5ddd4be2d53455955" title=" " alt="" coords="516,208,625,235"/>
<area shape="rect" href="zns_8c.html#a2bd0e00434954d61e13cfe8a65a02e34" title=" " alt="" coords="732,360,849,387"/>
<area shape="rect" href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c" title=" " alt="" coords="718,411,863,437"/>
<area shape="rect" href="zns_8h.html#a456d13e8923adbff0acc0ab45e47ec8f" title=" " alt="" coords="722,309,859,336"/>
<area shape="rect" href="zns_8c.html#a7cf84991a322dded9376491f5d98dedb" title=" " alt="" coords="485,157,656,184"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_afbd33ad1ba3c29a67e6f3f7d2d63859c_icgraph.png" border="0" usemap="#zns_8c_afbd33ad1ba3c29a67e6f3f7d2d63859c_icgraph" alt=""/></div>
<map name="zns_8c_afbd33ad1ba3c29a67e6f3f7d2d63859c_icgraph" id="zns_8c_afbd33ad1ba3c29a67e6f3f7d2d63859c_icgraph">
<area shape="rect" title=" " alt="" coords="929,5,1096,32"/>
<area shape="rect" href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa" title=" " alt="" coords="783,5,881,32"/>
<area shape="rect" href="zns_8c.html#a08aeb05994f79207836886d8a1475372" title=" " alt="" coords="575,5,735,32"/>
<area shape="rect" href="femu_8c.html#a76a47b73caa1fa75fb706e3ed8f16a73" title=" " alt="" coords="332,5,527,32"/>
<area shape="rect" href="femu_8c.html#a966fbeb7afc495936413dbc445a0dd45" title=" " alt="" coords="177,5,284,32"/>
<area shape="rect" href="femu_8c.html#aeb3b70286609648db37222148efcf8d3" title=" " alt="" coords="5,5,129,32"/>
</map>
</div>

</div>
</div>
<a id="a5a340f34f865c916bb163abd16dc637f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a340f34f865c916bb163abd16dc637f">&#9670;&nbsp;</a></span>zns_zoned_ns_shutdown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void zns_zoned_ns_shutdown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structNvmeNamespace.html">NvmeNamespace</a> *&#160;</td>
          <td class="paramname"><em>ns</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;{</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="structFemuCtrl.html">FemuCtrl</a> *n = ns-&gt;<a class="code" href="structNvmeNamespace.html#a8354f38841896795412b089fdfbe1528">ctrl</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="structNvmeZone.html">NvmeZone</a> *zone, *next;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    QTAILQ_FOREACH_SAFE(zone, &amp;n-&gt;closed_zones, entry, next) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        QTAILQ_REMOVE(&amp;n-&gt;closed_zones, zone, entry);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <a class="code" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16">zns_aor_dec_active</a>(ns);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <a class="code" href="zns_8c.html#a8f09f2d274ee382c164ad442bb4f3e47">zns_clear_zone</a>(ns, zone);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    QTAILQ_FOREACH_SAFE(zone, &amp;n-&gt;imp_open_zones, entry, next) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        QTAILQ_REMOVE(&amp;n-&gt;imp_open_zones, zone, entry);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <a class="code" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b">zns_aor_dec_open</a>(ns);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16">zns_aor_dec_active</a>(ns);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="zns_8c.html#a8f09f2d274ee382c164ad442bb4f3e47">zns_clear_zone</a>(ns, zone);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    QTAILQ_FOREACH_SAFE(zone, &amp;n-&gt;exp_open_zones, entry, next) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        QTAILQ_REMOVE(&amp;n-&gt;exp_open_zones, zone, entry);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b">zns_aor_dec_open</a>(ns);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16">zns_aor_dec_active</a>(ns);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <a class="code" href="zns_8c.html#a8f09f2d274ee382c164ad442bb4f3e47">zns_clear_zone</a>(ns, zone);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    assert(n-&gt;<a class="code" href="structFemuCtrl.html#a33144e9a783e4a96c1149c2fc04b4704">nr_open_zones</a> == 0);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
</div><!-- fragment --><div class="dynheader">
函数调用图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a5a340f34f865c916bb163abd16dc637f_cgraph.png" border="0" usemap="#zns_8c_a5a340f34f865c916bb163abd16dc637f_cgraph" alt=""/></div>
<map name="zns_8c_a5a340f34f865c916bb163abd16dc637f_cgraph" id="zns_8c_a5a340f34f865c916bb163abd16dc637f_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,188,83"/>
<area shape="rect" href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16" title=" " alt="" coords="236,5,385,32"/>
<area shape="rect" href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b" title=" " alt="" coords="240,56,381,83"/>
<area shape="rect" href="zns_8c.html#a8f09f2d274ee382c164ad442bb4f3e47" title=" " alt="" coords="250,107,371,133"/>
<area shape="rect" href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c" title=" " alt="" coords="436,56,581,83"/>
<area shape="rect" href="zns_8h.html#a677294d02c732b61b18d610041851e4b" title=" " alt="" coords="433,107,584,133"/>
<area shape="rect" href="zns_8h.html#afdc856385776185b67188b43c7569469" title=" " alt="" coords="434,157,583,184"/>
</map>
</div>
<div class="dynheader">
这是这个函数的调用关系图:</div>
<div class="dyncontent">
<div class="center"><img src="zns_8c_a5a340f34f865c916bb163abd16dc637f_icgraph.png" border="0" usemap="#zns_8c_a5a340f34f865c916bb163abd16dc637f_icgraph" alt=""/></div>
<map name="zns_8c_a5a340f34f865c916bb163abd16dc637f_icgraph" id="zns_8c_a5a340f34f865c916bb163abd16dc637f_icgraph">
<area shape="rect" title=" " alt="" coords="189,5,372,32"/>
<area shape="rect" href="zns_8h.html#a23ed6cd90a43d43bad4b9196673fd1bf" title=" " alt="" coords="5,5,141,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="adma_8c_html_adef0f21bc237d992b4ae8b29258645a8"><div class="ttname"><a href="dma_8c.html#adef0f21bc237d992b4ae8b29258645a8">dma_write_prp</a></div><div class="ttdeci">uint16_t dma_write_prp(FemuCtrl *n, uint8_t *ptr, uint32_t len, uint64_t prp1, uint64_t prp2)</div><div class="ttdef"><b>Definition:</b> dma.c:112</div></div>
<div class="ttc" id="azns_8h_html_ad7a1a230fc044bbd799963b157b06c96aed799eebe132cead31e3192550f5fafe"><div class="ttname"><a href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96aed799eebe132cead31e3192550f5fafe">NVME_ZONE_REPORT_EXPLICITLY_OPEN</a></div><div class="ttdeci">@ NVME_ZONE_REPORT_EXPLICITLY_OPEN</div><div class="ttdef"><b>Definition:</b> zns.h:36</div></div>
<div class="ttc" id="astructNvmeCmd_html"><div class="ttname"><a href="structNvmeCmd.html">NvmeCmd</a></div><div class="ttdef"><b>Definition:</b> nvme.h:290</div></div>
<div class="ttc" id="astructNvmeCmd_html_a542065d60952eff1b4de0fdf3ecb5b29"><div class="ttname"><a href="structNvmeCmd.html#a542065d60952eff1b4de0fdf3ecb5b29">NvmeCmd::cdw11</a></div><div class="ttdeci">uint32_t cdw11</div><div class="ttdef"><b>Definition:</b> nvme.h:301</div></div>
<div class="ttc" id="azns_8c_html_a52eacdcbc504ab2769e6b194295e2355"><div class="ttname"><a href="zns_8c.html#a52eacdcbc504ab2769e6b194295e2355">zns_set_zd_ext</a></div><div class="ttdeci">static uint16_t zns_set_zd_ext(NvmeNamespace *ns, NvmeZone *zone)</div><div class="ttdef"><b>Definition:</b> zns.c:631</div></div>
<div class="ttc" id="azns_8c_html_a0759e855e2f759918191c8abe275500c"><div class="ttname"><a href="zns_8c.html#a0759e855e2f759918191c8abe275500c">NvmeZoneProcessingMask</a></div><div class="ttdeci">NvmeZoneProcessingMask</div><div class="ttdef"><b>Definition:</b> zns.c:525</div></div>
<div class="ttc" id="astructNvmeRequest_html_a335e5b18fb079480b1b1a1f06652c647"><div class="ttname"><a href="structNvmeRequest.html#a335e5b18fb079480b1b1a1f06652c647">NvmeRequest::cmd</a></div><div class="ttdeci">NvmeCmd cmd</div><div class="ttdef"><b>Definition:</b> nvme.h:975</div></div>
<div class="ttc" id="anvme_8h_html_a01e3a918ff89282c841471f5d797fbf6a9c323c2099e3f3da156bb6896b824724"><div class="ttname"><a href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a9c323c2099e3f3da156bb6896b824724">NVME_CMD_ZONE_MGMT_SEND</a></div><div class="ttdeci">@ NVME_CMD_ZONE_MGMT_SEND</div><div class="ttdef"><b>Definition:</b> nvme.h:340</div></div>
<div class="ttc" id="astructNvmeZoneDescr_html_aad408ac3045c84d106809b7a2b684afd"><div class="ttname"><a href="structNvmeZoneDescr.html#aad408ac3045c84d106809b7a2b684afd">NvmeZoneDescr::za</a></div><div class="ttdeci">uint8_t za</div><div class="ttdef"><b>Definition:</b> zns.h:61</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a43aae0e0a370dd16186369148885344f"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a43aae0e0a370dd16186369148885344f">NVME_LBA_RANGE</a></div><div class="ttdeci">@ NVME_LBA_RANGE</div><div class="ttdef"><b>Definition:</b> nvme.h:534</div></div>
<div class="ttc" id="azns_8c_html_a12ca668cf37e73d231f247d41d5990f9"><div class="ttname"><a href="zns_8c.html#a12ca668cf37e73d231f247d41d5990f9">zns_init_zoned_state</a></div><div class="ttdeci">static void zns_init_zoned_state(NvmeNamespace *ns)</div><div class="ttdef"><b>Definition:</b> zns.c:84</div></div>
<div class="ttc" id="astructNvmeIdNsZoned_html_a500b54d39a4323d0b3b0445d3b0158ec"><div class="ttname"><a href="structNvmeIdNsZoned.html#a500b54d39a4323d0b3b0445d3b0158ec">NvmeIdNsZoned::mar</a></div><div class="ttdeci">uint32_t mar</div><div class="ttdef"><b>Definition:</b> zns.h:91</div></div>
<div class="ttc" id="astructNvmeIdNs_html_ad67c077eb81ad2014ec2d9217c2c537d"><div class="ttname"><a href="structNvmeIdNs.html#ad67c077eb81ad2014ec2d9217c2c537d">NvmeIdNs::nuse</a></div><div class="ttdeci">uint64_t nuse</div><div class="ttdef"><b>Definition:</b> nvme.h:860</div></div>
<div class="ttc" id="astructFemuCtrl_html_aacb80a44168a3ad90772b9e623dfed94"><div class="ttname"><a href="structFemuCtrl.html#aacb80a44168a3ad90772b9e623dfed94">FemuCtrl::zone_capacity</a></div><div class="ttdeci">uint64_t zone_capacity</div><div class="ttdef"><b>Definition:</b> nvme.h:1198</div></div>
<div class="ttc" id="astructFemuCtrl_html_abb0af9e86a49398d043a81869f2c89da"><div class="ttname"><a href="structFemuCtrl.html#abb0af9e86a49398d043a81869f2c89da">FemuCtrl::zone_size_bs</a></div><div class="ttdeci">uint64_t zone_size_bs</div><div class="ttdef"><b>Definition:</b> nvme.h:1182</div></div>
<div class="ttc" id="azns_8c_html_a61f038c076c83ca5f99341b71c9b8e10"><div class="ttname"><a href="zns_8c.html#a61f038c076c83ca5f99341b71c9b8e10">zns_finalize_zoned_write</a></div><div class="ttdeci">static void zns_finalize_zoned_write(NvmeNamespace *ns, NvmeRequest *req, bool failed)</div><div class="ttdef"><b>Definition:</b> zns.c:435</div></div>
<div class="ttc" id="anvme_8h_html_ae412c484b40ac7903597a299757a7a83"><div class="ttname"><a href="nvme_8h.html#ae412c484b40ac7903597a299757a7a83">nvme_check_mdts</a></div><div class="ttdeci">static uint16_t nvme_check_mdts(FemuCtrl *n, size_t len)</div><div class="ttdef"><b>Definition:</b> nvme.h:1466</div></div>
<div class="ttc" id="astructFemuCtrl_html"><div class="ttname"><a href="structFemuCtrl.html">FemuCtrl</a></div><div class="ttdef"><b>Definition:</b> nvme.h:1170</div></div>
<div class="ttc" id="azns_8c_html_a9674ef207fca784d45d2b13fe63e31f5"><div class="ttname"><a href="zns_8c.html#a9674ef207fca784d45d2b13fe63e31f5">zns_get_zone_by_slba</a></div><div class="ttdeci">static NvmeZone * zns_get_zone_by_slba(NvmeNamespace *ns, uint64_t slba)</div><div class="ttdef"><b>Definition:</b> zns.c:15</div></div>
<div class="ttc" id="azns_8c_html_a05f7689d91910e1a2f865b30a9bc5393"><div class="ttname"><a href="zns_8c.html#a05f7689d91910e1a2f865b30a9bc5393">zns_set_ctrl_str</a></div><div class="ttdeci">static void zns_set_ctrl_str(FemuCtrl *n)</div><div class="ttdef"><b>Definition:</b> zns.c:1240</div></div>
<div class="ttc" id="astructFemuCtrl_html_a2b07accc41de60cd0c6de43adde355ad"><div class="ttname"><a href="structFemuCtrl.html#a2b07accc41de60cd0c6de43adde355ad">FemuCtrl::ext_ops</a></div><div class="ttdeci">FemuExtCtrlOps ext_ops</div><div class="ttdef"><b>Definition:</b> nvme.h:1206</div></div>
<div class="ttc" id="azns_8h_html_ad7a1a230fc044bbd799963b157b06c96a92520822547e2ce8c33ec460a94d4240"><div class="ttname"><a href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96a92520822547e2ce8c33ec460a94d4240">NVME_ZONE_REPORT_FULL</a></div><div class="ttdeci">@ NVME_ZONE_REPORT_FULL</div><div class="ttdef"><b>Definition:</b> zns.h:38</div></div>
<div class="ttc" id="azns_8c_html_a84203495e6de57d698b7e393f7106984"><div class="ttname"><a href="zns_8c.html#a84203495e6de57d698b7e393f7106984">zns_do_write</a></div><div class="ttdeci">static uint16_t zns_do_write(FemuCtrl *n, NvmeRequest *req, bool append, bool wrz)</div><div class="ttdef"><b>Definition:</b> zns.c:1036</div></div>
<div class="ttc" id="azns_8c_html_ab23b42610e0276e68ccaac4d13e18bfa"><div class="ttname"><a href="zns_8c.html#ab23b42610e0276e68ccaac4d13e18bfa">zns_io_cmd</a></div><div class="ttdeci">static uint16_t zns_io_cmd(FemuCtrl *n, NvmeNamespace *ns, NvmeCmd *cmd, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> zns.c:1221</div></div>
<div class="ttc" id="azns_8h_html_a0b9c3e6b619d9dca6883a7fe3cb4daa9"><div class="ttname"><a href="zns_8h.html#a0b9c3e6b619d9dca6883a7fe3cb4daa9">zns_ns_nlbas</a></div><div class="ttdeci">static uint64_t zns_ns_nlbas(NvmeNamespace *ns)</div><div class="ttdef"><b>Definition:</b> zns.h:142</div></div>
<div class="ttc" id="astructNvmeIdNsZoned_html_a939eab059a9bb921f2c63b5f426ca700"><div class="ttname"><a href="structNvmeIdNsZoned.html#a939eab059a9bb921f2c63b5f426ca700">NvmeIdNsZoned::lbafe</a></div><div class="ttdeci">NvmeLBAFE lbafe[16]</div><div class="ttdef"><b>Definition:</b> zns.h:96</div></div>
<div class="ttc" id="arte__branch__prediction_8h_html_ac6c45889010c1bd68631771b64f18101"><div class="ttname"><a href="rte__branch__prediction_8h.html#ac6c45889010c1bd68631771b64f18101">unlikely</a></div><div class="ttdeci">#define unlikely(x)</div><div class="ttdef"><b>Definition:</b> rte_branch_prediction.h:38</div></div>
<div class="ttc" id="astructNvmeRequest_html_a678064f3bc45fbeb366ea44aea7273b2"><div class="ttname"><a href="structNvmeRequest.html#a678064f3bc45fbeb366ea44aea7273b2">NvmeRequest::qsg</a></div><div class="ttdeci">QEMUSGList qsg</div><div class="ttdef"><b>Definition:</b> nvme.h:978</div></div>
<div class="ttc" id="azns_8c_html_a5a340f34f865c916bb163abd16dc637f"><div class="ttname"><a href="zns_8c.html#a5a340f34f865c916bb163abd16dc637f">zns_zoned_ns_shutdown</a></div><div class="ttdeci">static void zns_zoned_ns_shutdown(NvmeNamespace *ns)</div><div class="ttdef"><b>Definition:</b> zns.c:182</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4aea82bfe7be2189eb2b5cb5f18cfd50ab"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4aea82bfe7be2189eb2b5cb5f18cfd50ab">NVME_ZONE_INVALID_WRITE</a></div><div class="ttdeci">@ NVME_ZONE_INVALID_WRITE</div><div class="ttdef"><b>Definition:</b> nvme.h:561</div></div>
<div class="ttc" id="astructFemuCtrl_html_ac6e80e0bc39d8878bee79720f0733909"><div class="ttname"><a href="structFemuCtrl.html#ac6e80e0bc39d8878bee79720f0733909">FemuCtrl::zasl_bs</a></div><div class="ttdeci">uint32_t zasl_bs</div><div class="ttdef"><b>Definition:</b> nvme.h:1178</div></div>
<div class="ttc" id="azns_8c_html_a94c5876f1b68a759a109b78003852924"><div class="ttname"><a href="zns_8c.html#a94c5876f1b68a759a109b78003852924">zns_advance_zone_wp</a></div><div class="ttdeci">static uint64_t zns_advance_zone_wp(NvmeNamespace *ns, NvmeZone *zone, uint32_t nlb)</div><div class="ttdef"><b>Definition:</b> zns.c:474</div></div>
<div class="ttc" id="azns_8h_html_aaa8cc4b8399a19cd06d0f905ee30206bad14bc4f2128512e5370d033f7a11368c"><div class="ttname"><a href="zns_8h.html#aaa8cc4b8399a19cd06d0f905ee30206bad14bc4f2128512e5370d033f7a11368c">NVME_ZONE_ACTION_OPEN</a></div><div class="ttdeci">@ NVME_ZONE_ACTION_OPEN</div><div class="ttdef"><b>Definition:</b> zns.h:52</div></div>
<div class="ttc" id="anvme_8h_html_a5d9fde4912328e2ecf4f80e41e1da013"><div class="ttname"><a href="nvme_8h.html#a5d9fde4912328e2ecf4f80e41e1da013">FemuExtCtrlOps</a></div><div class="ttdeci">struct FemuExtCtrlOps FemuExtCtrlOps</div></div>
<div class="ttc" id="astructFemuCtrl_html_aad9ab3272256c2c2a4dea360e3392032"><div class="ttname"><a href="structFemuCtrl.html#aad9ab3272256c2c2a4dea360e3392032">FemuCtrl::zd_extensions</a></div><div class="ttdeci">uint8_t * zd_extensions</div><div class="ttdef"><b>Definition:</b> nvme.h:1200</div></div>
<div class="ttc" id="astructNvmeZone_html"><div class="ttname"><a href="structNvmeZone.html">NvmeZone</a></div><div class="ttdef"><b>Definition:</b> zns.h:101</div></div>
<div class="ttc" id="azns_8c_html_a841382c8c3024053a641811800230a23"><div class="ttname"><a href="zns_8c.html#a841382c8c3024053a641811800230a23">zns_check_zone_state_for_write</a></div><div class="ttdeci">static uint16_t zns_check_zone_state_for_write(NvmeZone *zone)</div><div class="ttdef"><b>Definition:</b> zns.c:289</div></div>
<div class="ttc" id="azns_8h_html_a686c1e6209d4c3eaf3897e73484bdf9f"><div class="ttname"><a href="zns_8h.html#a686c1e6209d4c3eaf3897e73484bdf9f">zns_l2b</a></div><div class="ttdeci">static size_t zns_l2b(NvmeNamespace *ns, uint64_t lba)</div><div class="ttdef"><b>Definition:</b> zns.h:148</div></div>
<div class="ttc" id="astructFemuCtrl_html_a8dc93dbc4b721983afa203722a769e7a"><div class="ttname"><a href="structFemuCtrl.html#a8dc93dbc4b721983afa203722a769e7a">FemuCtrl::zasl</a></div><div class="ttdeci">uint8_t zasl</div><div class="ttdef"><b>Definition:</b> nvme.h:1179</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a6bf2d17d215aefaee1b47f4af6e6b6b6"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a6bf2d17d215aefaee1b47f4af6e6b6b6">NVME_ZONE_OFFLINE</a></div><div class="ttdeci">@ NVME_ZONE_OFFLINE</div><div class="ttdef"><b>Definition:</b> nvme.h:560</div></div>
<div class="ttc" id="azns_8h_html_a2e93736ade251765711cae3a888e25b9"><div class="ttname"><a href="zns_8h.html#a2e93736ade251765711cae3a888e25b9">NvmeZoneState</a></div><div class="ttdeci">NvmeZoneState</div><div class="ttdef"><b>Definition:</b> zns.h:69</div></div>
<div class="ttc" id="azns_8c_html_a7cf84991a322dded9376491f5d98dedb"><div class="ttname"><a href="zns_8c.html#a7cf84991a322dded9376491f5d98dedb">zns_aio_zone_reset_cb</a></div><div class="ttdeci">static void zns_aio_zone_reset_cb(NvmeRequest *req, NvmeZone *zone)</div><div class="ttdef"><b>Definition:</b> zns.c:502</div></div>
<div class="ttc" id="adram_8c_html_a1ccbcf0c92b7b084afc9890f3a7e5799"><div class="ttname"><a href="dram_8c.html#a1ccbcf0c92b7b084afc9890f3a7e5799">backend_rw</a></div><div class="ttdeci">int backend_rw(SsdDramBackend *b, QEMUSGList *qsg, uint64_t *lbal, bool is_write)</div><div class="ttdef"><b>Definition:</b> dram.c:29</div></div>
<div class="ttc" id="astructNvmeCmd_html_abe88eab6edc75248f89446542ae46eed"><div class="ttname"><a href="structNvmeCmd.html#abe88eab6edc75248f89446542ae46eed">NvmeCmd::cdw13</a></div><div class="ttdeci">uint32_t cdw13</div><div class="ttdef"><b>Definition:</b> nvme.h:303</div></div>
<div class="ttc" id="astructNvmeRequest_html_a6c614d6e18850245fb2b05f087c4cc71"><div class="ttname"><a href="structNvmeRequest.html#a6c614d6e18850245fb2b05f087c4cc71">NvmeRequest::status</a></div><div class="ttdeci">uint16_t status</div><div class="ttdef"><b>Definition:</b> nvme.h:965</div></div>
<div class="ttc" id="anvme_8h_html_a2342f477442526e6bc2aa046f9bd4a94a64b23085931f2a85c7105d303bb4a495"><div class="ttname"><a href="nvme_8h.html#a2342f477442526e6bc2aa046f9bd4a94a64b23085931f2a85c7105d303bb4a495">NVME_CSI_ZONED</a></div><div class="ttdeci">@ NVME_CSI_ZONED</div><div class="ttdef"><b>Definition:</b> nvme.h:119</div></div>
<div class="ttc" id="azns_8c_html_ad642783946555e5f78ea1651c02404cb"><div class="ttname"><a href="zns_8c.html#ad642783946555e5f78ea1651c02404cb">zns_finish_zone</a></div><div class="ttdeci">static uint16_t zns_finish_zone(NvmeNamespace *ns, NvmeZone *zone, NvmeZoneState state, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> zns.c:578</div></div>
<div class="ttc" id="azns_8h_html_a2e93736ade251765711cae3a888e25b9afc7fe17858da6497474a2307ab239967"><div class="ttname"><a href="zns_8h.html#a2e93736ade251765711cae3a888e25b9afc7fe17858da6497474a2307ab239967">NVME_ZONE_STATE_FULL</a></div><div class="ttdeci">@ NVME_ZONE_STATE_FULL</div><div class="ttdef"><b>Definition:</b> zns.h:76</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a3268f6be90861f0c2270d86a44d5b09c">NVME_SUCCESS</a></div><div class="ttdeci">@ NVME_SUCCESS</div><div class="ttdef"><b>Definition:</b> nvme.h:520</div></div>
<div class="ttc" id="azns_8c_html_a7c7e09c6f357c1f77c724c664f6c0128"><div class="ttname"><a href="zns_8c.html#a7c7e09c6f357c1f77c724c664f6c0128">zns_reset_zone</a></div><div class="ttdeci">static uint16_t zns_reset_zone(NvmeNamespace *ns, NvmeZone *zone, NvmeZoneState state, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> zns.c:598</div></div>
<div class="ttc" id="azns_8h_html_a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08"><div class="ttname"><a href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a21cdc4c6354dc259071ac0f4d16a4c08">NVME_ZONE_STATE_EMPTY</a></div><div class="ttdeci">@ NVME_ZONE_STATE_EMPTY</div><div class="ttdef"><b>Definition:</b> zns.h:71</div></div>
<div class="ttc" id="astructNvmeRwCmd_html_a0f256de361f51a961d5a44955321b526"><div class="ttname"><a href="structNvmeRwCmd.html#a0f256de361f51a961d5a44955321b526">NvmeRwCmd::slba</a></div><div class="ttdeci">uint64_t slba</div><div class="ttdef"><b>Definition:</b> nvme.h:424</div></div>
<div class="ttc" id="anvme_8h_html_aa0cbe71eec16c64680b81f88140fa928"><div class="ttname"><a href="nvme_8h.html#aa0cbe71eec16c64680b81f88140fa928">NVME_ERR_REC_DULBE</a></div><div class="ttdeci">#define NVME_ERR_REC_DULBE(err_rec)</div><div class="ttdef"><b>Definition:</b> nvme.h:807</div></div>
<div class="ttc" id="astructFemuCtrl_html_afdc1d22ac9fbea382272a39bfdd52db7"><div class="ttname"><a href="structFemuCtrl.html#afdc1d22ac9fbea382272a39bfdd52db7">FemuCtrl::zone_size_log2</a></div><div class="ttdeci">uint32_t zone_size_log2</div><div class="ttdef"><b>Definition:</b> nvme.h:1199</div></div>
<div class="ttc" id="azns_8h_html_a2e93736ade251765711cae3a888e25b9a5a871630ac0aaff6794aaed5587d7fd3"><div class="ttname"><a href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a5a871630ac0aaff6794aaed5587d7fd3">NVME_ZONE_STATE_OFFLINE</a></div><div class="ttdeci">@ NVME_ZONE_STATE_OFFLINE</div><div class="ttdef"><b>Definition:</b> zns.h:77</div></div>
<div class="ttc" id="astructNvmeIdNs_html_a253f93bc4614efc3b4c21732ea40d36f"><div class="ttname"><a href="structNvmeIdNs.html#a253f93bc4614efc3b4c21732ea40d36f">NvmeIdNs::npdg</a></div><div class="ttdeci">uint16_t npdg</div><div class="ttdef"><b>Definition:</b> nvme.h:881</div></div>
<div class="ttc" id="astructOc12IdAddrFormat_html_a732423af24585adde3b4003bfed623a2"><div class="ttname"><a href="structOc12IdAddrFormat.html#a732423af24585adde3b4003bfed623a2">Oc12IdAddrFormat::res</a></div><div class="ttdeci">uint8_t res[4]</div><div class="ttdef"><b>Definition:</b> oc12.h:105</div></div>
<div class="ttc" id="astructFemuCtrl_html_a4bd5012806e5cda6eb475cb787f4be3d"><div class="ttname"><a href="structFemuCtrl.html#a4bd5012806e5cda6eb475cb787f4be3d">FemuCtrl::features</a></div><div class="ttdeci">NvmeFeatureVal features</div><div class="ttdef"><b>Definition:</b> nvme.h:1270</div></div>
<div class="ttc" id="azns_8c_html_a0759e855e2f759918191c8abe275500ca03e0191366f1f0b541aed2014625d6d2"><div class="ttname"><a href="zns_8c.html#a0759e855e2f759918191c8abe275500ca03e0191366f1f0b541aed2014625d6d2">NVME_PROC_READ_ONLY_ZONES</a></div><div class="ttdeci">@ NVME_PROC_READ_ONLY_ZONES</div><div class="ttdef"><b>Definition:</b> zns.c:529</div></div>
<div class="ttc" id="adma_8c_html_a83e01cb3ebf3721ca1fd024940ed6aa6"><div class="ttname"><a href="dma_8c.html#a83e01cb3ebf3721ca1fd024940ed6aa6">dma_read_prp</a></div><div class="ttdeci">uint16_t dma_read_prp(FemuCtrl *n, uint8_t *ptr, uint32_t len, uint64_t prp1, uint64_t prp2)</div><div class="ttdef"><b>Definition:</b> dma.c:137</div></div>
<div class="ttc" id="astructNvmeNamespace_html"><div class="ttname"><a href="structNvmeNamespace.html">NvmeNamespace</a></div><div class="ttdef"><b>Definition:</b> nvme.h:1059</div></div>
<div class="ttc" id="anvme_8h_html_a01e3a918ff89282c841471f5d797fbf6af12c69a9bdf0ad418e4a144ef5424336"><div class="ttname"><a href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6af12c69a9bdf0ad418e4a144ef5424336">NVME_CMD_WRITE</a></div><div class="ttdeci">@ NVME_CMD_WRITE</div><div class="ttdef"><b>Definition:</b> nvme.h:334</div></div>
<div class="ttc" id="azns_8c_html_afbd33ad1ba3c29a67e6f3f7d2d63859c"><div class="ttname"><a href="zns_8c.html#afbd33ad1ba3c29a67e6f3f7d2d63859c">zns_zone_mgmt_send</a></div><div class="ttdeci">static uint16_t zns_zone_mgmt_send(FemuCtrl *n, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> zns.c:769</div></div>
<div class="ttc" id="azns_8h_html_aaa8cc4b8399a19cd06d0f905ee30206bab89ed14a825ba30c52e5f5ef3829e375"><div class="ttname"><a href="zns_8h.html#aaa8cc4b8399a19cd06d0f905ee30206bab89ed14a825ba30c52e5f5ef3829e375">NVME_ZONE_ACTION_SET_ZD_EXT</a></div><div class="ttdeci">@ NVME_ZONE_ACTION_SET_ZD_EXT</div><div class="ttdef"><b>Definition:</b> zns.h:55</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a885e33aaef46f9a32806fd9d576167a1">NVME_DNR</a></div><div class="ttdeci">@ NVME_DNR</div><div class="ttdef"><b>Definition:</b> nvme.h:575</div></div>
<div class="ttc" id="astructNvmeZoneDescr_html_a068bbc643247a8243a5c8aaaa7e9380b"><div class="ttname"><a href="structNvmeZoneDescr.html#a068bbc643247a8243a5c8aaaa7e9380b">NvmeZoneDescr::zt</a></div><div class="ttdeci">uint8_t zt</div><div class="ttdef"><b>Definition:</b> zns.h:59</div></div>
<div class="ttc" id="azns_8h_html_afdc856385776185b67188b43c7569469"><div class="ttname"><a href="zns_8h.html#afdc856385776185b67188b43c7569469">zns_set_zone_state</a></div><div class="ttdeci">static void zns_set_zone_state(NvmeZone *zone, NvmeZoneState state)</div><div class="ttdef"><b>Definition:</b> zns.h:158</div></div>
<div class="ttc" id="astructNvmeZoneDescr_html_a8a7ee2fa67d9368e1a3eb9b8a72f0759"><div class="ttname"><a href="structNvmeZoneDescr.html#a8a7ee2fa67d9368e1a3eb9b8a72f0759">NvmeZoneDescr::zs</a></div><div class="ttdeci">uint8_t zs</div><div class="ttdef"><b>Definition:</b> zns.h:60</div></div>
<div class="ttc" id="anvme_8h_html_a2342f477442526e6bc2aa046f9bd4a94a28181a48fe56de9ccab6eb11dd3fc9cc"><div class="ttname"><a href="nvme_8h.html#a2342f477442526e6bc2aa046f9bd4a94a28181a48fe56de9ccab6eb11dd3fc9cc">NVME_CSI_NVM</a></div><div class="ttdeci">@ NVME_CSI_NVM</div><div class="ttdef"><b>Definition:</b> nvme.h:118</div></div>
<div class="ttc" id="azns_8c_html_ac4fd6eccdc41d46c3c9ad323e89019d2"><div class="ttname"><a href="zns_8c.html#ac4fd6eccdc41d46c3c9ad323e89019d2">zns_init_zone_geometry</a></div><div class="ttdeci">static int zns_init_zone_geometry(NvmeNamespace *ns, Error **errp)</div><div class="ttdef"><b>Definition:</b> zns.c:24</div></div>
<div class="ttc" id="astructFemuCtrl_html_ad35028fa04e029ef80fb4da8a501bb02"><div class="ttname"><a href="structFemuCtrl.html#ad35028fa04e029ef80fb4da8a501bb02">FemuCtrl::nr_active_zones</a></div><div class="ttdeci">int32_t nr_active_zones</div><div class="ttdef"><b>Definition:</b> nvme.h:1202</div></div>
<div class="ttc" id="astructNvmeRequest_html_a22a0c24be595ec2abed21073be01efd9"><div class="ttname"><a href="structNvmeRequest.html#a22a0c24be595ec2abed21073be01efd9">NvmeRequest::iov</a></div><div class="ttdeci">QEMUIOVector iov</div><div class="ttdef"><b>Definition:</b> nvme.h:979</div></div>
<div class="ttc" id="azns_8c_html_aa65a4a4ae802bdd6f8cc362247c6325b"><div class="ttname"><a href="zns_8c.html#aa65a4a4ae802bdd6f8cc362247c6325b">zns_init</a></div><div class="ttdeci">static void zns_init(FemuCtrl *n, Error **errp)</div><div class="ttdef"><b>Definition:</b> zns.c:1290</div></div>
<div class="ttc" id="azns_8c_html_a0759e855e2f759918191c8abe275500ca3606a12acd83bf8178443ffaa3e72ac9"><div class="ttname"><a href="zns_8c.html#a0759e855e2f759918191c8abe275500ca3606a12acd83bf8178443ffaa3e72ac9">NVME_PROC_OPENED_ZONES</a></div><div class="ttdeci">@ NVME_PROC_OPENED_ZONES</div><div class="ttdef"><b>Definition:</b> zns.c:527</div></div>
<div class="ttc" id="anvme_8h_html_a01e3a918ff89282c841471f5d797fbf6aa4fe58ce24eda3bf7e1e5e3c22470b30"><div class="ttname"><a href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6aa4fe58ce24eda3bf7e1e5e3c22470b30">NVME_CMD_ZONE_MGMT_RECV</a></div><div class="ttdeci">@ NVME_CMD_ZONE_MGMT_RECV</div><div class="ttdef"><b>Definition:</b> nvme.h:341</div></div>
<div class="ttc" id="azns_8h_html_ad7a1a230fc044bbd799963b157b06c96a41833392f0ae7d34840885a6ed822e57"><div class="ttname"><a href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96a41833392f0ae7d34840885a6ed822e57">NVME_ZONE_REPORT_IMPLICITLY_OPEN</a></div><div class="ttdeci">@ NVME_ZONE_REPORT_IMPLICITLY_OPEN</div><div class="ttdef"><b>Definition:</b> zns.h:35</div></div>
<div class="ttc" id="astructNvmeIdNs_html_a0588b7533fd0a4d1d56fd12b8fb7502d"><div class="ttname"><a href="structNvmeIdNs.html#a0588b7533fd0a4d1d56fd12b8fb7502d">NvmeIdNs::ncap</a></div><div class="ttdeci">uint64_t ncap</div><div class="ttdef"><b>Definition:</b> nvme.h:859</div></div>
<div class="ttc" id="astructNvmeNamespace_html_a8354f38841896795412b089fdfbe1528"><div class="ttname"><a href="structNvmeNamespace.html#a8354f38841896795412b089fdfbe1528">NvmeNamespace::ctrl</a></div><div class="ttdeci">struct FemuCtrl * ctrl</div><div class="ttdef"><b>Definition:</b> nvme.h:1060</div></div>
<div class="ttc" id="astructNvmeNamespace_html_ac5c0ddf3fd8b71e4387062b8a5e1075d"><div class="ttname"><a href="structNvmeNamespace.html#ac5c0ddf3fd8b71e4387062b8a5e1075d">NvmeNamespace::id_ns</a></div><div class="ttdeci">NvmeIdNs id_ns</div><div class="ttdef"><b>Definition:</b> nvme.h:1061</div></div>
<div class="ttc" id="azns_8h_html_a14a74756029b38a3ee3d4bc79383ee6b"><div class="ttname"><a href="zns_8h.html#a14a74756029b38a3ee3d4bc79383ee6b">zns_aor_dec_open</a></div><div class="ttdeci">static void zns_aor_dec_open(NvmeNamespace *ns)</div><div class="ttdef"><b>Definition:</b> zns.h:197</div></div>
<div class="ttc" id="astructNvmeIdNsZoned_html_a9e353280dd471a8ea6cb2c96ff6018e8"><div class="ttname"><a href="structNvmeIdNsZoned.html#a9e353280dd471a8ea6cb2c96ff6018e8">NvmeIdNsZoned::zoc</a></div><div class="ttdeci">uint16_t zoc</div><div class="ttdef"><b>Definition:</b> zns.h:89</div></div>
<div class="ttc" id="azns_8h_html_ad064d2d81e65c1f8d539bafbee8cf353"><div class="ttname"><a href="zns_8h.html#ad064d2d81e65c1f8d539bafbee8cf353">zns_wp_is_valid</a></div><div class="ttdeci">static bool zns_wp_is_valid(NvmeZone *zone)</div><div class="ttdef"><b>Definition:</b> zns.h:173</div></div>
<div class="ttc" id="azns_8h_html_a2e93736ade251765711cae3a888e25b9a65105422decdfd6860779463c8964b55"><div class="ttname"><a href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a65105422decdfd6860779463c8964b55">NVME_ZONE_STATE_EXPLICITLY_OPEN</a></div><div class="ttdeci">@ NVME_ZONE_STATE_EXPLICITLY_OPEN</div><div class="ttdef"><b>Definition:</b> zns.h:73</div></div>
<div class="ttc" id="astructNvmeRequest_html_a3609469c3f31833cb86006bae283e160"><div class="ttname"><a href="structNvmeRequest.html#a3609469c3f31833cb86006bae283e160">NvmeRequest::ns</a></div><div class="ttdeci">struct NvmeNamespace * ns</div><div class="ttdef"><b>Definition:</b> nvme.h:964</div></div>
<div class="ttc" id="anvme-util_8c_html_a9e84e8328646dcb1f24be9c79018e6a0"><div class="ttname"><a href="nvme-util_8c.html#a9e84e8328646dcb1f24be9c79018e6a0">nvme_set_ctrl_name</a></div><div class="ttdeci">void nvme_set_ctrl_name(FemuCtrl *n, const char *mn, const char *sn, int *dev_id)</div><div class="ttdef"><b>Definition:</b> nvme-util.c:282</div></div>
<div class="ttc" id="azns_8h_html_ad7a1a230fc044bbd799963b157b06c96a1470a143eb11896fd977b96133736274"><div class="ttname"><a href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96a1470a143eb11896fd977b96133736274">NVME_ZONE_REPORT_READ_ONLY</a></div><div class="ttdeci">@ NVME_ZONE_REPORT_READ_ONLY</div><div class="ttdef"><b>Definition:</b> zns.h:39</div></div>
<div class="ttc" id="astructFemuCtrl_html_ab5a216b7e1406665640e42409e2c8de8"><div class="ttname"><a href="structFemuCtrl.html#ab5a216b7e1406665640e42409e2c8de8">FemuCtrl::mdts</a></div><div class="ttdeci">uint8_t mdts</div><div class="ttdef"><b>Definition:</b> nvme.h:1228</div></div>
<div class="ttc" id="astructNvmeZoneDescr_html_ada6f1e571b88b3ef9bcd3a70a69c44d4"><div class="ttname"><a href="structNvmeZoneDescr.html#ada6f1e571b88b3ef9bcd3a70a69c44d4">NvmeZoneDescr::wp</a></div><div class="ttdeci">uint64_t wp</div><div class="ttdef"><b>Definition:</b> zns.h:65</div></div>
<div class="ttc" id="azns_8c_html_a48ae04e0f8dcb34ff3803282d5b0ad17"><div class="ttname"><a href="zns_8c.html#a48ae04e0f8dcb34ff3803282d5b0ad17">zns_do_zone_op</a></div><div class="ttdeci">static uint16_t zns_do_zone_op(NvmeNamespace *ns, NvmeZone *zone, enum NvmeZoneProcessingMask proc_mask, op_handler_t op_hndlr, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> zns.c:683</div></div>
<div class="ttc" id="azns_8c_html_a06c9f096d365e730b91eb297bf71961e"><div class="ttname"><a href="zns_8c.html#a06c9f096d365e730b91eb297bf71961e">NVME_DEFAULT_MAX_AZ_SIZE</a></div><div class="ttdeci">#define NVME_DEFAULT_MAX_AZ_SIZE</div><div class="ttdef"><b>Definition:</b> zns.c:5</div></div>
<div class="ttc" id="azns_8c_html_abcb43c9722f5f6a3346b15dfd3872008"><div class="ttname"><a href="zns_8c.html#abcb43c9722f5f6a3346b15dfd3872008">zns_write</a></div><div class="ttdeci">static uint16_t zns_write(FemuCtrl *n, NvmeNamespace *ns, NvmeCmd *cmd, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> zns.c:1165</div></div>
<div class="ttc" id="azns_8c_html_a819d2621fbd145acef21bd41486156a3"><div class="ttname"><a href="zns_8c.html#a819d2621fbd145acef21bd41486156a3">zns_assign_zone_state</a></div><div class="ttdeci">static void zns_assign_zone_state(NvmeNamespace *ns, NvmeZone *zone, NvmeZoneState state)</div><div class="ttdef"><b>Definition:</b> zns.c:226</div></div>
<div class="ttc" id="azns_8c_html_a9a270c9ffa0fb88a1c6d57ecfe3e6815"><div class="ttname"><a href="zns_8c.html#a9a270c9ffa0fb88a1c6d57ecfe3e6815">zns_check_zone_read</a></div><div class="ttdeci">static uint16_t zns_check_zone_read(NvmeNamespace *ns, uint64_t slba, uint32_t nlb)</div><div class="ttdef"><b>Definition:</b> zns.c:369</div></div>
<div class="ttc" id="azns_8c_html_a6719fe173fec9e6e538ab3f449491bd2"><div class="ttname"><a href="zns_8c.html#a6719fe173fec9e6e538ab3f449491bd2">zns_get_mgmt_zone_slba_idx</a></div><div class="ttdeci">static uint16_t zns_get_mgmt_zone_slba_idx(FemuCtrl *n, NvmeCmd *c, uint64_t *slba, uint32_t *zone_idx)</div><div class="ttdef"><b>Definition:</b> zns.c:746</div></div>
<div class="ttc" id="azns_8h_html_a4f19d3f42d1013ffcb74de021711223b"><div class="ttname"><a href="zns_8h.html#a4f19d3f42d1013ffcb74de021711223b">NvmeZoneReportHeader</a></div><div class="ttdeci">struct QEMU_PACKED NvmeZoneReportHeader NvmeZoneReportHeader</div></div>
<div class="ttc" id="astructNvmeCmd_html_ab8451175fd2fa5932757675268633fab"><div class="ttname"><a href="structNvmeCmd.html#ab8451175fd2fa5932757675268633fab">NvmeCmd::cdw12</a></div><div class="ttdeci">uint32_t cdw12</div><div class="ttdef"><b>Definition:</b> nvme.h:302</div></div>
<div class="ttc" id="astructNvmeZone_html_ad456c9d5b78f51ba486371ab73d7465e"><div class="ttname"><a href="structNvmeZone.html#ad456c9d5b78f51ba486371ab73d7465e">NvmeZone::w_ptr</a></div><div class="ttdeci">uint64_t w_ptr</div><div class="ttdef"><b>Definition:</b> zns.h:103</div></div>
<div class="ttc" id="azns_8c_html_ab56987b404fc29d662252ee6f15e9012"><div class="ttname"><a href="zns_8c.html#ab56987b404fc29d662252ee6f15e9012">zns_map_dptr</a></div><div class="ttdeci">static uint16_t zns_map_dptr(FemuCtrl *n, size_t len, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> zns.c:1021</div></div>
<div class="ttc" id="azns_8c_html_af29e49b46b70e9dc142f1bb3bf7e65da"><div class="ttname"><a href="zns_8c.html#af29e49b46b70e9dc142f1bb3bf7e65da">zns_close_zone</a></div><div class="ttdeci">static uint16_t zns_close_zone(NvmeNamespace *ns, NvmeZone *zone, NvmeZoneState state, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> zns.c:563</div></div>
<div class="ttc" id="azns_8h_html_ad7a1a230fc044bbd799963b157b06c96aeb60f762c578dc20b988c5f5d0895cab"><div class="ttname"><a href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96aeb60f762c578dc20b988c5f5d0895cab">NVME_ZONE_REPORT_EMPTY</a></div><div class="ttdeci">@ NVME_ZONE_REPORT_EMPTY</div><div class="ttdef"><b>Definition:</b> zns.h:34</div></div>
<div class="ttc" id="azns_8h_html_aaa8cc4b8399a19cd06d0f905ee30206ba07ee30b06c2463c2264f7c73f2179674"><div class="ttname"><a href="zns_8h.html#aaa8cc4b8399a19cd06d0f905ee30206ba07ee30b06c2463c2264f7c73f2179674">NVME_ZONE_ACTION_CLOSE</a></div><div class="ttdeci">@ NVME_ZONE_ACTION_CLOSE</div><div class="ttdef"><b>Definition:</b> zns.h:50</div></div>
<div class="ttc" id="azns_8h_html_aaa8cc4b8399a19cd06d0f905ee30206ba011be216afb1020ab9d50fea6164cd1b"><div class="ttname"><a href="zns_8h.html#aaa8cc4b8399a19cd06d0f905ee30206ba011be216afb1020ab9d50fea6164cd1b">NVME_ZONE_ACTION_FINISH</a></div><div class="ttdeci">@ NVME_ZONE_ACTION_FINISH</div><div class="ttdef"><b>Definition:</b> zns.h:51</div></div>
<div class="ttc" id="astructNvmeRwCmd_html"><div class="ttname"><a href="structNvmeRwCmd.html">NvmeRwCmd</a></div><div class="ttdef"><b>Definition:</b> nvme.h:415</div></div>
<div class="ttc" id="astructFemuCtrl_html_adaa9832711cd5744244c2cd80e0b027c"><div class="ttname"><a href="structFemuCtrl.html#adaa9832711cd5744244c2cd80e0b027c">FemuCtrl::zone_size</a></div><div class="ttdeci">uint64_t zone_size</div><div class="ttdef"><b>Definition:</b> nvme.h:1197</div></div>
<div class="ttc" id="azns_8c_html_a232d1c0fc6117ae692ff092d05f473e6"><div class="ttname"><a href="zns_8c.html#a232d1c0fc6117ae692ff092d05f473e6">zns_read</a></div><div class="ttdeci">static uint16_t zns_read(FemuCtrl *n, NvmeNamespace *ns, NvmeCmd *cmd, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> zns.c:1116</div></div>
<div class="ttc" id="azns_8c_html_a2bd0e00434954d61e13cfe8a65a02e34"><div class="ttname"><a href="zns_8c.html#a2bd0e00434954d61e13cfe8a65a02e34">zns_aor_check</a></div><div class="ttdeci">static int zns_aor_check(NvmeNamespace *ns, uint32_t act, uint32_t opn)</div><div class="ttdef"><b>Definition:</b> zns.c:274</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4ae600f4ddbb7e75f8a0031c5f2cc78371"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4ae600f4ddbb7e75f8a0031c5f2cc78371">NVME_ZONE_BOUNDARY_ERROR</a></div><div class="ttdeci">@ NVME_ZONE_BOUNDARY_ERROR</div><div class="ttdef"><b>Definition:</b> nvme.h:557</div></div>
<div class="ttc" id="azns_8h_html_a1f2a423f30678b841f4aaf3f09d0e7de"><div class="ttname"><a href="zns_8h.html#a1f2a423f30678b841f4aaf3f09d0e7de">zns_zone_wr_boundary</a></div><div class="ttdeci">static uint64_t zns_zone_wr_boundary(NvmeZone *zone)</div><div class="ttdef"><b>Definition:</b> zns.h:168</div></div>
<div class="ttc" id="azns_8c_html_a88a38b39db2e6829a576bebd97ece799"><div class="ttname"><a href="zns_8c.html#a88a38b39db2e6829a576bebd97ece799">zns_admin_cmd</a></div><div class="ttdeci">static uint16_t zns_admin_cmd(FemuCtrl *n, NvmeCmd *cmd)</div><div class="ttdef"><b>Definition:</b> zns.c:1098</div></div>
<div class="ttc" id="astructNvmeRequest_html_ac97874623323ab8b0699246da22eb696"><div class="ttname"><a href="structNvmeRequest.html#ac97874623323ab8b0699246da22eb696">NvmeRequest::opaque</a></div><div class="ttdeci">void * opaque</div><div class="ttdef"><b>Definition:</b> nvme.h:990</div></div>
<div class="ttc" id="azns_8h_html_aaa8cc4b8399a19cd06d0f905ee30206baf20618c3c1b0653fe4075b072cd6409a"><div class="ttname"><a href="zns_8h.html#aaa8cc4b8399a19cd06d0f905ee30206baf20618c3c1b0653fe4075b072cd6409a">NVME_ZONE_ACTION_OFFLINE</a></div><div class="ttdeci">@ NVME_ZONE_ACTION_OFFLINE</div><div class="ttdef"><b>Definition:</b> zns.h:54</div></div>
<div class="ttc" id="azns_8h_html_a5b5faae59db38c0e3b1c5c6be4f90e99a0befe230ab3de39e04876554c3506be3"><div class="ttname"><a href="zns_8h.html#a5b5faae59db38c0e3b1c5c6be4f90e99a0befe230ab3de39e04876554c3506be3">NVME_ZA_ZD_EXT_VALID</a></div><div class="ttdeci">@ NVME_ZA_ZD_EXT_VALID</div><div class="ttdef"><b>Definition:</b> zns.h:19</div></div>
<div class="ttc" id="astructNvmeRequest_html_a6f04006cddb851afcc919412c6e90b60"><div class="ttname"><a href="structNvmeRequest.html#a6f04006cddb851afcc919412c6e90b60">NvmeRequest::is_write</a></div><div class="ttdeci">uint16_t is_write</div><div class="ttdef"><b>Definition:</b> nvme.h:967</div></div>
<div class="ttc" id="azns_8c_html_a81321b3c5f8d3e0069c181e2dfa4f452"><div class="ttname"><a href="zns_8c.html#a81321b3c5f8d3e0069c181e2dfa4f452">zns_zone_matches_filter</a></div><div class="ttdeci">static bool zns_zone_matches_filter(uint32_t zafs, NvmeZone *zl)</div><div class="ttdef"><b>Definition:</b> zns.c:865</div></div>
<div class="ttc" id="azns_8h_html_aa89459701c0f4b283d7ae01ea614877c"><div class="ttname"><a href="zns_8h.html#aa89459701c0f4b283d7ae01ea614877c">zns_aor_inc_active</a></div><div class="ttdeci">static void zns_aor_inc_active(NvmeNamespace *ns)</div><div class="ttdef"><b>Definition:</b> zns.h:207</div></div>
<div class="ttc" id="astructFemuCtrl_html_af7aabe80b46d1d28417b5f757b25f8d7"><div class="ttname"><a href="structFemuCtrl.html#af7aabe80b46d1d28417b5f757b25f8d7">FemuCtrl::max_active_zones</a></div><div class="ttdeci">uint32_t max_active_zones</div><div class="ttdef"><b>Definition:</b> nvme.h:1184</div></div>
<div class="ttc" id="azns_8c_html_a0759e855e2f759918191c8abe275500ca0f07a84b957a078ed2a401ebdee9fc0d"><div class="ttname"><a href="zns_8c.html#a0759e855e2f759918191c8abe275500ca0f07a84b957a078ed2a401ebdee9fc0d">NVME_PROC_CURRENT_ZONE</a></div><div class="ttdeci">@ NVME_PROC_CURRENT_ZONE</div><div class="ttdef"><b>Definition:</b> zns.c:526</div></div>
<div class="ttc" id="astructNvmeLBAFE_html_aa8a5633997607babbd25a84cc3ab2495"><div class="ttname"><a href="structNvmeLBAFE.html#aa8a5633997607babbd25a84cc3ab2495">NvmeLBAFE::zsze</a></div><div class="ttdeci">uint64_t zsze</div><div class="ttdef"><b>Definition:</b> zns.h:83</div></div>
<div class="ttc" id="azns_8h_html_af2c9d24f2afaea78ba6081a0cbb5c6cf"><div class="ttname"><a href="zns_8h.html#af2c9d24f2afaea78ba6081a0cbb5c6cf">zns_get_zd_extension</a></div><div class="ttdeci">static uint8_t * zns_get_zd_extension(NvmeNamespace *ns, uint32_t zone_idx)</div><div class="ttdef"><b>Definition:</b> zns.h:182</div></div>
<div class="ttc" id="azns_8c_html_a3357eef3f827fdab1d88e5c95ae3c386"><div class="ttname"><a href="zns_8c.html#a3357eef3f827fdab1d88e5c95ae3c386">zns_check_zone_state_for_read</a></div><div class="ttdeci">static uint16_t zns_check_zone_state_for_read(NvmeZone *zone)</div><div class="ttdef"><b>Definition:</b> zns.c:346</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4aa0de61bbc9c674158a3acd6d6abbafd5"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4aa0de61bbc9c674158a3acd6d6abbafd5">NVME_ZONE_TOO_MANY_ACTIVE</a></div><div class="ttdeci">@ NVME_ZONE_TOO_MANY_ACTIVE</div><div class="ttdef"><b>Definition:</b> nvme.h:562</div></div>
<div class="ttc" id="azns_8c_html_af08b9977a8c3f36290e243506b5222d6"><div class="ttname"><a href="zns_8c.html#af08b9977a8c3f36290e243506b5222d6">NVME_DEFAULT_ZONE_SIZE</a></div><div class="ttdeci">#define NVME_DEFAULT_ZONE_SIZE</div><div class="ttdef"><b>Definition:</b> zns.c:4</div></div>
<div class="ttc" id="astructFemuCtrl_html_ade2c007bdb0d6d63de0b2ef92eba5339"><div class="ttname"><a href="structFemuCtrl.html#ade2c007bdb0d6d63de0b2ef92eba5339">FemuCtrl::max_open_zones</a></div><div class="ttdeci">uint32_t max_open_zones</div><div class="ttdef"><b>Definition:</b> nvme.h:1185</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a5fa9131cf96f83f34916a127d8b7d312"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a5fa9131cf96f83f34916a127d8b7d312">NVME_NO_COMPLETE</a></div><div class="ttdeci">@ NVME_NO_COMPLETE</div><div class="ttdef"><b>Definition:</b> nvme.h:576</div></div>
<div class="ttc" id="astructNvmeIdNsZoned_html"><div class="ttname"><a href="structNvmeIdNsZoned.html">NvmeIdNsZoned</a></div><div class="ttdef"><b>Definition:</b> zns.h:88</div></div>
<div class="ttc" id="aoc12_8h_html_a1b0c7bd4d79798ef4e0ce23894c9aeb2"><div class="ttname"><a href="oc12_8h.html#a1b0c7bd4d79798ef4e0ce23894c9aeb2">state</a></div><div class="ttdeci">uint32_t state</div><div class="ttdef"><b>Definition:</b> oc12.h:2</div></div>
<div class="ttc" id="azns_8h_html_a456d13e8923adbff0acc0ab45e47ec8f"><div class="ttname"><a href="zns_8h.html#a456d13e8923adbff0acc0ab45e47ec8f">zns_aor_inc_open</a></div><div class="ttdeci">static void zns_aor_inc_open(NvmeNamespace *ns)</div><div class="ttdef"><b>Definition:</b> zns.h:187</div></div>
<div class="ttc" id="astructNvmeLBAFE_html_ad42d0fa49eccc65d5e9510de7dd38c53"><div class="ttname"><a href="structNvmeLBAFE.html#ad42d0fa49eccc65d5e9510de7dd38c53">NvmeLBAFE::zdes</a></div><div class="ttdeci">uint8_t zdes</div><div class="ttdef"><b>Definition:</b> zns.h:84</div></div>
<div class="ttc" id="astructNvmeCmd_html_a3b34c627a05e2a86edf1a93567422c8c"><div class="ttname"><a href="structNvmeCmd.html#a3b34c627a05e2a86edf1a93567422c8c">NvmeCmd::dptr</a></div><div class="ttdeci">NvmeCmdDptr dptr</div><div class="ttdef"><b>Definition:</b> nvme.h:299</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a778b8f53d6725ef86c455e2e55d46ce7"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a778b8f53d6725ef86c455e2e55d46ce7">NVME_INVALID_OPCODE</a></div><div class="ttdeci">@ NVME_INVALID_OPCODE</div><div class="ttdef"><b>Definition:</b> nvme.h:521</div></div>
<div class="ttc" id="azns_8h_html_aaa8cc4b8399a19cd06d0f905ee30206ba3f1b6afd3836d3050b2c0c1e3f8af672"><div class="ttname"><a href="zns_8h.html#aaa8cc4b8399a19cd06d0f905ee30206ba3f1b6afd3836d3050b2c0c1e3f8af672">NVME_ZONE_ACTION_RESET</a></div><div class="ttdeci">@ NVME_ZONE_ACTION_RESET</div><div class="ttdef"><b>Definition:</b> zns.h:53</div></div>
<div class="ttc" id="azns_8c_html_a0759e855e2f759918191c8abe275500ca18d09cd4a0933aceda32e432dd97faf8"><div class="ttname"><a href="zns_8c.html#a0759e855e2f759918191c8abe275500ca18d09cd4a0933aceda32e432dd97faf8">NVME_PROC_CLOSED_ZONES</a></div><div class="ttdeci">@ NVME_PROC_CLOSED_ZONES</div><div class="ttdef"><b>Definition:</b> zns.c:528</div></div>
<div class="ttc" id="astructNvmeIdNs_html_a37d82bc83c29f8eb8040f48a5262980c"><div class="ttname"><a href="structNvmeIdNs.html#a37d82bc83c29f8eb8040f48a5262980c">NvmeIdNs::nsfeat</a></div><div class="ttdeci">uint8_t nsfeat</div><div class="ttdef"><b>Definition:</b> nvme.h:861</div></div>
<div class="ttc" id="azns_8c_html_a0759e855e2f759918191c8abe275500ca3bed639d7837a92a297e4df431c7ed9f"><div class="ttname"><a href="zns_8c.html#a0759e855e2f759918191c8abe275500ca3bed639d7837a92a297e4df431c7ed9f">NVME_PROC_FULL_ZONES</a></div><div class="ttdeci">@ NVME_PROC_FULL_ZONES</div><div class="ttdef"><b>Definition:</b> zns.c:530</div></div>
<div class="ttc" id="astructNvmeIdNs_html_a4a814e395ae6ea7b3b7c5cba1c22ad85"><div class="ttname"><a href="structNvmeIdNs.html#a4a814e395ae6ea7b3b7c5cba1c22ad85">NvmeIdNs::nsze</a></div><div class="ttdeci">uint64_t nsze</div><div class="ttdef"><b>Definition:</b> nvme.h:858</div></div>
<div class="ttc" id="azns_8c_html_ae9ed91ad4901fe7f2cd4f9df6c333901"><div class="ttname"><a href="zns_8c.html#ae9ed91ad4901fe7f2cd4f9df6c333901">zns_check_bounds</a></div><div class="ttdeci">static uint16_t zns_check_bounds(NvmeNamespace *ns, uint64_t slba, uint32_t nlb)</div><div class="ttdef"><b>Definition:</b> zns.c:1009</div></div>
<div class="ttc" id="azns_8c_html_a54625ca641142f536befa8182db6164e"><div class="ttname"><a href="zns_8c.html#a54625ca641142f536befa8182db6164e">zns_init_zone_identify</a></div><div class="ttdeci">static void zns_init_zone_identify(FemuCtrl *n, NvmeNamespace *ns, int lba_index)</div><div class="ttdef"><b>Definition:</b> zns.c:123</div></div>
<div class="ttc" id="azns_8h_html_ad289f1f71a7a4a355201b3bd3bdb5f16"><div class="ttname"><a href="zns_8h.html#ad289f1f71a7a4a355201b3bd3bdb5f16">zns_aor_dec_active</a></div><div class="ttdeci">static void zns_aor_dec_active(NvmeNamespace *ns)</div><div class="ttdef"><b>Definition:</b> zns.h:217</div></div>
<div class="ttc" id="astructFemuCtrl_html_a0b48d3c6cc09b094369348af59a3b096"><div class="ttname"><a href="structFemuCtrl.html#a0b48d3c6cc09b094369348af59a3b096">FemuCtrl::csi</a></div><div class="ttdeci">uint8_t csi</div><div class="ttdef"><b>Definition:</b> nvme.h:1189</div></div>
<div class="ttc" id="aunionNvmeCmdDptr_html_aaad95622d868c580eadba6c852bf961d"><div class="ttname"><a href="unionNvmeCmdDptr.html#aaad95622d868c580eadba6c852bf961d">NvmeCmdDptr::prp1</a></div><div class="ttdeci">uint64_t prp1</div><div class="ttdef"><b>Definition:</b> nvme.h:277</div></div>
<div class="ttc" id="astructNvmeIdNsZoned_html_ae3a418cba7dee27d904fc063b6312524"><div class="ttname"><a href="structNvmeIdNsZoned.html#ae3a418cba7dee27d904fc063b6312524">NvmeIdNsZoned::mor</a></div><div class="ttdeci">uint32_t mor</div><div class="ttdef"><b>Definition:</b> zns.h:92</div></div>
<div class="ttc" id="azns_8c_html_aea339e52add6067aeb466ab8b0f56a1d"><div class="ttname"><a href="zns_8c.html#aea339e52add6067aeb466ab8b0f56a1d">zns_open_zone</a></div><div class="ttdeci">static uint16_t zns_open_zone(NvmeNamespace *ns, NvmeZone *zone, NvmeZoneState state, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> zns.c:533</div></div>
<div class="ttc" id="astructNvmeIdNsZoned_html_ae5cc4700899bf362fa57a6ee56913bf9"><div class="ttname"><a href="structNvmeIdNsZoned.html#ae5cc4700899bf362fa57a6ee56913bf9">NvmeIdNsZoned::ozcs</a></div><div class="ttdeci">uint16_t ozcs</div><div class="ttdef"><b>Definition:</b> zns.h:90</div></div>
<div class="ttc" id="azns_8h_html_ad7a1a230fc044bbd799963b157b06c96a4c0c7febda38f49b8f19fd9cc2e4fc03"><div class="ttname"><a href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96a4c0c7febda38f49b8f19fd9cc2e4fc03">NVME_ZONE_REPORT_OFFLINE</a></div><div class="ttdeci">@ NVME_ZONE_REPORT_OFFLINE</div><div class="ttdef"><b>Definition:</b> zns.h:40</div></div>
<div class="ttc" id="astructNvmeCmd_html_ab217950fc2408f7a848af10f36b0cd8f"><div class="ttname"><a href="structNvmeCmd.html#ab217950fc2408f7a848af10f36b0cd8f">NvmeCmd::cdw10</a></div><div class="ttdeci">uint32_t cdw10</div><div class="ttdef"><b>Definition:</b> nvme.h:300</div></div>
<div class="ttc" id="astructNvmeCmd_html_a2751bc2a772082d3af81124a1d120a0c"><div class="ttname"><a href="structNvmeCmd.html#a2751bc2a772082d3af81124a1d120a0c">NvmeCmd::opcode</a></div><div class="ttdeci">uint16_t opcode</div><div class="ttdef"><b>Definition:</b> nvme.h:291</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a8afc2d666d7ef8839d71b360fd1087d9"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8afc2d666d7ef8839d71b360fd1087d9">NVME_ZONE_FULL</a></div><div class="ttdeci">@ NVME_ZONE_FULL</div><div class="ttdef"><b>Definition:</b> nvme.h:558</div></div>
<div class="ttc" id="azns_8h_html_a677294d02c732b61b18d610041851e4b"><div class="ttname"><a href="zns_8h.html#a677294d02c732b61b18d610041851e4b">zns_get_zone_state</a></div><div class="ttdeci">static NvmeZoneState zns_get_zone_state(NvmeZone *zone)</div><div class="ttdef"><b>Definition:</b> zns.h:153</div></div>
<div class="ttc" id="astructFemuCtrl_html_aeaa1d7586c6d9356cc321cc86b7ebb62"><div class="ttname"><a href="structFemuCtrl.html#aeaa1d7586c6d9356cc321cc86b7ebb62">FemuCtrl::id_ns_zoned</a></div><div class="ttdeci">NvmeIdNsZoned * id_ns_zoned</div><div class="ttdef"><b>Definition:</b> nvme.h:1190</div></div>
<div class="ttc" id="azns_8h_html_aa03c395f4bba42d5fc5b8ef247b082ae"><div class="ttname"><a href="zns_8h.html#aa03c395f4bba42d5fc5b8ef247b082ae">zns_zone_rd_boundary</a></div><div class="ttdeci">static uint64_t zns_zone_rd_boundary(NvmeNamespace *ns, NvmeZone *zone)</div><div class="ttdef"><b>Definition:</b> zns.h:163</div></div>
<div class="ttc" id="astructNvmeCmd_html_a520cb16bdabbb80e149a2696357ae01c"><div class="ttname"><a href="structNvmeCmd.html#a520cb16bdabbb80e149a2696357ae01c">NvmeCmd::psdt</a></div><div class="ttdeci">uint16_t psdt</div><div class="ttdef"><b>Definition:</b> nvme.h:294</div></div>
<div class="ttc" id="azns_8c_html_a5fa5b88257a067bda683c7f981b39524"><div class="ttname"><a href="zns_8c.html#a5fa5b88257a067bda683c7f981b39524">zns_check_zone_write</a></div><div class="ttdeci">static uint16_t zns_check_zone_write(FemuCtrl *n, NvmeNamespace *ns, NvmeZone *zone, uint64_t slba, uint32_t nlb, bool append)</div><div class="ttdef"><b>Definition:</b> zns.c:316</div></div>
<div class="ttc" id="azns_8h_html_ad7a1a230fc044bbd799963b157b06c96aa7bb2898d42b87813864238178fa9354"><div class="ttname"><a href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96aa7bb2898d42b87813864238178fa9354">NVME_ZONE_REPORT_CLOSED</a></div><div class="ttdeci">@ NVME_ZONE_REPORT_CLOSED</div><div class="ttdef"><b>Definition:</b> zns.h:37</div></div>
<div class="ttc" id="adma_8c_html_aff05c76845a6cc08d0131d2761153493"><div class="ttname"><a href="dma_8c.html#aff05c76845a6cc08d0131d2761153493">nvme_map_prp</a></div><div class="ttdeci">uint16_t nvme_map_prp(QEMUSGList *qsg, QEMUIOVector *iov, uint64_t prp1, uint64_t prp2, uint32_t len, FemuCtrl *n)</div><div class="ttdef"><b>Definition:</b> dma.c:23</div></div>
<div class="ttc" id="astructFemuCtrl_html_aaad2dc59565b90a54c8b118032d67801"><div class="ttname"><a href="structFemuCtrl.html#aaad2dc59565b90a54c8b118032d67801">FemuCtrl::zone_array</a></div><div class="ttdeci">NvmeZone * zone_array</div><div class="ttdef"><b>Definition:</b> nvme.h:1191</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4ac15d4a175d76002c99d321be8104866c"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4ac15d4a175d76002c99d321be8104866c">NVME_ZONE_READ_ONLY</a></div><div class="ttdeci">@ NVME_ZONE_READ_ONLY</div><div class="ttdef"><b>Definition:</b> nvme.h:559</div></div>
<div class="ttc" id="azns_8h_html_af6b7cd466fb58a480d24a7c8ed1fb2ee"><div class="ttname"><a href="zns_8h.html#af6b7cd466fb58a480d24a7c8ed1fb2ee">NvmeZoneDescr</a></div><div class="ttdeci">struct QEMU_PACKED NvmeZoneDescr NvmeZoneDescr</div></div>
<div class="ttc" id="azns_8c_html_a8f09f2d274ee382c164ad442bb4f3e47"><div class="ttname"><a href="zns_8c.html#a8f09f2d274ee382c164ad442bb4f3e47">zns_clear_zone</a></div><div class="ttdeci">static void zns_clear_zone(NvmeNamespace *ns, NvmeZone *zone)</div><div class="ttdef"><b>Definition:</b> zns.c:163</div></div>
<div class="ttc" id="astructNvmeZoneReportHeader_html_a95ea3874aec112d532276a06fd2afbd7"><div class="ttname"><a href="structNvmeZoneReportHeader.html#a95ea3874aec112d532276a06fd2afbd7">NvmeZoneReportHeader::nr_zones</a></div><div class="ttdeci">uint64_t nr_zones</div><div class="ttdef"><b>Definition:</b> zns.h:23</div></div>
<div class="ttc" id="azns_8h_html_ad7a1a230fc044bbd799963b157b06c96ab5d96bcc1fd68002871e534bb0e88679"><div class="ttname"><a href="zns_8h.html#ad7a1a230fc044bbd799963b157b06c96ab5d96bcc1fd68002871e534bb0e88679">NVME_ZONE_REPORT_ALL</a></div><div class="ttdeci">@ NVME_ZONE_REPORT_ALL</div><div class="ttdef"><b>Definition:</b> zns.h:33</div></div>
<div class="ttc" id="astructNvmeZonedResult_html"><div class="ttname"><a href="structNvmeZonedResult.html">NvmeZonedResult</a></div><div class="ttdef"><b>Definition:</b> zns.h:6</div></div>
<div class="ttc" id="azns_8c_html_ad5f4088354d2555f9d66e2ba441592ff"><div class="ttname"><a href="zns_8c.html#ad5f4088354d2555f9d66e2ba441592ff">zns_auto_open_zone</a></div><div class="ttdeci">static uint16_t zns_auto_open_zone(NvmeNamespace *ns, NvmeZone *zone)</div><div class="ttdef"><b>Definition:</b> zns.c:419</div></div>
<div class="ttc" id="astructNvmeZoneReportHeader_html"><div class="ttname"><a href="structNvmeZoneReportHeader.html">NvmeZoneReportHeader</a></div><div class="ttdef"><b>Definition:</b> zns.h:22</div></div>
<div class="ttc" id="astructNvmeNamespace_html_a1868691a915c0a0cc8eeef08fe969f51"><div class="ttname"><a href="structNvmeNamespace.html#a1868691a915c0a0cc8eeef08fe969f51">NvmeNamespace::size</a></div><div class="ttdeci">uint64_t size</div><div class="ttdef"><b>Definition:</b> nvme.h:1066</div></div>
<div class="ttc" id="azns_8c_html_a6e03af0f3d0b7c597d9137a0b18bca56"><div class="ttname"><a href="zns_8c.html#a6e03af0f3d0b7c597d9137a0b18bca56">zns_zone_mgmt_recv</a></div><div class="ttdeci">static uint16_t zns_zone_mgmt_recv(FemuCtrl *n, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> zns.c:891</div></div>
<div class="ttc" id="astructNvmeRequest_html_a8cec02fb87e647c828d06f533aec8758"><div class="ttname"><a href="structNvmeRequest.html#a8cec02fb87e647c828d06f533aec8758">NvmeRequest::cqe</a></div><div class="ttdeci">NvmeCqe cqe</div><div class="ttdef"><b>Definition:</b> nvme.h:976</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4aa17e6457f1ee4cbc398f2da7fcf2fc4f"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4aa17e6457f1ee4cbc398f2da7fcf2fc4f">NVME_ZONE_INVAL_TRANSITION</a></div><div class="ttdeci">@ NVME_ZONE_INVAL_TRANSITION</div><div class="ttdef"><b>Definition:</b> nvme.h:564</div></div>
<div class="ttc" id="azns_8h_html_a175b9ee53a65f84e7ede4410eca5686cae7fa22feb03f5e24adf5a3d1e8c62872"><div class="ttname"><a href="zns_8h.html#a175b9ee53a65f84e7ede4410eca5686cae7fa22feb03f5e24adf5a3d1e8c62872">NVME_ZONE_REPORT</a></div><div class="ttdeci">@ NVME_ZONE_REPORT</div><div class="ttdef"><b>Definition:</b> zns.h:28</div></div>
<div class="ttc" id="azns_8c_html_a02ec33ad0c6f39ad701ac9ea780811c4"><div class="ttname"><a href="zns_8c.html#a02ec33ad0c6f39ad701ac9ea780811c4">zns_auto_transition_zone</a></div><div class="ttdeci">static void zns_auto_transition_zone(NvmeNamespace *ns)</div><div class="ttdef"><b>Definition:</b> zns.c:402</div></div>
<div class="ttc" id="astructFemuCtrl_html_aa7cfd4a7ec5ef933c85eeee459b97a7d"><div class="ttname"><a href="structFemuCtrl.html#aa7cfd4a7ec5ef933c85eeee459b97a7d">FemuCtrl::cross_zone_read</a></div><div class="ttdeci">bool cross_zone_read</div><div class="ttdef"><b>Definition:</b> nvme.h:1181</div></div>
<div class="ttc" id="azns_8h_html_a175b9ee53a65f84e7ede4410eca5686cad3280c3e4f22285e4865aff0184b7144"><div class="ttname"><a href="zns_8h.html#a175b9ee53a65f84e7ede4410eca5686cad3280c3e4f22285e4865aff0184b7144">NVME_ZONE_REPORT_EXTENDED</a></div><div class="ttdeci">@ NVME_ZONE_REPORT_EXTENDED</div><div class="ttdef"><b>Definition:</b> zns.h:29</div></div>
<div class="ttc" id="anvme_8h_html_a01e3a918ff89282c841471f5d797fbf6af03a6460a154989e7816c9518c281422"><div class="ttname"><a href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6af03a6460a154989e7816c9518c281422">NVME_CMD_ZONE_APPEND</a></div><div class="ttdeci">@ NVME_CMD_ZONE_APPEND</div><div class="ttdef"><b>Definition:</b> nvme.h:342</div></div>
<div class="ttc" id="astructFemuCtrl_html_ab4f555e0b42bfe51c089ab004c88ff48"><div class="ttname"><a href="structFemuCtrl.html#ab4f555e0b42bfe51c089ab004c88ff48">FemuCtrl::mbe</a></div><div class="ttdeci">SsdDramBackend * mbe</div><div class="ttdef"><b>Definition:</b> nvme.h:1308</div></div>
<div class="ttc" id="azns_8h_html_a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b"><div class="ttname"><a href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a01e2b371b7d8606267e1d9636df79b9b">NVME_ZONE_STATE_CLOSED</a></div><div class="ttdeci">@ NVME_ZONE_STATE_CLOSED</div><div class="ttdef"><b>Definition:</b> zns.h:74</div></div>
<div class="ttc" id="azns_8h_html_a71c2dafc519a9ac21e152ff2167ac42ca493593fedcfbf64c0571f0b8cb4cc603"><div class="ttname"><a href="zns_8h.html#a71c2dafc519a9ac21e152ff2167ac42ca493593fedcfbf64c0571f0b8cb4cc603">NVME_ZONE_TYPE_SEQ_WRITE</a></div><div class="ttdeci">@ NVME_ZONE_TYPE_SEQ_WRITE</div><div class="ttdef"><b>Definition:</b> zns.h:45</div></div>
<div class="ttc" id="astructNvmeZoneDescr_html_a5360d246a3f047192480695171e0d37f"><div class="ttname"><a href="structNvmeZoneDescr.html#a5360d246a3f047192480695171e0d37f">NvmeZoneDescr::zcap</a></div><div class="ttdeci">uint64_t zcap</div><div class="ttdef"><b>Definition:</b> zns.h:63</div></div>
<div class="ttc" id="astructFemuExtCtrlOps_html_a5a0b55a8db93619bd96e347ed4c7a930"><div class="ttname"><a href="structFemuExtCtrlOps.html#a5a0b55a8db93619bd96e347ed4c7a930">FemuExtCtrlOps::state</a></div><div class="ttdeci">void * state</div><div class="ttdef"><b>Definition:</b> nvme.h:1160</div></div>
<div class="ttc" id="anvme_8h_html_a11cbb7fe027f15d75255035b8993bd4ea0493c6b9a42545699964aba6dc94d342"><div class="ttname"><a href="nvme_8h.html#a11cbb7fe027f15d75255035b8993bd4ea0493c6b9a42545699964aba6dc94d342">NVME_PSDT_PRP</a></div><div class="ttdeci">@ NVME_PSDT_PRP</div><div class="ttdef"><b>Definition:</b> nvme.h:285</div></div>
<div class="ttc" id="astructFemuCtrl_html_a9d862ea82682f6232413280b92ddc4d1"><div class="ttname"><a href="structFemuCtrl.html#a9d862ea82682f6232413280b92ddc4d1">FemuCtrl::parent_obj</a></div><div class="ttdeci">PCIDevice parent_obj</div><div class="ttdef"><b>Definition:</b> nvme.h:1171</div></div>
<div class="ttc" id="anvme_8h_html_a01e3a918ff89282c841471f5d797fbf6a13421e16e166f06ef616c86258232336"><div class="ttname"><a href="nvme_8h.html#a01e3a918ff89282c841471f5d797fbf6a13421e16e166f06ef616c86258232336">NVME_CMD_READ</a></div><div class="ttdeci">@ NVME_CMD_READ</div><div class="ttdef"><b>Definition:</b> nvme.h:335</div></div>
<div class="ttc" id="azns_8h_html_a2e93736ade251765711cae3a888e25b9a9f9310a3aab3b20b1dc6ea8a2b658add"><div class="ttname"><a href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a9f9310a3aab3b20b1dc6ea8a2b658add">NVME_ZONE_STATE_READ_ONLY</a></div><div class="ttdeci">@ NVME_ZONE_STATE_READ_ONLY</div><div class="ttdef"><b>Definition:</b> zns.h:75</div></div>
<div class="ttc" id="astructFemuCtrl_html_ac31c5055e8db3e4124d1bceb15d16f6b"><div class="ttname"><a href="structFemuCtrl.html#ac31c5055e8db3e4124d1bceb15d16f6b">FemuCtrl::zd_extension_size</a></div><div class="ttdeci">uint32_t zd_extension_size</div><div class="ttdef"><b>Definition:</b> nvme.h:1186</div></div>
<div class="ttc" id="astructNvmeZoneDescr_html"><div class="ttname"><a href="structNvmeZoneDescr.html">NvmeZoneDescr</a></div><div class="ttdef"><b>Definition:</b> zns.h:58</div></div>
<div class="ttc" id="azns_8c_html_a21f29cc79d1f772a1244c0f512171c0a"><div class="ttname"><a href="zns_8c.html#a21f29cc79d1f772a1244c0f512171c0a">zns_offline_zone</a></div><div class="ttdeci">static uint16_t zns_offline_zone(NvmeNamespace *ns, NvmeZone *zone, NvmeZoneState state, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> zns.c:618</div></div>
<div class="ttc" id="astructFemuCtrl_html_a33144e9a783e4a96c1149c2fc04b4704"><div class="ttname"><a href="structFemuCtrl.html#a33144e9a783e4a96c1149c2fc04b4704">FemuCtrl::nr_open_zones</a></div><div class="ttdeci">int32_t nr_open_zones</div><div class="ttdef"><b>Definition:</b> nvme.h:1201</div></div>
<div class="ttc" id="aunionNvmeCmdDptr_html_a9fc9a97c707652c679097b32ffd84bc3"><div class="ttname"><a href="unionNvmeCmdDptr.html#a9fc9a97c707652c679097b32ffd84bc3">NvmeCmdDptr::prp2</a></div><div class="ttdeci">uint64_t prp2</div><div class="ttdef"><b>Definition:</b> nvme.h:278</div></div>
<div class="ttc" id="astructFemuCtrl_html_a22f0cfaa256d6bc65497853249789c83"><div class="ttname"><a href="structFemuCtrl.html#a22f0cfaa256d6bc65497853249789c83">FemuCtrl::zoned</a></div><div class="ttdeci">bool zoned</div><div class="ttdef"><b>Definition:</b> nvme.h:1180</div></div>
<div class="ttc" id="astructFemuCtrl_html_a98ca6ff3bc65ccc7f98a589e018b7d71"><div class="ttname"><a href="structFemuCtrl.html#a98ca6ff3bc65ccc7f98a589e018b7d71">FemuCtrl::namespaces</a></div><div class="ttdeci">NvmeNamespace * namespaces</div><div class="ttdef"><b>Definition:</b> nvme.h:1265</div></div>
<div class="ttc" id="astructNvmeRwCmd_html_a34ba11f86be8f5d4be5518370faf2514"><div class="ttname"><a href="structNvmeRwCmd.html#a34ba11f86be8f5d4be5518370faf2514">NvmeRwCmd::nlb</a></div><div class="ttdeci">uint16_t nlb</div><div class="ttdef"><b>Definition:</b> nvme.h:425</div></div>
<div class="ttc" id="azns_8h_html_a2e93736ade251765711cae3a888e25b9a044a8bce6652c9e617f784a37f643d38"><div class="ttname"><a href="zns_8h.html#a2e93736ade251765711cae3a888e25b9a044a8bce6652c9e617f784a37f643d38">NVME_ZONE_STATE_IMPLICITLY_OPEN</a></div><div class="ttdeci">@ NVME_ZONE_STATE_IMPLICITLY_OPEN</div><div class="ttdef"><b>Definition:</b> zns.h:72</div></div>
<div class="ttc" id="azns_8c_html_a8910113c66e3bce77dbbdbb560d9aefd"><div class="ttname"><a href="zns_8c.html#a8910113c66e3bce77dbbdbb560d9aefd">zns_exit</a></div><div class="ttdeci">static void zns_exit(FemuCtrl *n)</div><div class="ttdef"><b>Definition:</b> zns.c:1305</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a93e2646391dead4a07fa746cb4c6c75d"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a93e2646391dead4a07fa746cb4c6c75d">NVME_ZONE_TOO_MANY_OPEN</a></div><div class="ttdeci">@ NVME_ZONE_TOO_MANY_OPEN</div><div class="ttdef"><b>Definition:</b> nvme.h:563</div></div>
<div class="ttc" id="azns_8c_html_aa9deb4d27a553448ab81440798d09fb7"><div class="ttname"><a href="zns_8c.html#aa9deb4d27a553448ab81440798d09fb7">zns_bulk_proc_zone</a></div><div class="ttdeci">static uint16_t zns_bulk_proc_zone(NvmeNamespace *ns, NvmeZone *zone, enum NvmeZoneProcessingMask proc_mask, op_handler_t op_hndlr, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> zns.c:650</div></div>
<div class="ttc" id="azns_8c_html_a299230188329a14db7c7542d2764c7ce"><div class="ttname"><a href="zns_8c.html#a299230188329a14db7c7542d2764c7ce">zns_init_zone_cap</a></div><div class="ttdeci">static int zns_init_zone_cap(FemuCtrl *n)</div><div class="ttdef"><b>Definition:</b> zns.c:1258</div></div>
<div class="ttc" id="astructFemuCtrl_html_a101d7d739551ef1fafb2df650b9cf155"><div class="ttname"><a href="structFemuCtrl.html#a101d7d739551ef1fafb2df650b9cf155">FemuCtrl::num_zones</a></div><div class="ttdeci">uint32_t num_zones</div><div class="ttdef"><b>Definition:</b> nvme.h:1196</div></div>
<div class="ttc" id="astructNvmeZoneDescr_html_a626c7b988cfde334d69cae1ff7a9fe2c"><div class="ttname"><a href="structNvmeZoneDescr.html#a626c7b988cfde334d69cae1ff7a9fe2c">NvmeZoneDescr::zslba</a></div><div class="ttdeci">uint64_t zslba</div><div class="ttdef"><b>Definition:</b> zns.h:64</div></div>
<div class="ttc" id="astructFemuCtrl_html_a6d0418e38e888b2b8980a34198bfd463"><div class="ttname"><a href="structFemuCtrl.html#a6d0418e38e888b2b8980a34198bfd463">FemuCtrl::page_size</a></div><div class="ttdeci">uint16_t page_size</div><div class="ttdef"><b>Definition:</b> nvme.h:1210</div></div>
<div class="ttc" id="astructNvmeZone_html_a63c9307f75b339e60aa2cd6f5b839724"><div class="ttname"><a href="structNvmeZone.html#a63c9307f75b339e60aa2cd6f5b839724">NvmeZone::d</a></div><div class="ttdeci">NvmeZoneDescr d</div><div class="ttdef"><b>Definition:</b> zns.h:102</div></div>
<div class="ttc" id="azns_8c_html_a52ee538a6713c7b29769f23b61dad575"><div class="ttname"><a href="zns_8c.html#a52ee538a6713c7b29769f23b61dad575">zns_check_dulbe</a></div><div class="ttdeci">static uint16_t zns_check_dulbe(NvmeNamespace *ns, uint64_t slba, uint32_t nlb)</div><div class="ttdef"><b>Definition:</b> zns.c:1111</div></div>
<div class="ttc" id="azns_8c_html_ace4f37fd873afd711375d7c88dc333ff"><div class="ttname"><a href="zns_8c.html#ace4f37fd873afd711375d7c88dc333ff">zns_set_ctrl</a></div><div class="ttdeci">static void zns_set_ctrl(FemuCtrl *n)</div><div class="ttdef"><b>Definition:</b> zns.c:1249</div></div>
<div class="ttc" id="azns_8c_html_a4c27f4956bf97dcabba73019e80b191a"><div class="ttname"><a href="zns_8c.html#a4c27f4956bf97dcabba73019e80b191a">zns_start_ctrl</a></div><div class="ttdeci">static int zns_start_ctrl(FemuCtrl *n)</div><div class="ttdef"><b>Definition:</b> zns.c:1272</div></div>
<div class="ttc" id="anvme_8h_html_a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c"><div class="ttname"><a href="nvme_8h.html#a2259ab6ad32aaf55b340159f4fb043f4a8b85ba3cbcb57ab6be06fdced051d11c">NVME_INVALID_FIELD</a></div><div class="ttdeci">@ NVME_INVALID_FIELD</div><div class="ttdef"><b>Definition:</b> nvme.h:522</div></div>
<div class="ttc" id="astructFemuCtrl_html_ac3284df15757fa3c9e773199fa426d51"><div class="ttname"><a href="structFemuCtrl.html#ac3284df15757fa3c9e773199fa426d51">FemuCtrl::zone_cap_bs</a></div><div class="ttdeci">bool zone_cap_bs</div><div class="ttdef"><b>Definition:</b> nvme.h:1183</div></div>
<div class="ttc" id="azns_8h_html_a63a81710dc2a7e2e61f2b7ace02a538a"><div class="ttname"><a href="zns_8h.html#a63a81710dc2a7e2e61f2b7ace02a538a">zns_ns_lbads</a></div><div class="ttdeci">static uint8_t zns_ns_lbads(NvmeNamespace *ns)</div><div class="ttdef"><b>Definition:</b> zns.h:135</div></div>
<div class="ttc" id="astructNvmeFeatureVal_html_a63adb2ba3685f4bf39e7375c37be8b14"><div class="ttname"><a href="structNvmeFeatureVal.html#a63adb2ba3685f4bf39e7375c37be8b14">NvmeFeatureVal::err_rec</a></div><div class="ttdeci">uint32_t err_rec</div><div class="ttdef"><b>Definition:</b> nvme.h:789</div></div>
<div class="ttc" id="azns_8c_html_a4285aad08edb64a1c6aea72ad77f8338"><div class="ttname"><a href="zns_8c.html#a4285aad08edb64a1c6aea72ad77f8338">zns_zone_append</a></div><div class="ttdeci">static uint16_t zns_zone_append(FemuCtrl *n, NvmeRequest *req)</div><div class="ttdef"><b>Definition:</b> zns.c:1106</div></div>
<div class="ttc" id="anvme_8h_html_a50171c329ed9567d9e35cd7bade09800"><div class="ttname"><a href="nvme_8h.html#a50171c329ed9567d9e35cd7bade09800">femu_err</a></div><div class="ttdeci">#define femu_err(fmt,...)</div><div class="ttdef"><b>Definition:</b> nvme.h:1489</div></div>
<div class="ttc" id="azns_8c_html_a755fef089b9a7fc5ddd4be2d53455955"><div class="ttname"><a href="zns_8c.html#a755fef089b9a7fc5ddd4be2d53455955">zns_zone_idx</a></div><div class="ttdeci">static uint32_t zns_zone_idx(NvmeNamespace *ns, uint64_t slba)</div><div class="ttdef"><b>Definition:</b> zns.c:7</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_6c6e843608783eea365fe594895ecbc0.html">zns</a></li><li class="navelem"><a class="el" href="zns_8c.html">zns.c</a></li>
    <li class="footer">制作者
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
